<!DOCTYPE html><html lang="en-us" dir="ltr"> <head><script async src="https://ot.www.cloudflare.com/public/vendor/onetrust/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" data-domain-script="b1e05d49-f072-4bae-9116-bdb78af15448"></script><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="KeThzeyMOr"><meta name="baidu-site-verification" content="code-NIlrS7gNhx"><meta charset="UTF-8"><meta name="description" content="Get the latest news on how products at Cloudflare are built, technologies used, and open positions to join the teams helping to build a better Internet."><title>JavaScript</title><meta name="title" content="JavaScript"><meta name="msvalidate.01" content="CF295E1604697F9CAD18B5A232E871F6"><meta class="swiftype" name="language" data-type="string" content="en"><script src="/static/z/i.js" type="text/javascript" referrerpolicy="origin"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-32x32.png"><link rel="mask-icon" href="/images/favicon-32x32.png" color="#f78100"><link rel="stylesheet" href="/themes/ashes.min.css"><link rel="sitemap" href="/sitemap.xml"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link rel="canonical" href="https://blog.cloudflare.com/tag/javascript/"><link rel="alternate" type="application/rss+xml" title="Cloudflare Javascript RSS Feed" href="/tag/javascript/rss"><link rel="alternate" hreflang="en-us" href="https://blog.cloudflare.com/tag/javascript/"><link rel="alternate" hreflang="de-de" href="https://blog.cloudflare.com/de-de/tag/javascript/"><link rel="alternate" hreflang="es-es" href="https://blog.cloudflare.com/es-es/tag/javascript/"><link rel="alternate" hreflang="fr-fr" href="https://blog.cloudflare.com/fr-fr/tag/javascript/"><link rel="alternate" hreflang="ja-jp" href="https://blog.cloudflare.com/ja-jp/tag/javascript/"><link rel="alternate" hreflang="ko-kr" href="https://blog.cloudflare.com/ko-kr/tag/javascript/"><link rel="alternate" hreflang="zh-tw" href="https://blog.cloudflare.com/zh-tw/tag/javascript/"><link rel="alternate" hreflang="zh-cn" href="https://blog.cloudflare.com/zh-cn/tag/javascript/"><link rel="alternate" hreflang="pt-br" href="https://blog.cloudflare.com/pt-br/tag/javascript/"><!-- General Meta Tags --><meta property="article:publisher" content="https://www.facebook.com/cloudflare"><!-- Facebook Meta Tags --><meta property="og:site_name" content="The Cloudflare Blog"><meta property="og:type" content="website"><meta property="og:title" content="The Cloudflare Blog: JavaScript"><meta property="og:description" content="Collection of Cloudflare blog posts tagged 'JavaScript'"><meta property="og:url" content="https://blog.cloudflare.com/tag/javascript/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="628"><!-- Twitter/X Meta Tags --><meta name="twitter:title" content="The Cloudflare Blog: JavaScript"><meta name="twitter:description" content="Collection of Cloudflare blog posts tagged 'JavaScript'"><meta name="twitter:url" content="https://blog.cloudflare.com/tag/javascript/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@cloudflare"><meta property="og:image"><meta name="twitter:image"><link rel="stylesheet" href="/_astro/index.DAblDsYO.css"></head><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="25IqC0" component-url="/_astro/GoogleAnalytics.o7SaAFZX.js" component-export="GoogleAnalytics" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;title&quot;:[0,&quot;JavaScript&quot;],&quot;canonical&quot;:[0,&quot;https://blog.cloudflare.com/tag/javascript&quot;],&quot;info&quot;:[0],&quot;tagInfo&quot;:[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/javascript&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;visibility&quot;:[0,&quot;public&quot;],&quot;feature_image&quot;:[0,&quot;&quot;],&quot;publicly_index&quot;:[0,true]}],&quot;authorInfo&quot;:[0],&quot;translatedPosts&quot;:[1,[]]}" ssr client="only" opts="{&quot;name&quot;:&quot;GoogleAnalytics&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island><script>(()=>{var l=(n,t)=>{let i=async()=>{await(await n())()},e=typeof t.value=="object"?t.value:void 0,s={timeout:e==null?void 0:e.timeout};"requestIdleCallback"in window?window.requestIdleCallback(i,s):setTimeout(i,s.timeout||200)};(self.Astro||(self.Astro={})).idle=l;window.dispatchEvent(new Event("astro:idle"));})();</script><astro-island uid="ZRth6s" prefix="r8" component-url="/_astro/Navigation.JWiNRNo9.js" component-export="Navigation" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;logo&quot;:[0,&quot;//images.ctfassets.net/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png&quot;],&quot;pagesStore&quot;:[0,{&quot;page&quot;:[0,&quot;Tag&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;],&quot;translationsAvailable&quot;:[1,[[0,&quot;de-de&quot;],[0,&quot;es-es&quot;],[0,&quot;fr-fr&quot;],[0,&quot;ja-jp&quot;],[0,&quot;ko-kr&quot;],[0,&quot;zh-tw&quot;],[0,&quot;zh-cn&quot;],[0,&quot;pt-br&quot;]]],&quot;navData&quot;:[1,[[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T22:44:28.803Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-06-17T05:04:39.288Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,153],&quot;revision&quot;:[0,44],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;AI&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:21.536Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-05-19T05:03:04.375Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,135],&quot;revision&quot;:[0,46],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Developers&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;5kZtWqjqa7aOUoZr8NFGwI&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:26.040Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-30T14:03:57.409Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,142],&quot;revision&quot;:[0,43],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;name&quot;:[0,&quot;Radar&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:20.198Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-09T11:02:56.665Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,68],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Product News&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:42:46.231Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-09T11:02:54.136Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,134],&quot;revision&quot;:[0,41],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Security&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;16yk8DVbNNifxov5cWvAov&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:56:23.848Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:54.104Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,65],&quot;revision&quot;:[0,29],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;name&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;slug&quot;:[0,&quot;policy&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:46.068Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:53.720Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,136],&quot;revision&quot;:[0,44],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Zero Trust&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;48r7QV00gLMWOIcM1CSDRy&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:54:22.790Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:52.422Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,66],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;name&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;slug&quot;:[0,&quot;speed-and-reliability&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4g8tPriKOAUwdUT4jNPebe&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:40.927Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:51.235Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,77],&quot;revision&quot;:[0,29],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;name&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;slug&quot;:[0,&quot;life-at-cloudflare&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;V86khSc459Yi1AhTlvtY7&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:53.657Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-02-04T17:12:59.473Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,57],&quot;revision&quot;:[0,21],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Partners&quot;],&quot;name&quot;:[0,&quot;Partners&quot;],&quot;slug&quot;:[0,&quot;partners&quot;],&quot;featured&quot;:[0,true]}]}]]]}],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="idle" opts="{&quot;name&quot;:&quot;NavigationComponent&quot;,&quot;value&quot;:true}" await-children><header class="flex flex-row flex-wrap justify-between items-flex-end mw8 center mv3 pl3 pr1"><div class="w-100 flex items-flex-end justify-between justify-start-l"><div class="w-100 tr flex justify-end"><div class="flex justify-between items-center"><span class="dn di-l pr1"><a href="https://dash.cloudflare.com/sign-up" class="f1 blue1 dn di-l b no-underline underline-hover" target="_blank" rel="noreferrer">Get Started Free</a></span><span class="f1 gray4 dn di-l pr1">|</span><span class="dn di-l"><a target="_blank" href="https://www.cloudflare.com/plans/enterprise/contact/" class="f1 gray4 no-underline underline-hover pr1" rel="noreferrer">Contact Sales</a></span><span class="f1 gray4 dn di-l pr1">|</span><div class="relative flex cf-dropdown"><div class="flex items-center" dir="ltr"><button type="button" class="f1 gray4 no-underline language-picker js-language-picker" style="background:transparent;border:none;padding:0"><span class="language-picker__globe-icon"></span><span class="language-picker__caret-icon ph1">▼</span></button></div></div></div></div></div><div class="w-100 w-50-l flex items-end nb5 nb1-l"><a href="/" class="header-logo mr4 dn db-l"><img class="header-logo" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png" alt="The Cloudflare Blog" width="170" height="57"/></a><h2 class="mt0 mb1 dn di-l"><a href="/" class="fw5 f5 gray3 no-underline"><span class="dn di-l">The Cloudflare Blog</span></a></h2></div><div class="w-100 w-50-l dn db-l"><div class="w-100 tr mkto-sub-message"><p class="f2">Subscribe to receive notifications of new posts:</p></div><div class="w-100 tr"><div class="marketo-form-container"><form id="mktoForm_1653"><div class="top-subscribe-form-container"><div class="top-subscribe-form-field"><input placeholder="Email Address" class="top-subscribe-form-input" name="email" type="email" title="Must be valid email."/></div><button class="top-subscribe-form-button" type="button">Subscribe</button></div></form></div></div></div></header><nav dir="ltr" class="bb b--black-10 db dn-l w-100 ph3 "><div class=" flex justify-between items-center" style="height:44px"><a href="/search/"><img class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a><button type="button" style="background:transparent;border:none"><img src="/images/hamburger.svg" alt="hamburger menu"/></button></div><div class="js-mobile-nav-container dn"><div class="flex flex-column flex-wrap bg-gray9 o-95 absolute ph3 z-1 left-0 right-0 mx-4"><div class="pv3 ph2 tl"><a href="/tag/ai/" class="no-underline gray1 f4 fw7">AI</a></div><div class="pv3 ph2 tl"><a href="/tag/developers/" class="no-underline gray1 f4 fw7">Developers</a></div><div class="pv3 ph2 tl"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f4 fw7">Radar</a></div><div class="pv3 ph2 tl"><a href="/tag/product-news/" class="no-underline gray1 f4 fw7">Product News</a></div><div class="pv3 ph2 tl"><a href="/tag/security/" class="no-underline gray1 f4 fw7">Security</a></div><div class="pv3 ph2 tl"><a href="/tag/policy/" class="no-underline gray1 f4 fw7">Policy &amp; Legal</a></div><div class="pv3 ph2 tl"><a href="/tag/zero-trust/" class="no-underline gray1 f4 fw7">Zero Trust</a></div><div class="pv3 ph2 tl"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f4 fw7">Speed &amp; Reliability</a></div><div class="pv3 ph2 tl"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f4 fw7">Life at Cloudflare</a></div><div class="pv3 ph2 tl"><a href="/tag/partners/" class="no-underline gray1 f4 fw7">Partners</a></div></div></div></nav><nav id="nav" class="w-100 bb-0 bb-l b--black-10 z-1"><div id="desktop-nav-items-container" class="flex flex-wrap justify-between items-center mw8 center mv3 mv0-l"><div data-tag="ai" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/ai/" class="no-underline gray1 f2 fw5 pv3">AI</a></div><div data-tag="developers" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/developers/" class="no-underline gray1 f2 fw5 pv3">Developers</a></div><div data-tag="cloudflare-radar" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f2 fw5 pv3">Radar</a></div><div data-tag="product-news" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/product-news/" class="no-underline gray1 f2 fw5 pv3">Product News</a></div><div data-tag="security" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/security/" class="no-underline gray1 f2 fw5 pv3">Security</a></div><div data-tag="policy" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/policy/" class="no-underline gray1 f2 fw5 pv3">Policy &amp; Legal</a></div><div data-tag="zero-trust" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/zero-trust/" class="no-underline gray1 f2 fw5 pv3">Zero Trust</a></div><div data-tag="speed-and-reliability" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f2 fw5 pv3">Speed &amp; Reliability</a></div><div data-tag="life-at-cloudflare" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f2 fw5 pv3">Life at Cloudflare</a></div><div data-tag="partners" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/partners/" class="no-underline gray1 f2 fw5 pv3">Partners</a></div><div class="nav-item ml2 mr3 dn db-l pv3" data-tag="search icon"><a href="/search/"><img id="search-icon" class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a></div></div></nav><!--astro:end--></astro-island> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script> <div class="flex flex-row flex-wrap mw8 center bb b--gray8 ph3"> <h1 class="site-title f7 fw4 mt4 mb3 mv4-l">JavaScript</h1> </div> <main id="site-main" class="flex flex-row flex-wrap mw8 center pt0 pt3-l mt4-l"> <astro-island uid="Z1txy6K" prefix="r0" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,true],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;3cuVG8K7iSqKV8O3fNrAYK&quot;],&quot;title&quot;:[0,&quot;We shipped FinalizationRegistry in Workers: why you should never use it&quot;],&quot;slug&quot;:[0,&quot;we-shipped-finalizationregistry-in-workers-why-you-should-never-use-it&quot;],&quot;excerpt&quot;:[0,&quot;Cloudflare Workers now support FinalizationRegistry, but just because you can use it doesn’t mean you should.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;We’ve recently added support for the &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/FinalizationRegistry\&quot;&gt;&lt;u&gt;FinalizationRegistry API&lt;/u&gt;&lt;/a&gt; in Cloudflare Workers. This API allows developers to request a callback when a JavaScript object is garbage-collected, a feature that can be particularly relevant for managing external resources, such as memory allocated by &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/WebAssembly\&quot;&gt;&lt;u&gt;WebAssembly&lt;/u&gt;&lt;/a&gt; (Wasm). However, despite its availability, our general advice is: &lt;b&gt;avoid using it directly in most scenarios.&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Our decision to add &lt;code&gt;FinalizationRegistry&lt;/code&gt; — while still cautioning against using it — opens up a bigger conversation: how memory management works when JavaScript and WebAssembly share the same runtime. This is becoming more common in high-performance web apps, and getting it wrong can lead to memory leaks, out-of-memory errors, and performance issues, especially in resource-constrained environments like Cloudflare Workers.&lt;/p&gt;&lt;p&gt;In this post, we’ll look at how JavaScript and Wasm handle memory differently, why that difference matters, and what &lt;code&gt;FinalizationRegistry&lt;/code&gt; is actually useful for. We’ll also explain its limitations, particularly around timing and predictability, walk through why we decided to support it, and how we’ve made it safer to use. Finally, we’ll talk about how newer JavaScript language features offer a more reliable and structured approach to solving these problems.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;memory-management-101\&quot;&gt;Memory management 101&lt;/h2&gt;\n            &lt;a href=\&quot;#memory-management-101\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;javascript\&quot;&gt;JavaScript&lt;/h3&gt;\n            &lt;a href=\&quot;#javascript\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;JavaScript relies on automatic memory management through a process called &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Memory_management#garbage_collection\&quot;&gt;&lt;u&gt;garbage collection&lt;/u&gt;&lt;/a&gt;. This means developers do not need to worry about freeing allocated memory, or lifetimes. The garbage collector identifies and reclaims memory occupied by objects that are no longer needed by the program (that is, garbage). This helps prevent memory leaks and simplifies memory management for developers.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;function greet() {\n  let name = &amp;quot;Alice&amp;quot;;         // String is allocated in memory\n  console.log(&amp;quot;Hello, &amp;quot; + name);\n}                             // &amp;#039;name&amp;#039; goes out of scope\n\ngreet();\n// JavaScript automatically frees allocated memory at some point in future&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;webassembly\&quot;&gt;WebAssembly&lt;/h3&gt;\n            &lt;a href=\&quot;#webassembly\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;WebAssembly (Wasm) is an assembly-like instruction format designed to run high-performance applications on the web. While it initially gained prominence in web browsers, Wasm is also highly effective on the server side. At Cloudflare, we leverage Wasm to enable users to run code written in a variety of programming languages, such as &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/rust/\&quot;&gt;&lt;u&gt;Rust&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/\&quot;&gt;&lt;u&gt;Python&lt;/u&gt;&lt;/a&gt;, directly within our &lt;a href=\&quot;https://www.cloudflare.com/learning/serverless/glossary/what-is-chrome-v8/\&quot;&gt;&lt;u&gt;V8 isolates&lt;/u&gt;&lt;/a&gt;, offering both performance and versatility.&lt;/p&gt;&lt;p&gt;Wasm runtimes are designed to be simple stack machines, and lack built-in garbage collectors. This necessitates manual memory management (allocation and deallocation of memory used by Wasm code), making it an ideal compilation target for languages like Rust and C++ that handle their own memory.&lt;/p&gt;&lt;p&gt;Wasm modules operate on &lt;a href=\&quot;https://webassembly.github.io/spec/core/exec/runtime.html#memory-instances\&quot;&gt;&lt;u&gt;linear memory&lt;/u&gt;&lt;/a&gt;: a resizable block of raw bytes, which JavaScript views as an &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/WebAssembly/Reference/JavaScript_interface/Memory\&quot;&gt;&lt;u&gt;ArrayBuffer&lt;/u&gt;&lt;/a&gt;. This memory is organized in 64 KB pages, and its initial size is defined when the module is compiled or loaded. Wasm code interacts with this memory using 32-bit offsets — integer values functioning as direct pointers that specify a byte offset from the start of its linear memory. This direct memory access model is crucial for Wasm&amp;#39;s high performance. The host environment (which in Cloudflare Workers is JavaScript) also shares this ArrayBuffer, reading and writing (often via &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray\&quot;&gt;&lt;u&gt;TypedArrays&lt;/u&gt;&lt;/a&gt;) to enable vital data exchange between Wasm and JavaScript.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3nWyMj5xginVWLxCnPpUdY/f939bb0b4f0007999aff876854645f16/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1494\&quot; height=\&quot;672\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;A core Wasm design is its &lt;a href=\&quot;https://webassembly.org/docs/security/\&quot;&gt;&lt;u&gt;secure sandbox&lt;/u&gt;&lt;/a&gt;. This confines Wasm code strictly to its own linear memory and explicitly declared imports from the host, preventing unauthorized memory access or system calls. Direct interaction with JavaScript objects is blocked; communication occurs through numeric values, function references, or operations on the shared ArrayBuffer. This strong isolation is vital for security, ensuring Wasm modules don&amp;#39;t interfere with the host or other application components, which is especially important in multi-tenant environments like Cloudflare Workers.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3Ck9v7opkB5Mg1agKNnQm7/c328cc0a2d1c3145a527e1267594fe1d/image2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1984\&quot; height=\&quot;844\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Bridging WebAssembly memory with JavaScript often involves writing low-level &amp;quot;glue&amp;quot; code to convert raw byte arrays from Wasm into usable JavaScript types. Doing this manually for every function or data structure is both tedious and error-prone. Fortunately, tools like &lt;a href=\&quot;https://rustwasm.github.io/wasm-bindgen/\&quot;&gt;&lt;u&gt;wasm-bindgen&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://emscripten.org/\&quot;&gt;&lt;u&gt;Emscripten (Embind)&lt;/u&gt;&lt;/a&gt; handle this interop automatically, generating the binding code needed to pass data cleanly between the two environments. We use these same tools under the hood — wasm-bindgen for Rust-based &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;&lt;u&gt;workers-rs&lt;/u&gt;&lt;/a&gt; projects, and Emscripten for &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/how-python-workers-work/\&quot;&gt;&lt;u&gt;Python Workers&lt;/u&gt;&lt;/a&gt; — to simplify integration and let developers focus on application logic rather than memory translation.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;interoperability\&quot;&gt;Interoperability&lt;/h2&gt;\n            &lt;a href=\&quot;#interoperability\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;High-performance web apps often use JavaScript for interactive UIs and data fetching, while WebAssembly handles demanding operations like media processing and complex calculations for significant performance gains, allowing developers to maximize efficiency. Given the difference in memory management models, developers need  to be careful when using WebAssembly memory in JavaScript.&lt;/p&gt;&lt;p&gt;For this example, we&amp;#39;ll use Rust to compile a WebAssembly module manually. Rust is a popular choice for WebAssembly because it offers precise control over memory and easy Wasm compilation using standard toolchains.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;rust\&quot;&gt;Rust&lt;/h3&gt;\n            &lt;a href=\&quot;#rust\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Here we have two simple functions. &lt;code&gt;make_buffer&lt;/code&gt; creates a string and returns a raw pointer back to JavaScript. The function intentionally “forgets” the memory allocated so that it doesn’t get cleaned up after the function returns. &lt;code&gt;free_buffer&lt;/code&gt;, on the other hand, expects the initial string reference handed back and frees the memory.&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;// Allocate a fresh byte buffer and hand the raw pointer + length to JS.\n// *We intentionally “forget” the Vec so Rust will not free it right away;\n//   JS now owns it and must call `free_buffer` later.*\n#[no_mangle]\npub extern &amp;quot;C&amp;quot; fn make_buffer(out_len: *mut usize) -&amp;gt; *mut u8 {\n    let mut data = b&amp;quot;Hello from Rust&amp;quot;.to_vec();\n    let ptr = data.as_mut_ptr();\n    let len  = data.len();\n\n    unsafe { *out_len = len };\n\n    std::mem::forget(data);\n    return ptr;\n}\n\n/// Counterpart that **must** be called by JS to avoid a leak.\n#[no_mangle]\npub unsafe extern &amp;quot;C&amp;quot; fn free_buffer(ptr: *mut u8, len: usize) {\n    let _ = Vec::from_raw_parts(ptr, len, len);\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;javascript\&quot;&gt;JavaScript&lt;/h3&gt;\n            &lt;a href=\&quot;#javascript\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Back in JavaScript land, we’ll call these Wasm functions and output them using console.log. This is a common pattern in Wasm-based applications since WebAssembly doesn’t have direct access to Web APIs, and rely on a JavaScript “glue” to interface with the outer world in order to do anything useful.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const { instance } = await WebAssembly.instantiate(WasmBytes, {});\n\nconst { memory, make_buffer, free_buffer } = instance.exports;\n\n//  Use the Rust functions\nconst lenPtr = 0;                 // scratch word in Wasm memory\nconst ptr = make_buffer(lenPtr);\n\nconst len = new DataView(memory.buffer).getUint32(lenPtr, true);\nconst data = new Uint8Array(memory.buffer, ptr, len);\n\nconsole.log(new TextDecoder().decode(data)); // “Hello from Rust”\n\nfree_buffer(ptr, len); // free_buffer must be called to prevent memory leaks&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You can find all code samples along with setup instructions &lt;a href=\&quot;https://github.com/cloudflare/cloudflare-blog/tree/master/2025-06-finalization-registry\&quot;&gt;&lt;u&gt;here&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;As you can see, working with Wasm memory from JavaScript requires care, as it introduces the risk of memory leaks if allocated memory isn’t properly released. JavaScript developers are often unfamiliar with manual memory management, and it’s easy to forget returning memory to WebAssembly after use. This can become especially tricky when Wasm-allocated data is passed into JavaScript libraries, making ownership and lifetime harder to track.&lt;/p&gt;&lt;p&gt;While occasional leaks may not cause immediate issues, over time they can lead to increased memory usage and degrade performance, particularly in memory-constrained environments like Cloudflare Workers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;finalizationregistry\&quot;&gt;FinalizationRegistry&lt;/h2&gt;\n            &lt;a href=\&quot;#finalizationregistry\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;&lt;code&gt;FinalizationRegistry&lt;/code&gt;, introduced as part of the &lt;a href=\&quot;https://tc39.es/proposal-weakrefs/\&quot;&gt;&lt;u&gt;TC-39 WeakRef proposal&lt;/u&gt;&lt;/a&gt;, is a JavaScript API which lets you run “finalizers” (aka cleanup callbacks) when an object gets garbage-collected. Let’s look at a simple example to demonstrate the API:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const my_registry = new FinalizationRegistry((obj) =&amp;gt; { console.log(&amp;quot;Cleaned up: &amp;quot; + obj); });\n\n{\n  let temporary = { key: &amp;quot;value&amp;quot; };\n  // Register this object in our FinalizationRegistry -- the second argument,\n  // &amp;quot;temporary&amp;quot;, will be passed to our callback as its obj parameter\n  my_registry.register(temporary, &amp;quot;temporary&amp;quot;);\n}\n\n// At some point in the future when temporary object gets garbage collected, we&amp;#039;ll see &amp;quot;Cleaned up: temporary&amp;quot; in our logs.&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Let’s see how we can use this API in our Wasm-based application:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const { instance } = await WebAssembly.instantiate(WasmBytes, {});\n\nconst { memory, make_buffer, free_buffer } = instance.exports;\n\n// FinalizationRegistry would be responsible for returning memory back to Wasm\nconst cleanupFr = new FinalizationRegistry(({ ptr, len }) =&amp;gt; {\n  free_buffer(ptr, len);\n});\n\n//  Use the Rust functions\nconst lenPtr = 0;                 // scratch word in Wasm memory\nconst ptr = make_buffer(lenPtr);\n\nconst len = new DataView(memory.buffer).getUint32(lenPtr, true);\nconst data = new Uint8Array(memory.buffer, ptr, len);\n\n// Register the data buffer in our FinalizationRegistry so that it gets cleaned up automatically\ncleanupFr.register(data, { ptr, len });\n\nconsole.log(new TextDecoder().decode(data));   // → “Hello from Rust”\n\n// No need to manually call free_buffer, FinalizationRegistry will do this for us&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We can use a &lt;code&gt;FinalizationRegistry&lt;/code&gt; to manage any object borrowed from WebAssembly by registering it with a finalizer that calls the appropriate free function. This is the same approach used by &lt;a href=\&quot;https://rustwasm.github.io/docs/wasm-bindgen/reference/weak-references.html\&quot;&gt;&lt;u&gt;wasm-bindgen&lt;/u&gt;&lt;/a&gt;. It shifts the burden of manual cleanup away from the JavaScript developer and delegates it to the JavaScript garbage collector. However, in practice, things aren’t quite that simple.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;inherent-issues-with-finalizationregistry\&quot;&gt;Inherent issues with FinalizationRegistry&lt;/h2&gt;\n            &lt;a href=\&quot;#inherent-issues-with-finalizationregistry\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;There is a fundamental issue with &lt;code&gt;FinalizationRegistry&lt;/code&gt;: garbage collection is non-deterministic, and may clean up your unused memory at some arbitrary point in the future. In some cases, garbage collection might not even run and your “finalizers” will never be triggered.&lt;/p&gt;&lt;p&gt;This is part of its &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/FinalizationRegistry#notes_on_cleanup_callbacks\&quot;&gt;&lt;u&gt;documentation&lt;/u&gt;&lt;/a&gt; as well:&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&lt;i&gt;“A conforming JavaScript implementation, even one that does garbage collection, is not required to call cleanup callbacks. When and whether it does so is entirely down to the implementation of the JavaScript engine. When a registered object is reclaimed, any cleanup callbacks for it may be called then, or some time later, or not at all.”&lt;/i&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Even Emscripten mentions this in their &lt;a href=\&quot;https://emscripten.org/docs/porting/connecting_cpp_and_javascript/embind.html#automatic-memory-management\&quot;&gt;&lt;u&gt;documentation&lt;/u&gt;&lt;/a&gt;: “&lt;i&gt;... finalizers are not guaranteed to be called, and even if they are, there are no guarantees about their timing or order of execution, which makes them unsuitable for general RAII-style resource management.&lt;/i&gt;”&lt;/p&gt;&lt;p&gt;Given their non-deterministic nature, developers seldom use finalizers for any essential program logic. Treat them as a last-ditch safety net, not as a primary cleanup mechanism — explicit, deterministic teardown logic is almost always safer, faster, and easier to reason about.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;enabling-finalizationregistry-in-workers\&quot;&gt;Enabling FinalizationRegistry in Workers&lt;/h2&gt;\n            &lt;a href=\&quot;#enabling-finalizationregistry-in-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Given its non-deterministic nature and limited early adoption, we initially disabled the &lt;code&gt;FinalizationRegistry&lt;/code&gt; API in our runtime. However, as usage of Wasm-based Workers grew — particularly among high-traffic customers — we began to see new demands emerge. One such customer was running an extremely high requests per second (RPS) workload using WebAssembly, and needed tight control over memory to sustain massive traffic spikes without degradation. This highlighted a gap in our memory management capabilities, especially in cases where manual cleanup wasn’t always feasible or reliable. As a result, we re-evaluated our stance and began exploring the challenges and trade-offs of enabling &lt;code&gt;FinalizationRegistry&lt;/code&gt; within the Workers environment, despite its known limitations.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;preventing-footguns-with-safe-defaults\&quot;&gt;Preventing footguns with safe defaults&lt;/h3&gt;\n            &lt;a href=\&quot;#preventing-footguns-with-safe-defaults\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Because this API could be misused and cause unpredictable results for our customers, we’ve added a few safeguards. Most importantly, cleanup callbacks are run without an active async context, which means they cannot perform any I/O. This includes sending events to a tail Worker, logging metrics, or making fetch requests.&lt;/p&gt;&lt;p&gt;While this might sound limiting, it’s very intentional. Finalization callbacks are meant for cleanup — especially for releasing WebAssembly memory — not for triggering side effects. If we allowed I/O here, developers might (accidentally) rely on finalizers to perform critical logic that depends on when garbage collection happens. That timing is non-deterministic and outside your control, which could lead to flaky, hard-to-debug behavior.&lt;/p&gt;&lt;p&gt;We don’t have full control over when V8’s garbage collector performs cleanup, but V8 does let us nudge the timing of finalizer execution. Like Node and Deno, Workers queue &lt;code&gt;FinalizationRegistry&lt;/code&gt; jobs only after the microtask queue has drained, so each cleanup batch slips into the quiet slots between I/O phases of the event loop.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/69QSYwmiAueWyP2KlvBwGi/183345cbb043acbe4d76c0fdb2ebf4dd/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1992\&quot; height=\&quot;344\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;security-concerns\&quot;&gt;Security concerns&lt;/h3&gt;\n            &lt;a href=\&quot;#security-concerns\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The Cloudflare Workers runtime is &lt;a href=\&quot;https://blog.cloudflare.com/mitigating-spectre-and-other-security-threats-the-cloudflare-workers-security-model\&quot;&gt;&lt;u&gt;specifically engineered&lt;/u&gt;&lt;/a&gt; to prevent side-channel attacks in a multi-tenant environment. Prior to enabling the &lt;code&gt;FinalizationRegistry&lt;/code&gt; API, we did a thorough analysis to assess its impact on our security model and determine the necessity of additional safeguards. The non-deterministic nature of &lt;code&gt;FinalizationRegistry&lt;/code&gt; raised concerns about potential information leaks leading to Spectre-like vulnerabilities, particularly regarding the possibility of exploiting the garbage collector (GC) as a confused deputy or using it to create a timer.&lt;/p&gt;&lt;h4&gt;GC as confused deputy&lt;/h4&gt;&lt;p&gt;One concern was whether the garbage collector (GC) could act as a confused deputy — a security antipattern where a privileged component is tricked into misusing its authority on behalf of untrusted code. In theory, a clever attacker could try to exploit the GC&amp;#39;s ability to access internal object lifetimes and memory behavior in order to infer or manipulate sensitive information across isolation boundaries.&lt;/p&gt;&lt;p&gt;However, our analysis indicated that the V8 GC is effectively contained and not exposed to confused deputy risks within the runtime. This is attributed to our existing threat models and security measures, such as the isolation of user code, where the V8 Isolate serves as the primary security boundary. Furthermore, even though FinalizationRegistry involves some internal GC mechanics, the callbacks themselves execute in the same isolate that registered them — never across isolates — ensuring isolation remains intact.&lt;/p&gt;&lt;h4&gt;GC as timer&lt;/h4&gt;&lt;p&gt;We also evaluated the possibility of using FinalizationRegistry as a high-resolution timing mechanism — a common vector in side-channel attacks like Spectre. The concern here is that an attacker could schedule object finalization in a way that indirectly leaks information via the timing of callbacks.&lt;/p&gt;&lt;p&gt;In practice, though, the resolution of such a &amp;quot;GC timer&amp;quot; is low and highly variable, offering poor reliability for side-channel attacks. Additionally, we control when finalizer callbacks are scheduled — delaying them until after the microtask queue has drained — giving us an extra layer of control to limit timing precision and reduce risk.&lt;/p&gt;&lt;p&gt;Following a review with our security research team, we determined that our existing security model is sufficient to support this API.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;predictable-cleanups\&quot;&gt;Predictable cleanups?&lt;/h2&gt;\n            &lt;a href=\&quot;#predictable-cleanups\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;JavaScript&amp;#39;s &lt;a href=\&quot;https://tc39.es/proposal-explicit-resource-management/\&quot;&gt;&lt;u&gt;Explicit Resource Management&lt;/u&gt;&lt;/a&gt; proposal introduces a deterministic approach to handle resources needing manual cleanup, such as file handles, network connections, or database sessions. Drawing inspiration from constructs like C#&amp;#39;s &lt;a href=\&quot;https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/using\&quot;&gt;&lt;u&gt;using&lt;/u&gt;&lt;/a&gt; and Python&amp;#39;s &lt;a href=\&quot;https://docs.python.org/3/reference/compound_stmts.html#with\&quot;&gt;&lt;u&gt;with&lt;/u&gt;&lt;/a&gt;, this proposal introduces the using and &lt;code&gt;await using&lt;/code&gt; syntax. This new syntax guarantees that objects adhering to a specific cleanup protocol are automatically disposed of when they are no longer within their scope.&lt;/p&gt;&lt;p&gt;Let’s look at a simple example to understand it a bit better.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;class MyResource {\n  [Symbol.dispose]() {\n    console.log(&amp;quot;Resource cleaned up!&amp;quot;);\n  }\n\n  use() {\n    console.log(&amp;quot;Using the resource...&amp;quot;);\n  }\n}\n\n{\n  using res = new MyResource();\n  res.use();\n} // When this block ends, Symbol.dispose is called automatically (and deterministically).&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The proposal also includes additional features that offer finer control over when dispose methods are called. But at a high level, it provides a much-needed, deterministic way to manage resource cleanup. Let’s now update our earlier WebAssembly-based example to take advantage of this new mechanism instead of relying on &lt;code&gt;FinalizationRegistry&lt;/code&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const { instance } = await WebAssembly.instantiate(WasmBytes, {});\nconst { memory, make_buffer, free_buffer } = instance.exports;\n\nclass WasmBuffer {\n  constructor(ptr, len) {\n    this.ptr = ptr;\n    this.len = len;\n  }\n\n  [Symbol.dispose]() {\n    free_buffer(this.ptr, this.len);\n  }\n}\n\n{\n  const lenPtr = 0;\n  const ptr = make_buffer(lenPtr);\n  const len = new DataView(memory.buffer).getUint32(lenPtr, true);\n\n  using buf = new WasmBuffer(ptr, len);\n\n  const data = new Uint8Array(memory.buffer, ptr, len);\n  console.log(new TextDecoder().decode(data));  // → “Hello from Rust”\n} // Symbol.dispose or free_buffer gets called deterministically here&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Explicit Resource Management provides a more dependable way to clean up resources than &lt;code&gt;FinalizationRegistry&lt;/code&gt;, as it runs cleanup logic — such as calling &lt;code&gt;free_buffer&lt;/code&gt; in WasmBuffer via &lt;code&gt;[Symbol.dispose]()&lt;/code&gt; and the &lt;code&gt;using&lt;/code&gt; syntax — deterministically, rather than relying on the garbage collector’s unpredictable timing. This makes it a more reliable choice for managing critical resources, especially memory.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;future\&quot;&gt;Future&lt;/h2&gt;\n            &lt;a href=\&quot;#future\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Emscripten &lt;a href=\&quot;https://emscripten.org/docs/porting/connecting_cpp_and_javascript/embind.html#automatic-memory-management\&quot;&gt;&lt;u&gt;already makes use&lt;/u&gt;&lt;/a&gt; of Explicit Resource Management for handling Wasm memory, using &lt;code&gt;FinalizationRegistry&lt;/code&gt; as a last resort, while wasm-bindgen &lt;a href=\&quot;https://github.com/rustwasm/wasm-bindgen/pull/4118\&quot;&gt;&lt;u&gt;supports it in experimental mode&lt;/u&gt;&lt;/a&gt;. The proposal has seen growing adoption across the ecosystem and was recently conditionally advanced to Stage 4 in the TC39 process, meaning it’ll soon officially be part of the JavaScript language standard. This reflects a broader shift toward more predictable and structured memory cleanup in WebAssembly applications.&lt;/p&gt;&lt;p&gt;We &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/changelog/#2025-05-22\&quot;&gt;&lt;u&gt;recently added support&lt;/u&gt;&lt;/a&gt; for this feature in Cloudflare Workers as well, enabling developers to take advantage of deterministic resource cleanup in edge environments. As support for the feature matures, it&amp;#39;s likely to become a standard practice for managing linear memory safely and reliably.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;finalizationregistry-still-not-dead-yet\&quot;&gt;FinalizationRegistry: still not dead yet?&lt;/h3&gt;\n            &lt;a href=\&quot;#finalizationregistry-still-not-dead-yet\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Explicit Resource Management brings much-needed structure and predictability to resource cleanup in WebAssembly and JavaScript interop applications, but it doesn’t make &lt;code&gt;FinalizationRegistry&lt;/code&gt; obsolete. There are still important use cases, particularly when a Wasm-allocated object’s lifecycle is out of your hands or when explicit disposal isn’t practical. In scenarios involving third-party libraries, dynamic lifecycles, or integration layers that don’t follow &lt;code&gt;using&lt;/code&gt; patterns, &lt;code&gt;FinalizationRegistry&lt;/code&gt; remains a valuable fallback to prevent memory leaks.&lt;/p&gt;&lt;p&gt;Looking ahead, a hybrid approach will likely become the standard in Wasm-JavaScript applications. Developers can use ERM for deterministic cleanup of Wasm memory and other resources, while relying on &lt;code&gt;FinalizationRegistry&lt;/code&gt; as a safety net when full control isn’t possible. Together, they offer a more reliable and flexible foundation for managing memory across the JavaScript and WebAssembly boundary.&lt;/p&gt;&lt;p&gt;Ready to try it yourself? Deploy a &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/webassembly/\&quot;&gt;&lt;u&gt;WebAssembly-powered Worker&lt;/u&gt;&lt;/a&gt; and experiment with memory management — start building with &lt;a href=\&quot;https://developers.cloudflare.com/workers/\&quot;&gt;&lt;u&gt;Cloudflare Workers&lt;/u&gt;&lt;/a&gt; today.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-06-11T14:00+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-06-11T13:00:03.311Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7cLMMILFb6WD9qrMUeJoWO/57652dbdb6f77038eedffd08bef442e4/image4.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Ketan Gupta&quot;],&quot;slug&quot;:[0,&quot;ketan-gupta&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4HNGL8tqmoWI8yZJEEynzY/4dc4778dc00d47cc7da853c61c224fd7/Ketan_Gupta.webp&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Harris Hancock&quot;],&quot;slug&quot;:[0,&quot;harris-hancock&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/kl1szOUahVoAesAqM5x8w/18cf3fe1108e24731361523b5c51e45c/Harris_Hancock.webp&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare Workers now support FinalizationRegistry, but just because you can use it doesn’t mean you should. Dive into the tricky world of JavaScript and WebAssembly memory management and see why newer features make life a lot easier.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/we-shipped-finalizationregistry-in-workers-why-you-should-never-use-it&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;We shipped FinalizationRegistry in Workers: why you should never use it&quot;],&quot;description&quot;:[0,&quot;Cloudflare Workers now support FinalizationRegistry, but just because you can use it doesn’t mean you should. Dive into the tricky world of JavaScript and WebAssembly memory management and see why newer features make life a lot easier. &quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3qcV6p7f2TQDnrcte9HS0w/1488188579d497e0756b603e8e41091f/We_shipped_FinalizationRegistry_in_Workers-_why_you_should_never_use_it-OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-100 featured-post  flex flex-row flex-wrap mb4 items-center bb b--gray8 bn-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-50-l"><a href="/we-shipped-finalizationregistry-in-workers-why-you-should-never-use-it/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">We shipped FinalizationRegistry in Workers: why you should never use it</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2025-06-11</p><p class="f4 fw3 lh-copy " data-testid="post-content">Cloudflare Workers now support FinalizationRegistry, but just because you can use it doesn’t mean you should.<!-- -->...</p><a href="/we-shipped-finalizationregistry-in-workers-why-you-should-never-use-it/" class="no-underline gray1 f4 lh-copy fw3 underline-hover" data-testid="post-continue-reading">Continue reading »</a><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/ketan-gupta/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4HNGL8tqmoWI8yZJEEynzY/4dc4778dc00d47cc7da853c61c224fd7/Ketan_Gupta.webp" alt="Ketan Gupta" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/ketan-gupta/" class="fw5 f4 no-underline black">Ketan Gupta</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/harris-hancock/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/kl1szOUahVoAesAqM5x8w/18cf3fe1108e24731361523b5c51e45c/Harris_Hancock.webp" alt="Harris Hancock" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/harris-hancock/" class="fw5 f4 no-underline black">Harris Hancock</a></div></li></ul></div><div class="w-50-l"><img class="dn di-l " src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7cLMMILFb6WD9qrMUeJoWO/57652dbdb6f77038eedffd08bef442e4/image4.png" alt="We shipped FinalizationRegistry in Workers: why you should never use it"/></div></article><!--astro:end--></astro-island><astro-island uid="Z1LkKoU" prefix="r1" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,false],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;6rBnmM6UiFX8ca7XXlOU2X&quot;],&quot;title&quot;:[0,&quot;Cloudflare Snippets are now Generally Available&quot;],&quot;slug&quot;:[0,&quot;snippets&quot;],&quot;excerpt&quot;:[0,&quot;Cloudflare Snippets are now generally available, enabling fast, cost-free JavaScript-based HTTP traffic modifications across all paid plans. &quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;program-your-traffic-at-the-edge-fast-flexible-and-free\&quot;&gt;Program your traffic at the edge — fast, flexible, and free&lt;/h2&gt;\n            &lt;a href=\&quot;#program-your-traffic-at-the-edge-fast-flexible-and-free\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/\&quot;&gt;&lt;u&gt;Cloudflare Snippets&lt;/u&gt;&lt;/a&gt; are &lt;b&gt;now generally available (GA)&lt;/b&gt; for all paid plans, giving you a fast, flexible way to control HTTP traffic using lightweight JavaScript “code rules” — at no extra cost.&lt;/p&gt;&lt;p&gt;Need to transform headers dynamically, fine-tune &lt;a href=\&quot;https://www.cloudflare.com/learning/cdn/what-is-caching/\&quot;&gt;caching&lt;/a&gt;, rewrite URLs, retry failed requests, replace expired links, throttle suspicious traffic, or validate authentication tokens? Snippets provide a production-ready solution built for performance, security, and control.&lt;/p&gt;&lt;p&gt;With GA, we’re introducing a new &lt;a href=\&quot;https://developers.cloudflare.com/changelog/2025-01-29-snippets-code-editor/\&quot;&gt;&lt;u&gt;code editor&lt;/u&gt;&lt;/a&gt; to streamline writing and testing logic. This summer, we’re also rolling out an integration with &lt;a href=\&quot;https://blog.cloudflare.com/secrets-store-beta/\&quot;&gt;&lt;u&gt;Secrets Store&lt;/u&gt;&lt;/a&gt; — enabling you to bind and manage sensitive values like API keys directly in Snippets, securely and at scale.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;what-are-snippets\&quot;&gt;What are Snippets?&lt;/h2&gt;\n            &lt;a href=\&quot;#what-are-snippets\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Snippets bring the power of JavaScript to &lt;a href=\&quot;https://developers.cloudflare.com/rules/\&quot;&gt;&lt;u&gt;Cloudflare Rules&lt;/u&gt;&lt;/a&gt;, letting you write logic that runs before a request reaches your origin or after a response returns from upstream. They’re ideal when built-in rule actions aren’t quite enough. While Cloudflare Rules let you define traffic logic without code, Snippets extend that model with greater flexibility for advanced scenarios.&lt;/p&gt;&lt;p&gt;Think of Snippets as the ultra-fast &lt;b&gt;“code layer” &lt;/b&gt;of &lt;a href=\&quot;https://developers.cloudflare.com/rules/\&quot;&gt;&lt;u&gt;Cloudflare Rules&lt;/u&gt;&lt;/a&gt;: the &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/\&quot;&gt;&lt;u&gt;Ruleset Engine&lt;/u&gt;&lt;/a&gt; evaluates your rules and invokes your code, which then runs on the &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/\&quot;&gt;&lt;u&gt;Workers runtime&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;key-capabilities-of-snippets\&quot;&gt;Key capabilities of Snippets:&lt;/h3&gt;\n            &lt;a href=\&quot;#key-capabilities-of-snippets\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Ultra-fast execution&lt;/b&gt;: optimized for speed with the &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/\&quot;&gt;&lt;u&gt;Ruleset Engine&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/\&quot;&gt;&lt;u&gt;Workers runtime&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Granular request matching&lt;/b&gt;: trigger Snippets based on &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.full_uri/\&quot;&gt;&lt;u&gt;URI&lt;/u&gt;&lt;/a&gt;, &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.user_agent/\&quot;&gt;&lt;u&gt;user-agent&lt;/u&gt;&lt;/a&gt;, &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.cookies/\&quot;&gt;&lt;u&gt;cookies&lt;/u&gt;&lt;/a&gt;, headers and more.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Sequential execution&lt;/b&gt;: &lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/how-it-works/\&quot;&gt;&lt;u&gt;run&lt;/u&gt;&lt;/a&gt; multiple Snippets on the same request, applying modifications step by step.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Native &lt;a href=\&quot;https://developers.cloudflare.com/rules/\&quot;&gt;&lt;u&gt;Cloudflare Rules&lt;/u&gt;&lt;/a&gt; integration: Snippets &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/reference/phases-list/#request-phases\&quot;&gt;&lt;u&gt;inherit&lt;/u&gt;&lt;/a&gt; request modifications from other Cloudflare products.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;JavaScript and Web APIs support, plus essential &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/\&quot;&gt;&lt;u&gt;Workers runtime&lt;/u&gt;&lt;/a&gt; features:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/fetch/\&quot;&gt;&lt;u&gt;fetch API&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/cache/\&quot;&gt;&lt;u&gt;cache API&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/request/#incomingrequestcfproperties\&quot;&gt;&lt;u&gt;request.cf object&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/html-rewriter/\&quot;&gt;&lt;u&gt;HTMLRewriter&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Automated deployment and versioning via &lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/create-terraform/\&quot;&gt;&lt;u&gt;Terraform&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Best of all? Snippets are &lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/#availability\&quot;&gt;&lt;u&gt;included&lt;/u&gt;&lt;/a&gt; at no extra cost for Pro, Business, and Enterprise plans — with &lt;b&gt;no usage-based fees&lt;/b&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;the-journey-to-ga-how-snippets-became-production-grade\&quot;&gt;The journey to GA: How Snippets became production-grade&lt;/h2&gt;\n            &lt;a href=\&quot;#the-journey-to-ga-how-snippets-became-production-grade\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Cloudflare Snippets started as a bold idea: bring the power of JavaScript-based logic to Cloudflare Rules, without the complexity of a full-stack developer platform.&lt;/p&gt;&lt;p&gt;Over the past two years, Snippets have evolved into a production-ready “code rules” solution, shaping the future of HTTP traffic control.&lt;/p&gt;&lt;p&gt;&lt;b&gt;2022:&lt;/b&gt; Cloudflare Snippets were &lt;a href=\&quot;https://blog.cloudflare.com/snippets-announcement/\&quot;&gt;&lt;u&gt;announced&lt;/u&gt;&lt;/a&gt; during Developer Week as a solution for users needing flexible HTTP traffic modifications without a full Worker.&lt;/p&gt;&lt;p&gt;&lt;b&gt;2023:&lt;/b&gt; &lt;b&gt;Alpha launch &lt;/b&gt;— hundreds of users tested Snippets for high-performance traffic logic.&lt;/p&gt;&lt;p&gt;&lt;b&gt;2024:&lt;/b&gt; &lt;b&gt;7x traffic growth&lt;/b&gt;, processing 17,000 requests per second. Terraform support and production-grade backend were released.&lt;/p&gt;&lt;p&gt;&lt;b&gt;2025:&lt;/b&gt; &lt;b&gt;General Availability &lt;/b&gt;— Snippets introduces a &lt;a href=\&quot;https://developers.cloudflare.com/changelog/2025-01-29-snippets-code-editor/\&quot;&gt;&lt;u&gt;new code editor&lt;/u&gt;&lt;/a&gt;, &lt;a href=\&quot;https://developers.cloudflare.com/changelog/2025-02-12-rules-upgraded-limits/\&quot;&gt;&lt;u&gt;increased limits&lt;/u&gt;&lt;/a&gt; alongside other Cloudflare Rules products, integration with &lt;a href=\&quot;https://developers.cloudflare.com/fundamentals/trace-request/#_top\&quot;&gt;&lt;u&gt;Trace&lt;/u&gt;&lt;/a&gt;, and a production-grade experience built for scale, handling &lt;b&gt;over 2 million requests per second&lt;/b&gt; at peak. Integration with the Secrets Store is rolling out this summer.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1fZv7cpSGntSQadS761Zkv/31707075a85d393f4883b190599581f7/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1031\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;new-snippets-trace\&quot;&gt;New: Snippets + Trace&lt;/h2&gt;\n            &lt;a href=\&quot;#new-snippets-trace\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/fundamentals/trace-request/#_top\&quot;&gt;&lt;u&gt;Cloudflare Trace&lt;/u&gt;&lt;/a&gt; now shows exactly which Snippets were triggered on a request. This makes it easier to debug traffic behavior, verify logic execution, and understand how your Snippets interact with other products in the request pipeline.&lt;/p&gt;&lt;p&gt;Whether you’re fine-tuning header logic or troubleshooting a routing issue, Trace gives you real-time insight into how your edge logic behaves in production.&lt;/p&gt;&lt;div style=\&quot;position: relative; padding-top: 41.72453703703704%;\&quot;&gt;\n  &lt;iframe\n    src=\&quot;https://customer-eq7kiuol0tk9chox.cloudflarestream.com/5ef9a151a67a362fc2b7591c9573538f/iframe?preload=true&amp;poster=https%3A%2F%2Fcustomer-eq7kiuol0tk9chox.cloudflarestream.com%2F5ef9a151a67a362fc2b7591c9573538f%2Fthumbnails%2Fthumbnail.jpg%3Ftime%3D%26height%3D600\&quot;\n    loading=\&quot;lazy\&quot;\n    style=\&quot;border: none; position: absolute; top: 0; left: 0; height: 100%; width: 100%;\&quot;\n    allow=\&quot;accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;\&quot;\n    allowfullscreen=\&quot;true\&quot;\n  &gt;&lt;/iframe&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;coming-soon-snippets-secrets-store\&quot;&gt;Coming soon: Snippets + Secrets Store&lt;/h2&gt;\n            &lt;a href=\&quot;#coming-soon-snippets-secrets-store\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;In the third quarter, you’ll be able to securely access API keys, authentication tokens, and other sensitive values from &lt;a href=\&quot;https://blog.cloudflare.com/secrets-store-beta/\&quot;&gt;&lt;u&gt;Secrets Store&lt;/u&gt;&lt;/a&gt; directly in your Snippets. No more plaintext secrets in your code, no more workarounds.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/51QyhWrvtGEQ568lzuqRD/f8eb60c0258d28ef1431fad7f5d03b12/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;886\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Once rolled out, secrets can be configured for Snippets via the &lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/create-dashboard/\&quot;&gt;&lt;u&gt;dashboard&lt;/u&gt;&lt;/a&gt; or &lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/create-api/\&quot;&gt;&lt;u&gt;API&lt;/u&gt;&lt;/a&gt; under the new &lt;b&gt;“Settings”&lt;/b&gt; button.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2ipprc9qz2mPpp7XGOURgH/47112dde677906746ef4f798d5c082c0/3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1796\&quot; height=\&quot;780\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;when-to-use-snippets-vs-cloudflare-workers\&quot;&gt;When to use Snippets vs. Cloudflare Workers&lt;/h2&gt;\n            &lt;a href=\&quot;#when-to-use-snippets-vs-cloudflare-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Snippets are fast, flexible, and free, but how do they compare to Cloudflare Workers? Both allow you to programmatically control traffic. However, they solve different problems:&lt;/p&gt;&lt;div style=\&quot;margin-left:0pt;\&quot; dir=\&quot;ltr\&quot; align=\&quot;left\&quot;&gt;\n    &lt;figure class=\&quot;table\&quot;&gt;\n        &lt;table class=\&quot;ck-table-resized\&quot; style=\&quot;border-collapse:collapse;border-style:none;\&quot;&gt;\n            &lt;colgroup&gt;\n                &lt;col style=\&quot;width:33.33%;\&quot; width=\&quot;470\&quot;&gt;\n                &lt;col style=\&quot;width:33.33%;\&quot; width=\&quot;89\&quot;&gt;\n                &lt;col style=\&quot;width:33.34%;\&quot; width=\&quot;75\&quot;&gt;\n            &lt;/colgroup&gt;\n            &lt;tbody&gt;\n                &lt;tr style=\&quot;height:25.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:center;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;&lt;strong&gt;Feature&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:center;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;&lt;strong&gt;Snippets&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:center;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;&lt;strong&gt;Workers&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Execute scripts based on request attributes (headers, geolocation, cookies, etc.)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;❌&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#383838;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Modify HTTP requests/responses or serve a different response&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:#ffffff;color:#383838;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Add, remove, or rewrite headers dynamically&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:#ffffff;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Cache&lt;/span&gt;&lt;/span&gt;&lt;span style=\&quot;background-color:#ffffff;color:#383838;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt; assets at the edge&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:#ffffff;color:#383838;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Route traffic dynamically between origins&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:#ffffff;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Authenticate&lt;/span&gt;&lt;/span&gt;&lt;span style=\&quot;background-color:#ffffff;color:#383838;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt; requests, pre-sign URLs, run A/B testing&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Perform compute-intensive tasks (e.g., AI inference, image processing)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;❌&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Store persistent data (e.g., KV, Durable Objects, D1)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;❌&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Deploy via CLI (Wrangler)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;❌&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:27.25pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#383838;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Use TypeScript, Python, Rust or other programming languages&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:middle;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;❌&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#000000;border-width:0.5pt;overflow-wrap:break-word;overflow:hidden;padding:5pt;vertical-align:top;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;✅&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n            &lt;/tbody&gt;\n        &lt;/table&gt;\n    &lt;/figure&gt;\n&lt;/div&gt;&lt;p&gt;&lt;b&gt;Use Snippets when:&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;You need ultra-fast conditional traffic modifications directly on Cloudflare’s network.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;You want to extend Cloudflare Rules beyond built-in actions.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;You need free, unlimited invocations within the &lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/#limits\&quot;&gt;&lt;u&gt;execution limits&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;You are migrating from VCL, Akamai’s EdgeWorkers, or on-premise logic.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;Use Workers when:&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Your application requires state management, Developer Platform product integrations, or high compute limits.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;You are building APIs, full-stack applications, or complex workflows.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;You need logging, debugging tools, CLI support, and gradual rollouts.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Still unsure? Check out our &lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/when-to-use/\&quot;&gt;&lt;u&gt;detailed guide&lt;/u&gt;&lt;/a&gt; for best practices.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;snippets-in-action-real-world-use-cases\&quot;&gt;Snippets in action: real-world use cases&lt;/h2&gt;\n            &lt;a href=\&quot;#snippets-in-action-real-world-use-cases\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Below are practical use cases demonstrating Snippets. Each script can be dynamically triggered using our powerful &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/rules-language/\&quot;&gt;&lt;u&gt;Rules&lt;/u&gt;&lt;/a&gt; language, so you can granularly control which requests your Snippets will be applied to.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;1-dynamically-modify-headers\&quot;&gt;1. Dynamically modify headers&lt;/h3&gt;\n            &lt;a href=\&quot;#1-dynamically-modify-headers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Inject custom headers, remove unnecessary ones, and tweak values on the fly:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export default {\n  async fetch(request) {\n    const timestamp = Date.now().toString(16); // convert timestamp to HEX\n    const modifiedRequest = new Request(request, { headers: new Headers(request.headers) });\n    modifiedRequest.headers.set(&amp;quot;X-Hex-Timestamp&amp;quot;, timestamp); // send HEX timestamp to upstream\n\n    const response = await fetch(modifiedRequest);\n    const newResponse = new Response(response.body, response); // make response from upstream mutable\n\n    newResponse.headers.append(&amp;quot;x-snippets-hello&amp;quot;, &amp;quot;Hello from Cloudflare Snippets&amp;quot;); // add new response header\n    newResponse.headers.delete(&amp;quot;x-header-to-delete&amp;quot;); // delete response header\n    newResponse.headers.set(&amp;quot;x-header-to-change&amp;quot;, &amp;quot;NewValue&amp;quot;); // replace the value of existing response header\n\n    return newResponse;\n  },\n};&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;2-serve-a-custom-maintenance-page\&quot;&gt;2. Serve a custom maintenance page&lt;/h3&gt;\n            &lt;a href=\&quot;#2-serve-a-custom-maintenance-page\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Route traffic to a maintenance page when your origin is undergoing planned maintenance:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export default {\n    async fetch(request) { // for all matching requests, return predefined HTML response with 503 status code\n        return new Response(`\n            &amp;lt;!DOCTYPE html&amp;gt;\n            &amp;lt;html lang=&amp;quot;en&amp;quot;&amp;gt;\n            &amp;lt;head&amp;gt;\n                &amp;lt;meta charset=&amp;quot;UTF-8&amp;quot;&amp;gt;\n                &amp;lt;title&amp;gt;We&amp;#039;ll Be Right Back!&amp;lt;/title&amp;gt;\n                &amp;lt;style&amp;gt; body { font-family: Arial, sans-serif; text-align: center; padding: 20px; } &amp;lt;/style&amp;gt;\n            &amp;lt;/head&amp;gt;\n            &amp;lt;body&amp;gt;\n                &amp;lt;h1&amp;gt;We&amp;#039;ll Be Right Back!&amp;lt;/h1&amp;gt;\n                &amp;lt;p&amp;gt;Our site is undergoing maintenance. Check back soon!&amp;lt;/p&amp;gt;\n            &amp;lt;/body&amp;gt;\n            &amp;lt;/html&amp;gt;\n        `, { status: 503, headers: { &amp;quot;Content-Type&amp;quot;: &amp;quot;text/html&amp;quot; } });\n    }\n};&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;3-retry-failed-requests-to-a-backup-origin\&quot;&gt;3. Retry failed requests to a backup origin&lt;/h3&gt;\n            &lt;a href=\&quot;#3-retry-failed-requests-to-a-backup-origin\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Ensure reliability by automatically rerouting requests when your primary origin returns an unexpected response:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export default {\n  async fetch(request) {\n    const response = await fetch(request); // send original request to the origin\n\n    if (!response.ok &amp;amp;&amp;amp; !response.redirected) { // if response is not 200 OK or a redirect, send to another origin\n      const newRequest = new Request(request); // clone the original request to construct a new request\n      newRequest.headers.set(&amp;quot;X-Rerouted&amp;quot;, &amp;quot;1&amp;quot;); // add a header to identify a re-routed request at the new origin\n      const url = new URL(request.url); // clone the original URL\n      url.hostname = &amp;quot;backup.example.com&amp;quot;; // send request to a different origin / hostname\n      return await fetch(url, newRequest); // serve response from the backup origin\n    }\n\n    return response; // otherwise, serve response from the primary origin\n  },\n};&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;4-redirect-users-based-on-their-location\&quot;&gt;4. Redirect users based on their location&lt;/h3&gt;\n            &lt;a href=\&quot;#4-redirect-users-based-on-their-location\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Send visitors to region-specific sites for better localization:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export default {\n    async fetch(request) {\n        const country = request.cf.country; // identify visitor&amp;#039;s country using request.cf property\n        const redirectMap = { US: &amp;quot;https://example.com/us&amp;quot;, EU: &amp;quot;https://example.com/eu&amp;quot; }; // define redirects for each country\n        if (redirectMap[country]) return Response.redirect(redirectMap[country], 301); // redirect on match\n        return fetch(request); // otherwise, proceed to upstream normally\n    }\n};&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;getting-started-with-snippets\&quot;&gt;Getting started with Snippets&lt;/h2&gt;\n            &lt;a href=\&quot;#getting-started-with-snippets\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Snippets are available right now in the Cloudflare dashboard under &lt;b&gt;Rules &amp;gt; Snippets&lt;/b&gt;:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Go to Rules → Snippets.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Use prebuilt &lt;a href=\&quot;https://developers.cloudflare.com/rules/examples/\&quot;&gt;&lt;u&gt;templates&lt;/u&gt;&lt;/a&gt; or write your own JavaScript code.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Configure a flexible rule to trigger your Snippet.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Test and deploy instantly.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Automate via &lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/create-api/\&quot;&gt;&lt;u&gt;API&lt;/u&gt;&lt;/a&gt; or &lt;a href=\&quot;https://developers.cloudflare.com/rules/snippets/create-terraform/\&quot;&gt;&lt;u&gt;Terraform&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;try-snippets-today\&quot;&gt;Try Snippets today&lt;/h2&gt;\n            &lt;a href=\&quot;#try-snippets-today\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Cloudflare Snippets are now generally available, bringing fast, cost-free, and intelligent HTTP traffic control to all paid plans.&lt;/p&gt;&lt;p&gt;With native integration into Cloudflare Rules and Terraform — and Secrets Store integration coming this summer — Snippets provide the most efficient way to manage advanced traffic logic at scale.&lt;/p&gt;&lt;p&gt;Explore Snippets in the Cloudflare Dashboard and start optimizing your traffic with lightweight, flexible rules that enhance performance and reduce complexity.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-04-09T14:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-04-16T15:46:18.927Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4K75EXkUFjERUZC1whnHvh/5c9a5ec68e5a3024bbb0fc605f1378d8/Feature_Image.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;2xCnBweKwOI3VXdYsGVbMe&quot;],&quot;name&quot;:[0,&quot;Developer Week&quot;],&quot;slug&quot;:[0,&quot;developer-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;4eBircwQ1VIos6rC8wgALG&quot;],&quot;name&quot;:[0,&quot;Snippets&quot;],&quot;slug&quot;:[0,&quot;snippets&quot;]}],[0,{&quot;id&quot;:[0,&quot;3E2D6D4cI82KIloPpl0WZW&quot;],&quot;name&quot;:[0,&quot;General Availability&quot;],&quot;slug&quot;:[0,&quot;general-availability&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;3aRZvV7ApVpkYKGhnNQH4w&quot;],&quot;name&quot;:[0,&quot;CDN&quot;],&quot;slug&quot;:[0,&quot;cdn&quot;]}],[0,{&quot;id&quot;:[0,&quot;4Hr4XSACbfTmrYAA7iESxH&quot;],&quot;name&quot;:[0,&quot;Edge Rules&quot;],&quot;slug&quot;:[0,&quot;edge-rules&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Nikita Cano&quot;],&quot;slug&quot;:[0,&quot;nikita&quot;],&quot;bio&quot;:[0,&quot;Product Manager, Rules and Insights (Configuration Rules, Compression Rules, Page Rules, Redirect Rules, Origin Rules, Snippets, Trace, Traffic Sequence, Transform Rules, URL Normalization, etc.)&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6hGB1W3bIJaibV4F7Qe0L8/56f554eeae28828297135a54eacc3065/nikita.jpeg&quot;],&quot;location&quot;:[0,&quot;London, United Kingdom&quot;],&quot;website&quot;:[0,&quot;https://nikitacano.com&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare Snippets are now GA, enabling fast, cost-free JavaScript-based HTTP traffic modifications across all paid plans. With Terraform support and upcoming integration with Secrets Store, Snippets provide a powerful, production-ready solution for managing HTTP traffic via code rules.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/snippets&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Cloudflare Snippets are now Generally Available&quot;],&quot;description&quot;:[0,&quot;Cloudflare Snippets are now GA, enabling fast, cost-free JavaScript-based HTTP traffic modifications across all paid plans. With Terraform support and upcoming integration with Secrets Store, Snippets provide a powerful, production-ready solution for managing HTTP traffic via code rules.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1u82DgH9pMX5KZvYTBK5fl/bad7c50cde89c9153e80d19107be709a/OG_Share_2024__35_.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-50-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-100"><a href="/snippets/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">Cloudflare Snippets are now Generally Available</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2025-04-09</p><div class=""><a href="/tag/developer-week/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developer Week</a><a href="/tag/snippets/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Snippets</a><a href="/tag/general-availability/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">General Availability</a><a href="/tag/javascript/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">JavaScript</a><a href="/tag/cdn/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">CDN</a><a href="/tag/edge-rules/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Edge Rules</a><a href="/tag/developers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developers</a></div><p class="f3 fw4 gray1 lh-copy " data-testid="post-content">Cloudflare Snippets are now generally available, enabling fast, cost-free JavaScript-based HTTP traffic modifications across all paid plans. <!-- -->...</p><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/nikita/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6hGB1W3bIJaibV4F7Qe0L8/56f554eeae28828297135a54eacc3065/nikita.jpeg" alt="Nikita Cano" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/nikita/" class="fw4 f3 no-underline black">Nikita Cano</a></div></li></ul></div></article><!--astro:end--></astro-island><astro-island uid="ZmlTfj" prefix="r2" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,false],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;55t98SAXi3erhs7Wn5dgno&quot;],&quot;title&quot;:[0,&quot;New URLPattern API brings improved pattern matching to Node.js and Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;improving-web-standards-urlpattern&quot;],&quot;excerpt&quot;:[0,&quot;Today we&#39;re announcing our latest contribution to Node.js, now available in v23.8.0: URLPattern. &quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Today, we are excited to announce that we have contributed an implementation of the &lt;a href=\&quot;https://urlpattern.spec.whatwg.org\&quot;&gt;&lt;u&gt;URLPattern&lt;/u&gt;&lt;/a&gt; API to Node.js, and it is available starting with &lt;a href=\&quot;https://nodejs.org/en/blog/release/v23.8.0\&quot;&gt;&lt;u&gt;the v23.8.0 update&lt;/u&gt;&lt;/a&gt;. We&amp;#39;ve done this by adding our URLPattern implementation to &lt;a href=\&quot;https://github.com/ada-url/ada\&quot;&gt;&lt;u&gt;Ada URL&lt;/u&gt;&lt;/a&gt;, the high-performance URL parser that now powers URL handling in both Node.js and Cloudflare Workers. This marks an important step toward bringing this API to the broader JavaScript ecosystem.&lt;/p&gt;&lt;p&gt;Cloudflare Workers has, from the beginning, embraced a standards-based JavaScript programming model, and Cloudflare was one of the founding companies for what has evolved into &lt;a href=\&quot;https://ecma-international.org/technical-committees/tc55/\&quot;&gt;&lt;u&gt;ECMA&amp;#39;s 55th Technical Committee&lt;/u&gt;&lt;/a&gt;, focusing on interoperability between Web-interoperable runtimes like Workers, Node.js, Deno, and others. This contribution highlights and marks our commitment to this ongoing philosophy. Ensuring that all the JavaScript runtimes work consistently and offer at least a minimally consistent set of features is critical to ensuring the ongoing health of the ecosystem as a whole.&lt;/p&gt;&lt;p&gt;URLPattern API contribution is just one example of Cloudflare’s ongoing commitment to the open-source ecosystem. We actively contribute to numerous open-source projects including Node.js, V8, and Ada URL, while also maintaining our own open-source initiatives like &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;&lt;u&gt;workerd&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://github.com/cloudflare/workers-sdk\&quot;&gt;&lt;u&gt;wrangler&lt;/u&gt;&lt;/a&gt;. By upstreaming improvements to foundational technologies that power the web, we strengthen the entire developer ecosystem while ensuring consistent features across JavaScript runtimes. This collaborative approach reflects our belief that open standards and shared implementations benefit everyone - reducing fragmentation, improving developer experience and creating a better Internet. &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;what-is-urlpattern\&quot;&gt;What is URLPattern?&lt;/h2&gt;\n            &lt;a href=\&quot;#what-is-urlpattern\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;URLPattern is a standard published by the &lt;a href=\&quot;https://whatwg.org/\&quot;&gt;&lt;u&gt;WHATWG (Web Hypertext Application Technology Working Group)&lt;/u&gt;&lt;/a&gt; which provides a pattern-matching system for URLs. This specification is available at &lt;a href=\&quot;http://urlpattern.spec.whatwg.org\&quot;&gt;&lt;u&gt;urlpattern.spec.whatwg.org&lt;/u&gt;&lt;/a&gt;. The API provides developers with an easy-to-use, &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions\&quot;&gt;&lt;u&gt;regular expression (regex)&lt;/u&gt;&lt;/a&gt;-based approach to handling route matching, with built-in support for named parameters, wildcards, and more complex pattern matching that works uniformly across all URL components.&lt;/p&gt;&lt;p&gt;URLPattern is part of the &lt;a href=\&quot;https://min-common-api.proposal.wintertc.org/\&quot;&gt;&lt;u&gt;WinterTC Minimum Common API&lt;/u&gt;&lt;/a&gt;, a soon-to-be standardized subset of web platform APIs designed to ensure interoperability across JavaScript runtimes, particularly for server-side and non-browser environments, and includes other APIs such as &lt;a href=\&quot;https://url.spec.whatwg.org/#url\&quot;&gt;&lt;u&gt;URL&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://url.spec.whatwg.org/#urlsearchparams\&quot;&gt;&lt;u&gt;URLSearchParams&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Cloudflare Workers has supported URLPattern for a number of years now, reflecting our commitment to enabling developers to use standard APIs across both browsers and server-side JavaScript runtimes. Contributing to Node.js and unifying the URLPattern implementation simplifies the ecosystem by reducing fragmentation, while at the same time improving our own implementation in Cloudflare Workers by making it faster and more specification compliant.&lt;/p&gt;&lt;p&gt;The following example demonstrates how URLPattern is used by creating a pattern that matches URLs with a “/blog/:year/:month/:slug” path structure, then tests if one specific URL string matches this pattern, and extracts the named parameters from a second URL using the exec method.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const pattern = new URLPattern({\n  pathname: &amp;#039;/blog/:year/:month/:slug&amp;#039;\n});\n\nif (pattern.test(&amp;#039;https://example.com/blog/2025/03/urlpattern-launch&amp;#039;)) {\n  console.log(&amp;#039;Match found!&amp;#039;);\n}\n\nconst result = pattern.exec(&amp;#039;https://example.com/blog/2025/03/urlpattern-launch&amp;#039;);\nconsole.log(result.pathname.groups.year); // &amp;quot;2025&amp;quot;\nconsole.log(result.pathname.groups.month); // &amp;quot;03&amp;quot;\nconsole.log(result.pathname.groups.slug); // &amp;quot;urlpattern-launch&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The URLPattern constructor accepts pattern strings or objects defining patterns for individual URL components. The &lt;code&gt;test()&lt;/code&gt; method returns a boolean indicating if a URL simply matches the pattern. The &lt;code&gt;exec()&lt;/code&gt; method provides detailed match results including captured groups. Behind this simple API, there’s sophisticated machinery working behind the scenes:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;When a URLPattern is used, it internally breaks down a URL, matching it against eight distinct components: protocol, username, password, hostname, port, pathname, search, and hash. This component-based approach gives the developer control over which parts of a URL to match.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Upon creation of the instance, URLPattern parses your input patterns for each component and compiles them internally into eight specialized regular expressions (one for each component type). This compilation step happens just once when you create an URLPattern object, optimizing subsequent matching operations.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;During a match operation (whether using &lt;code&gt;test()&lt;/code&gt; or &lt;code&gt;exec()&lt;/code&gt;), these regular expressions are used to determine if the input matches the given properties. The &lt;code&gt;test()&lt;/code&gt; method tells you if there’s a match, while &lt;code&gt;exec()&lt;/code&gt; provides detailed information about what was matched, including any named capture groups from your pattern.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;fixing-things-along-the-way\&quot;&gt;Fixing things along the way&lt;/h2&gt;\n            &lt;a href=\&quot;#fixing-things-along-the-way\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;While implementing URLPattern, we discovered some inconsistencies between the specification and the &lt;a href=\&quot;https://github.com/web-platform-tests/wpt/pull/49782\&quot;&gt;&lt;u&gt;web-platform tests&lt;/u&gt;&lt;/a&gt;, a cross-browser test suite maintained by all major browsers to test conformance to web standard specifications. For instance, we found that &lt;a href=\&quot;https://github.com/whatwg/urlpattern/issues/240\&quot;&gt;&lt;u&gt;URLs with non-special protocols (opaque-paths)&lt;/u&gt;&lt;/a&gt; and URLs with invalid characters in hostnames were not correctly defined and processed within the URLPattern specification. We worked actively with the Chromium and the Safari teams to address these issues.&lt;/p&gt;&lt;p&gt;URLPatterns constructed from hostname components that contain newline or tab characters were expected to fail in the corresponding web-platform tests. This was due to an inconsistency with the original URLPattern implementation and the URLPattern specification.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const pattern = new URL({ &amp;quot;hostname&amp;quot;: &amp;quot;bad\\nhostname&amp;quot; });\nconst matched = pattern.test({ &amp;quot;hostname&amp;quot;: &amp;quot;badhostname&amp;quot; });\n// This now returns true.&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We opened &lt;a href=\&quot;https://github.com/whatwg/urlpattern/issues/239\&quot;&gt;&lt;u&gt;several issues&lt;/u&gt;&lt;/a&gt; to document these inconsistencies and followed up with &lt;a href=\&quot;https://github.com/whatwg/urlpattern/pull/243\&quot;&gt;&lt;u&gt;a pull-request to fix the specification&lt;/u&gt;&lt;/a&gt;, ensuring that all implementations will eventually converge on the same corrected behavior. This also resulted in fixing several inconsistencies in web-platform tests, particularly around handling certain types of white space (such as newline or tab characters) in hostnames. &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;getting-started-with-urlpattern\&quot;&gt;Getting started with URLPattern&lt;/h2&gt;\n            &lt;a href=\&quot;#getting-started-with-urlpattern\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;If you’re interested in using URLPattern today, you can:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Use it natively in modern browsers by accessing the global URLPattern class&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Try it in Cloudflare Workers (which has had URLPattern support for some time, now with improved spec compliance and performance)&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Try it in Node.js, &lt;a href=\&quot;https://nodejs.org/en/blog/release/v23.8.0\&quot;&gt;&lt;u&gt;starting from v23.8.0&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Try it in NativeScript on iOS and Android, &lt;a href=\&quot;https://blog.nativescript.org/nativescript-8-9-announcement/\&quot;&gt;&lt;u&gt;starting from v8.9.0&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Try it in &lt;a href=\&quot;https://docs.deno.com/api/web/~/URLPattern\&quot;&gt;&lt;u&gt;Deno&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Here is a more complex example showing how URLPattern can be used for routing in a Cloudflare Worker — a common use case when building API endpoints or web applications that need to handle different URL paths efficiently and differently. The following example shows a pattern for &lt;a href=\&quot;https://en.wikipedia.org/wiki/REST\&quot;&gt;&lt;u&gt;REST APIs&lt;/u&gt;&lt;/a&gt; that matches both “/users” and “/users/:userId”&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const routes = [\n  new URLPattern({ pathname: &amp;#039;/users{/:userId}?&amp;#039; }),\n];\n\nexport default {\n  async fetch(request, env, ctx): Promise&amp;lt;Response&amp;gt; {\n    const url = new URL(request.url);\n    for (const route of routes) {\n      const match = route.exec(url);\n      if (match) {\n        const { userId } = match.pathname.groups;\n        if (userId) {\n          return new Response(`User ID: ${userId}`);\n        }\n        return new Response(&amp;#039;List of users&amp;#039;);\n      }\n    }\n    // No matching route found\n    return new Response(&amp;#039;Not Found&amp;#039;, { status: 404 });\n  },\n} satisfies ExportedHandler&amp;lt;Env&amp;gt;;&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;what-does-the-future-hold\&quot;&gt;What does the future hold?&lt;/h2&gt;\n            &lt;a href=\&quot;#what-does-the-future-hold\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;The contribution of URLPattern to Ada URL and Node.js is just the beginning. We’re excited about the possibilities this opens up for developers across different JavaScript environments.&lt;/p&gt;&lt;p&gt;In the future, we expect to contribute additional improvements to URLPattern’s performance, enabling more use cases for web application routing. Additionally, efforts to standardize the &lt;a href=\&quot;https://github.com/whatwg/urlpattern/pull/166\&quot;&gt;&lt;u&gt;URLPatternList proposal&lt;/u&gt;&lt;/a&gt; will help deliver faster matching capabilities for server-side runtimes. We’re excited about these developments and encourage you to try URLPattern in your projects today.\t&lt;/p&gt;&lt;p&gt;Try it and let us know what you think by creating an issue on the &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;&lt;u&gt;workerd repository&lt;/u&gt;&lt;/a&gt;. Your feedback is invaluable as we work to further enhance URLPattern.&lt;/p&gt;&lt;p&gt;We hope to do our part to build a unified Javascript ecosystem, and encourage others to do the same. This may mean looking for opportunities, such as we have with URLPattern, to share API implementations across backend runtimes. It could mean using or contributing to &lt;a href=\&quot;https://web-platform-tests.org/\&quot;&gt;&lt;u&gt;web-platform-tests&lt;/u&gt;&lt;/a&gt; if you are working on a server-side runtime or web-standard APIs, or it might mean joining &lt;a href=\&quot;https://wintertc.org/faq\&quot;&gt;&lt;u&gt;WinterTC&lt;/u&gt;&lt;/a&gt; to help define web-interoperable standards for server-side JavaScript.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-24T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-24T13:00:02.188Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4alnOiec0KLTuB3ehnNX7f/a52cbb9ed9a18cc9c4c15d877a28936a/image1.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3XzVULQKajbCuWudT6JD0p&quot;],&quot;name&quot;:[0,&quot;Node.js&quot;],&quot;slug&quot;:[0,&quot;node-js&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;iiynSxxhE6dlxRhbsXqc4&quot;],&quot;name&quot;:[0,&quot;Standards&quot;],&quot;slug&quot;:[0,&quot;standards&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Yagiz Nizipli&quot;],&quot;slug&quot;:[0,&quot;yagiz-nizipli&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/Nt978ELmW8HwrYwJDdwUz/c463d2ccaa54ed75b9c2e3f0fa0a7385/Yagiz_Nizipli.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;James M Snell&quot;],&quot;slug&quot;:[0,&quot;jasnell&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dR6CJtYedvLrkAZ6rxv9I/0db3d5a763a8b0a350ac04ac6410da6b/jasnell.jpg&quot;],&quot;location&quot;:[0,&quot;California&quot;],&quot;website&quot;:[0,&quot;https://bsky.app/profile/jasnell.me&quot;],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Daniel Lemire (Guest author)&quot;],&quot;slug&quot;:[0,&quot;daniel-lemire-guest-author&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7iDgTkAE7gRzKZ3vB9B8K8/e48298f6600293f80d1609fc02471208/Daniel_Lemire__Guest_author_.jpeg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Today we&#39;re announcing our latest contribution to Node.js, now available in v23.8.0: URLPattern. We&#39;ve added our implementation to Ada URL, bringing this standard pattern-matching API to Node.js to improve how developers match patterns and routes across all JavaScript environments.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/improving-web-standards-urlpattern&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0],&quot;description&quot;:[0,&quot;Today we&#39;re announcing our latest contribution to Node.js, now available in v23.8.0: URLPattern. We&#39;ve added our implementation to Ada URL, bringing this standard pattern-matching API to Node.js to improve how developers match patterns and routes across all JavaScript environments.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6bo0v1Q736CDgyXvO8SLfs/30d813354c853ea477e4507f3d54e771/New_URLPattern_API_brings_improved_pattern_matching_to_Node.js_and_Cloudflare_Workers-OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-50-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-100"><a href="/improving-web-standards-urlpattern/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">New URLPattern API brings improved pattern matching to Node.js and Cloudflare Workers</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2025-03-24</p><div class=""><a href="/tag/node-js/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Node.js</a><a href="/tag/javascript/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">JavaScript</a><a href="/tag/workers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Cloudflare Workers</a><a href="/tag/standards/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Standards</a></div><p class="f3 fw4 gray1 lh-copy " data-testid="post-content">Today we&#x27;re announcing our latest contribution to Node.js, now available in v23.8.0: URLPattern. <!-- -->...</p><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/yagiz-nizipli/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/Nt978ELmW8HwrYwJDdwUz/c463d2ccaa54ed75b9c2e3f0fa0a7385/Yagiz_Nizipli.jpg" alt="Yagiz Nizipli" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/yagiz-nizipli/" class="fw4 f3 no-underline black">Yagiz Nizipli</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/jasnell/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dR6CJtYedvLrkAZ6rxv9I/0db3d5a763a8b0a350ac04ac6410da6b/jasnell.jpg" alt="James M Snell" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/jasnell/" class="fw4 f3 no-underline black">James M Snell</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/daniel-lemire-guest-author/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7iDgTkAE7gRzKZ3vB9B8K8/e48298f6600293f80d1609fc02471208/Daniel_Lemire__Guest_author_.jpeg" alt="Daniel Lemire (Guest author)" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/daniel-lemire-guest-author/" class="fw4 f3 no-underline black">Daniel Lemire (Guest author)</a></div></li></ul></div></article><!--astro:end--></astro-island><astro-island uid="Z2raOME" prefix="r3" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,false],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;3VQUOQBWzT8cc7oFFv003i&quot;],&quot;title&quot;:[0,&quot;How we train AI to uncover malicious JavaScript intent and make web surfing safer&quot;],&quot;slug&quot;:[0,&quot;how-we-train-ai-to-uncover-malicious-javascript-intent-and-make-web-surfing-safer&quot;],&quot;excerpt&quot;:[0,&quot;Learn more about how Cloudflare developed an AI model to uncover malicious JavaScript intent using a Graph Neural Network, from pre-processing data to inferencing at scale. &quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Modern websites &lt;a href=\&quot;https://blog.cloudflare.com/application-security-report-2024-update/#enterprise-applications-use-47-third-party-scripts-on-average\&quot;&gt;&lt;u&gt;rely heavily&lt;/u&gt;&lt;/a&gt; on JavaScript. Leveraging third-party scripts accelerates web app development, enabling organizations to deploy new features faster without building everything from scratch. However, supply chain attacks targeting third-party JavaScript are no longer just a theoretical concern — they have become a reality, as &lt;a href=\&quot;https://blog.cloudflare.com/polyfill-io-now-available-on-cdnjs-reduce-your-supply-chain-risk/\&quot;&gt;&lt;u&gt;recent incidents&lt;/u&gt;&lt;/a&gt; have shown. Given the vast number of scripts and the rapid pace of updates, manually reviewing each one is not a scalable security strategy.&lt;/p&gt;&lt;p&gt;Cloudflare provides automated client-side protection through &lt;a href=\&quot;https://developers.cloudflare.com/page-shield/\&quot;&gt;&lt;u&gt;Page Shield&lt;/u&gt;&lt;/a&gt;. Until now, Page Shield could scan JavaScript dependencies on a web page, flagging obfuscated script content which also exfiltrates data. However, these are only indirect indicators of compromise or malicious intent. Our original approach didn’t provide clear insights into a script’s specific malicious objectives or the type of attack it was designed to execute.&lt;/p&gt;&lt;p&gt;Taking things a step further, we have developed a new AI model that allows us to detect the exact malicious intent behind each script. This intelligence is now integrated into Page Shield, available to all Page Shield &lt;a href=\&quot;https://developers.cloudflare.com/page-shield/#availability\&quot;&gt;&lt;u&gt;add-on&lt;/u&gt;&lt;/a&gt; customers. We are starting with three key threat categories: &lt;a href=\&quot;https://en.wikipedia.org/wiki/Web_skimming\&quot;&gt;&lt;u&gt;Magecart&lt;/u&gt;&lt;/a&gt;, crypto mining, and malware.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6EefJpCcho3DIjbVbQIjuz/68852b905955065e48ec2aa4648621cd/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;371\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Screenshot of Page Shield dashboard showing results of three types of analysis.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;With these improvements, Page Shield provides deeper visibility into client-side threats, empowering organizations to better protect their users from evolving security risks. This new capability is available to all Page Shield customers with the &lt;a href=\&quot;https://developers.cloudflare.com/page-shield/#availability\&quot;&gt;&lt;u&gt;add-on&lt;/u&gt;&lt;/a&gt;. Head over &lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/:zone/security/page-shield\&quot;&gt;&lt;u&gt;to the dashboard&lt;/u&gt;&lt;/a&gt;, and you can find the new malicious code analysis for each of the scripts monitored.&lt;/p&gt;&lt;p&gt;In the following sections, we take a deep dive into how we developed this model.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;training-the-model-to-detect-hidden-malicious-intent\&quot;&gt;Training the model to detect hidden malicious intent&lt;/h3&gt;\n            &lt;a href=\&quot;#training-the-model-to-detect-hidden-malicious-intent\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;We built this new Page Shield AI model to detect the intent of JavaScript threats at scale. Training such a model for JavaScript comes with unique challenges, including dealing with web code written in many different styles, often obfuscated yet benign. For instance, the following three snippets serve the same function.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;//Readable, plain code\nfunction sayHi(name) {\n  console.log(\n    `Hello ${\n      name ?? \n      &amp;quot;World&amp;quot; //default\n    }!`\n  );\n}\nsayHi(&amp;quot;Internet&amp;quot;);\n\n//Minified\nfunction sayHi(l){console.log(`Hello ${l??&amp;quot;World&amp;quot;}!`)}sayHi(&amp;quot;Internet&amp;quot;);\n\n//Obfuscated\nvar h=Q;(function(V,A){var J=Q,p=V();while(!![]){try{var b=-parseInt(J(&amp;#039;0x79&amp;#039;))/0x1*(-parseInt(J(&amp;#039;0x6e&amp;#039;))/0x2)+-parseInt(J(&amp;#039;0x80&amp;#039;))/0x3+parseInt(J(&amp;#039;0x76&amp;#039;))/0x4*(-parseInt(J(&amp;#039;0x72&amp;#039;))/0x5)+parseInt(J(&amp;#039;0x6a&amp;#039;))/0x6+parseInt(J(&amp;#039;0x84&amp;#039;))/0x7+-parseInt(J(&amp;#039;0x6d&amp;#039;))/0x8*(-parseInt(J(&amp;#039;0x7d&amp;#039;))/0x9)+parseInt(J(&amp;#039;0x73&amp;#039;))/0xa*(-parseInt(J(&amp;#039;0x7c&amp;#039;))/0xb);if(b===A)break;else p[&amp;#039;push&amp;#039;](p[&amp;#039;shift&amp;#039;]());}catch(U){p[&amp;#039;push&amp;#039;](p[&amp;#039;shift&amp;#039;]());}}}(S,0x22097));function sayHi(p){var Y=Q,b=(function(){var W=!![];return function(e,x){var B=W?function(){var m=Q;if(x){var G=x[m(&amp;#039;0x71&amp;#039;)](e,arguments);return x=null,G;}}:function(){};return W=![],B;};}()),U=b(this,function(){var s=Q,W=typeof window!==s(&amp;#039;0x6b&amp;#039;)?window:typeof process===s(&amp;#039;0x6c&amp;#039;)&amp;amp;&amp;amp;typeof require===s(&amp;#039;0x7b&amp;#039;)&amp;amp;&amp;amp;typeof global===&amp;#039;object&amp;#039;?global:this,e=W[&amp;#039;console&amp;#039;]=W[&amp;#039;console&amp;#039;]||{},x=[s(&amp;#039;0x78&amp;#039;),s(&amp;#039;0x70&amp;#039;),&amp;#039;info&amp;#039;,s(&amp;#039;0x69&amp;#039;),s(&amp;#039;0x77&amp;#039;),&amp;#039;table&amp;#039;,s(&amp;#039;0x7f&amp;#039;)];for(var B=0x0;B&amp;lt;x[s(&amp;#039;0x83&amp;#039;)];B++){var G=b[s(&amp;#039;0x75&amp;#039;)][s(&amp;#039;0x6f&amp;#039;)][s(&amp;#039;0x74&amp;#039;)](b),t=x[B],X=e[t]||G;G[&amp;#039;__proto__&amp;#039;]=b[s(&amp;#039;0x74&amp;#039;)](b),G[&amp;#039;toString&amp;#039;]=X[s(&amp;#039;0x7e&amp;#039;)][&amp;#039;bind&amp;#039;](X),e[t]=G;}});U(),console[&amp;#039;log&amp;#039;](Y(&amp;#039;0x81&amp;#039;)+(p??Y(&amp;#039;0x7a&amp;#039;))+&amp;#039;!&amp;#039;);}sayHi(h(&amp;#039;0x82&amp;#039;));function Q(V,A){var p=S();return Q=function(b,U){b=b-0x69;var W=p[b];return W;},Q(V,A);}function S(){var v=[&amp;#039;Internet&amp;#039;,&amp;#039;length&amp;#039;,&amp;#039;77966Hcxgji&amp;#039;,&amp;#039;error&amp;#039;,&amp;#039;1078032RtaGFM&amp;#039;,&amp;#039;undefined&amp;#039;,&amp;#039;object&amp;#039;,&amp;#039;8zrzBEk&amp;#039;,&amp;#039;244xEPFaR&amp;#039;,&amp;#039;prototype&amp;#039;,&amp;#039;warn&amp;#039;,&amp;#039;apply&amp;#039;,&amp;#039;10LQgYRU&amp;#039;,&amp;#039;400TNVOzq&amp;#039;,&amp;#039;bind&amp;#039;,&amp;#039;constructor&amp;#039;,&amp;#039;146612cfnkCX&amp;#039;,&amp;#039;exception&amp;#039;,&amp;#039;log&amp;#039;,&amp;#039;1513TBJIGL&amp;#039;,&amp;#039;World&amp;#039;,&amp;#039;function&amp;#039;,&amp;#039;57541MkoqrR&amp;#039;,&amp;#039;2362383dtBFrf&amp;#039;,&amp;#039;toString&amp;#039;,&amp;#039;trace&amp;#039;,&amp;#039;647766YvOJOm&amp;#039;,&amp;#039;Hello\\x20&amp;#039;];S=function(){return v;};return S();}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;With such a variance of styles (and many more), our machine learning solution needs to balance precision (low false positive rate), recall (don’t miss an attack vector), and speed. Here’s how we do it:&lt;/p&gt;&lt;h4&gt;Using syntax trees to classify malicious code&lt;/h4&gt;&lt;p&gt;JavaScript files are parsed into &lt;a href=\&quot;https://en.wikipedia.org/wiki/Tree_(graph_theory)\&quot;&gt;&lt;u&gt;syntax trees (connected acyclic graphs)&lt;/u&gt;&lt;/a&gt;. These serve as the input to a &lt;a href=\&quot;https://en.wikipedia.org/wiki/Graph_neural_network\&quot;&gt;&lt;u&gt;Graph Neural Network (GNN)&lt;/u&gt;&lt;/a&gt;. GNNs are used because they effectively capture the interdependencies (relationships between nodes) in executing code, such as a function calling another function. This contrasts with treating the code as merely a sequence of words — something a code compiler, incidentally, does not do. Another motivation to use GNNs is the &lt;a href=\&quot;https://dl.acm.org/doi/10.1007/978-3-030-92270-2_57\&quot;&gt;&lt;u&gt;insight&lt;/u&gt;&lt;/a&gt; that the syntax trees of malicious versus benign JavaScript tend to be different. For example, it’s not rare to find attacks that consist of malicious snippets inserted into, but otherwise isolated from, the rest of a benign base code.&lt;/p&gt;&lt;p&gt;To parse the files, the &lt;a href=\&quot;https://tree-sitter.github.io/\&quot;&gt;&lt;u&gt;tree-sitter library&lt;/u&gt;&lt;/a&gt; was chosen for its speed. One peculiarity of this parser, specialized for text editors, is that it parses out &lt;a href=\&quot;https://en.wikipedia.org/wiki/Parse_tree\&quot;&gt;&lt;u&gt;concrete syntax trees (CST)&lt;/u&gt;&lt;/a&gt;. CSTs retain everything from the original text input, including spacing information, comments, and even nodes attempting to repair syntax errors. This differs from &lt;a href=\&quot;https://en.wikipedia.org/wiki/Abstract_syntax_tree\&quot;&gt;&lt;u&gt;abstract syntax trees (AST)&lt;/u&gt;&lt;/a&gt;, the data structures used in compilers, which have just the essential information to execute the underlying code while ignoring the rest. One key reason for wanting to convert the CST to an AST-like structure, is that it reduces the tree size, which in turn reduces computation and memory usage. To do that, we abstract and filter out unnecessary nodes such as code comments. Consider for instance, how the following snippet&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;x = `result: ${(10+5) *   3}`;;; //this is a comment&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;… gets converted to an AST-like representation:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4KweWZ4yIzOTiIcYqHC682/56c059b38ad46949e7285d84438be4c9/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1520\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Abstract Syntax Tree (AST) representation of the sample code above. Unnecessary elements get removed (e.g. comments, spacing) whereas others get encoded in the tree structure (order of operations due to parentheses).&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;One benefit of working with parsed syntax trees is that &lt;a href=\&quot;https://huggingface.co/learn/nlp-course/en/chapter2/4\&quot;&gt;&lt;u&gt;tokenization&lt;/u&gt;&lt;/a&gt; comes for free! We collect and treat the node leaves’ text as our tokens, which will be used as features (inputs) for the machine learning model. Note that multiple characters in the original input, for instance backticks to form a template string, are not treated as tokens per se, but remain encoded in the graph structure given to the GNN. (Notice in the sample tree representations the different node types, such as “assignment_expression”). Moreover, some details in the exact text input become irrelevant in the executing AST, such as whether a string was originally written using double quotes vs. single quotes.&lt;/p&gt;&lt;p&gt;We encode the node tokens and node types into a matrix of counts. Currently, we lowercase the nodes&amp;#39; text to reduce vocabulary size, improving efficiency and reducing sparsity. Note that JavaScript is a case-sensitive language, so this is a trade-off we continue to explore. This matrix and, importantly, the information about the node edges within the tree, is the input to the GNN.&lt;/p&gt;&lt;p&gt;How do we deal with obfuscated code? We don’t treat it specially. Rather, we always parse the JavaScript text as is, which incidentally unescapes &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Character_escape\&quot;&gt;&lt;u&gt;escape characters&lt;/u&gt;&lt;/a&gt; too. For instance, the resulting AST shown below for the following input exemplifies that:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;atob(&amp;#039;\\x55\\x32\\x56\\x75\\x5a\\x45\\x52\\x68\\x64\\x47\\x45\\x3d&amp;#039;) == &amp;quot;SendData&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/sV2qPtj8G30EFnW6rwCav/ef0a970e338e5610da08fa3ccbdeafcc/3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1080\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Abstract Syntax Tree (AST) representation of the sample code above. JavaScript escape characters are unescaped.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;Moreover, our vocabulary contains several tokens that are commonly used in obfuscated code, such as double escaped hexadecimal-encoded characters. That, together with the graph structure information, is giving us satisfying results — the model successfully classifies malicious code whether it&amp;#39;s obfuscated or not. Analogously, our model’s scores remain stable when applied to plain benign scripts compared to obfuscating them in different ways. In other words, the model’s score on a script is similar to the score on an obfuscated version of the same script. Having said that, some of our model&amp;#39;s false positives (FPs) originate from benign but obfuscated code, so we continue to investigate how we can improve our model&amp;#39;s intelligence.&lt;/p&gt;&lt;h4&gt;Architecting the Graph Neural Network&lt;/h4&gt;&lt;p&gt;We train a &lt;a href=\&quot;https://mbernste.github.io/posts/gcn/\&quot;&gt;&lt;u&gt;message-passing graph convolutional network (MPGCN)&lt;/u&gt;&lt;/a&gt; that processes the input trees. The message-passing layers iteratively update each node’s internal representation, encoded in a matrix, by aggregating information from its neighbors (parent and child nodes in the tree). A pooling layer then condenses this matrix into a feature vector, discarding the explicit graph structure (edge connections between nodes). At this point, standard neural network layers, such as fully connected layers, can be applied to progressively refine the representation. Finally, a &lt;a href=\&quot;https://en.wikipedia.org/wiki/Softmax_function\&quot;&gt;&lt;u&gt;softmax activation&lt;/u&gt;&lt;/a&gt; layer produces a probability distribution over the four possible classes: benign, magecart, cryptomining, and malware.&lt;/p&gt;&lt;p&gt;We use the &lt;a href=\&quot;https://github.com/tensorflow/gnn\&quot;&gt;&lt;u&gt;TF-GNN library&lt;/u&gt;&lt;/a&gt; to implement graph neural networks, with &lt;a href=\&quot;https://keras.io/\&quot;&gt;&lt;u&gt;Keras&lt;/u&gt;&lt;/a&gt; serving as the high-level frontend for model building and training. This works well for us with one exception: &lt;a href=\&quot;https://github.com/tensorflow/gnn/issues/803#issue-2279602052\&quot;&gt;&lt;u&gt;TF-GNN does not support sparse matrices / tensors&lt;/u&gt;&lt;/a&gt;. (That lack of support increases memory consumption, which also adds some latency.) Because of this, we are considering switching to &lt;a href=\&quot;https://pytorch-geometric.readthedocs.io/\&quot;&gt;&lt;u&gt;PyTorch Geometric&lt;/u&gt;&lt;/a&gt; instead.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/79SbvJgWq3mwMks6Vtxpgs/5ab55f19b6cf90dc070b5f0d70abdde9/4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1228\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Graph neural network architecture, transforming the input tree with features down to the 4 classification probabilities.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;The model’s output probabilities are finally inverted and scaled into &lt;a href=\&quot;https://developers.cloudflare.com/page-shield/how-it-works/malicious-script-detection/#malicious-script-detection\&quot;&gt;&lt;u&gt;scores&lt;/u&gt;&lt;/a&gt; (ranging from 1 to 99). The “js_integrity” score aggregates the malicious classes (magecart, malware, cryptomining). A low score means likely malicious, and a high score means likely benign. We use this output format for consistency with other Cloudflare detection systems, such as &lt;a href=\&quot;https://developers.cloudflare.com/page-shield/how-it-works/malicious-script-detection/#malicious-script-detection\&quot;&gt;&lt;u&gt;Bot Management&lt;/u&gt;&lt;/a&gt; and the &lt;a href=\&quot;https://developers.cloudflare.com/waf/detections/attack-score/\&quot;&gt;&lt;u&gt;WAF Attack Score&lt;/u&gt;&lt;/a&gt;. The following diagram illustrates the preprocessing and feature analysis pipeline of the model down to the inference results.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/zLPW9kydBIJySfjaN2TTI/d7b9a7f51c1bb501aac2b7a724d62a1d/5.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1347\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Model inference pipeline to sniff out and alert on malicious JavaScript.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;h4&gt;Tackling unbalanced data: malicious scripts are the minority&lt;/h4&gt;&lt;p&gt;Finding malicious scripts is like finding a needle in a haystack; they are anomalies among plenty of otherwise benign JavaScript. This naturally results in a highly imbalanced dataset. For example, our Magecart-labeled scripts only account for ~6% of the total dataset.&lt;/p&gt;&lt;p&gt;Not only that, but the “benign” category contains an immense variance (and amount) of JavaScript to classify. The lengths of the scripts are highly diverse (ranging from just a few bytes to several megabytes), their coding styles vary widely, some are obfuscated whereas others are not, etc. To make matters worse, malicious payloads are often just small, carefully inserted fragments within an otherwise perfectly valid and functional benign script. This all creates a cacophony of token distributions for an ML model to make sense of.&lt;/p&gt;&lt;p&gt;Still, our biggest problem remains finding enough malevolent JavaScript to add to our training dataset. Thus, simplifying it, our strategy for data collection and annotation is two-fold:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Malicious scripts are about quantity → the more, the merrier (for our model, that is 😉). Of course, we still care about quality and diversity. But because we have so few of them (in comparison to the number of benign scripts), we take what we can.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Benign scripts are about quality → the more &lt;i&gt;variance&lt;/i&gt;, the merrier. Here we have the opposite situation. Because we can collect so many of them easily, the value is in adding differentiated scripts.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h5&gt;Learning key scripts only: reduce false positives with minimal annotation time&lt;/h5&gt;&lt;p&gt;To filter out semantically-similar scripts (mostly benign), we employed the latest advancements in LLM for generating code &lt;a href=\&quot;https://www.cloudflare.com/learning/ai/what-are-embeddings/\&quot;&gt;&lt;u&gt;embeddings&lt;/u&gt;&lt;/a&gt;. We added those scripts that are distant enough from each other to our dataset, as measured by &lt;a href=\&quot;https://developers.cloudflare.com/vectorize/best-practices/create-indexes/#distance-metrics\&quot;&gt;&lt;u&gt;vector cosine similarity&lt;/u&gt;&lt;/a&gt;. Our methodology is simple — for a batch of potentially new scripts:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Initialize an empty &lt;a href=\&quot;https://www.cloudflare.com/learning/ai/what-is-vector-database/\&quot;&gt;&lt;u&gt;vector database&lt;/u&gt;&lt;/a&gt;. For local experimentation, we are fans of &lt;a href=\&quot;https://docs.trychroma.com/docs/overview/introduction\&quot;&gt;&lt;u&gt;Chroma DB&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;For each script:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Call an LLM to generate its embedding. We’ve had good results with &lt;a href=\&quot;https://github.com/bigcode-project/starcoder2\&quot;&gt;&lt;u&gt;starcoder2&lt;/u&gt;&lt;/a&gt;, and most recently &lt;a href=\&quot;https://huggingface.co/Qwen/Qwen2.5-Coder-32B\&quot;&gt;&lt;u&gt;qwen2.5-coder&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Search in the database for the top-1 closest other script’s vectors.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;If the distance &amp;gt; threshold (0.10), select it and add it to the database.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Else, discard the script (though we consider it for further validations and tests).&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Although this methodology has an inherent bias in gradually favoring the first seen scripts, in practice we’ve used it for batches of newly and randomly sampled JavaScript only. To review the whole existing dataset, we could employ other but similar strategies, like applying &lt;a href=\&quot;https://scikit-learn.org/stable/modules/generated/sklearn.cluster.HDBSCAN.html\&quot;&gt;&lt;u&gt;HDBSCAN&lt;/u&gt;&lt;/a&gt; to identify an unknown number of clusters and then selecting the medoids, boundary, and anomaly data points.&lt;/p&gt;&lt;p&gt;We’ve successfully employed this strategy for pinpointing a few highly varied scripts that were relevant for the model to learn from. Our security researchers save a tremendous amount of time on manual annotation, while false positives are drastically reduced. For instance, in a large and unlabeled bucket of scripts, one of our early evaluation models identified ~3,000 of them as malicious. That’s too many to manually review! By removing near duplicates, we narrowed the need for annotation down to only 196 samples, less than 7% of the original amount (see the &lt;a href=\&quot;https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding\&quot;&gt;&lt;u&gt;t-SNE&lt;/u&gt;&lt;/a&gt; visualization below of selected points and clusters). Three of those scripts were actually malicious, one we could not fully determine, and the rest were benign. By just re-training with these new labeled scripts, a tiny fraction of our whole dataset, we reduced false positives by 50% (as gauged in the same bucket and in a controlled test set). We have consistently repeated this procedure to iteratively enhance successive model versions.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/hHw00ojXE4CdorMQI5b56/897e0e045230522478e0735c3e28ff12/6.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1551\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;2D visualization of scripts projected onto an embedding space, highlighting those sufficiently dissimilar from one another.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;h4&gt;From the lab, to the real world&lt;/h4&gt;&lt;p&gt;Our latest model in evaluation has both a macro accuracy and an overall malicious precision nearing 99%(!) on our test dataset. So we are done, right? Wrong! The real world is not the same as the lab, where many more variances of benign JavaScript can be seen. To further assure minimum prediction changes between model releases, we follow these three anti-fool measures:&lt;/p&gt;&lt;h5&gt;Evaluate metrics uncertainty&lt;/h5&gt;&lt;p&gt;First, we thoroughly estimate the &lt;i&gt;uncertainty&lt;/i&gt; of our offline evaluation metrics. How accurate are our accuracy metrics themselves? To gauge that, we calculate the &lt;a href=\&quot;https://en.wikipedia.org/wiki/Standard_error\&quot;&gt;&lt;u&gt;standard error&lt;/u&gt;&lt;/a&gt; and confidence intervals for our offline metrics (precision, recall, &lt;a href=\&quot;https://en.wikipedia.org/wiki/F-score\&quot;&gt;&lt;u&gt;F1 measure&lt;/u&gt;&lt;/a&gt;). To do that, we calculate the model’s predicted scores on the test set once (the original sample), and then generate bootstrapped resamples from it. We use simple random (re-)sampling as it offers us a more conservative estimate of error than stratified or balanced sampling.&lt;/p&gt;&lt;p&gt;We would generate 1,000 resamples, each a fraction of 15% resampled from the original test sample, then calculate the metrics for each individual resample. This results in a distribution of sampled data points. We measure its mean, the standard deviation (with &lt;a href=\&quot;https://en.wikipedia.org/wiki/Standard_deviation#Corrected_sample_standard_deviation\&quot;&gt;&lt;u&gt;Bessel’s correction&lt;/u&gt;&lt;/a&gt;), and finally the standard error and a &lt;a href=\&quot;https://en.wikipedia.org/wiki/Confidence_interval\&quot;&gt;&lt;u&gt;confidence interval&lt;/u&gt;&lt;/a&gt; (CI) (using the percentile method, such as the 2.5 and 97.5 percentiles for a 95% CI). See below for an example of a bootstrapped distribution for precision (P), illustrating that a model’s performance is a continuum rather than a fixed value, and that might exhibit subtly (left-)skewed tails. For some of our internally evaluated models, it can easily happen that some of the sub-sampled metrics decrease by up to 20 percentage points within a 95% confidence range. High standard errors and/or confidence ranges signal needs for model improvement and for improving and increasing our test set.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2x3X2oVv2EfIkLYFrcjLWK/985a685e565f759b7781821595ac4ff7/7.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1279\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;An evaluation metric, here precision (P), might change significantly depending on what’s exactly tested. We thoroughly estimate the metric’s standard error and confidence intervals.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;h5&gt;Benchmark against massive offline unlabeled dataset&lt;/h5&gt;&lt;p&gt;We run our model on the entire corpus of scripts seen by Cloudflare&amp;#39;s network and temporarily cached in the last 90 days. By the way, that’s nearly 1 TiB and 26 million different JavaScript files! With that, we can observe the model’s behavior against real traffic, yet completely offline (to ensure no impact to production). We check the malicious prediction rate, latency, throughput, etc. and sample some of the predictions for verification and annotation.&lt;/p&gt;&lt;h5&gt;Review in staging and shadow mode&lt;/h5&gt;&lt;p&gt;Only after all the previous checks were cleared, we then run this new tentative version in our staging environment. For major model upgrades, we also deploy them in &lt;a href=\&quot;https://cloud.google.com/architecture/guidelines-for-developing-high-quality-ml-solutions\&quot;&gt;&lt;u&gt;shadow mode&lt;/u&gt;&lt;/a&gt; (log-only mode) — running on production, alongside our existing model. We study the model’s behavior for a while before finally marking it as production ready, otherwise we go back to the drawing board.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;ai-inference-at-scale\&quot;&gt;AI inference at scale&lt;/h3&gt;\n            &lt;a href=\&quot;#ai-inference-at-scale\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;At the time of writing, Page Shield sees an average of &lt;i&gt;40,000 scripts per second&lt;/i&gt;. Many of those scripts are repeated, though. Everything on the Internet follows a &lt;a href=\&quot;https://blog.cloudflare.com/making-waf-ai-models-go-brr/#caching-inference-result\&quot;&gt;&lt;u&gt;Zipf&amp;#39;s law distribution&lt;/u&gt;&lt;/a&gt;, and JavaScript seen on the Cloudflare network is no exception. For instance, it is estimated that different versions of the &lt;a href=\&quot;https://blog.cloudflare.com/page-shield-positive-blocking-policies/#client-side-libraries\&quot;&gt;&lt;u&gt;Bootstrap library run on more than 20% of websites&lt;/u&gt;&lt;/a&gt;. It would be a waste of computing resources if we repeatedly re-ran the AI model for the very same inputs — inference result caching is needed. Not to mention, GPU utilization is expensive!&lt;/p&gt;&lt;p&gt;The question is, what is the best way to cache the scripts? We could take an &lt;a href=\&quot;https://csrc.nist.gov/glossary/term/sha_256\&quot;&gt;&lt;u&gt;SHA-256&lt;/u&gt;&lt;/a&gt; hash of the plain content as is. However, any single change in the transmitted content (comments, spacing, or a different character set) changes the SHA-256 output hash.&lt;/p&gt;&lt;p&gt;A better caching approach? Since we need to parse the code into syntax trees for our GNN model anyway, this tree structure and content is what we use to hash the JavaScript. As described above, we filter out nodes in the syntax tree like comments or empty statements. In addition, some irrelevant details get abstracted out in the AST (escape sequences are unescaped, the way of writing strings is normalized, unnecessary parentheses are removed for the operations order is encoded in the tree, etc.).&lt;/p&gt;&lt;p&gt;Using such a tree-based approach to caching, we can conclude that at any moment over 99.9% of reported scripts have already been seen in our network! Unless we deploy a new model with significant improvements, we don’t re-score previously seen JavaScript but just return the cached score. As a result, the model only needs to be called &lt;i&gt;fewer than 10 times per minute&lt;/i&gt;, even during peak times!&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;let-ai-help-ease-pci-dss-v4-compliance\&quot;&gt;Let AI help ease PCI DSS v4 compliance&lt;/h3&gt;\n            &lt;a href=\&quot;#let-ai-help-ease-pci-dss-v4-compliance\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;One of the most popular use cases for deploying Page Shield is to help meet the two new client-side security requirements in PCI DSS v4 — &lt;a href=\&quot;https://assets.ctfassets.net/slt3lc6tev37/4HJex2kG7FCb1IJRC9rIhL/081fdd8b1a471def14cfd415f99e4b58/Evaluation_Page_Shield_091124_FINAL.pdf\&quot;&gt;&lt;u&gt;6.4.3 and 11.6.1&lt;/u&gt;&lt;/a&gt;. These requirements make companies responsible for approving scripts used in payment pages, where payment card data could be compromised by malicious JavaScript. Both of these requirements &lt;a href=\&quot;https://blog.pcisecuritystandards.org/countdown-to-pci-dss-v4.0\&quot;&gt;&lt;u&gt;become effective&lt;/u&gt;&lt;/a&gt; on March 31, 2025.&lt;/p&gt;&lt;p&gt;Page Shield with AI malicious JavaScript detection can be deployed with just a few clicks, especially if your website is already proxied through Cloudflare. &lt;a href=\&quot;https://www.cloudflare.com/page-shield/\&quot;&gt;&lt;u&gt;Sign up here&lt;/u&gt;&lt;/a&gt; to fast track your onboarding!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-19T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-19T13:00:04.030Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1o9yaTNN9SM62ZTRbuG5VG/c6d53aa5ea8fad514d392c3d6c05f4d1/Feature_Image.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;6stQ7u3dAyBmZithR7rBBD&quot;],&quot;name&quot;:[0,&quot;Page Shield&quot;],&quot;slug&quot;:[0,&quot;page-shield&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;1HAYmR545ufVxM2rQzz0SE&quot;],&quot;name&quot;:[0,&quot;Machine Learning&quot;],&quot;slug&quot;:[0,&quot;machine-learning&quot;]}],[0,{&quot;id&quot;:[0,&quot;7BhREQYSSCo9INFzIXH0G0&quot;],&quot;name&quot;:[0,&quot;Malicious JavaScript&quot;],&quot;slug&quot;:[0,&quot;malicious-javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Juan Miguel Cejuela&quot;],&quot;slug&quot;:[0,&quot;juan-miguel-cejuela&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7xNmoPH4z9aRMGppMiktnI/fd1eb08762fb7187ff475d3b34d4d6c5/juan-miguel-cejuela.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@juanmirocks&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Zhiyuan Zheng&quot;],&quot;slug&quot;:[0,&quot;xmflsct&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1P7uGGL8VL5tDIimsTxWo1/5a08bf32629b5bab2ecee50b73ba8c61/xmflsct.jpg&quot;],&quot;location&quot;:[0,&quot;Netherlands&quot;],&quot;website&quot;:[0,&quot;https://xmflsct.com&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Learn more about how Cloudflare developed an AI model to uncover malicious JavaScript intent using a Graph Neural Network, from pre-processing data to inferencing at scale. &quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/how-we-train-ai-to-uncover-malicious-javascript-intent-and-make-web-surfing-safer&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;How we train AI to uncover malicious JavaScript intent and make web surfing safer&quot;],&quot;description&quot;:[0,&quot;Learn more about how Cloudflare developed an AI model to uncover malicious JavaScript intent using a Graph Neural Network, from pre-processing data to inferencing at scale.This AI model is part of our Page Shield offering, helping make web surfing safer.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/22SXBNpNrhwPyjv2hag6Hv/613dc1d6884e90ec842d4ed7c09b0934/OG_Share_2024__16_.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-50-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-100"><a href="/how-we-train-ai-to-uncover-malicious-javascript-intent-and-make-web-surfing-safer/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">How we train AI to uncover malicious JavaScript intent and make web surfing safer</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2025-03-19</p><div class=""><a href="/tag/security-week/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Security Week</a><a href="/tag/page-shield/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Page Shield</a><a href="/tag/ai/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">AI</a><a href="/tag/machine-learning/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Machine Learning</a><a href="/tag/malicious-javascript/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Malicious JavaScript</a><a href="/tag/javascript/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">JavaScript</a></div><p class="f3 fw4 gray1 lh-copy " data-testid="post-content">Learn more about how Cloudflare developed an AI model to uncover malicious JavaScript intent using a Graph Neural Network, from pre-processing data to inferencing at scale. <!-- -->...</p><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/juan-miguel-cejuela/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7xNmoPH4z9aRMGppMiktnI/fd1eb08762fb7187ff475d3b34d4d6c5/juan-miguel-cejuela.jpg" alt="Juan Miguel Cejuela" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/juan-miguel-cejuela/" class="fw4 f3 no-underline black">Juan Miguel Cejuela</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/xmflsct/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1P7uGGL8VL5tDIimsTxWo1/5a08bf32629b5bab2ecee50b73ba8c61/xmflsct.jpg" alt="Zhiyuan Zheng" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/xmflsct/" class="fw4 f3 no-underline black">Zhiyuan Zheng</a></div></li></ul></div></article><!--astro:end--></astro-island><astro-island uid="Z1mkz11" prefix="r4" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,false],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;6mJPdu3FUGFiIg7e0UMXr6&quot;],&quot;title&quot;:[0,&quot;Internationalization and localization: bringing Cloudflare Radar to a global audience&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar-localization-journey&quot;],&quot;excerpt&quot;:[0,&quot;Internationalization and localization require more than translation: tone, images, date/time and number formatting, among other items, need to be considered.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;a href=\&quot;https://radar.cloudflare.com/\&quot;&gt;Cloudflare Radar&lt;/a&gt; celebrated its fourth birthday in September 2024. As we’ve expanded Radar’s scope over the last four years, the value that it provides as a resource for the &lt;b&gt;global&lt;/b&gt; Internet has grown over time, and with Radar data and graphs often appearing in publications and social media around the world, we knew that we needed to make it available in languages beyond English.&lt;/p&gt;&lt;p&gt;Localization is important because most Internet users do not speak English as a first language. According to &lt;a href=\&quot;https://w3techs.com/technologies/history_overview/content_language/ms/y\&quot;&gt;&lt;u&gt;W3Techs&lt;/u&gt;&lt;/a&gt;, English usage on the Internet has dropped 8.3 points (57.7% to 49.4%) since January 2023, whereas usage of other languages like Spanish, German, Japanese, Italian, Portuguese and Dutch is steadily increasing. Furthermore, a &lt;a href=\&quot;https://csa-research.com/Featured-Content/For-Global-Enterprises/Global-Growth/CRWB-Series/CRWB-B2C\&quot;&gt;&lt;u&gt;CSA Research study&lt;/u&gt;&lt;/a&gt; determined that 65% of Internet users prefer content in their language.&lt;/p&gt;&lt;p&gt;To successfully (and painlessly) localize any product, it must be internationalized first.  Internationalization is the process of making a product ready to be translated and adapted into multiple languages and cultures, and it sets the foundation to enable your product to be localized later on at a much faster pace (and at a lower cost, both in time and budget). Below, we review how Cloudflare’s Radar and Globalization teams worked together to deliver a Radar experience spanning twelve languages.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;what-is-localization\&quot;&gt;What is localization?&lt;/h2&gt;\n            &lt;a href=\&quot;#what-is-localization\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Localization (l10n) is the process of adapting content for a region, including translation, associated imagery, and cultural elements that influence how your content will be perceived. The goal, ideally, is to make the content sound like it was originally written with the region in mind, incorporating relevant cultural nuances instead of merely replacing English with translated text.&lt;/p&gt;&lt;p&gt;Localization includes, among others:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Language&lt;/b&gt;: Translation, obviously, but it’s just the beginning.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Tone and message&lt;/b&gt;: Localization considers what will resonate with your target audience, not just what’s accurate.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Images&lt;/b&gt;: What may be appropriate in one country can be problematic in another (maps, for instance, that tend to include disputed territories). &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Date, time, measurement, and number formats&lt;/b&gt;: Formats change based on location and may differ even within the same language. In the U.S., the date follows this format: “December 15, 2018.” But in the U.K., that same date would be written like this: “15 December 2018.” Not to mention a constant source of confusion: the month/day/year vs.day/month/year difference:&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/ChruPHkbCpKkaDNfnd3wK/13a299038c2fc70e71fc7e4e71fb8671/image9.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;356\&quot; height=\&quot;222\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Image: XKCD, &lt;/i&gt;&lt;/sup&gt;&lt;a href=\&quot;https://xkcd.com/2562/\&quot;&gt;&lt;sup&gt;&lt;i&gt;&lt;u&gt;https://xkcd.com/2562/&lt;/u&gt;&lt;/i&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Pixar movies are a great example of localization&lt;b&gt;&lt;i&gt;. &lt;/i&gt;&lt;/b&gt;Pixar takes great care to internationalize their movie production process, so they can replace or insert scenes that will resonate with watchers all over the world, not just the US. Let’s consider &lt;i&gt;Inside Out&lt;/i&gt; (2015). During the movie, Riley reminisces about playing ice hockey back in Minnesota. Most of the world is not as familiar with ice hockey as in the US, so Pixar wisely decided that they would use soccer elsewhere, allowing a more direct emotional connection with those audiences. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2vmuz0H3YXa6sAh0EJpj0E/5ed37b80f24932c6082a079a587c1ac4/Screenshot_2024-12-14_at_16.15.15.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1378\&quot; height=\&quot;322\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Images: scene from Inside Out (2015), produced by Pixar Animation Studios and Walt Disney Pictures. Copyright Pixar Animation Studios and Walt Disney Pictures. Images used under fair use.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;And you don’t have to go to computer animated movies. Here’s an example from The Shining (1980) where the famous “All work and no play makes Jack a dull boy” typewriter scene was localized into all languages differently. &lt;i&gt;The producers, in a pre-Information Technology example of internationalization, shot and cut the localized scene into the local versions of the movie.&lt;/i&gt;&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3GNqgdcxlk9fLll5OQgilJ/5bfe683547230280ea84741a7c7c0405/Screenshot_2024-12-14_at_16.16.28.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1492\&quot; height=\&quot;362\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Images: scene from The Shining (1980), directed by Stanley Kubrick. Copyright Warner Bros. Pictures. Images used under fair use.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;internationalization\&quot;&gt;Internationalization&lt;/h2&gt;\n            &lt;a href=\&quot;#internationalization\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Localization is hard, and no one in the business will tell you otherwise. Fortunately there’s a playbook: the first step to localization is &lt;b&gt;internationalization&lt;/b&gt; (i18n). &lt;b&gt;Internationalization&lt;/b&gt; is the process of making a product ready to be translated and adapted into multiple languages and cultures. It&amp;#39;s a preparatory step that helps with translation and localization. The more you internationalize your code and the more you take into account language and cultural nuances, the easier the localization will be.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;hard-coding-and-externalization\&quot;&gt;Hard-coding and externalization&lt;/h3&gt;\n            &lt;a href=\&quot;#hard-coding-and-externalization\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The first step to internationalize Radar was to assess how many of the localizable strings were hard-coded. Hard coding is the practice of embedding data directly into the source code of a program. Although a convenient and fast way to write your code, it makes it more difficult to change or localize the code later.&lt;/p&gt;&lt;p&gt;Most of the strings that make up the Radar pages used to be hard-coded, so before we could begin translating, &lt;b&gt;externalization&lt;/b&gt; had to be done, which is the process of extracting any text that needs to be localized from the code and moving it into separate files.&lt;/p&gt;&lt;p&gt;Hard-coded strings:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import Card from “~/components/Card”;\nimport Chart from “~/components/Chart”;\n\nexport default function TrafficChart() {\n  return (\n    &amp;lt;Card\n      title=&amp;quot;Traffic&amp;quot;\n      description=&amp;quot;Share of HTTP requests&amp;quot;\n    &amp;gt;\n      &amp;lt;Chart /&amp;gt;\n    &amp;lt;/Card&amp;gt;\n  );\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Externalized key placeholders:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { useTranslation } from &amp;quot;react-i18next&amp;quot;;\nimport Card from “~/components/Card”;\nimport Chart from “~/components/Chart”;\n\nexport default function TrafficChart() {\n  const { t } = useTranslation();\n  return (\n    &amp;lt;Card\n      title={t(&amp;quot;traffic.chart.title&amp;quot;)}\n      description={t(&amp;quot;traffic.chart.description&amp;quot;)}\n    &amp;gt;\n      &amp;lt;Chart /&amp;gt;\n    &amp;lt;/Card&amp;gt;\n  );\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;There are several benefits to externalizing strings:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;It allows translators to work on separate, isolated files that contain only localizable strings &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;It prevents accidental changes to the code &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;It allows developers to deploy updates, changes, and fixes without having to recompile or redeploy code for each language every time&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If you look at the example below, when the code is compiled or deployed, upon reaching line 10 (on the left), it will find a key named &lt;code&gt;traffic.chart.title&lt;/code&gt;. It will then proceed to match that key within the JSON file on the right, finding it on line 1090 and resolving it to “&lt;code&gt;Traffic&lt;/code&gt;” for English, &amp;quot;&lt;code&gt;Tráfego&lt;/code&gt;&amp;quot; for Portuguese and &amp;quot;&lt;code&gt;トラフィック&lt;/code&gt;&amp;quot; for Japanese, doing this for every localized JSON file present in the code.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/14pNiwO9UTdrwbFzq2VUvi/c1a163bc98915195a0cb8ccb29639365/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1920\&quot; height=\&quot;800\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;pseudo-translation\&quot;&gt;Pseudo translation&lt;/h3&gt;\n            &lt;a href=\&quot;#pseudo-translation\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Not all strings are easily found and some are buried deep in the code, sometimes in legacy, inherited code or APIs. Fortunately, there are some strategies that help detect hard-coded strings. This is where &lt;b&gt;&lt;i&gt;pseudo translation&lt;/i&gt;&lt;/b&gt; comes into play.&lt;/p&gt;&lt;p&gt;&lt;i&gt;Pseudo translation&lt;/i&gt; is a process that replaces all characters in a string with similar-looking ones; pseudo translated strings are enclosed within [ ] characters, and some extra characters are added to them to simulate text expansion (&lt;a href=\&quot;#text-expansion\&quot;&gt;&lt;u&gt;more on that later&lt;/u&gt;&lt;/a&gt;). It is an invaluable tool to help us find any hard coded strings, and to stress test the UI for language readiness and length variability, while still keeping the content mostly readable. For example, this string:&lt;/p&gt;&lt;p&gt;&lt;code&gt;Routing Information&lt;/code&gt;&lt;/p&gt;&lt;p&gt;looks like this once pseudo translated:&lt;/p&gt;&lt;p&gt;&lt;code&gt;[R~óútíñg Í~ñfó~rmát~íóñ]&lt;/code&gt;&lt;/p&gt;&lt;p&gt;Once pseudo translation is done, any English strings left intact are most likely hard coded or come from other sources. In the screenshot below you can see how &lt;code&gt;ASN&lt;/code&gt;, &lt;code&gt;Country&lt;/code&gt;, &lt;code&gt;Name&lt;/code&gt; and &lt;code&gt;Prefix Count&lt;/code&gt; did not get pseudo translated and had to be externalized by the Radar developers. The Globalization team collaborated with the Radar team to report and fix hard-coded text issues, as well as the issues that are mentioned in the next few sections.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/16SjYR099rxBLw0YuptB9n/7ca430aa1544349c3e2eff45cdbdfe60/image4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1271\&quot; height=\&quot;644\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;text-expansion\&quot;&gt;Text expansion&lt;/h3&gt;\n            &lt;a href=\&quot;#text-expansion\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Text expansion occurs when translated content from one language to another takes up more space than the original. Sometimes this expansion is horizontal, as English to German can &lt;a href=\&quot;https://abctranslations.com/text-expansion-and-reduction-in-translation-services\&quot;&gt;&lt;u&gt;expand&lt;/u&gt;&lt;/a&gt; up to an average of 35%, Spanish 30%, and French 20%). Asian languages might contract from the English but expand vertically. Interestingly, the fewer characters English has, the more the localized languages tend to expand.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3P2FszOadUDhhc1oRzjjra/250d2425f09423907359914bf628e29c/image10.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;996\&quot; height=\&quot;507\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Data source: &lt;/i&gt;&lt;/sup&gt;&lt;a href=\&quot;https://www.ibm.com/docs/en/i/7.3?topic=interfaces-text-translation-design\&quot;&gt;&lt;sup&gt;&lt;i&gt;&lt;u&gt;IBM&lt;/u&gt;&lt;/i&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;UI designers and developers need to keep this in mind when creating their applications. Thus, one important consideration is to test the design mock-ups with larger texts and plan the UI to accommodate for text expansion. If some English content barely fits within its container, it will most likely not fit in other languages and possibly break the layout.&lt;/p&gt;&lt;p&gt;Here’s an example of the same button in different languages in Radar’s fixed-width sidebar. Since it’s the main navigation, truncating the text is not appropriate and the only viable option is wrapping, which means localized buttons can end up having different heights. Sometimes it’s necessary to trade visual consistency for usability.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/oByQcEAMDwh4gv1GtxOQG/0de2878728f293a49e03a9b90fbae536/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1104\&quot; height=\&quot;294\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;string-concatenation\&quot;&gt;String concatenation&lt;/h3&gt;\n            &lt;a href=\&quot;#string-concatenation\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In English, you can easily chain-connect words because most words lack &lt;a href=\&quot;https://en.wikipedia.org/wiki/Inflection\&quot;&gt;&lt;u&gt;inflections&lt;/u&gt;&lt;/a&gt;. Almost all programming languages are designed using the English language in mind. An old linguist joke goes like: &lt;i&gt;an English teacher: a teacher of English or a teacher from England? &lt;/i&gt;Case in point, it would be nightmarish to translate this example:&lt;/p&gt;&lt;p&gt;&lt;code&gt;A lovely little old rectangular green French silver whittling knife&lt;/code&gt; &lt;/p&gt;&lt;p&gt;Most Western languages need to connect words with some &lt;i&gt;glue&lt;/i&gt;: prepositions, articles, or inflections. This is why, in general, string concatenation (putting together sentences or sentence parts by combining two or more strings) is a terrible practice for localization, even though it seems efficient from a development point of view. You can’t assume that all languages follow the same sentence structure as English. Most languages don’t.&lt;/p&gt;&lt;p&gt;Sentences may need to be completely reversed for them to sound grammatically correct in other languages. This becomes a particularly severe problem when a string doesn’t include a placeholder because it’s assumed to be concatenated at the beginning or the end of the string, such as this:&lt;/p&gt;&lt;p&gt;&lt;code&gt;&amp;quot;is currently categorized as:&amp;quot;&lt;/code&gt;&lt;/p&gt;&lt;p&gt;Developers need to make sure to include any placeholders within the string itself, so that translators can easily move them as needed, for instance:&lt;/p&gt;&lt;p&gt;&lt;code&gt;&amp;quot;Distribution of {{botClass}} traffic by IP version&amp;quot;&lt;/code&gt;&lt;/p&gt;&lt;p&gt;would look like this in Simplified Chinese (notice how the &lt;code&gt;{{botClass}}&lt;/code&gt; placeholder got moved)&lt;/p&gt;&lt;p&gt;&lt;code&gt;&amp;quot;{{botClass}} 流量分布（按 IP 版本）&amp;quot;&lt;/code&gt;&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;string-reuse\&quot;&gt;String reuse&lt;/h3&gt;\n            &lt;a href=\&quot;#string-reuse\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;As with string concatenation, string reuse (using the same string in more than one place and just swapping out the contents of a placeholder) seems efficient if you’re a developer. A problem arises when translating this into gendered languages, such as most European languages. In Spanish, depending on its position and context, a word as simple as “open” standing by itself, could have all these different translations:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3rcU3cH7ZXfsn5bxmx11UG/60e9ebfbec19caed3553e8d3b63828fd/image7.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;847\&quot; height=\&quot;614\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Other examples are &lt;code&gt;Custom&lt;/code&gt;, &lt;code&gt;Detected&lt;/code&gt;, or &lt;code&gt;Disabled&lt;/code&gt;, which can have different translations depending on their position within a sentence, their location in the UI, depending on whether they accompany a singular, plural, masculine or feminine noun, so &lt;a href=\&quot;https://www.i18next.com/translation-function/plurals#singular-plural\&quot;&gt;&lt;u&gt;extra entries&lt;/u&gt;&lt;/a&gt; for these may need to be created in the language files.&lt;/p&gt;&lt;p&gt;Translators will also need to know what will replace the placeholders in strings like the one below, because the surrounding wording may refer to a term that is masculine, feminine, or neutral (for languages that have those, such as German). If a placeholder could be more than one of these (a masculine noun but also a feminine noun), the translation will become grammatically incorrect in at least some of the cases. In the following example, translators would need to know what &lt;code&gt;{link1}&lt;/code&gt; and &lt;code&gt;{link2}&lt;/code&gt; will be replaced with, so they know which grammatically correct wording to use around them.&lt;/p&gt;&lt;p&gt;&lt;code&gt;Your use of the URL Scanner is subject to our {{link1}}. Any personal data in a submitted URL will be handled in accordance with our {{link2}}&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;A better way to do this is to have component placeholders and include the text to be translated for context:&lt;/p&gt;&lt;p&gt;&lt;code&gt;Your use of the URL Scanner is subject to our &amp;lt;link1&amp;gt;Online Service Terms of Use&amp;lt;/link1&amp;gt;. Any personal data in a submitted URL will be handled in accordance with our &amp;lt;link2&amp;gt;Privacy Policy&amp;lt;/link2&amp;gt;&lt;/code&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;regional-considerations\&quot;&gt;Regional considerations&lt;/h2&gt;\n            &lt;a href=\&quot;#regional-considerations\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;date-formats\&quot;&gt;Date formats&lt;/h3&gt;\n            &lt;a href=\&quot;#date-formats\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Date formats vary greatly from country to country. Not only can’t you assume that all countries use a month/day/year format, but even the day that the week starts may be different based on the country or culture.\n\nHere’s a comparison of Radar’s date picker in American English against European Spanish (which has weeks starting on Mondays instead of Sundays), and against Simplified Chinese (which uses a completely different format for dates).&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/10dcc7wLFMwNmIeMtHeezb/863c9e61d174f9f647379a146b0d4912/image2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1548\&quot; height=\&quot;600\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Thankfully, developers don’t need to know all the country-specific details, as they can use &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat\&quot;&gt;&lt;u&gt;Intl.DateTimeFormat&lt;/u&gt;&lt;/a&gt; or &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString\&quot;&gt;&lt;u&gt;Date.toLocaleString()&lt;/u&gt;&lt;/a&gt; for this.&lt;/p&gt;&lt;p&gt;Intl.DateTimeFormat receives a locale and formatting &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat/DateTimeFormat#date-time_component_options\&quot;&gt;&lt;u&gt;options&lt;/u&gt;&lt;/a&gt; that differ from string tokens commonly found on date libraries such as &lt;a href=\&quot;http://day.js\&quot;&gt;&lt;u&gt;Day.js&lt;/u&gt;&lt;/a&gt; or &lt;a href=\&quot;https://momentjs.com/\&quot;&gt;&lt;u&gt;Moment.js&lt;/u&gt;&lt;/a&gt;. Unless you specifically use the &lt;a href=\&quot;https://day.js.org/docs/en/display/format#localized-formats\&quot;&gt;&lt;u&gt;localized string tokens&lt;/u&gt;&lt;/a&gt; on those libraries, the order of the tokens is fixed, along with any characters or delimiters you might add to the format, which poses a problem because the date format parts order should change according to the locale. \n\nIntl.DateTimeFormat handles all that and saves you the trouble of having to add a date formatting dependency to your project and loading library-specific locale resources.&lt;/p&gt;&lt;p&gt;Here’s an example of a generic React component using Intl.DateTimeFormat and react-i18next. The code below will render the date as “Tue, Oct 1, 2024” for American English (en-US) and as “2024年10月1日(火)” for Japanese (ja-JP).&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { useTranslation } from &amp;quot;react-i18next&amp;quot;;\n\nexport default function SomeComponent() {\n  const { i18n } = useTranslation();\n  const date = new Date(&amp;quot;2024-10-01&amp;quot;);\n  return (\n    &amp;lt;time dateTime={date.toISOString()}&amp;gt;\n      {new Intl.DateTimeFormat(i18n.language, {\n        weekday: &amp;quot;short&amp;quot;,\n        month: &amp;quot;short&amp;quot;,\n        year: &amp;quot;numeric&amp;quot;,\n        day: &amp;quot;numeric&amp;quot;,\n      }).format(date)}\n    &amp;lt;/time&amp;gt;\n  );\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;number-notations\&quot;&gt;Number notations&lt;/h3&gt;\n            &lt;a href=\&quot;#number-notations\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Similarly, different locales use different notations for numbers. In the US and the UK, a period is used as the decimal separator, and a comma as the thousands separator. Instead, other countries use a comma as the decimal separator and a period (or a space) as the thousands separator. Again, it’s not necessary for developers to know all the odds and ends for this, as they can use &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat\&quot;&gt;&lt;u&gt;Intl.NumberFormat&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Here’s an example of a generic React component using Intl.NumberFormat and react-i18next. The code below will render the number as “12,345,678.90” for American English (en-US) and as “12 345 678,90” for Portuguese (pt-PT). Intl.NumberFormat &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat#options\&quot;&gt;&lt;u&gt;options&lt;/u&gt;&lt;/a&gt; can be passed to format numbers as decimals, percentages, currencies, etc, and specify things like number of decimal places and rounding strategies.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { useTranslation } from &amp;quot;react-i18next&amp;quot;;\n\nexport default function SomeComponent() {\n  const { i18n } = useTranslation();\n  return (\n    &amp;lt;span&amp;gt;{new Intl.NumberFormat(i18n.language, {\n    style: &amp;quot;decimal&amp;quot;,\n    minimumFractionDigits: 2,\n  }).format(12345678.9)}&amp;lt;/span&amp;gt;);\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;As of mid-December, regionalized number formatting is not fully implemented on Radar. We expect this to be complete by the end of Q1 2025.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;list-sorting\&quot;&gt;List sorting&lt;/h3&gt;\n            &lt;a href=\&quot;#list-sorting\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;When you have a list of items that appears sorted, such as a country list in a dropdown, it’s not enough to simply translate the items. For instance, when translated into Portuguese, “&lt;code&gt;South Africa&lt;/code&gt;” becomes “&lt;code&gt;África do Sul&lt;/code&gt;”, which means it should then go near the top of the list. Besides that, each language has different sorting requirements, and those go way beyond the A-Z alphabet. For instance, several Asian languages don’t use Latin characters at all, and may get sorted by stroke or &lt;a href=\&quot;https://en.wikipedia.org/wiki/Chinese_character_radicals\&quot;&gt;&lt;u&gt;character radical&lt;/u&gt;&lt;/a&gt; order instead.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5uOOTu2U3txnxjcVkhI4VI/37af8b29d9537fc56c4c5e23e3504640/image13.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1770\&quot; height=\&quot;756\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Here’s an example of a generic React country selector component using &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare\&quot;&gt;&lt;u&gt;String.localeCompare&lt;/u&gt;&lt;/a&gt; and react-i18next. The code below imports a list of countries with name and &lt;a href=\&quot;https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2\&quot;&gt;&lt;u&gt;alpha-2&lt;/u&gt;&lt;/a&gt; code and sorts the options according to the translated country name for the active locale. &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Collator/Collator#options\&quot;&gt;&lt;u&gt;Intl.Collator options&lt;/u&gt;&lt;/a&gt; can be passed to localeCompare() for specific sorting needs.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { useTranslation } from &amp;quot;react-i18next&amp;quot;;\n\nimport Select from &amp;quot;~/components/Select&amp;quot;;\nimport COUNTRIES from &amp;quot;~/constants/geo&amp;quot;;\n\nexport default function CountrySelector() {\n  const { t, i18n } = useTranslation();\n  const options = COUNTRIES.map(({ name, code }) =&amp;gt; ({\n    label: t(name, { ns: &amp;quot;countries&amp;quot; }),\n    value: code,\n  })).sort((a, b) =&amp;gt; a.label.localeCompare(b.label, i18n.language));\n  return &amp;lt;Select options={options} onChange={(option) =&amp;gt; { /* do something */ }} /&amp;gt;;\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;api-localization\&quot;&gt;API localization&lt;/h2&gt;\n            &lt;a href=\&quot;#api-localization\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Many of the Radar screens and reports include output from Cloudflare or third-party APIs. Unfortunately, the vast majority of these APIs only output English content. When combining that with the translated part of the site, it may give the impression of a poorly localized site.&lt;/p&gt;&lt;p&gt;To solve this, we take API outputs and map everything into &lt;a href=\&quot;https://react.i18next.com/guides/multiple-translation-files\&quot;&gt;&lt;u&gt;separate files&lt;/u&gt;&lt;/a&gt;, translate all possible messages, and then display that instead of the original output. But as APIs evolve over time and new messages are added, or existing ones get changed, keeping up with these translations becomes an endless game of “&lt;a href=\&quot;https://en.wikipedia.org/wiki/Whac-A-Mole\&quot;&gt;&lt;u&gt;whac-a-mole&lt;/u&gt;&lt;/a&gt;&amp;quot;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-RUST\&quot;&gt;&lt;code class=\&quot;language-RUST\&quot;&gt;&amp;quot;Address unreachable error when attempting to load page&amp;quot;: &amp;quot;Error de dirección inaccesible al intentar cargar la página&amp;quot;,\n&amp;quot;Authentication failed&amp;quot;: &amp;quot;Autenticación fallida&amp;quot;,\n&amp;quot;Browser did not fully start before timeout&amp;quot;: &amp;quot;El navegador no se ha iniciado por completo antes de agotar el tiempo de espera.&amp;quot;,\n&amp;quot;Certificate and/or SSL error when attempting to load page&amp;quot;: &amp;quot;Error de certificado y/o SSL al intentar cargar la página&amp;quot;,\n&amp;quot;Crawl took too long to finish&amp;quot;: &amp;quot;El rastreo ha tardado demasiado en completarse.&amp;quot;,\n&amp;quot;DNS resolution failed&amp;quot;: &amp;quot;Error de resolución de DNS&amp;quot;,\n&amp;quot;Network connection aborted.&amp;quot;: &amp;quot;Conexión de red cancelada&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;It should be a best practice for APIs to accept a locale parameter or header, and for engineers to have multiple languages in mind when building these APIs, even if it’s just the error messages. That could save time and resources for any number of clients they might have.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;project-setup\&quot;&gt;Project setup&lt;/h2&gt;\n            &lt;a href=\&quot;#project-setup\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Radar is a &lt;a href=\&quot;https://remix.run/\&quot;&gt;&lt;u&gt;Remix&lt;/u&gt;&lt;/a&gt; project running on &lt;a href=\&quot;https://pages.cloudflare.com/\&quot;&gt;&lt;u&gt;Cloudflare Pages&lt;/u&gt;&lt;/a&gt;. While researching ways to implement internationalization, we came across this Remix &lt;a href=\&quot;https://remix.run/blog/remix-i18n\&quot;&gt;&lt;u&gt;blog post&lt;/u&gt;&lt;/a&gt;, and after some experimenting, we decided to go with Sergio Xalambrí’s &lt;a href=\&quot;https://github.com/sergiodxa/remix-i18next\&quot;&gt;&lt;u&gt;remix-i18next&lt;/u&gt;&lt;/a&gt;. We mostly followed the installation instructions found on the repo, with some changes.&lt;/p&gt;&lt;p&gt;We have multiple translation files on every locale folder, one for each data source, to help us maintain strings that come from APIs. Each file can be used to create a namespace for translations, to avoid key collisions, and also to be loaded separately as needed for each route or component.&lt;/p&gt;&lt;p&gt;On remix-i18next’s instructions, you’ll find the concept of backend plugins to achieve the loading of these files, except that you cannot use &lt;a href=\&quot;https://github.com/i18next/i18next-fs-backend\&quot;&gt;&lt;u&gt;i18next-fs-backend&lt;/u&gt;&lt;/a&gt; with Cloudflare Pages because there’s no access to the filesystem. To solve that we used the &lt;i&gt;resources&lt;/i&gt; approach, similar to what can be found on this sample &lt;a href=\&quot;https://github.com/sergiodxa/remix-vite-i18next\&quot;&gt;&lt;u&gt;remix-i18next with vite&lt;/u&gt;&lt;/a&gt; setup, but we didn’t want to have to maintain the resources dictionary each time we add new namespaces, so &lt;a href=\&quot;https://vite.dev/guide/features#glob-import\&quot;&gt;&lt;u&gt;vite’s Glob imports&lt;/u&gt;&lt;/a&gt; came in handy:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { serverOnly$ } from &amp;quot;vite-env-only/macros&amp;quot;;\n\nexport const resources = serverOnly$(\n  Object.entries(import.meta.glob(&amp;quot;./*/*.json&amp;quot;, { import: &amp;quot;default&amp;quot; })).reduce(\n    (acc, [path, module]) =&amp;gt; {\n      const parts = path.split(&amp;quot;/&amp;quot;).slice(1);\n      const locale = parts[0];\n      const namespace = parts[1].split(&amp;quot;.&amp;quot;)[0];\n      if (!acc[locale]) acc[locale] = {};\n      if (!acc[locale][namespace]) acc[locale][namespace] = {};\n      module().then((value) =&amp;gt; (acc[locale][namespace] = value));\n      return acc;\n    },\n    {},\n  ),\n)!;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This creates a &lt;a href=\&quot;https://github.com/pcattori/vite-env-only?tab=readme-ov-file#serveronly\&quot;&gt;&lt;u&gt;server-side only&lt;/u&gt;&lt;/a&gt; resources dictionary by importing all JSON files in the locales folder to be passed as the resources property for the i18next configuration in Remix’s &lt;a href=\&quot;https://remix.run/docs/en/main/file-conventions/entry.server\&quot;&gt;&lt;u&gt;entry.server.tsx&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;To load namespaces on the client side, we created a Remix &lt;a href=\&quot;https://remix.run/docs/en/main/guides/resource-routes#creating-resource-routes\&quot;&gt;&lt;u&gt;resource route&lt;/u&gt;&lt;/a&gt; that uses the resources dictionary and responds with the namespace object of the requested locale:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { LoaderFunctionArgs } from &amp;quot;@remix-run/server-runtime&amp;quot;;\n\nimport { resources } from &amp;quot;~/i18n&amp;quot;;\n\nexport async function loader({ params }: LoaderFunctionArgs) {\n  const { locale, namespace } = params;\n  return resources[locale]?.[namespace] || {};\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You can then use the &lt;a href=\&quot;https://github.com/i18next/i18next-http-backend\&quot;&gt;&lt;u&gt;i18next-http-backend&lt;/u&gt;&lt;/a&gt; or &lt;a href=\&quot;https://github.com/dotcore64/i18next-fetch-backend\&quot;&gt;&lt;u&gt;i18next-fetch-backend&lt;/u&gt;&lt;/a&gt; backend plugins for the i18next configuration in Remix’s &lt;a href=\&quot;https://remix.run/docs/en/main/file-conventions/entry.client\&quot;&gt;&lt;u&gt;entry.client.tsx&lt;/u&gt;&lt;/a&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import i18next from &amp;quot;i18next&amp;quot;;\nimport i18nextHttpBackend from &amp;quot;i18next-http-backend&amp;quot;;\nimport { initReactI18next } from &amp;quot;react-i18next&amp;quot;;\nimport { getInitialNamespaces } from &amp;quot;remix-i18next/client&amp;quot;;\nimport { options } from “~/i18n”;\n  \nawait i18next\n    .use(initReactI18next)\n    .use(i18nextHttpBackend)\n    .init({\n      ...options,\n      ns: getInitialNamespaces(),\n      backend: { loadPath: &amp;quot;/api/i18n/{{lng}}/{{ns}}&amp;quot; },\n    });&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Default namespaces are defined with the &lt;i&gt;defaultNS&lt;/i&gt; config property:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export const defaultNS = [&amp;quot;main&amp;quot;, &amp;quot;countries&amp;quot;];&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Additional namespaces to be used for each route can be defined through Remix’s &lt;a href=\&quot;https://remix.run/docs/en/main/route/handle\&quot;&gt;&lt;u&gt;handle export&lt;/u&gt;&lt;/a&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export const handle = {\n  i18n: [&amp;quot;url-scanner&amp;quot;, &amp;quot;domain-categories&amp;quot;],\n};&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Namespaces on the server side get picked up by the &lt;i&gt;getRouteNamespaces&lt;/i&gt; function on entry.server.tsx:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const ns = i18n.getRouteNamespaces(remixContext);&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;On the client-side, examples suggested that you’d have to declare the namespaces on each &lt;i&gt;useTranslation()&lt;/i&gt; hook instance, but we worked around that in Remix’s &lt;a href=\&quot;https://remix.run/docs/en/main/file-conventions/root\&quot;&gt;&lt;u&gt;root.tsx&lt;/u&gt;&lt;/a&gt; file:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { useLocation, useMatches } from &amp;quot;@remix-run/react&amp;quot;;\nimport { useTranslation } from &amp;quot;react-i18next&amp;quot;;\nimport { defaultNS } from “~/i18n”;\n\nexport function Layout({ children }) {\n  const location = useLocation();\n  const matches = useMatches();\n  const handle = matches?.find((m) =&amp;gt; m.pathname === location.pathname)?.handle || {};\n  useTranslation([...new Set([...defaultNS, ...(handle.i18n || [])])]);\n  ...\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This causes the client-side plugin to make calls to the resource route and load the required namespaces.&lt;/p&gt;&lt;p&gt;We also wanted to have the locale in the URL pathname, but not for the default language, so Remix’s &lt;a href=\&quot;https://remix.run/docs/en/main/file-conventions/routes#optional-segments\&quot;&gt;&lt;u&gt;optional segments&lt;/u&gt;&lt;/a&gt; allowed us to do just that. remix-i18next does not have URL locale detection by default, but you can provide your own &lt;a href=\&quot;https://github.com/sergiodxa/remix-i18next?tab=readme-ov-file#finding-the-locale-from-the-request-url-pathname\&quot;&gt;&lt;u&gt;findLocale function&lt;/u&gt;&lt;/a&gt; that will receive the request as an argument, and you can then parse the request URL to extract the locale.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;search-engine-optimization\&quot;&gt;Search engine optimization&lt;/h2&gt;\n            &lt;a href=\&quot;#search-engine-optimization\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Once you set up your project for internationalization, you can inform search engines of &lt;a href=\&quot;https://developers.google.com/search/docs/specialty/international/localized-versions\&quot;&gt;&lt;u&gt;localized versions of your pages&lt;/u&gt;&lt;/a&gt;. This allows search engines to display localized results of your website in the same language that is being searched.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;&amp;lt;head&amp;gt;\n  ...\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/&amp;quot; hreflang=&amp;quot;en-US&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/de-de&amp;quot; hreflang=&amp;quot;de-DE&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/es-es&amp;quot; hreflang=&amp;quot;es-ES&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/es-la&amp;quot; hreflang=&amp;quot;es-LA&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/fr-fr&amp;quot; hreflang=&amp;quot;fr-FR&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/it-it&amp;quot; hreflang=&amp;quot;it-IT&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/ja-jp&amp;quot; hreflang=&amp;quot;ja-JP&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/ko-kr&amp;quot; hreflang=&amp;quot;ko-KR&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/pt-br&amp;quot; hreflang=&amp;quot;pt-BR&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/pt-pt&amp;quot; hreflang=&amp;quot;pt-PT&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/zh-cn&amp;quot; hreflang=&amp;quot;zh-CN&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/zh-tw&amp;quot; hreflang=&amp;quot;zh-TW&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;alternate&amp;quot; href=&amp;quot;https://radar.cloudflare.com/&amp;quot; hreflang=&amp;quot;x-default&amp;quot;&amp;gt;\n  &amp;lt;link rel=&amp;quot;canonical&amp;quot; href=&amp;quot;https://radar.cloudflare.com/&amp;quot;&amp;gt;\n  ...\n&amp;lt;/head&amp;gt;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You should also localize page titles, descriptions, and relevant &lt;a href=\&quot;https://ogp.me/\&quot;&gt;&lt;u&gt;Open Graph&lt;/u&gt;&lt;/a&gt; metadata. To achieve this with Remix and remix-i18next, you use the &lt;a href=\&quot;https://github.com/sergiodxa/remix-i18next?tab=readme-ov-file#translating-text-inside-loaders-or-actions\&quot;&gt;&lt;u&gt;getFixedT&lt;/u&gt;&lt;/a&gt; method in route loaders to resolve the translations and return data for the &lt;a href=\&quot;https://remix.run/docs/en/main/route/meta\&quot;&gt;&lt;u&gt;meta export&lt;/u&gt;&lt;/a&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import type { LoaderFunctionArgs, MetaArgs } from &amp;quot;@remix-run/server-runtime&amp;quot;;\nimport i18n from &amp;quot;~/i18next.server&amp;quot;;\n\nexport async function loader({ request }: LoaderFunctionArgs) {\n  const t = await i18n.getFixedT(request);\n  return {\n    meta: {\n      title: t(&amp;quot;meta.about.title&amp;quot;),\n      description: t(&amp;quot;meta.about.description&amp;quot;),\n      url: request.url,\n    },\n  };\n}\n\nexport const meta = ({ data }: MetaArgs&amp;lt;typeof loader&amp;gt;) =&amp;gt; data.meta;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;If you are defining default meta tags in parent routes you may also need to &lt;a href=\&quot;https://remix.run/docs/ru/main/route/meta#merging-with-parent-meta\&quot;&gt;&lt;u&gt;merge the meta objects&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;conclusion\&quot;&gt;Conclusion&lt;/h2&gt;\n            &lt;a href=\&quot;#conclusion\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;There is hardly ever an absolute when dealing with languages. Your Spanish, your French, your Japanese will be different from someone else’s, even if you grew up next door to each other. Family, education, environment, relationships will season and give color to your language. It is like a family recipe — it’s unique, it feels like home and it’s not negotiable. It does not make it better or worse, it just makes it yours. And yours will always be different from other languages.&lt;/p&gt;&lt;p&gt;Localization is hard. We have seen that there are many things that can and will go sideways, and there are many unknowns that bubble up to the surface in the process. It can also make a product better, as it stress tests the product’s code and design. A tight relationship between the globalization and Radar teams helped make our efforts go more smoothly. In addition, our translators stepped up to the challenge, familiarizing themselves with Radar, analyzing the English content, finding the right translation that will not only resonate with the audience but also fit in the space allotted, constantly checking for context, previous translations, consistency, industry standards, adapting to style guides, tone, and messaging, and after all of that, ultimately acknowledging the fact that there will be people who will disagree (to varying levels of zeal) with their choice of words.&lt;/p&gt;&lt;p&gt;If you haven’t done so already, we encourage you to explore the localized versions of &lt;a href=\&quot;https://radar.cloudflare.com/\&quot;&gt;Cloudflare Radar&lt;/a&gt;. Click the language drop-down in the upper right corner of the Radar interface and select your language of choice — Radar will be presented in that language until a new selection is made. Have comments or suggestions about the translations? Let us know at radar_localization@cloudflare.com.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-12-16T14:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-12-27T02:23:28.341Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/23W9FGPU51EFRpGuQPbjsB/938a0b6d732350374c6bad7a172992fe/image5.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;5kZtWqjqa7aOUoZr8NFGwI&quot;],&quot;name&quot;:[0,&quot;Radar&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;4Q2EPwJDKGOtxg97VVbme6&quot;],&quot;name&quot;:[0,&quot;Radar Maps&quot;],&quot;slug&quot;:[0,&quot;radar-maps&quot;]}],[0,{&quot;id&quot;:[0,&quot;4Bxs1aM0hus2gdp4Q1U8DZ&quot;],&quot;name&quot;:[0,&quot;Localization&quot;],&quot;slug&quot;:[0,&quot;localization&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Alejandro Diaz-Garcia&quot;],&quot;slug&quot;:[0,&quot;alejandro-diaz-garcia&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7yCRRxIOq9LdBV03Ce5poC/0c392740c5dce324ac922446a9ec0271/unnamed.webp&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;David Fidalgo&quot;],&quot;slug&quot;:[0,&quot;david-fidalgo&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4cLhERyfSM5zX6qvksLZe4/ae2e3e9504b2722d435afa239a9cbe0b/unnamed__1_.webp&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Nuno Pereira&quot;],&quot;slug&quot;:[0,&quot;nuno-pereira&quot;],&quot;bio&quot;:[0,&quot;full-time househusband, cat dad, total weeb. part-time frontend dev. i work as a hobby.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3XV8v72ZJPC16ZrtHYsjaN/c9969e181cfc075b5f1e4653e23299e4/nuno-pereira.png&quot;],&quot;location&quot;:[0,&quot;Lisbon, Portugal&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Internationalization and localization require more than translation: tone, images, date/time and number formatting, among other items, need to be considered. The strong collaboration between the localization and Radar dev teams was key to successfully tailoring content to accommodate regional differences.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Internationalization and localization: bringing Cloudflare Radar to a global audience: Loc&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/cloudflare-radar-localization-journey&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Internationalization and localization: bringing Cloudflare Radar to a global audience&quot;],&quot;description&quot;:[0,&quot;Internationalization and localization require more than translation: tone, images, date/time and number formatting, among other items, need to be considered. The strong collaboration between the localization and Radar dev teams was key to successfully tailoring content to accommodate regional differences.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3KzRfuAuUCXl6WncXAJJwH/32b7fb879a4b4f26414c6714f70a35b9/Internationalization_and_localization-_bringing_Cloudflare_Radar_to_a_global_audience-OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-50-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-100"><a href="/cloudflare-radar-localization-journey/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">Internationalization and localization: bringing Cloudflare Radar to a global audience</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2024-12-16</p><div class=""><a href="/tag/cloudflare-radar/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Radar</a><a href="/tag/javascript/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">JavaScript</a><a href="/tag/radar-maps/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Radar Maps</a><a href="/tag/localization/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Localization</a></div><p class="f3 fw4 gray1 lh-copy " data-testid="post-content">Internationalization and localization require more than translation: tone, images, date/time and number formatting, among other items, need to be considered.<!-- -->...</p><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/alejandro-diaz-garcia/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7yCRRxIOq9LdBV03Ce5poC/0c392740c5dce324ac922446a9ec0271/unnamed.webp" alt="Alejandro Diaz-Garcia" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/alejandro-diaz-garcia/" class="fw4 f3 no-underline black">Alejandro Diaz-Garcia</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/david-fidalgo/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4cLhERyfSM5zX6qvksLZe4/ae2e3e9504b2722d435afa239a9cbe0b/unnamed__1_.webp" alt="David Fidalgo" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/david-fidalgo/" class="fw4 f3 no-underline black">David Fidalgo</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/nuno-pereira/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3XV8v72ZJPC16ZrtHYsjaN/c9969e181cfc075b5f1e4653e23299e4/nuno-pereira.png" alt="Nuno Pereira" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/nuno-pereira/" class="fw4 f3 no-underline black">Nuno Pereira</a></div></li></ul></div></article><!--astro:end--></astro-island> <astro-island uid="Zq09Me" prefix="r5" component-url="/_astro/MorePosts.DyRVOquy.js" component-export="default" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;posts&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;2b8uznXSknoVGwTIcxxmKp&quot;],&quot;title&quot;:[0,&quot;DO it again: how we used Durable Objects to add WebSockets support and authentication to AI Gateway&quot;],&quot;slug&quot;:[0,&quot;do-it-again&quot;],&quot;excerpt&quot;:[0,&quot;We used Cloudflare’s Developer Platform and Durable Objects to build authentication and a WebSockets API that developers can use to call AI Gateway, enabling continuous communication over a single&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;In October 2024, we talked about storing &lt;a href=\&quot;https://blog.cloudflare.com/billions-and-billions-of-logs-scaling-ai-gateway-with-the-cloudflare\&quot;&gt;&lt;u&gt;billions of logs&lt;/u&gt;&lt;/a&gt; from your AI application using AI Gateway, and how we used Cloudflare’s Developer Platform to do this. &lt;/p&gt;&lt;p&gt;With AI Gateway already processing over 3 billion logs and experiencing rapid growth, the number of connections to the platform continues to increase steadily. To help developers manage this scale more effectively, we wanted to offer an alternative to implementing HTTP/2 keep-alive to maintain persistent HTTP(S) connections, thereby avoiding the overhead of repeated handshakes and &lt;a href=\&quot;https://www.cloudflare.com/en-gb/learning/ssl/what-happens-in-a-tls-handshake/\&quot;&gt;&lt;u&gt;TLS negotiations&lt;/u&gt;&lt;/a&gt; with each new HTTP connection to AI Gateway. We understand that implementing HTTP/2 can present challenges, particularly when many libraries and tools may not support it by default and most modern programming languages have well-established WebSocket libraries available.&lt;/p&gt;&lt;p&gt;With this in mind, we used Cloudflare’s Developer Platform and Durable Objects (yes, again!) to build a &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/websockets/\&quot;&gt;&lt;u&gt;WebSockets API&lt;/u&gt;&lt;/a&gt; that establishes a single, persistent connection, enabling continuous communication. &lt;/p&gt;&lt;p&gt;Through this API, all AI providers supported by AI Gateway can be accessed via WebSocket, allowing you to maintain a single TCP connection between your client or server application and the AI Gateway. The best part? Even if your chosen provider doesn’t support WebSockets, we handle it for you, managing the requests to your preferred AI provider.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/20z8XfL3pJ78z1Y0Yp7JNO/0b8607702a25ede4268009f124278985/unnamed.png\&quot; alt=\&quot;BLOG-2617 2\&quot; class=\&quot;kg-image\&quot; width=\&quot;1290\&quot; height=\&quot;516\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;By connecting via WebSocket to AI Gateway, we make the requests to the inference service for you using the provider’s supported protocols (HTTPS, WebSocket, etc.), and you can keep the connection open to execute as many inference requests as you would like. &lt;/p&gt;&lt;p&gt;To make your connection to AI Gateway more secure, we are also introducing authentication for AI Gateway. The new WebSockets API will require authentication. All you need to do is &lt;a href=\&quot;https://developers.cloudflare.com/fundamentals/api/get-started/create-token/#_top\&quot;&gt;&lt;u&gt;create a Cloudflare API token&lt;/u&gt;&lt;/a&gt; with the permission “AI Gateway: Run” and send that in the &lt;code&gt;cf-aig-authorization&lt;/code&gt; header.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2NqmYZX8NdnrTUBHkQiLA1/4bda8a44aa225c7ff440686dd3046a5a/image4.png\&quot; alt=\&quot;BLOG-2617 3\&quot; class=\&quot;kg-image\&quot; width=\&quot;1344\&quot; height=\&quot;516\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In the flow diagram above:&lt;/p&gt;&lt;p&gt;1️⃣ When Authenticated Gateway is enabled and a valid token is included, requests will pass successfully.&lt;/p&gt;&lt;p&gt;2️⃣ If Authenticated Gateway is enabled, but a request does not contain the required &lt;code&gt;cf-aig-authorization&lt;/code&gt; header with a valid token, the request will fail. This ensures only verified requests pass through the gateway. &lt;/p&gt;&lt;p&gt;3️⃣ When Authenticated Gateway is disabled, the &lt;code&gt;cf-aig-authorization&lt;/code&gt; header is bypassed entirely, and any token — whether valid or invalid — is ignored.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;how-we-built-it\&quot;&gt;How we built it&lt;/h2&gt;\n            &lt;a href=\&quot;#how-we-built-it\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;We recently used Durable Objects (DOs) to scale our logging solution for AI Gateway, so using WebSockets within the same DOs was a natural fit.&lt;/p&gt;&lt;p&gt;When a new WebSocket connection is received by our Cloudflare Workers, we implement authentication in two ways to support the diverse capabilities of WebSocket clients. The primary method involves validating a Cloudflare API token through the &lt;code&gt;cf-aig-authorization&lt;/code&gt; header, ensuring the token is valid for the connecting account and gateway. &lt;/p&gt;&lt;p&gt;However, due to limitations in browser WebSocket implementations, we also support authentication via the “sec-websocket-protocol” header. Browser WebSocket clients don&amp;#39;t allow for custom headers in their standard API, complicating the addition of authentication tokens in requests. While we don’t recommend that you store API keys in a browser, we decided to add this method to add more flexibility to all WebSocket clients.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// Built-in WebSocket client in browsers\nconst socket = new WebSocket(&amp;quot;wss://gateway.ai.cloudflare.com/v1/my-account-id/my-gateway/&amp;quot;, [\n   &amp;quot;cf-aig-authorization.${AI_GATEWAY_TOKEN}&amp;quot;\n]);\n\n\n// ws npm package\nimport WebSocket from &amp;quot;ws&amp;quot;;\nconst ws = new WebSocket(&amp;quot;wss://gateway.ai.cloudflare.com/v1/my-account-id/my-gateway/&amp;quot;,{\n   headers: {\n       &amp;quot;cf-aig-authorization&amp;quot;: &amp;quot;Bearer AI_GATEWAY_TOKEN&amp;quot;,\n   },\n});\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;After this initial verification step, we upgrade the connection to the Durable Object, meaning that it will now handle all the messages for the connection. Before the new connection is fully accepted, we generate a random UUID, so this connection is identifiable among all the messages received by the Durable Object. During an open connection, any AI Gateway settings passed via headers — such as &lt;code&gt;cf-aig-skip-cache&lt;/code&gt; (&lt;a href=\&quot;https://developers.cloudflare.com/ai-gateway/configuration/caching/#skip-cache-cf-skip-cache\&quot;&gt;&lt;u&gt;which bypasses caching when set to true&lt;/u&gt;&lt;/a&gt;) — are stored and applied to all requests in the session. However, these headers can still be overridden on a per-request basis, just like with the &lt;a href=\&quot;https://developers.cloudflare.com/ai-gateway/providers/universal/\&quot;&gt;&lt;u&gt;Universal Endpoint&lt;/u&gt;&lt;/a&gt; today.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;how-it-works\&quot;&gt;How it works&lt;/h2&gt;\n            &lt;a href=\&quot;#how-it-works\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Once the connection is established, the Durable Object begins listening for incoming messages. From this point on, users can send messages in the AI Gateway universal format via WebSocket, simplifying the transition of your application from an existing HTTP setup to WebSockets-based communication.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import WebSocket from &amp;quot;ws&amp;quot;;\nconst ws = new WebSocket(&amp;quot;wss://gateway.ai.cloudflare.com/v1/my-account-id/my-gateway/&amp;quot;,{\n   headers: {\n       &amp;quot;cf-aig-authorization&amp;quot;: &amp;quot;Bearer AI_GATEWAY_TOKEN&amp;quot;,\n   },\n});\n\nws.send(JSON.stringify({\n   type: &amp;quot;universal.create&amp;quot;,\n   request: {\n      &amp;quot;eventId&amp;quot;: &amp;quot;my-request&amp;quot;,\n      &amp;quot;provider&amp;quot;: &amp;quot;workers-ai&amp;quot;,\n      &amp;quot;endpoint&amp;quot;: &amp;quot;@cf/meta/llama-3.1-8b-instruct&amp;quot;,\n      &amp;quot;headers&amp;quot;: {\n         &amp;quot;Authorization&amp;quot;: &amp;quot;Bearer WORKERS_AI_TOKEN&amp;quot;,\n         &amp;quot;Content-Type&amp;quot;: &amp;quot;application/json&amp;quot;\n      },\n      &amp;quot;query&amp;quot;: {\n         &amp;quot;prompt&amp;quot;: &amp;quot;tell me a joke&amp;quot;\n      }\n   }\n}));\n\nws.on(&amp;quot;message&amp;quot;, function incoming(message) {\n   console.log(message.toString())\n});\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;When a new message reaches the Durable Object, it’s processed using the same code that powers the HTTP Universal Endpoint, enabling seamless code reuse across Workers and Durable Objects — one of the key benefits of building on Cloudflare.&lt;/p&gt;&lt;p&gt;For non-streaming requests, the response is wrapped in a JSON envelope, allowing us to include additional information beyond the AI inference itself, such as the AI Gateway log ID for that request.&lt;/p&gt;&lt;p&gt;Here’s an example response for the request above:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;{\n  &amp;quot;type&amp;quot;:&amp;quot;universal.created&amp;quot;,\n  &amp;quot;metadata&amp;quot;:{\n     &amp;quot;cacheStatus&amp;quot;:&amp;quot;MISS&amp;quot;,\n     &amp;quot;eventId&amp;quot;:&amp;quot;my-request&amp;quot;,\n     &amp;quot;logId&amp;quot;:&amp;quot;01JC3R94FRD97JBCBX3S0ZAXKW&amp;quot;,\n     &amp;quot;step&amp;quot;:&amp;quot;0&amp;quot;,\n     &amp;quot;contentType&amp;quot;:&amp;quot;application/json&amp;quot;\n  },\n  &amp;quot;response&amp;quot;:{\n     &amp;quot;result&amp;quot;:{\n        &amp;quot;response&amp;quot;:&amp;quot;Why was the math book sad? Because it had too many problems. Would you like to hear another one?&amp;quot;\n     },\n     &amp;quot;success&amp;quot;:true,\n     &amp;quot;errors&amp;quot;:[],\n     &amp;quot;messages&amp;quot;:[]\n  }\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;For streaming requests, AI Gateway sends an initial message with request metadata telling the developer the stream is starting.&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;{\n  &amp;quot;type&amp;quot;:&amp;quot;universal.created&amp;quot;,\n  &amp;quot;metadata&amp;quot;:{\n     &amp;quot;cacheStatus&amp;quot;:&amp;quot;MISS&amp;quot;,\n     &amp;quot;eventId&amp;quot;:&amp;quot;my-request&amp;quot;,\n     &amp;quot;logId&amp;quot;:&amp;quot;01JC40RB3NGBE5XFRZGBN07572&amp;quot;,\n     &amp;quot;step&amp;quot;:&amp;quot;0&amp;quot;,\n     &amp;quot;contentType&amp;quot;:&amp;quot;text/event-stream&amp;quot;\n  }\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;After this initial message, all streaming chunks are relayed in real-time to the WebSocket connection as they arrive from the inference provider. Note that only the &lt;code&gt;eventId&lt;/code&gt; field is included in the metadata for these streaming chunks (more info on what this new field is below).&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;{\n  &amp;quot;type&amp;quot;:&amp;quot;universal.stream&amp;quot;,\n  &amp;quot;metadata&amp;quot;:{\n     &amp;quot;eventId&amp;quot;:&amp;quot;my-request&amp;quot;,\n  }\n  &amp;quot;response&amp;quot;:{\n     &amp;quot;response&amp;quot;:&amp;quot;would&amp;quot;\n  }\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This approach serves two purposes: first, all request metadata is already provided in the initial message. Second, it addresses the concurrency challenge of handling multiple streaming requests simultaneously.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;handling-asynchronous-events\&quot;&gt;Handling asynchronous events&lt;/h2&gt;\n            &lt;a href=\&quot;#handling-asynchronous-events\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;With WebSocket connections, client and server can send messages asynchronously at any time. This means the client doesn’t need to wait for a server response before sending another message. But what happens if a client sends multiple streaming inference requests immediately after the WebSocket connection opens?&lt;/p&gt;&lt;p&gt;In this case, the server streams all the inference responses simultaneously to the client. Since everything occurs asynchronously, the client has no built-in way to identify which response corresponds to each request.&lt;/p&gt;&lt;p&gt;To address this, we introduced a new field in the Universal format called &lt;code&gt;eventId&lt;/code&gt;, which allows AI Gateway to include a client-defined ID with each message, even in a streaming WebSocket environment.&lt;/p&gt;&lt;p&gt;So, to fully answer the question above: the server streams both responses in parallel chunks, and the client can accurately identify which request each message belongs to based on the &lt;code&gt;eventId&lt;/code&gt;.&lt;/p&gt;&lt;div style=\&quot;position: relative; padding-top: 64.46945337620579%;\&quot;&gt;\n  &lt;iframe\n    src=\&quot;https://customer-eq7kiuol0tk9chox.cloudflarestream.com/324e09febc0e82cc472df27994001319/iframe?preload=true&amp;poster=https%3A%2F%2Fcustomer-eq7kiuol0tk9chox.cloudflarestream.com%2F324e09febc0e82cc472df27994001319%2Fthumbnails%2Fthumbnail.jpg%3Ftime%3D%26height%3D600&amp;title=How+we+used+Durable+Objects+to+add+WebSockets+support+and+authentication+to+AI+Gateway\&quot;\n    loading=\&quot;lazy\&quot;\n    style=\&quot;border: none; position: absolute; top: 0; left: 0; height: 100%; width: 100%;\&quot;\n    allow=\&quot;accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;\&quot;\n    allowfullscreen=\&quot;true\&quot;\n  &gt;&lt;/iframe&gt;\n&lt;/div&gt;&lt;p&gt;Once all chunks for a request have been streamed, AI Gateway sends a final message to signal the request’s completion. For added flexibility, this message includes all the metadata again, even though it was also provided at the start of the streaming process.&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;{\n  &amp;quot;type&amp;quot;:&amp;quot;universal.done&amp;quot;,\n  &amp;quot;metadata&amp;quot;:{\n     &amp;quot;cacheStatus&amp;quot;:&amp;quot;MISS&amp;quot;,\n     &amp;quot;eventId&amp;quot;:&amp;quot;my-request&amp;quot;,\n     &amp;quot;logId&amp;quot;:&amp;quot;01JC40RB3NGBE5XFRZGBN07572&amp;quot;,\n     &amp;quot;step&amp;quot;:&amp;quot;0&amp;quot;,\n     &amp;quot;contentType&amp;quot;:&amp;quot;text/event-stream&amp;quot;\n  }\n}\n&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;try-it-out-today\&quot;&gt;Try it out today&lt;/h2&gt;\n            &lt;a href=\&quot;#try-it-out-today\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;AI Gateway’s real-time Websocket API is now in beta and open to everyone!&lt;/p&gt;&lt;p&gt;To try it out, copy your gateway universal endpoint URL, and replace the “https://” with “wss://”, like this: &lt;/p&gt;&lt;p&gt;&lt;code&gt;wss://gateway.ai.cloudflare.com/v1/my-account-id/my-gateway/&lt;/code&gt;&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5qbWGSAjCj8GjKmY8Zyvld/1bf36332de118857e3d24baea0c2ffc9/BLOG-2617_4.png\&quot; alt=\&quot;BLOG-2617 4\&quot; class=\&quot;kg-image\&quot; width=\&quot;1778\&quot; height=\&quot;1642\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Then open a WebSocket connection using your Universal Endpoint, and guarantee that it is authenticated with a Cloudflare token with the AI Gateway &lt;i&gt;Run&lt;/i&gt; permission.&lt;/p&gt;&lt;p&gt;Here’s an example code using the &lt;a href=\&quot;https://www.npmjs.com/package/ws\&quot;&gt;&lt;u&gt;ws npm package&lt;/u&gt;&lt;/a&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import WebSocket from &amp;quot;ws&amp;quot;;\nconst ws = new WebSocket(&amp;quot;wss://gateway.ai.cloudflare.com/v1/my-account-id/my-gateway/&amp;quot;, {\n   headers: {\n       &amp;quot;cf-aig-authorization&amp;quot;: &amp;quot;Bearer AI_GATEWAY_TOKEN&amp;quot;,\n   },\n});\n\nws.on(&amp;quot;open&amp;quot;, function open() {\n   console.log(&amp;quot;Connected to server.&amp;quot;);\n   ws.send(JSON.stringify({\n      type: &amp;quot;universal.create&amp;quot;,\n      request: {\n         &amp;quot;provider&amp;quot;: &amp;quot;workers-ai&amp;quot;,\n         &amp;quot;endpoint&amp;quot;: &amp;quot;@cf/meta/llama-3.1-8b-instruct&amp;quot;,\n         &amp;quot;headers&amp;quot;: {\n            &amp;quot;Authorization&amp;quot;: &amp;quot;Bearer WORKERS_AI_TOKEN&amp;quot;,\n            &amp;quot;Content-Type&amp;quot;: &amp;quot;application/json&amp;quot;\n         },\n         &amp;quot;query&amp;quot;: {\n            &amp;quot;stream&amp;quot;: true,\n            &amp;quot;prompt&amp;quot;: &amp;quot;tell me a joke&amp;quot;\n         }\n      }\n   }));\n});\n\n\nws.on(&amp;quot;message&amp;quot;, function incoming(message) {\n   console.log(message.toString())\n});\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Here’s an example code using the built-in browser WebSocket client:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;const socket = new WebSocket(&amp;quot;wss://gateway.ai.cloudflare.com/v1/my-account-id/my-gateway/&amp;quot;, [\n   &amp;quot;cf-aig-authorization.${AI_GATEWAY_TOKEN}&amp;quot;\n]);\n\nsocket.addEventListener(&amp;quot;open&amp;quot;, (event) =&amp;gt; {\n  console.log(&amp;quot;Connected to server.&amp;quot;);\n   socket.send(JSON.stringify({\n      type: &amp;quot;universal.create&amp;quot;,\n      request: {\n         &amp;quot;provider&amp;quot;: &amp;quot;workers-ai&amp;quot;,\n         &amp;quot;endpoint&amp;quot;: &amp;quot;@cf/meta/llama-3.1-8b-instruct&amp;quot;,\n         &amp;quot;headers&amp;quot;: {\n            &amp;quot;Authorization&amp;quot;: &amp;quot;Bearer WORKERS_AI_TOKEN&amp;quot;,\n            &amp;quot;Content-Type&amp;quot;: &amp;quot;application/json&amp;quot;\n         },\n         &amp;quot;query&amp;quot;: {\n            &amp;quot;stream&amp;quot;: true,\n            &amp;quot;prompt&amp;quot;: &amp;quot;tell me a joke&amp;quot;\n         }\n      }\n   }));\n});\n\nsocket.addEventListener(&amp;quot;message&amp;quot;, (event) =&amp;gt; {\n  console.log(event.data);\n});\n&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;and-we-will-do-it-again\&quot;&gt;And we will DO it again&lt;/h3&gt;\n            &lt;a href=\&quot;#and-we-will-do-it-again\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In Q1 2025, we plan to support WebSocket-to-WebSocket connections (using DOs), allowing you to connect to OpenAI&amp;#39;s new real-time API directly through our platform. In the meantime, you can deploy &lt;a href=\&quot;https://github.com/cloudflare/openai-workers-relay\&quot;&gt;&lt;u&gt;this Worker&lt;/u&gt;&lt;/a&gt; in your account to proxy the requests yourself.&lt;/p&gt;&lt;p&gt;If you have any questions, reach out on our &lt;a href=\&quot;http://discord.cloudflare.com/\&quot;&gt;&lt;u&gt;Discord channel&lt;/u&gt;&lt;/a&gt;. We’re also hiring for AI Gateway, check out &lt;a href=\&quot;https://www.cloudflare.com/en-gb/careers/jobs/?department=Emerging+Technology+and+Incubation&amp;location=Lisbon%2C+Portugal\&quot;&gt;&lt;u&gt;Cloudflare Jobs in Lisbon&lt;/u&gt;&lt;/a&gt;!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-11-19T14:00-08:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-12-12T00:01:04.316Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7pWrV3fofHKlFNRux72rdY/37e923b4a6668480d42086e81fccb266/BLOG-2617_1.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;1GyUhE8o287lrdNSpdRUIe&quot;],&quot;name&quot;:[0,&quot;AI Gateway&quot;],&quot;slug&quot;:[0,&quot;ai-gateway&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Catarina Pires Mota&quot;],&quot;slug&quot;:[0,&quot;catarina-pires-mota&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1YWsahYr40z3FhQwupqAlX/a106b6fd29b4862193399b15022f45b3/_tmp_mini_magick20220926-42-fogz3a.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Gabriel Massadas&quot;],&quot;slug&quot;:[0,&quot;gabriel-massadas&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7oQXIEt6Jo1bGVuttPgl46/1c53697f20dec595f4a3f6a13303ff8c/gabriel-massadas.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;We used Cloudflare’s Developer Platform and Durable Objects to build authentication and a WebSockets API that developers can use to call AI Gateway, enabling continuous communication over a single, persistent connection.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/do-it-again&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;DO it again: how we used Durable Objects to add WebSockets support and authentication to AI Gateway&quot;],&quot;description&quot;:[0,&quot;We used Cloudflare’s Developer Platform and Durable Objects to build authentication and a WebSockets API that developers can use to call AI Gateway, enabling continuous communication over a single, persistent connection.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6WRhvjGNDm8Cg8UqbaDSxh/a67f73081c4788250d2d09d870319e78/DO_it_again-_how_we_used_Durable_Objects_to_add_WebSockets_support_and_authentication_to_AI_Gateway-OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;3zICVbgdxrLByG4g2Dsddy&quot;],&quot;title&quot;:[0,&quot;More NPM packages on Cloudflare Workers: Combining polyfills and native code to support Node.js APIs&quot;],&quot;slug&quot;:[0,&quot;more-npm-packages-on-cloudflare-workers-combining-polyfills-and-native-code&quot;],&quot;excerpt&quot;:[0,&quot;Workers now supports more NPM packages and Node.js APIs using an overhauled hybrid compatibility layer.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;/p&gt;&lt;p&gt;Today, we are excited to announce a preview of &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/\&quot;&gt;&lt;u&gt;improved Node.js compatibility&lt;/u&gt;&lt;/a&gt; for Workers and Pages. Broader compatibility lets you use more NPM packages and take advantage of the JavaScript ecosystem when writing your Workers.&lt;/p&gt;&lt;p&gt;Our newest version of Node.js compatibility combines the best features of our previous efforts. &lt;a href=\&quot;https://workers.cloudflare.com/\&quot;&gt;&lt;u&gt;Cloudflare Workers&lt;/u&gt;&lt;/a&gt; have supported Node.js in some form for quite a while. We first announced polyfill support in &lt;a href=\&quot;https://blog.cloudflare.com/node-js-support-cloudflare-workers\&quot;&gt;&lt;u&gt;2021&lt;/u&gt;&lt;/a&gt;, and later &lt;a href=\&quot;https://blog.cloudflare.com/workers-node-js-asynclocalstorage\&quot;&gt;&lt;u&gt;built-in support for parts of the Node.js API&lt;/u&gt;&lt;/a&gt; that has &lt;a href=\&quot;https://blog.cloudflare.com/workers-node-js-apis-stream-path\&quot;&gt;&lt;u&gt;expanded&lt;/u&gt;&lt;/a&gt; over time.&lt;/p&gt;&lt;p&gt;The latest changes make it even better:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;You can use far more &lt;a href=\&quot;https://en.wikipedia.org/wiki/Npm\&quot;&gt;&lt;u&gt;NPM&lt;/u&gt;&lt;/a&gt; packages on Workers.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;You can use packages that do not use the &lt;code&gt;node&lt;/code&gt;: prefix to import Node.js APIs&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;You can use &lt;a href=\&quot;https://workers-nodejs-compat-matrix.pages.dev/\&quot;&gt;&lt;u&gt;more Node.js APIs on Workers&lt;/u&gt;&lt;/a&gt;, including most methods on &lt;a href=\&quot;https://nodejs.org/docs/latest/api/async_hooks.html\&quot;&gt;&lt;code&gt;&lt;u&gt;async_hooks&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;, &lt;a href=\&quot;https://nodejs.org/api/buffer.html\&quot;&gt;&lt;code&gt;&lt;u&gt;buffer&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;, &lt;a href=\&quot;https://nodejs.org/api/dns.html\&quot;&gt;&lt;code&gt;&lt;u&gt;dns&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;, &lt;a href=\&quot;https://nodejs.org/docs/latest/api/os.html\&quot;&gt;&lt;code&gt;&lt;u&gt;os&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;, and &lt;a href=\&quot;https://nodejs.org/docs/latest/api/events.html\&quot;&gt;&lt;code&gt;&lt;u&gt;events&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;. Many more, such as &lt;a href=\&quot;https://nodejs.org/api/fs.html\&quot;&gt;&lt;code&gt;&lt;u&gt;fs&lt;/u&gt;&lt;/code&gt;&lt;/a&gt; or &lt;a href=\&quot;https://nodejs.org/docs/latest/api/process.html\&quot;&gt;&lt;code&gt;&lt;u&gt;process&lt;/u&gt;&lt;/code&gt;&lt;/a&gt; are importable with mocked methods.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;To give it a try, add the following flag to &lt;code&gt;wrangler.toml&lt;/code&gt;, and deploy your Worker with &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/\&quot;&gt;&lt;u&gt;Wrangler&lt;/u&gt;&lt;/a&gt;:&lt;/p&gt;&lt;p&gt;&lt;code&gt;compatibility_flags = [&amp;quot;nodejs_compat_v2&amp;quot;]&lt;/code&gt;&lt;/p&gt;&lt;p&gt;Packages that could not be imported with &lt;code&gt;nodejs_compat&lt;/code&gt;, even as a dependency of another package, will now load. This includes popular packages such as &lt;a href=\&quot;https://www.npmjs.com/package/body-parser\&quot;&gt;body-parser&lt;/a&gt;, &lt;a href=\&quot;https://www.npmjs.com/package/jsonwebtoken\&quot;&gt;jsonwebtoken&lt;/a&gt;, {}&lt;a href=\&quot;https://www.npmjs.com/package/got\&quot;&gt;got&lt;/a&gt;, &lt;a href=\&quot;https://www.npmjs.com/package/passport\&quot;&gt;passport&lt;/a&gt;, &lt;a href=\&quot;https://www.npmjs.com/package/md5\&quot;&gt;md5&lt;/a&gt;, &lt;a href=\&quot;https://www.npmjs.com/package/knex\&quot;&gt;knex&lt;/a&gt;, &lt;a href=\&quot;https://www.npmjs.com/package/mailparser\&quot;&gt;mailparser&lt;/a&gt;, &lt;a href=\&quot;https://www.npmjs.com/package/csv-stringify\&quot;&gt;csv-stringify&lt;/a&gt;, &lt;a href=\&quot;https://www.npmjs.com/package/cookie-signature\&quot;&gt;cookie-signature&lt;/a&gt;, &lt;a href=\&quot;https://www.npmjs.com/package/stream-slice\&quot;&gt;stream-slice&lt;/a&gt;, and many more.&lt;/p&gt;&lt;p&gt;This behavior will soon become the default for all Workers with the &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/\&quot;&gt;&lt;u&gt;existing nodejs_compat compatibility flag&lt;/u&gt;&lt;/a&gt; enabled, and a &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/compatibility-dates/\&quot;&gt;&lt;u&gt;compatibility date&lt;/u&gt;&lt;/a&gt; of 2024-09-23 or later. As you experiment with improved Node.js compatibility, share your feedback by &lt;a href=\&quot;https://github.com/cloudflare/workers-sdk/issues/new?assignees=&amp;labels=bug&amp;projects=&amp;template=bug-template.yaml&amp;title=%F0%9F%90%9B+BUG%3A\&quot;&gt;&lt;u&gt;opening an issue on GitHub&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;workerd-is-not-node-js\&quot;&gt;Workerd is not Node.js&lt;/h3&gt;\n            &lt;a href=\&quot;#workerd-is-not-node-js\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;To understand the latest changes, let’s start with a brief overview of how the Workers runtime differs from &lt;a href=\&quot;https://nodejs.org/\&quot;&gt;&lt;u&gt;Node.js&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Node.js was built primarily for services run directly on a host OS and pioneered server-side JavaScript. Because of this, it includes functionality necessary to interact with the host machine, such as &lt;a href=\&quot;https://nodejs.org/api/process.html\&quot;&gt;&lt;u&gt;process&lt;/u&gt;&lt;/a&gt; or &lt;a href=\&quot;https://nodejs.org/api/fs.html\&quot;&gt;&lt;u&gt;fs&lt;/u&gt;&lt;/a&gt;, and a variety of utility modules, such as &lt;a href=\&quot;https://nodejs.org/api/crypto.html\&quot;&gt;&lt;u&gt;crypto&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Cloudflare Workers run on an open source JavaScript/Wasm runtime called &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;&lt;u&gt;workerd&lt;/u&gt;&lt;/a&gt;. While both Node.js and workerd are built on &lt;a href=\&quot;https://v8.dev/\&quot;&gt;&lt;u&gt;V8&lt;/u&gt;&lt;/a&gt;, workerd is &lt;a href=\&quot;https://blog.cloudflare.com/cloud-computing-without-containers\&quot;&gt;&lt;u&gt;designed to run untrusted code in shared processes&lt;/u&gt;&lt;/a&gt;, exposes &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/bindings/\&quot;&gt;&lt;u&gt;bindings&lt;/u&gt;&lt;/a&gt; for interoperability with other Cloudflare services, including &lt;a href=\&quot;https://blog.cloudflare.com/javascript-native-rpc\&quot;&gt;&lt;u&gt;JavaScript-native RPC&lt;/u&gt;&lt;/a&gt;, and uses &lt;a href=\&quot;https://blog.cloudflare.com/introducing-the-wintercg\&quot;&gt;&lt;u&gt;web-standard APIs&lt;/u&gt;&lt;/a&gt; whenever possible.&lt;/p&gt;&lt;p&gt;Cloudflare &lt;a href=\&quot;https://blog.cloudflare.com/introducing-the-wintercg/\&quot;&gt;&lt;u&gt;helped establish&lt;/u&gt;&lt;/a&gt; &lt;a href=\&quot;https://wintercg.org/\&quot;&gt;&lt;u&gt;WinterCG&lt;/u&gt;&lt;/a&gt;, the Web-interoperable Runtimes Community Group to improve interoperability of JavaScript runtimes, both with each other and with the web platform. You can build many applications using only web-standard APIs, but what about when you want to import dependencies from NPM that rely on Node.js APIs?&lt;/p&gt;&lt;p&gt;For example, if you attempt to import &lt;a href=\&quot;https://www.npmjs.com/package/pg\&quot;&gt;&lt;u&gt;pg&lt;/u&gt;&lt;/a&gt;, a PostgreSQL driver, without Node.js compatibility turned on…&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import pg from &amp;#039;pg&amp;#039;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You will see the following error when you run &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/commands/#dev\&quot;&gt;&lt;u&gt;wrangler dev&lt;/u&gt;&lt;/a&gt; to build your Worker:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;✘ [ERROR] Could not resolve &amp;quot;events&amp;quot;\n    ../node_modules/.pnpm/pg-cloudflare@1.1.1/node_modules/pg-cloudflare/dist/index.js:1:29:\n      1 │ import { EventEmitter } from &amp;#039;events&amp;#039;;\n        ╵                              ~~~~~~~~\n  The package &amp;quot;events&amp;quot; wasn&amp;#039;t found on the file system but is built into node.&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This happens because the pg package imports the &lt;a href=\&quot;https://nodejs.org/api/events.html\&quot;&gt;&lt;u&gt;events module&lt;/u&gt;&lt;/a&gt; from Node.js, which is not provided by workerd by default.&lt;/p&gt;&lt;p&gt;How can we enable this?&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;our-first-approach-build-time-polyfills\&quot;&gt;Our first approach – build-time polyfills&lt;/h3&gt;\n            &lt;a href=\&quot;#our-first-approach-build-time-polyfills\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Polyfills are code that add functionality to a runtime that does not natively support it. They are often added to provide modern JavaScript functionality to older browsers, but can be used for server-side runtimes as well.&lt;/p&gt;&lt;p&gt;In 2022, we &lt;a href=\&quot;https://github.com/cloudflare/workers-sdk/pull/869\&quot;&gt;&lt;u&gt;added functionality to Wrangler&lt;/u&gt;&lt;/a&gt; that injected polyfill implementations of some Node.js APIs into your Worker if you set &lt;code&gt;node_compat = true&lt;/code&gt; in your wrangler.toml. For instance, the following code would work with this flag, but not without:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import EventEmitter from &amp;#039;events&amp;#039;;\nimport { inherits } from &amp;#039;util&amp;#039;;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;These polyfills are essentially just additional JavaScript code added to your Worker by &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/\&quot;&gt;&lt;u&gt;Wrangler&lt;/u&gt;&lt;/a&gt; when deploying the Worker. This behavior is enabled by &lt;a href=\&quot;https://www.npmjs.com/package/@esbuild-plugins/node-globals-polyfill\&quot;&gt;&lt;code&gt;&lt;u&gt;@esbuild-plugins/node-globals-polyfill&lt;/u&gt;&lt;/code&gt;&lt;/a&gt; which in itself uses &lt;a href=\&quot;https://github.com/ionic-team/rollup-plugin-node-polyfills/\&quot;&gt;&lt;code&gt;&lt;u&gt;rollup-plugin-node-polyfills&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;This allows you to import and use some NPM packages, such as pg. However, many modules cannot be polyfilled with fast enough code or cannot be polyfilled at all.&lt;/p&gt;&lt;p&gt;For instance, &lt;a href=\&quot;https://nodejs.org/api/buffer.html\&quot;&gt;&lt;u&gt;Buffer&lt;/u&gt;&lt;/a&gt; is a common Node.js API used to handle binary data. Polyfills exist for it, but JavaScript is often not optimized for the operations it performs under the hood, such as &lt;code&gt;copy&lt;/code&gt;, &lt;code&gt;concat&lt;/code&gt;, substring searches, or transcoding. While it is possible to implement in pure JavaScript, it could be far faster if the underlying runtime could use primitives from different languages. Similar limitations exist for other popular APIs such as &lt;a href=\&quot;https://nodejs.org/api/crypto.html\&quot;&gt;&lt;u&gt;Crypto&lt;/u&gt;&lt;/a&gt;, &lt;a href=\&quot;https://nodejs.org/api/async_context.html\&quot;&gt;&lt;u&gt;AsyncLocalStorage&lt;/u&gt;&lt;/a&gt;, and &lt;a href=\&quot;https://nodejs.org/api/stream.html\&quot;&gt;&lt;u&gt;Stream&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;our-second-approach-native-support-for-some-node-js-apis-in-the-workers-runtime\&quot;&gt;Our second approach – native support for some Node.js APIs in the Workers runtime&lt;/h3&gt;\n            &lt;a href=\&quot;#our-second-approach-native-support-for-some-node-js-apis-in-the-workers-runtime\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In 2023, we &lt;a href=\&quot;https://blog.cloudflare.com/workers-node-js-asynclocalstorage\&quot;&gt;&lt;u&gt;started adding&lt;/u&gt;&lt;/a&gt; a subset of Node.js APIs directly to the Workers runtime. You can enable these APIs by adding the &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/\&quot;&gt;&lt;u&gt;nodejs_compat compatibility flag&lt;/u&gt;&lt;/a&gt; to your Worker, but you cannot use polyfills with &lt;code&gt;node_compat = true&lt;/code&gt; at the same time.&lt;/p&gt;&lt;p&gt;Also, when importing Node.js APIs, you must use the &lt;code&gt;node&lt;/code&gt;: prefix:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { Buffer } from &amp;#039;node:buffer&amp;#039;;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Since these Node.js APIs are built directly into the Workers runtime, they can be &lt;a href=\&quot;https://github.com/cloudflare/workerd/blob/main/src/workerd/api/node/buffer.c%2B%2B\&quot;&gt;&lt;u&gt;written in C++&lt;/u&gt;&lt;/a&gt;, which allows them to be faster than JavaScript polyfills. APIs like &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/asynclocalstorage/\&quot;&gt;&lt;u&gt;AsyncLocalStorage&lt;/u&gt;&lt;/a&gt;, which cannot be polyfilled without safety or performance issues, can be provided natively.&lt;/p&gt;&lt;p&gt;Requiring the &lt;code&gt;node: &lt;/code&gt;prefix made imports more explicit and aligns with modern Node.js conventions. Unfortunately, existing NPM packages may import modules without &lt;code&gt;node:&lt;/code&gt;. For instance, revisiting the example above, if you import the popular package &lt;code&gt;pg&lt;/code&gt; in a Worker with the &lt;code&gt;nodejs_compat&lt;/code&gt; flag, you still see the following error:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;✘ [ERROR] Could not resolve &amp;quot;events&amp;quot;\n    ../node_modules/.pnpm/pg-cloudflare@1.1.1/node_modules/pg-cloudflare/dist/index.js:1:29:\n      1 │ import { EventEmitter } from &amp;#039;events&amp;#039;;\n        ╵                              ~~~~~~~~\n  The package &amp;quot;events&amp;quot; wasn&amp;#039;t found on the file system but is built into node.&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Many NPM packages still didn’t work in Workers, even if you enabled the &lt;code&gt;nodejs_compat&lt;/code&gt; compatibility flag. You had to choose between a smaller set of performant APIs, exposed in a way that many NPM packages couldn’t access, or a larger set of incomplete and less performant APIs. And APIs like &lt;code&gt;process&lt;/code&gt; that are exposed as globals in Node.js could still only be accessed by importing them as modules.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-new-approach-a-hybrid-model\&quot;&gt;The new approach: a hybrid model&lt;/h3&gt;\n            &lt;a href=\&quot;#the-new-approach-a-hybrid-model\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;What if we could have the best of both worlds, and it just worked?&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;A subset of Node.js APIs implemented directly in the Workers Runtime &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Polyfills for the majority of other Node.js APIs&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;No &lt;code&gt;node&lt;/code&gt;: prefix required&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;One simple way to opt-in&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Improved Node.js compatibility does just that.&lt;/p&gt;&lt;p&gt;Let’s take a look at two lines of code that look similar, but now act differently under the hood when &lt;code&gt;nodejs_compat_v2&lt;/code&gt; is enabled:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { Buffer } from &amp;#039;buffer&amp;#039;;  // natively implemented\nimport { isIP } from &amp;#039;net&amp;#039;; // polyfilled&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The first line imports &lt;code&gt;Buffer&lt;/code&gt; from a &lt;a href=\&quot;https://github.com/cloudflare/workerd/blob/main/src/node/internal/internal_buffer.ts\&quot;&gt;&lt;u&gt;JavaScript module&lt;/u&gt;&lt;/a&gt; in workerd that is backed by &lt;a href=\&quot;https://github.com/cloudflare/workerd/blob/main/src/workerd/api/node/buffer.c%2B%2B\&quot;&gt;&lt;code&gt;&lt;u&gt;C++ code&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;. Various other Node.js modules are similarly implemented in a combination of Typescript and C++, including &lt;a href=\&quot;https://github.com/cloudflare/workerd/blob/main/src/workerd/api/node/async-hooks.h\&quot;&gt;&lt;code&gt;&lt;u&gt;AsyncLocalStorage&lt;/u&gt;&lt;/code&gt;&lt;/a&gt; and &lt;a href=\&quot;https://github.com/cloudflare/workerd/blob/main/src/workerd/api/node/crypto.h\&quot;&gt;&lt;code&gt;&lt;u&gt;Crypto&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;. This allows for highly performant code that matches Node.js behavior.&lt;/p&gt;&lt;p&gt;Note that the &lt;code&gt;node:&lt;/code&gt; prefix is not needed when importing &lt;code&gt;buffer&lt;/code&gt;, but the code would also work with &lt;code&gt;node:buffer&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;The second line imports &lt;code&gt;net&lt;/code&gt; which Wrangler automatically polyfills using a library called &lt;a href=\&quot;https://github.com/unjs/unenv\&quot;&gt;&lt;u&gt;unenv&lt;/u&gt;&lt;/a&gt;. Polyfills and built-in runtime APIs now work together.&lt;/p&gt;&lt;p&gt;Previously, when you set &lt;code&gt;node_compat = true&lt;/code&gt;, Wrangler added polyfills for every Node.js API that it was able to, even if neither your Worker nor its dependencies used that API. When you enable the &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/\&quot;&gt;&lt;u&gt;nodejs_compat_v2 compatibility flag&lt;/u&gt;&lt;/a&gt;, Wrangler only adds polyfills for Node.js APIs that your Worker or its dependencies actually use. This results in small Worker sizes, even with polyfills.&lt;/p&gt;&lt;p&gt;For some Node.js APIs, there is not yet native support in the Workers runtime nor a polyfill implementation. In these cases, unenv “mocks” the interface. This means it adds the module and its methods to your Worker, but calling methods of the module will either do nothing or will throw an error with a message like:&lt;/p&gt;&lt;p&gt;&lt;code&gt;[unenv] &amp;lt;method name&amp;gt; is not implemented yet!&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This is more important than it might seem. Because if a Node.js API is “mocked”, NPM packages that depend on it can still be imported. Consider the following code:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;// Package name: my-module\n\nimport fs from &amp;quot;fs&amp;quot;;\n\nexport function foo(path) {\n  const data = fs.readFileSync(path, &amp;#039;utf8&amp;#039;);\n  return data;\n}\n\nexport function bar() {\n  return &amp;quot;baz&amp;quot;;\n}\n&lt;/pre&gt;&lt;/code&gt;\n            \n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { bar } from &amp;quot;my-module&amp;quot;\n\nbar(); // returns &amp;quot;baz&amp;quot;\nfoo(); // throws readFileSync is not implemented yet!\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Previously, even with the &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/\&quot;&gt;&lt;u&gt;existing nodejs_compat compatibility flag&lt;/u&gt;&lt;/a&gt; enabled, attempting to import my-module would fail at build time, because the &lt;code&gt;fs&lt;/code&gt; module could not be resolved. Now, the &lt;code&gt;fs&lt;/code&gt; module can be resolved, methods that do not rely on an unimplemented Node.js API work, and methods that do throw a more specific error – a runtime error that a specific Node.js API method is not yet supported, rather than a build-time error that the module could not be resolved.&lt;/p&gt;&lt;p&gt;This is what enables some packages to transition from “doesn’t even load on Workers” to, “loads, but with some unsupported methods”.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;still-missing-an-api-from-node-js-module-aliasing-to-the-rescue\&quot;&gt;Still missing an API from Node.js? Module aliasing to the rescue&lt;/h3&gt;\n            &lt;a href=\&quot;#still-missing-an-api-from-node-js-module-aliasing-to-the-rescue\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Let’s say you need an NPM package to work on Workers that relies on a Node.js API that isn’t yet implemented in the Workers runtime or as a polyfill in unenv. You can use &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/configuration/#module-aliasing\&quot;&gt;&lt;u&gt;module aliasing&lt;/u&gt;&lt;/a&gt; to implement just enough of that API to make things work.&lt;/p&gt;&lt;p&gt;For example, let’s say the NPM package you need to work calls &lt;a href=\&quot;https://nodejs.org/api/fs.html#fsreadfilepath-options-callback\&quot;&gt;&lt;u&gt;fs.readFile&lt;/u&gt;&lt;/a&gt;. You can alias the fs module by adding the following to your Worker’s wrangler.toml:&lt;/p&gt;\n            &lt;pre class=\&quot;language-toml\&quot;&gt;&lt;code class=\&quot;language-toml\&quot;&gt;[alias]\n&amp;quot;fs&amp;quot; = &amp;quot;./fs-polyfill&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Then, in the fs-polyfill.js file, you can define your own implementation of any methods of the fs module:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export function readFile() {\n  console.log(&amp;quot;readFile was called&amp;quot;);\n  // ...\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Now, the following code, which previously threw the error message “[unenv] readFile is not implemented yet!”, runs without errors:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { readFile } from &amp;#039;fs&amp;#039;;\n\nexport default {\n  async fetch(request, env, ctx) {\n    readFile();\n    return new Response(&amp;#039;Hello World!&amp;#039;);\n  },\n};\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You can also use module aliasing to provide an implementation of an NPM package that does not work on Workers, even if you only rely on that NPM package indirectly, as a dependency of one of your Worker&amp;#39;s dependencies.&lt;/p&gt;&lt;p&gt;For example, some NPM packages, such as &lt;a href=\&quot;https://www.npmjs.com/package/cross-fetch\&quot;&gt;&lt;u&gt;cross-fetch&lt;/u&gt;&lt;/a&gt;, depend on &lt;a href=\&quot;https://www.npmjs.com/package/node-fetch\&quot;&gt;&lt;u&gt;node-fetch&lt;/u&gt;&lt;/a&gt;, a package that provided a polyfill of the &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/fetch/\&quot;&gt;&lt;u&gt;fetch() API&lt;/u&gt;&lt;/a&gt; before it was built into Node.js. The node-fetch package isn&amp;#39;t needed in Workers, because the fetch() API is provided by the Workers runtime. And node-fetch doesn&amp;#39;t work on Workers, because it relies on currently unsupported Node.js APIs from the &lt;a href=\&quot;https://nodejs.org/api/http.html\&quot;&gt;&lt;u&gt;http&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://nodejs.org/api/https.html\&quot;&gt;&lt;u&gt;https&lt;/u&gt;&lt;/a&gt; modules.&lt;/p&gt;&lt;p&gt;You can alias all imports of node-fetch to instead point directly to the fetch() API that is built into the Workers runtime using the popular &lt;a href=\&quot;https://github.com/SukkaW/nolyfill\&quot;&gt;&lt;u&gt;nolyfill&lt;/u&gt;&lt;/a&gt; package:&lt;/p&gt;\n            &lt;pre class=\&quot;language-toml\&quot;&gt;&lt;code class=\&quot;language-toml\&quot;&gt;[alias]\n&amp;quot;node-fetch&amp;quot; = &amp;quot;./fetch-nolyfill&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;All your replacement module needs to do in this case is to re-export the fetch API that is built into the Workers runtime:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export default fetch;&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;contributing-back-to-unenv\&quot;&gt;Contributing back to unenv&lt;/h3&gt;\n            &lt;a href=\&quot;#contributing-back-to-unenv\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Cloudflare is actively contributing to unenv. We think unenv is solving the problem of cross-runtime compatibility the right way — it adds only the necessary polyfills to your application, based on what APIs you use and what runtime you target. The project supports a variety of runtimes beyond workerd and is already used by other popular projects including &lt;a href=\&quot;https://nuxt.com/\&quot;&gt;&lt;u&gt;Nuxt&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://nitro.unjs.io/\&quot;&gt;&lt;u&gt;Nitro&lt;/u&gt;&lt;/a&gt;. We want to thank &lt;a href=\&quot;https://github.com/pi0\&quot;&gt;&lt;u&gt;Pooya Parsa&lt;/u&gt;&lt;/a&gt; and the unenv maintainers and encourage others in the ecosystem to adopt or contribute.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-path-forward\&quot;&gt;The path forward&lt;/h3&gt;\n            &lt;a href=\&quot;#the-path-forward\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Currently, you can enable improved Node.js compatibility by setting the &lt;code&gt;nodejs_compat_v2&lt;/code&gt; flag in &lt;code&gt;wrangler.toml&lt;/code&gt;. We plan to make the new behavior the default when using the &lt;code&gt;nodejs_compat&lt;/code&gt; flag on September 23rd. This will require updating your &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/compatibility-dates/\&quot;&gt;&lt;code&gt;&lt;u&gt;compatibility_date&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;We are excited about the changes coming to Node.js compatibility, and encourage you to try it today. &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/\&quot;&gt;&lt;u&gt;See the documentation&lt;/u&gt;&lt;/a&gt; on how to opt-in for your Workers, and please send feedback and report bugs &lt;a href=\&quot;https://github.com/cloudflare/workers-sdk/issues/new?assignees=&amp;labels=bug&amp;projects=&amp;template=bug-template.yaml&amp;title=%F0%9F%90%9B+BUG%3A\&quot;&gt;&lt;u&gt;by opening an issue&lt;/u&gt;&lt;/a&gt;. Doing so will help us identify any gaps in support and ensure that as much of the Node.js ecosystem as possible runs on Workers.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-09-09T14:00-07:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:05:19.004Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4zhRsxzWAohI3jRhnrzfQ8/9c41603d664e454fd64aa92247114795/image1.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3XzVULQKajbCuWudT6JD0p&quot;],&quot;name&quot;:[0,&quot;Node.js&quot;],&quot;slug&quot;:[0,&quot;node-js&quot;]}],[0,{&quot;id&quot;:[0,&quot;5cye1Bh5KxFh3pKSnX8Dsy&quot;],&quot;name&quot;:[0,&quot;Serverless&quot;],&quot;slug&quot;:[0,&quot;serverless&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;James M Snell&quot;],&quot;slug&quot;:[0,&quot;jasnell&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dR6CJtYedvLrkAZ6rxv9I/0db3d5a763a8b0a350ac04ac6410da6b/jasnell.jpg&quot;],&quot;location&quot;:[0,&quot;California&quot;],&quot;website&quot;:[0,&quot;https://bsky.app/profile/jasnell.me&quot;],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Igor Minar&quot;],&quot;slug&quot;:[0,&quot;igor&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4bFcaTr1FpTJBKV7y849pd/499e62c642e20b9c8e83c9ce94f16728/igor.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@IgorMinar&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;James Culveyhouse&quot;],&quot;slug&quot;:[0,&quot;james-culveyhouse&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2IAt8Eb4CKZMgvCvxHdNM/2f6ec2bf2bf318993e9d2f6727dbba60/james-culveyhouse.jpg&quot;],&quot;location&quot;:[0,&quot;San Francisco, CA&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Mike Nomitch&quot;],&quot;slug&quot;:[0,&quot;mike-nomitch&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3Ub221L51x1p3FZJbnblyn/23b50473b99404db0baf42921edd269c/_tmp_mini_magick20240415-2-6izqhi.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Workers now supports more NPM packages and Node.js APIs using an overhauled hybrid compatibility layer.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;More NPM packages on Cloudflare Workers: Combining polyfills and native code to support Node.js APIs Loc&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/more-npm-packages-on-cloudflare-workers-combining-polyfills-and-native-code&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;More NPM packages on Cloudflare Workers: Combining polyfills and native code to support Node.js APIs&quot;],&quot;description&quot;:[0,&quot;Workers now supports more NPM packages and Node.js APIs using an overhauled hybrid compatibility layer.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7ahNGmC7Z5DQ44zQFJi9sk/c497a54eb5975a2b46a5d9e34e50cec7/More_NPM_packages_on_Cloudflare_Workers-_Combining_polyfills_and_native_code_to_support_Node.js_APIs-OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;3NHy1gOkql57RbBcdjWs5g&quot;],&quot;title&quot;:[0,&quot;Automatically replacing polyfill.io links with Cloudflare’s mirror for a safer Internet&quot;],&quot;slug&quot;:[0,&quot;automatically-replacing-polyfill-io-links-with-cloudflares-mirror-for-a-safer-internet&quot;],&quot;excerpt&quot;:[0,&quot;polyfill.io, a popular JavaScript library service, can no longer be trusted and should be removed from websites&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6gvTB6dkAGrmJeGFS870Am/4f3ad79cd55c39aa93ac3cd8523c2525/image2-12.png\&quot; alt=\&quot;Automatically replacing polyfill.io links with Cloudflare’s mirror for a safer Internet\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;900\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;polyfill.io, a popular JavaScript library service, can no longer be trusted and should be removed from websites.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://sansec.io/research/polyfill-supply-chain-attack\&quot;&gt;Multiple reports&lt;/a&gt;, corroborated with data seen by our own client-side security system, &lt;a href=\&quot;https://developers.cloudflare.com/page-shield/\&quot;&gt;Page Shield&lt;/a&gt;, have shown that the polyfill service was being used, and could be used again, to inject malicious JavaScript code into users’ browsers. This is a real threat to the Internet at large given the popularity of this library.&lt;/p&gt;&lt;p&gt;We have, over the last 24 hours, released an automatic JavaScript URL rewriting service that will rewrite any link to polyfill.io found in a website proxied by Cloudflare &lt;a href=\&quot;https://cdnjs.cloudflare.com/polyfill/\&quot;&gt;to a link to our mirror under cdnjs&lt;/a&gt;. This will avoid breaking site functionality while mitigating the risk of a supply chain attack.&lt;/p&gt;&lt;p&gt;Any website on the free plan has this feature automatically activated now. Websites on any paid plan can turn on this feature with a single click.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5R0ht5q4fAwm8gm3a2Xe5U/6b3ec28498e76ff75e37b58f3673e49a/image1-22.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1548\&quot; height=\&quot;322\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;You can find this new feature under &lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/:zone/security/settings\&quot;&gt;Security ⇒ Settings&lt;/a&gt; on any zone using Cloudflare.&lt;/p&gt;&lt;p&gt;Contrary to what is stated on the polyfill.io website, Cloudflare has never recommended the polyfill.io service or authorized their use of Cloudflare’s name on their website. We have asked them to remove the false statement, and they have, so far, ignored our requests. This is yet another warning sign that they cannot be trusted.&lt;/p&gt;&lt;p&gt;If you are not using Cloudflare today, we still highly recommend that you remove any use of polyfill.io and/or find an alternative solution. And, while the automatic replacement function will handle most cases, the best practice is to remove polyfill.io from your projects and replace it with a secure alternative mirror like Cloudflare’s even if you are a customer.&lt;/p&gt;&lt;p&gt;You can do this by searching your code repositories for instances of polyfill.io and replacing it with &lt;a href=\&quot;https://cdnjs.cloudflare.com/polyfill/\&quot;&gt;cdnjs.cloudflare.com/polyfill/&lt;/a&gt; (Cloudflare’s mirror). This is a non-breaking change as the two URLs will serve the same polyfill content. All website owners, regardless of the website using Cloudflare, should do this now.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;how-we-came-to-this-decision\&quot;&gt;How we came to this decision&lt;/h2&gt;\n            &lt;a href=\&quot;#how-we-came-to-this-decision\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Back in February, the domain polyfill.io, which hosts a popular JavaScript library, was sold to a new owner: Funnull, a relatively unknown company. &lt;a href=\&quot;/polyfill-io-now-available-on-cdnjs-reduce-your-supply-chain-risk\&quot;&gt;At the time, we were concerned&lt;/a&gt; that this created a supply chain risk. This led us to spin up our own mirror of the polyfill.io code hosted under cdnjs, a JavaScript library repository sponsored by Cloudflare.&lt;/p&gt;&lt;p&gt;The new owner was unknown in the industry and did not have a track record of trust to administer a project such as polyfill.io. The concern, &lt;a href=\&quot;https://x.com/triblondon/status/1761852117579427975\&quot;&gt;highlighted even by the original author&lt;/a&gt;, was that if they were to abuse polyfill.io by injecting additional code to the library, it could cause far-reaching security problems on the Internet affecting several hundreds of thousands websites. Or it could be used to perform a targeted supply-chain attack against specific websites.&lt;/p&gt;&lt;p&gt;Unfortunately, that worry came true on June 25, 2024, as the polyfill.io service was being used to inject nefarious code that, under certain circumstances, redirected users to other websites.&lt;/p&gt;&lt;p&gt;We have taken the exceptional step of using our ability to modify HTML on the fly to replace references to the polyfill.io CDN in our customers’ websites with links to our own, safe, mirror created back in February.&lt;/p&gt;&lt;p&gt;In the meantime, additional threat feed providers have also taken the decision to &lt;a href=\&quot;https://github.com/uBlockOrigin/uAssets/commit/91dfc54aed0f0aa514c1a481c3e63ea16da94c03\&quot;&gt;flag the domain as malicious&lt;/a&gt;. We have not outright blocked the domain through any of the mechanisms we have because we are concerned it could cause widespread web outages given how broadly polyfill.io is used with some estimates indicating &lt;a href=\&quot;https://w3techs.com/technologies/details/js-polyfillio\&quot;&gt;usage on nearly 4% of all websites&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;corroborating-data-with-page-shield\&quot;&gt;Corroborating data with Page Shield&lt;/h3&gt;\n            &lt;a href=\&quot;#corroborating-data-with-page-shield\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The original report indicates that malicious code was injected that, under certain circumstances, would redirect users to betting sites. It was doing this by loading additional JavaScript that would perform the redirect, under a set of additional domains which can be considered Indicators of Compromise (IoCs):&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;https://www.googie-anaiytics.com/analytics.js\nhttps://www.googie-anaiytics.com/html/checkcachehw.js\nhttps://www.googie-anaiytics.com/gtags.js\nhttps://www.googie-anaiytics.com/keywords/vn-keyword.json\nhttps://www.googie-anaiytics.com/webs-1.0.1.js\nhttps://www.googie-anaiytics.com/analytics.js\nhttps://www.googie-anaiytics.com/webs-1.0.2.js\nhttps://www.googie-anaiytics.com/ga.js\nhttps://www.googie-anaiytics.com/web-1.0.1.js\nhttps://www.googie-anaiytics.com/web.js\nhttps://www.googie-anaiytics.com/collect.js\nhttps://kuurza.com/redirect?from=bitget&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;(note the intentional misspelling of Google Analytics)&lt;/p&gt;&lt;p&gt;Page Shield, our client side security solution, is available on all paid plans. When turned on, it collects information about JavaScript files loaded by end user browsers accessing your website.&lt;/p&gt;&lt;p&gt;By looking at the database of detected JavaScript files, we immediately found matches with the IoCs provided above starting as far back as 2024-06-08 15:23:51 (first seen timestamp on Page Shield detected JavaScript file). This was a clear indication that malicious activity was active and associated with polyfill.io.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;replacing-insecure-javascript-links-to-polyfill-io\&quot;&gt;Replacing insecure JavaScript links to polyfill.io&lt;/h3&gt;\n            &lt;a href=\&quot;#replacing-insecure-javascript-links-to-polyfill-io\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;To achieve performant HTML rewriting, we need to make blazing-fast HTML alterations as responses stream through Cloudflare’s network. This has been made possible by leveraging &lt;a href=\&quot;/rust-nginx-module\&quot;&gt;ROFL (Response Overseer for FL)&lt;/a&gt;. ROFL powers various Cloudflare products that need to alter HTML as it streams, such as &lt;a href=\&quot;https://developers.cloudflare.com/speed/optimization/content/fonts/\&quot;&gt;Cloudflare Fonts,&lt;/a&gt; &lt;a href=\&quot;https://developers.cloudflare.com/waf/tools/scrape-shield/email-address-obfuscation/\&quot;&gt;Email Obfuscation&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/speed/optimization/content/rocket-loader/\&quot;&gt;Rocket Loader&lt;/a&gt;&lt;/p&gt;&lt;p&gt;ROFL is developed entirely in Rust. The memory-safety features of Rust are indispensable for ensuring protection against memory leaks while processing a staggering volume of requests, measuring in the millions per second. Rust&amp;#39;s compiled nature allows us to finely optimize our code for specific hardware configurations, delivering performance gains compared to interpreted languages.&lt;/p&gt;&lt;p&gt;The performance of ROFL allows us to rewrite HTML on-the-fly and modify the polyfill.io links quickly, safely, and efficiently. This speed helps us reduce any additional latency added by processing the HTML file.&lt;/p&gt;&lt;p&gt;If the feature is turned on, for any HTTP response with an HTML Content-Type, we parse all JavaScript script tag source attributes. If any are found linking to polyfill.io, we rewrite the src attribute to link to our mirror instead. We map to the correct version of the polyfill service while the query string is left untouched.&lt;/p&gt;&lt;p&gt;The logic will not activate if a Content Security Policy (CSP) header is found in the response. This ensures we don’t replace the link while breaking the CSP policy and therefore potentially breaking the website.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;default-on-for-free-customers-optional-for-everyone-else\&quot;&gt;Default on for free customers, optional for everyone else&lt;/h3&gt;\n            &lt;a href=\&quot;#default-on-for-free-customers-optional-for-everyone-else\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Cloudflare proxies millions of websites, and a large portion of these sites are on our free plan. Free plan customers tend to have simpler applications while not having the resources to update and react quickly to security concerns. We therefore decided to turn on the feature by default for sites on our free plan, as the likelihood of causing issues is reduced while also helping keep safe a very large portion of applications using polyfill.io.&lt;/p&gt;&lt;p&gt;Paid plan customers, on the other hand, have more complex applications and react quicker to security notices. We are confident that most paid customers using polyfill.io and Cloudflare will appreciate the ability to virtually patch the issue with a single click, while controlling when to do so.&lt;/p&gt;&lt;p&gt;All customers can turn off the feature at any time.&lt;/p&gt;&lt;p&gt;This isn’t the first time we’ve decided a security problem was so widespread and serious that we’d enable protection for all customers regardless of whether they were a paying customer or not. Back in 2014, we enabled &lt;a href=\&quot;/shellshock-protection-enabled-for-all-customers\&quot;&gt;Shellshock protection&lt;/a&gt; for everyone. In 2021, when the log4j vulnerability was disclosed &lt;a href=\&quot;/cve-2021-44228-log4j-rce-0-day-mitigation/\&quot;&gt;we rolled out protection&lt;/a&gt; for all customers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;do-not-use-polyfill-io\&quot;&gt;Do not use polyfill.io&lt;/h2&gt;\n            &lt;a href=\&quot;#do-not-use-polyfill-io\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;If you are using Cloudflare, you can remove polyfill.io with a single click on the Cloudflare dashboard by heading over to &lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/:zone/security/settings\&quot;&gt;your zone ⇒ Security ⇒ Settings&lt;/a&gt;. If you are a free customer, the rewrite is automatically active. This feature, we hope, will help you quickly patch the issue.&lt;/p&gt;&lt;p&gt;Nonetheless, you should ultimately search your code repositories for instances of polyfill.io and replace them with an alternative provider, such as Cloudflare’s secure mirror under cdnjs (&lt;a href=\&quot;https://cdnjs.cloudflare.com/polyfill/\&quot;&gt;https://cdnjs.cloudflare.com/polyfill/&lt;/a&gt;). Website owners who are not using Cloudflare should also perform these steps.&lt;/p&gt;&lt;p&gt;The underlying bundle links you should use are:&lt;/p&gt;&lt;p&gt;For minified: &lt;a href=\&quot;https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js\&quot;&gt;https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js&lt;/a&gt;\nFor unminified: &lt;a href=\&quot;https://cdnjs.cloudflare.com/polyfill/v3/polyfill.js\&quot;&gt;https://cdnjs.cloudflare.com/polyfill/v3/polyfill.js&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Doing this ensures your website is no longer relying on polyfill.io.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-06-26T21:23:41.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:28:31.956Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/35z20JxQR3qYtQM1ebtGKr/5096ec15802299536b61356b897f6083/automatically-replacing-polyfill-io-links-with-cloudflares-mirror-for-a-safer-internet.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1goKAxv27P7ytwqLodJSAK&quot;],&quot;name&quot;:[0,&quot;CDNJS&quot;],&quot;slug&quot;:[0,&quot;cdnjs&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;2pFyOCtANFB5qS6nbtQbVp&quot;],&quot;name&quot;:[0,&quot;Vulnerabilities&quot;],&quot;slug&quot;:[0,&quot;vulnerabilities&quot;]}],[0,{&quot;id&quot;:[0,&quot;urEf9QllkDeGxTu3ysdlo&quot;],&quot;name&quot;:[0,&quot;Application Security&quot;],&quot;slug&quot;:[0,&quot;application-security&quot;]}],[0,{&quot;id&quot;:[0,&quot;36Dg2NwTgUHhrlE0FRpSdJ&quot;],&quot;name&quot;:[0,&quot;Application Services&quot;],&quot;slug&quot;:[0,&quot;application-services&quot;]}],[0,{&quot;id&quot;:[0,&quot;48XxAr8BFykC1JZjxOCtZA&quot;],&quot;name&quot;:[0,&quot;Supply Chain Attacks&quot;],&quot;slug&quot;:[0,&quot;supply-chain-attacks&quot;]}],[0,{&quot;id&quot;:[0,&quot;5kIxDMJCg3PXQxVINDL0Cw&quot;],&quot;name&quot;:[0,&quot;Attacks&quot;],&quot;slug&quot;:[0,&quot;attacks&quot;]}],[0,{&quot;id&quot;:[0,&quot;3Fo5JgRZ6Fh2HHzhEr7AKn&quot;],&quot;name&quot;:[0,&quot;Better Internet&quot;],&quot;slug&quot;:[0,&quot;better-internet&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Matthew Prince&quot;],&quot;slug&quot;:[0,&quot;matthew-prince&quot;],&quot;bio&quot;:[0,&quot;A little bit geek, wonk, and nerd. Repeat entrepreneur, recovering lawyer, and former ski instructor. Co-founder &amp; CEO of Cloudflare (NYSE: NET).&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1VD9WePJ1jvjFwuSRF0IfQ/5e4f7d5fd4825358b33b2ead623140d8/matthew-prince.jpeg&quot;],&quot;location&quot;:[0,&quot;San Francisco, CA&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@eastdakota&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;John Graham-Cumming&quot;],&quot;slug&quot;:[0,&quot;john-graham-cumming&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5vGNsXzZrtSLn2X30pnpUY/6f350e7dd36058a6422f9199b452bb02/john-graham-cumming.jpg&quot;],&quot;location&quot;:[0,&quot;Lisbon, Portugal&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Michael Tremante&quot;],&quot;slug&quot;:[0,&quot;michael-tremante&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/61VxyepuDMgPc2YC1SLjzq/b40290be32d4c578dab2eb8ec1a3b6da/michael-tremante.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@MichaelTremante&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;polyfill.io, a popular JavaScript library service, can no longer be trusted and should be removed from websites&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Automatically replacing polyfill.io links with Cloudflare’s mirror for a safer Internet Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/automatically-replacing-polyfill-io-links-with-cloudflares-mirror-for-a-safer-internet&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Automatically replacing polyfill.io links with Cloudflare’s mirror for a safer Internet&quot;],&quot;description&quot;:[0,&quot;polyfill.io, a popular JavaScript library service, can no longer be trusted and should be removed from websites&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7f17UZnDkhzdK0fT9WgEUK/20bb6f20002a2dfe72f711cbb33341b6/automatically-replacing-polyfill-io-links-with-cloudflares-mirror-for-a-safer-internet-eGzfOO.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;64KHlCJKCdI1JNa3sCAqpL&quot;],&quot;title&quot;:[0,&quot;polyfill.io now available on cdnjs: reduce your supply chain risk&quot;],&quot;slug&quot;:[0,&quot;polyfill-io-now-available-on-cdnjs-reduce-your-supply-chain-risk&quot;],&quot;excerpt&quot;:[0,&quot;Polyfill.io is now available on cdnjs to reduce the risk of supply chain attacks. Replace your polyfill.io links today for a seamless experience&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4nxvskYVuRnRJHoLUMRY4l/e26d2d6b57eb9a286238ab84863dc947/image1-17.png\&quot; alt=\&quot;polyfill.io now available on cdnjs: reduce your supply chain risk\&quot; class=\&quot;kg-image\&quot; width=\&quot;1201\&quot; height=\&quot;675\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Polyfill.io is a popular JavaScript library that nullifies differences across old browser versions. These differences often take up substantial development time.&lt;/p&gt;&lt;p&gt;It does this by adding support for modern functions (via &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Glossary/Polyfill\&quot;&gt;polyfilling&lt;/a&gt;), ultimately letting developers work against a uniform environment simplifying development. The tool is historically loaded by linking to the endpoint provided under the domain polyfill.io.&lt;/p&gt;&lt;p&gt;In the interest of providing developers with additional options to use polyfill, today we are launching an &lt;a href=\&quot;https://cdnjs.cloudflare.com/polyfill\&quot;&gt;alternative endpoint under cdnjs&lt;/a&gt;. You can replace links to polyfill.io “as is” with our new endpoint. You will then rely on the same service and reputation that &lt;a href=\&quot;https://cdnjs.com/\&quot;&gt;cdnjs&lt;/a&gt; has built over the years for your polyfill needs.&lt;/p&gt;&lt;p&gt;Our interest in creating an alternative endpoint was also sparked by some &lt;a href=\&quot;https://github.com/polyfillpolyfill/polyfill-service/issues/2834\&quot;&gt;concerns raised by the community&lt;/a&gt;, and &lt;a href=\&quot;https://twitter.com/triblondon/status/1761852117579427975\&quot;&gt;main contributors&lt;/a&gt;, following the transition of the domain polyfill.io to a new provider (Funnull).&lt;/p&gt;&lt;p&gt;The concerns are that any website embedding a link to the original polyfill.io domain, will now be relying on Funnull to maintain and secure the underlying project to avoid the risk of a supply chain attack. Such an attack would occur if the underlying third party is compromised or alters the code being served to end users in nefarious ways, causing, by consequence, all websites using the tool to be compromised.&lt;/p&gt;&lt;p&gt;Supply chain attacks, in the context of web applications, are a growing concern for security teams, and also led us to build a client side security product to detect and mitigate these attack vectors: &lt;a href=\&quot;https://developers.cloudflare.com/page-shield/\&quot;&gt;Page Shield&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Irrespective of the scenario described above, this is a timely reminder of the complexities and risks tied to modern web applications. As maintainers and contributors of &lt;a href=\&quot;https://cdnjs.com/\&quot;&gt;cdnjs&lt;/a&gt;, currently used by &lt;a href=\&quot;https://w3techs.com/technologies/overview/content_delivery\&quot;&gt;more than 12% of all sites&lt;/a&gt;, this reinforces our commitment to help keep the Internet safe.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;polyfill-io-on-cdnjs\&quot;&gt;polyfill.io on cdnjs&lt;/h3&gt;\n            &lt;a href=\&quot;#polyfill-io-on-cdnjs\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The full polyfill.io implementation has been deployed at the following URL:&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://cdnjs.cloudflare.com/polyfill/\&quot;&gt;&lt;code&gt;https://cdnjs.cloudflare.com/polyfill/&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;The underlying bundle link is:&lt;/p&gt;&lt;p&gt;For minified: &lt;a href=\&quot;https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js\&quot;&gt;https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js&lt;/a&gt;For unminified: &lt;a href=\&quot;https://cdnjs.cloudflare.com/polyfill/v3/polyfill.js\&quot;&gt;https://cdnjs.cloudflare.com/polyfill/v3/polyfill.js&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Usage and deployment is intended to be identical to the original polyfill.io site. As a developer, you should be able to simply “replace” the old link with the new cdnjs-hosted link without observing any side effects, besides a possible improvement in performance and reliability.&lt;/p&gt;&lt;p&gt;If you don’t have access to the underlying website code, but your website is behind Cloudflare, replacing the links is even easier, as you can deploy a Cloudflare Worker to update the links for you:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;export interface Env {}\n\nexport default {\n    async fetch(request: Request, env: Env, ctx: ExecutionContext): Promise&amp;lt;Response&amp;gt; {\n        ctx.passThroughOnException();\n\n        const response = await fetch(request);\n\n        if ((response.headers.get(&amp;#039;content-type&amp;#039;) || &amp;#039;&amp;#039;).includes(&amp;#039;text/html&amp;#039;)) {\n            const rewriter = new HTMLRewriter()\n                .on(&amp;#039;link&amp;#039;, {\n                    element(element) {\n                        const rel = element.getAttribute(&amp;#039;rel&amp;#039;);\n                        if (rel === &amp;#039;preconnect&amp;#039;) {\n                            const href = new URL(element.getAttribute(&amp;#039;href&amp;#039;) || &amp;#039;&amp;#039;, request.url);\n\n                            if (href.hostname === &amp;#039;polyfill.io&amp;#039;) {\n                                href.hostname = &amp;#039;cdnjs.cloudflare.com&amp;#039;;\n                                element.setAttribute(&amp;#039;href&amp;#039;, href.toString());\n                            }\n                        }\n                    },\n                })\n\n                .on(&amp;#039;script&amp;#039;, {\n                    element(element) {\n                        if (element.hasAttribute(&amp;#039;src&amp;#039;)) {\n                            const src = new URL(element.getAttribute(&amp;#039;src&amp;#039;) || &amp;#039;&amp;#039;, request.url);\n                            if (src.hostname === &amp;#039;polyfill.io&amp;#039;) {\n                                src.hostname = &amp;#039;cdnjs.cloudflare.com&amp;#039;;\n                                src.pathname = &amp;#039;/polyfill&amp;#039; + src.pathname;\n\n                                element.setAttribute(&amp;#039;src&amp;#039;, src.toString());\n                            }\n                        }\n                    },\n                });\n\n            return rewriter.transform(response);\n        } else {\n            return response;\n        }\n    },\n};&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Instructions on how to deploy a worker can be found on our &lt;a href=\&quot;https://developers.cloudflare.com/workers/get-started/\&quot;&gt;developer documentation&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;You can also test the Worker on your website without deploying the worker. You can find instructions on how to do this in &lt;a href=\&quot;/workers-and-webpagetest/\&quot;&gt;another blog post we wrote in the past&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;implemented-with-rust-on-cloudflare-workers\&quot;&gt;Implemented with Rust on Cloudflare Workers&lt;/h3&gt;\n            &lt;a href=\&quot;#implemented-with-rust-on-cloudflare-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;We were happy to discover that polyfill.io is a &lt;a href=\&quot;https://github.com/polyfillpolyfill/polyfill-service\&quot;&gt;Rust project&lt;/a&gt;. As you might know, Rust has been a &lt;a href=\&quot;/workers-rust-sdk\&quot;&gt;first class citizen on Cloudflare Workers&lt;/a&gt; from the start.&lt;/p&gt;&lt;p&gt;The polyfill.io service was hosted on Fastly and used their Rust library. We forked the project to add the compatibility for Cloudflare Workers, and plan to make the fork publicly accessible in the near future.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;worker\&quot;&gt;Worker&lt;/h3&gt;\n            &lt;a href=\&quot;#worker\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The &lt;code&gt;https://cdnjs.cloudflare.com/polyfill/[...].js&lt;/code&gt; endpoints are also implemented in a Cloudflare Worker that wraps our Polyfill.io fork. The wrapper uses &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;Cloudflare’s Rust API&lt;/a&gt; and looks like the following:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;#[event(fetch)]\nasync fn main(req: Request, env: Env, ctx: Context) -&amp;gt; Result&amp;lt;Response&amp;gt; {\n    let metrics = {...};\n\n    let polyfill_store = get_d1(&amp;amp;req, &amp;amp;env)?;\n    let polyfill_env = Arc::new(service::Env { polyfill_store, metrics });\n    \n    // Run the polyfill.io entrypoint\n    let res = service::handle_request(req2, polyfill_env).await;\n\n    let status_code = if let Ok(res) = &amp;amp;res {\n        res.status_code()\n    } else {\n        500\n    };\n    metrics\n        .requests\n        .with_label_values(&amp;amp;[&amp;amp;status_code.to_string()])\n        .inc();\n\n    ctx.wait_until(async move {\n        if let Err(err) = metrics.report_metrics().await {\n            console_error!(&amp;quot;failed to report metrics: {err}&amp;quot;);\n        }\n    });\n\n    res\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The wrapper only sets up our internal &lt;a href=\&quot;https://developers.cloudflare.com/workers/observability/metrics-and-analytics/\&quot;&gt;metrics&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/workers/observability/logging/logpush/\&quot;&gt;logging&lt;/a&gt; tools, so we can monitor uptime and performance of the underlying logic while calling the Polyfill.io entrypoint.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;storage-for-the-polyfill-files\&quot;&gt;Storage for the Polyfill files&lt;/h3&gt;\n            &lt;a href=\&quot;#storage-for-the-polyfill-files\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;All the polyfill files are stored in a key-value store powered by &lt;a href=\&quot;https://developers.cloudflare.com/d1/\&quot;&gt;Cloudflare D1&lt;/a&gt;. This allows us to fetch as many polyfill files as we need with a single SQL query, as opposed to the original implementation doing one KV get() per file.&lt;/p&gt;&lt;p&gt;For performance, we have one Cloudflare D1 instance per region and the SQL queries are routed to the nearest database.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;cdnjs-for-your-javascript-libraries\&quot;&gt;cdnjs for your JavaScript libraries&lt;/h3&gt;\n            &lt;a href=\&quot;#cdnjs-for-your-javascript-libraries\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;cdnjs is hosting over 6k JavaScript libraries as of today. We are looking for ways to improve the service and provide new content. We listen to community feedback and welcome suggestions on our &lt;a href=\&quot;https://community.cloudflare.com/\&quot;&gt;community forum&lt;/a&gt;, or &lt;a href=\&quot;https://github.com/cdnjs\&quot;&gt;cdnjs on GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/page-shield/\&quot;&gt;Page Shield&lt;/a&gt; is also available to all paid plans. Log in to turn it on with a single click to increase visibility and security for your third party assets.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-02-29T17:51:32.000+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:27:06.351Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2HHsMUew6DZ8LWS8wYT19a/41e531b9fba6f617aacea2bcb2cb2bcb/polyfill-io-now-available-on-cdnjs-reduce-your-supply-chain-risk.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1goKAxv27P7ytwqLodJSAK&quot;],&quot;name&quot;:[0,&quot;CDNJS&quot;],&quot;slug&quot;:[0,&quot;cdnjs&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;48XxAr8BFykC1JZjxOCtZA&quot;],&quot;name&quot;:[0,&quot;Supply Chain Attacks&quot;],&quot;slug&quot;:[0,&quot;supply-chain-attacks&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Sven Sauleau&quot;],&quot;slug&quot;:[0,&quot;sven&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4AvybzTkWLlF4cdTgLrE3q/0d45d87578c7668f3d62e49095bb4409/sven.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@svensauleau&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Michael Tremante&quot;],&quot;slug&quot;:[0,&quot;michael-tremante&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/61VxyepuDMgPc2YC1SLjzq/b40290be32d4c578dab2eb8ec1a3b6da/michael-tremante.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@MichaelTremante&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Polyfill.io is now available on cdnjs to reduce the risk of supply chain attacks. Replace your polyfill.io links today for a seamless experience.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;polyfill.io now available on cdnjs: reduce your supply chain risk Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/polyfill-io-now-available-on-cdnjs-reduce-your-supply-chain-risk&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;polyfill.io now available on cdnjs: reduce your supply chain risk&quot;],&quot;description&quot;:[0,&quot;Polyfill.io is now available on cdnjs to reduce the risk of supply chain attacks. Replace your polyfill.io links today for a seamless experience.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/MyVsZKCFlhaGQdVAQd9lz/6f1fbc09ca36e258e712d6b4ac6244cf/polyfill-io-now-available-on-cdnjs-reduce-your-supply-chain-risk-BE8o4c.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;4RWvzttPkO6JoYsMwoovJ8&quot;],&quot;title&quot;:[0,&quot;Streaming and longer context lengths for LLMs on Workers AI&quot;],&quot;slug&quot;:[0,&quot;workers-ai-streaming&quot;],&quot;excerpt&quot;:[0,&quot;Workers AI now supports streaming text responses for the LLM models in our catalog, including Llama-2, using server-sent events&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6hqH5G1qi0RIrmIsdkb1Ql/0d7746c5af2fe23d347ef7192d868b36/pasted-image-0--3--2.png\&quot; alt=\&quot;Streaming LLMs and longer context lengths available in Workers AI\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;901\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Workers AI is our serverless GPU-powered inference platform running on top of Cloudflare’s global network. It provides a growing catalog of off-the-shelf models that run seamlessly with Workers and enable developers to build powerful and scalable AI applications in minutes. We’ve already seen developers doing amazing things with Workers AI, and we can’t wait to see what they do as we continue to expand the platform. To that end, today we’re excited to announce some of our most-requested new features: streaming responses for all &lt;a href=\&quot;https://www.cloudflare.com/learning/ai/what-is-large-language-model/\&quot;&gt;Large Language Models&lt;/a&gt; (LLMs) on Workers AI, larger context and sequence windows, and a full-precision &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/models/llm/\&quot;&gt;Llama-2&lt;/a&gt; model variant.&lt;/p&gt;&lt;p&gt;If you’ve used ChatGPT before, then you’re familiar with the benefits of response streaming, where responses flow in token by token. LLMs work internally by generating responses sequentially using a process of repeated inference — the full output of a LLM model is essentially a sequence of hundreds or thousands of individual prediction tasks. For this reason, while it only takes a few milliseconds to generate a single token, generating the full response takes longer, on the order of seconds. The good news is we can start displaying the response as soon as the first tokens are generated, and append each additional token until the response is complete. This yields a much better experience for the end user —  displaying text incrementally as it&amp;#39;s generated not only provides instant responsiveness, but also gives the end-user time to read and interpret the text.&lt;/p&gt;&lt;p&gt;As of today, you can now use response streaming for any LLM model in our catalog, including the very popular &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/models/llm/\&quot;&gt;Llama-2 model&lt;/a&gt;. Here’s how it works.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;server-sent-events-a-little-gem-in-the-browser-api\&quot;&gt;Server-sent events: a little gem in the browser API&lt;/h3&gt;\n            &lt;a href=\&quot;#server-sent-events-a-little-gem-in-the-browser-api\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;&lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events\&quot;&gt;Server-sent events&lt;/a&gt; are easy to use, simple to implement on the server side, standardized, and broadly available across many platforms natively or as a polyfill. Server-sent events fill a niche of handling a stream of updates from the server, removing the need for the boilerplate code that would otherwise be necessary to handle the event stream.&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;style type=\&quot;text/css\&quot;&gt;\n.tg  {border-collapse:collapse;border-color:#ccc;border-spacing:0;}\n.tg td{background-color:#fff;border-color:#ccc;border-style:solid;border-width:1px;color:#333;\n  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}\n.tg th{background-color:#f0f0f0;border-color:#ccc;border-style:solid;border-width:1px;color:#333;\n  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}\n.tg .tg-lt9p{background-color:#F3F3F3;text-align:left;vertical-align:top}\n.tg .tg-9qck{background-color:#F3F3F3;font-weight:bold;text-align:left;vertical-align:top}\n.tg .tg-0lax{text-align:left;vertical-align:top}\n&lt;/style&gt;\n&lt;table class=\&quot;tg\&quot; width=\&quot;100%\&quot;&gt;\n&lt;thead&gt;\n  &lt;tr&gt;\n    &lt;th class=\&quot;tg-lt9p\&quot;&gt;&lt;/th&gt;\n    &lt;th class=\&quot;tg-9qck\&quot;&gt;&lt;span style=\&quot;font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Easy-to-use&lt;/span&gt;&lt;/th&gt;\n    &lt;th class=\&quot;tg-9qck\&quot;&gt;&lt;span style=\&quot;font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Streaming&lt;/span&gt;&lt;/th&gt;\n    &lt;th class=\&quot;tg-9qck\&quot;&gt;&lt;span style=\&quot;font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Bidirectional&lt;/span&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-9qck\&quot;&gt;&lt;span style=\&quot;font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;fetch&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;✅&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-9qck\&quot;&gt;&lt;span style=\&quot;font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Server-sent events&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;✅&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;✅&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-9qck\&quot;&gt;&lt;span style=\&quot;font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Websockets&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;✅&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;✅&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;&lt;sup&gt;Comparing fetch, server-sent events, and websockets&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;To get started using streaming on Workers AI’s text generation models with server-sent events, set the “stream” parameter to true in the input of request. This will change the response format and &lt;code&gt;mime-type&lt;/code&gt; to &lt;code&gt;text/event-stream&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Here’s an example of using streaming with the &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/get-started/rest-api/\&quot;&gt;REST API&lt;/a&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;curl -X POST \\\n&amp;quot;https://api.cloudflare.com/client/v4/accounts/&amp;lt;account&amp;gt;/ai/run/@cf/meta/llama-2-7b-chat-int8&amp;quot; \\\n-H &amp;quot;Authorization: Bearer &amp;lt;token&amp;gt;&amp;quot; \\\n-H &amp;quot;Content-Type:application/json&amp;quot; \\\n-d &amp;#039;{ &amp;quot;prompt&amp;quot;: &amp;quot;where is new york?&amp;quot;, &amp;quot;stream&amp;quot;: true }&amp;#039;\n\ndata: {&amp;quot;response&amp;quot;:&amp;quot;New&amp;quot;}\n\ndata: {&amp;quot;response&amp;quot;:&amp;quot; York&amp;quot;}\n\ndata: {&amp;quot;response&amp;quot;:&amp;quot; is&amp;quot;}\n\ndata: {&amp;quot;response&amp;quot;:&amp;quot; located&amp;quot;}\n\ndata: {&amp;quot;response&amp;quot;:&amp;quot; in&amp;quot;}\n\ndata: {&amp;quot;response&amp;quot;:&amp;quot; the&amp;quot;}\n\n...\n\ndata: [DONE]&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;And here’s an example using a Worker script:&lt;/p&gt;\n            &lt;pre class=\&quot;language-typescript\&quot;&gt;&lt;code class=\&quot;language-typescript\&quot;&gt;import { Ai } from &amp;quot;@cloudflare/ai&amp;quot;;\nexport default {\n    async fetch(request, env, ctx) {\n        const ai = new Ai(env.AI, { sessionOptions: { ctx: ctx } });\n        const stream = await ai.run(\n            &amp;quot;@cf/meta/llama-2-7b-chat-int8&amp;quot;,\n            { prompt: &amp;quot;where is new york?&amp;quot;, stream: true  }\n        );\n        return new Response(stream,\n            { headers: { &amp;quot;content-type&amp;quot;: &amp;quot;text/event-stream&amp;quot; } }\n        );\n    }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;If you want to consume the output event-stream from this Worker in a browser page, the client-side JavaScript is something like:&lt;/p&gt;\n            &lt;pre class=\&quot;language-typescript\&quot;&gt;&lt;code class=\&quot;language-typescript\&quot;&gt;const source = new EventSource(&amp;quot;/worker-endpoint&amp;quot;);\nsource.onmessage = (event) =&amp;gt; {\n    if(event.data==&amp;quot;[DONE]&amp;quot;) {\n        // SSE spec says the connection is restarted\n        // if we don&amp;#039;t explicitly close it\n        source.close();\n        return;\n    }\n    const data = JSON.parse(event.data);\n    el.innerHTML += data.response;\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You can use this simple code with any simple HTML page, complex SPAs using React or other Web frameworks.&lt;/p&gt;&lt;p&gt;This creates a much more interactive experience for the user, who now sees the page update as the response is incrementally created, instead of waiting with a spinner until the entire response sequence has been generated. Try it out streaming on &lt;a href=\&quot;https://ai.cloudflare.com\&quot;&gt;ai.cloudflare.com&lt;/a&gt;.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card kg-width-wide\&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6VIIO6crNIkpaz8hG9n8jg/c703ab696213d0fa814aff31d6d36d09/llama-streaming.gif\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1518\&quot; height=\&quot;610\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Workers AI supports streaming text responses for the &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/models/llm/\&quot;&gt;Llama-2&lt;/a&gt; model and any future LLM models we are adding to our catalog.&lt;/p&gt;&lt;p&gt;But this is not all.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;higher-precision-longer-context-and-sequence-lengths\&quot;&gt;Higher precision, longer context and sequence lengths&lt;/h3&gt;\n            &lt;a href=\&quot;#higher-precision-longer-context-and-sequence-lengths\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Another top request we heard from our community after the launch of Workers AI was for longer questions and answers in our Llama-2 model. In LLM terminology, this translates to higher context length (the number of tokens the model takes as input before making the prediction) and higher sequence length (the number of tokens the model generates in the response.)&lt;/p&gt;&lt;p&gt;We’re listening, and in conjunction with streaming, today we are adding a higher 16-bit full-precision Llama-2 variant to the catalog, and increasing the context and sequence lengths for the existing 8-bit version.&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;style type=\&quot;text/css\&quot;&gt;\n.tg  {border-collapse:collapse;border-spacing:0;}\n.tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;\n  overflow:hidden;padding:10px 5px;word-break:normal;}\n.tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;\n  font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}\n.tg .tg-9qck{background-color:#F3F3F3;font-weight:bold;text-align:left;vertical-align:top}\n.tg .tg-0lax{text-align:left;vertical-align:top}\n&lt;/style&gt;\n&lt;table class=\&quot;tg\&quot; width=\&quot;100%\&quot;&gt;\n&lt;thead&gt;\n  &lt;tr&gt;\n    &lt;th class=\&quot;tg-9qck\&quot;&gt;&lt;span style=\&quot;font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Model&lt;/span&gt;&lt;/th&gt;\n    &lt;th class=\&quot;tg-9qck\&quot;&gt;&lt;span style=\&quot;font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Context length (in)&lt;/span&gt;&lt;/th&gt;\n    &lt;th class=\&quot;tg-9qck\&quot;&gt;&lt;span style=\&quot;font-weight:700;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Sequence length (out)&lt;/span&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;@cf/meta/llama-2-7b-chat-int8&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;2048 (768 before)&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;1800 (256 before)&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;@cf/meta/llama-2-7b-chat-fp16&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;3072&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;2500&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;Streaming, higher precision, and longer context and sequence lengths provide a better user experience and enable new, richer applications using large language models in Workers AI.&lt;/p&gt;&lt;p&gt;Check the Workers AI &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai\&quot;&gt;developer documentation&lt;/a&gt; for more information and options. If you have any questions or feedback about Workers AI, please come see us in the &lt;a href=\&quot;https://community.cloudflare.com/\&quot;&gt;Cloudflare Community&lt;/a&gt; and the &lt;a href=\&quot;https://discord.gg/cloudflaredev\&quot;&gt;Cloudflare Discord&lt;/a&gt;.If you are interested in machine learning and serverless AI, the Cloudflare Workers AI team is building a global-scale platform and tools that enable our customers to run fast, low-latency inference tasks on top of our network. Check our &lt;a href=\&quot;https://www.cloudflare.com/careers/jobs/\&quot;&gt;jobs page&lt;/a&gt; for opportunities.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2023-11-14T14:00:33.000+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:26:24.125Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/E30qOKdqjVdLW01aB7qXk/ccd5c2e9e3583a94e651e68ce427fc5e/workers-ai-streaming.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1Wf1Dpb2AFicG44jpRT29y&quot;],&quot;name&quot;:[0,&quot;Workers AI&quot;],&quot;slug&quot;:[0,&quot;workers-ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;5cye1Bh5KxFh3pKSnX8Dsy&quot;],&quot;name&quot;:[0,&quot;Serverless&quot;],&quot;slug&quot;:[0,&quot;serverless&quot;]}],[0,{&quot;id&quot;:[0,&quot;2FQK880QI5lKEUCjVHBber&quot;],&quot;name&quot;:[0,&quot;1.1.1.1&quot;],&quot;slug&quot;:[0,&quot;1-1-1-1&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Jesse Kipp&quot;],&quot;slug&quot;:[0,&quot;jesse&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/8yRqemLc8lLhE9Uwzd7G4/a303cca84c1840cc961831f1ea6b4213/jesse.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Celso Martinho&quot;],&quot;slug&quot;:[0,&quot;celso&quot;],&quot;bio&quot;:[0,&quot;From when Mosaic took over Gopher. Engineering Director at Cloudflare.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2pzgat1zmt1oF1byi7hskH/7b25e8e00117ee44afe36ad27d7d8032/celso.png&quot;],&quot;location&quot;:[0,&quot;Portugal, Lisbon&quot;],&quot;website&quot;:[0,&quot;https://celso.io/&quot;],&quot;twitter&quot;:[0,&quot;@celso&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Workers AI now supports streaming text responses for the LLM models in our catalog, including Llama-2, using server-sent events&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Streaming and longer context lengths for LLMs on Workers AI Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;Translated for Locale&quot;],&quot;deDE&quot;:[0,&quot;Translated for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;Translated for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;Translated for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/workers-ai-streaming&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Streaming and longer context lengths for LLMs on Workers AI&quot;],&quot;description&quot;:[0,&quot;Workers AI now supports streaming text responses for the LLM models in our catalog, including Llama-2, using server-sent events&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4IroqQ9dI46SGkhQvNb3XF/99170ace02d15c906c3a3857dfd69731/workers-ai-streaming-nnHfyN.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;341i4XnnUcmAjy5VZm855W&quot;],&quot;title&quot;:[0,&quot;Running Serverless Puppeteer with Workers and Durable Objects&quot;],&quot;slug&quot;:[0,&quot;running-serverless-puppeteer-workers-durable-objects&quot;],&quot;excerpt&quot;:[0,&quot;We’ve heard from developers that configuring and maintaining their own serverless browser automation systems can be quite painful. The Workers Browser Rendering API solves this&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6q1qWS257ltTlrgJ2rOFcf/baaa779be33983d718fa574c7794adf9/Running-Serverless-Puppeteer-with-Workers-and-Durable-Objects.png\&quot; alt=\&quot;Running Serverless Puppeteer with Workers and Durable Objects\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;900\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Last year, we &lt;a href=\&quot;/introducing-workers-browser-rendering-api/\&quot;&gt;announced the Browser Rendering API&lt;/a&gt; – letting users running Puppeteer, a browser automation library, directly in Workers. Puppeteer is one of the most popular libraries used to interact with a headless browser instance to accomplish tasks like taking screenshots, generating PDFs, crawling web pages, and testing &lt;a href=\&quot;https://www.cloudflare.com/learning/security/what-is-web-application-security/\&quot;&gt;web applications&lt;/a&gt;. We’ve heard from developers that configuring and maintaining their own serverless browser automation systems can be quite painful.&lt;/p&gt;&lt;p&gt;The &lt;a href=\&quot;https://developers.cloudflare.com/browser-rendering/\&quot;&gt;Workers Browser Rendering API&lt;/a&gt; solves this. It makes the Puppeteer library available directly in your Worker, connected to a real web browser, without the need to configure and manage infrastructure or keep browser sessions warm yourself. You can use &lt;a href=\&quot;https://www.npmjs.com/package/@cloudflare/puppeteer\&quot;&gt;@cloudflare/puppeteer&lt;/a&gt; to run the full Puppeteer API directly on Workers!&lt;/p&gt;&lt;p&gt;We’ve seen so much interest from the developer community since launching last year. While the Browser Rendering API is still in beta (sign up to our &lt;a href=\&quot;https://www.cloudflare.com/lp/workers-browser-rendering-api/?ref=blog.cloudflare.com&amp;cf_target_id=99BC25CE5278572504B986049859D8A2\&quot;&gt;waitlist&lt;/a&gt; to get access), we wanted to share a way to get more out of our &lt;a href=\&quot;https://developers.cloudflare.com/browser-rendering/platform/limits/\&quot;&gt;current limits&lt;/a&gt; by using the Browser Rendering API with &lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/\&quot;&gt;Durable Objects&lt;/a&gt;. We’ll also be sharing pricing for the Rendering API, so you can build knowing exactly what you’ll pay for.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;building-a-responsive-web-design-testing-tool-with-the-browser-rendering-api\&quot;&gt;Building a responsive web design testing tool with the Browser Rendering API&lt;/h3&gt;\n            &lt;a href=\&quot;#building-a-responsive-web-design-testing-tool-with-the-browser-rendering-api\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;As a designer or frontend developer, you want to make sure that content is well-designed for visitors browsing on different screen sizes. With the number of possible devices that users are browsing on are growing, it becomes difficult to test all the possibilities manually. While there are many testing tools on the market, we want to show how easy it is to create your own Chromium based tool with the Workers Browser Rendering API and Durable Objects.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/OQNeORd8VW4RffHGH8ndq/b94872dfb08664a524eae20227785acf/pasted-image-0--6--2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;852\&quot; height=\&quot;236\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;We’ll be using the Worker to handle any incoming requests, pass them to the Durable Object to take screenshots and store them in an R2 bucket. The Durable Object is used to create a browser session that’s persistent. By using &lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/api/alarms-in-durable-objects/\&quot;&gt;Durable Object Alarms&lt;/a&gt; we can keep browsers open for longer and reuse browser sessions across requests.&lt;/p&gt;&lt;p&gt;Let’s dive into how we can build this application:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Create a Worker with a Durable Object, Browser Rendering API binding and R2 bucket. This is the resulting wrangler.toml:&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;name = &amp;quot;rendering-api-demo&amp;quot;\nmain = &amp;quot;src/index.js&amp;quot;\ncompatibility_date = &amp;quot;2023-09-04&amp;quot;\ncompatibility_flags = [ &amp;quot;nodejs_compat&amp;quot;]\naccount_id = &amp;quot;c05e6a39aa4ccdd53ad17032f8a4dc10&amp;quot;\n\n\n# Browser Rendering API binding\nbrowser = { binding = &amp;quot;MYBROWSER&amp;quot; }\n\n# Bind an R2 Bucket\n[[r2_buckets]]\nbinding = &amp;quot;BUCKET&amp;quot;\nbucket_name = &amp;quot;screenshots&amp;quot;\n\n# Binding to a Durable Object\n[[durable_objects.bindings]]\nname = &amp;quot;BROWSER&amp;quot;\nclass_name = &amp;quot;Browser&amp;quot;\n\n[[migrations]]\ntag = &amp;quot;v1&amp;quot; # Should be unique for each entry\nnew_classes = [&amp;quot;Browser&amp;quot;] # Array of new classes&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;2. Define the Worker&lt;/p&gt;&lt;p&gt;This Worker simply passes the request onto the Durable Object.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;export default {\n\tasync fetch(request, env) {\n\n\t\tlet id = env.BROWSER.idFromName(&amp;quot;browser&amp;quot;);\n\t\tlet obj = env.BROWSER.get(id);\n\t  \n\t\t// Send a request to the Durable Object, then await its response.\n\t\tlet resp = await obj.fetch(request.url);\n\t\tlet count = await resp.text();\n\t  \n\t\treturn new Response(&amp;quot;success&amp;quot;);\n\t}\n};&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;3. Define the Durable Object class&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;const KEEP_BROWSER_ALIVE_IN_SECONDS = 60;\n\nexport class Browser {\n\tconstructor(state, env) {\n\t\tthis.state = state;\n\t\tthis.env = env;\n\t\tthis.keptAliveInSeconds = 0;\n\t\tthis.storage = this.state.storage;\n\t}\n  \n\tasync fetch(request) {\n\t\t// screen resolutions to test out\n\t\tconst width = [1920, 1366, 1536, 360, 414]\n\t\tconst height = [1080, 768, 864, 640, 896]\n\n\t\t// use the current date and time to create a folder structure for R2\n\t\tconst nowDate = new Date()\n\t\tvar coeff = 1000 * 60 * 5\n\t\tvar roundedDate = (new Date(Math.round(nowDate.getTime() / coeff) * coeff)).toString();\n\t\tvar folder = roundedDate.split(&amp;quot; GMT&amp;quot;)[0]\n\n\t\t//if there&amp;#039;s a browser session open, re-use it\n\t\tif (!this.browser) {\n\t\t\tconsole.log(`Browser DO: Starting new instance`);\n\t\t\ttry {\n\t\t\t  this.browser = await puppeteer.launch(this.env.MYBROWSER);\n\t\t\t} catch (e) {\n\t\t\t  console.log(`Browser DO: Could not start browser instance. Error: ${e}`);\n\t\t\t}\n\t\t  }\n\t\t\n\t\t// Reset keptAlive after each call to the DO\n\t\tthis.keptAliveInSeconds = 0;\n\t\t\n\t\tconst page = await this.browser.newPage();\n\n\t\t// take screenshots of each screen size \n\t\tfor (let i = 0; i &amp;lt; width.length; i++) {\n\t\t\tawait page.setViewport({ width: width[i], height: height[i] });\n\t\t\tawait page.goto(&amp;quot;https://workers.cloudflare.com/&amp;quot;);\n\t\t\tconst fileName = &amp;quot;screenshot_&amp;quot; + width[i] + &amp;quot;x&amp;quot; + height[i]\n\t\t\tconst sc = await page.screenshot({\n\t\t\t\tpath: fileName + &amp;quot;.jpg&amp;quot;\n\t\t\t}\n\t\t\t);\n\n\t\t\tthis.env.BUCKET.put(folder + &amp;quot;/&amp;quot;+ fileName + &amp;quot;.jpg&amp;quot;, sc);\n\t\t  }\n\t\t\n\t\t// Reset keptAlive after performing tasks to the DO.\n\t\tthis.keptAliveInSeconds = 0;\n\n\t\t// set the first alarm to keep DO alive\n\t\tlet currentAlarm = await this.storage.getAlarm();\n\t\tif (currentAlarm == null) {\n\t\tconsole.log(`Browser DO: setting alarm`);\n\t\tconst TEN_SECONDS = 10 * 1000;\n\t\tthis.storage.setAlarm(Date.now() + TEN_SECONDS);\n\t\t}\n\t\t\n\t\tawait this.browser.close();\n\t\treturn new Response(&amp;quot;success&amp;quot;);\n\t}\n\n\tasync alarm() {\n\t\tthis.keptAliveInSeconds += 10;\n\t\n\t\t// Extend browser DO life\n\t\tif (this.keptAliveInSeconds &amp;lt; KEEP_BROWSER_ALIVE_IN_SECONDS) {\n\t\t  console.log(`Browser DO: has been kept alive for ${this.keptAliveInSeconds} seconds. Extending lifespan.`);\n\t\t  this.storage.setAlarm(Date.now() + 10 * 1000);\n\t\t} else console.log(`Browser DO: cxceeded life of ${KEEP_BROWSER_ALIVE_IN_SECONDS}. Browser DO will be shut down in 10 seconds.`);\n\t  }\n\n  }&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;That’s it! With less than a hundred lines of code, you can fully customize a powerful tool to automate responsive web design testing. You can even incorporate it into your CI pipeline to automatically test different window sizes with each build and verify the result is as expected by using an automated library like &lt;a href=\&quot;https://www.npmjs.com/package/pixelmatch\&quot;&gt;pixelmatch&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;how-much-will-this-cost\&quot;&gt;How much will this cost?&lt;/h3&gt;\n            &lt;a href=\&quot;#how-much-will-this-cost\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;We’ve spoken to many customers deploying a Puppeteer service on their own infrastructure, on &lt;a href=\&quot;https://www.cloudflare.com/learning/cloud/what-is-a-public-cloud/\&quot;&gt;public cloud containers&lt;/a&gt; or &lt;a href=\&quot;https://www.cloudflare.com/learning/serverless/glossary/function-as-a-service-faas/\&quot;&gt;functions&lt;/a&gt; or using managed services. The common theme that we’ve heard is that these services are costly – costly to maintain and expensive to run.&lt;/p&gt;&lt;p&gt;While you won’t be billed for the Browser Rendering API yet, we want to be transparent with you about costs you start building. We know it’s important to understand the pricing structure so that you don’t get a surprise bill and so that you can design your application efficiently.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6gFIbTnuDafnmpIH2FpQUX/94ce188a354578aae872971f974fd4b4/pasted-image-0--7--2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1316\&quot; height=\&quot;468\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;You pay based on two usage metrics:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Number of sessions: A Browser Session is a new instance of a browser being launched&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Number of concurrent sessions: Concurrent Sessions is the number of browser instances open at once&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Using Durable Objects to persist browser sessions improves performance by eliminating the time that it takes to spin up a new browser session. Since it re-uses sessions, it cuts down on the number of concurrent sessions needed. We highly encourage this model of session re-use if you expect to see consistent traffic for applications that you build on the Browser Rendering API.&lt;/p&gt;&lt;p&gt;If you have feedback about this pricing, we’re all ears. Feel free to reach out through &lt;a href=\&quot;https://discord.gg/8Gs9T6jN\&quot;&gt;Discord&lt;/a&gt; (channel name: browser-rendering-api-beta) and share your thoughts.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;get-started\&quot;&gt;Get Started&lt;/h3&gt;\n            &lt;a href=\&quot;#get-started\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Sign up to our &lt;a href=\&quot;https://www.cloudflare.com/lp/workers-browser-rendering-api/?ref=blog.cloudflare.com&amp;cf_target_id=99BC25CE5278572504B986049859D8A2\&quot;&gt;waitlist&lt;/a&gt; to get access to the Workers Browser Rendering API. We’re so excited to see what you build! Share your creations with us on Twitter/X &lt;a href=\&quot;https://www.twitter.com/cloudflaredev\&quot;&gt;@CloudflareDev&lt;/a&gt; or on our Discord community.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2023-09-28T14:00:38.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:25:53.960Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3OJFuPzbh7O6f2CFrQTfOl/eafe854b1a8cffa1e1233fe25fc85e60/running-serverless-puppeteer-workers-durable-objects.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1Cv5JjXzKWKEA10JdYbXu1&quot;],&quot;name&quot;:[0,&quot;Birthday Week&quot;],&quot;slug&quot;:[0,&quot;birthday-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;]}],[0,{&quot;id&quot;:[0,&quot;5v2UZdTRX1Rw9akmhexnxs&quot;],&quot;name&quot;:[0,&quot;Durable Objects&quot;],&quot;slug&quot;:[0,&quot;durable-objects&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Tanushree Sharma&quot;],&quot;slug&quot;:[0,&quot;tanushree&quot;],&quot;bio&quot;:[0,&quot;Product Manager, Cloudflare Workers&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/77c5gQJtSO9WoLGws7OZef/e429d24838ca9eaa433be9015e69d938/tanushree.jpg&quot;],&quot;location&quot;:[0,&quot;Austin&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@_tanushreeeee&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;We’ve heard from developers that configuring and maintaining their own serverless browser automation systems can be quite painful. The Workers Browser Rendering API solves this&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Running Serverless Puppeteer with Workers and Durable Objects Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/running-serverless-puppeteer-workers-durable-objects&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Running Serverless Puppeteer with Workers and Durable Objects&quot;],&quot;description&quot;:[0,&quot;We’ve heard from developers that configuring and maintaining their own serverless browser automation systems can be quite painful. The Workers Browser Rendering API solves this&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2su2HyYQz8VT1AMWQg5RRs/e7186be164276f500d0e9b875bf4106d/running-serverless-puppeteer-workers-durable-objects-dKLqRb.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;397gVh2vxNiXM0KQCWX7kK&quot;],&quot;title&quot;:[0,&quot;More Node.js APIs in Cloudflare Workers — Streams, Path, StringDecoder&quot;],&quot;slug&quot;:[0,&quot;workers-node-js-apis-stream-path&quot;],&quot;excerpt&quot;:[0,&quot;Today we are announcing support for three additional APIs from Node.js in Cloudflare Workers — stream, crypto, and http/https.request. This increases compatibility with the existing ecosystem of open source NPM packages, allowing you to use your preferred libraries in Workers.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5qJu9MRz57Hr7ADuD0vyvp/1197816c370dcc274b5941ea7675e642/image2-33.png\&quot; alt=\&quot;More Node.js APIs in Cloudflare Workers — Streams, Path, StringDecoder\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1125\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Today we are announcing support for three additional APIs from Node.js in Cloudflare Workers. This increases compatibility with the existing ecosystem of open source npm packages, allowing you to use your preferred libraries in Workers, even if they depend on APIs from Node.js.&lt;/p&gt;&lt;p&gt;We recently &lt;a href=\&quot;/workers-node-js-asynclocalstorage/\&quot;&gt;added support&lt;/a&gt; for AsyncLocalStorage, EventEmitter, Buffer, assert and parts of util. Today, we are adding support for:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Node.js &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/streams\&quot;&gt;Streams&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/path\&quot;&gt;Path&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/nodejs/string-decoder/\&quot;&gt;StringDecoder&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;We are also sharing a preview of a new module type, available in the &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;open-source Workers runtime&lt;/a&gt;, that mirrors a Node.js environment more closely by making some APIs available as globals, and allowing imports without the node: specifier prefix.&lt;/p&gt;&lt;p&gt;You can start using these APIs today, in the &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;open-source runtime&lt;/a&gt; that powers Cloudflare Workers, in local development, and when you deploy your Worker. Get started by &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/nodejs-compatibility/\&quot;&gt;enabling the nodejs_compat compatibility flag&lt;/a&gt; for your Worker.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;stream\&quot;&gt;Stream&lt;/h3&gt;\n            &lt;a href=\&quot;#stream\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The &lt;a href=\&quot;https://nodejs.org/dist/latest-v20.x/docs/api/stream.html\&quot;&gt;Node.js streams API&lt;/a&gt; is the original API for working with streaming data in JavaScript that predates the &lt;a href=\&quot;https://streams.spec.whatwg.org/\&quot;&gt;WHATWG ReadableStream standard&lt;/a&gt;. Now, a full implementation of Node.js streams (based directly on the &lt;a href=\&quot;https://www.npmjs.com/package/readable-stream\&quot;&gt;official implementation&lt;/a&gt; provided by the Node.js project) is available within the Workers runtime.&lt;/p&gt;&lt;p&gt;Let&amp;#39;s start with a quick example:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import {\n  Readable,\n  Transform,\n} from &amp;#039;node:stream&amp;#039;;\n\nimport {\n  text,\n} from &amp;#039;node:stream/consumers&amp;#039;;\n\nimport {\n  pipeline,\n} from &amp;#039;node:stream/promises&amp;#039;;\n\n// A Node.js-style Transform that converts data to uppercase\n// and appends a newline to the end of the output.\nclass MyTransform extends Transform {\n  constructor() {\n    super({ encoding: &amp;#039;utf8&amp;#039; });\n  }\n  _transform(chunk, _, cb) {\n    this.push(chunk.toString().toUpperCase());\n    cb();\n  }\n  _flush(cb) {\n    this.push(&amp;#039;\\n&amp;#039;);\n    cb();\n  }\n}\n\nexport default {\n  async fetch() {\n    const chunks = [\n      &amp;quot;hello &amp;quot;,\n      &amp;quot;from &amp;quot;,\n      &amp;quot;the &amp;quot;,\n      &amp;quot;wonderful &amp;quot;,\n      &amp;quot;world &amp;quot;,\n      &amp;quot;of &amp;quot;,\n      &amp;quot;node.js &amp;quot;,\n      &amp;quot;streams!&amp;quot;\n    ];\n\n    function nextChunk(readable) {\n      readable.push(chunks.shift());\n      if (chunks.length === 0) readable.push(null);\n      else queueMicrotask(() =&amp;gt; nextChunk(readable));\n    }\n\n    // A Node.js-style Readable that emits chunks from the\n    // array...\n    const readable = new Readable({\n      encoding: &amp;#039;utf8&amp;#039;,\n      read() { nextChunk(readable); }\n    });\n\n    const transform = new MyTransform();\n    await pipeline(readable, transform);\n    return new Response(await text(transform));\n  }\n};&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;In this example we create two Node.js stream objects: one stream.Readable and one stream.Transform. The stream.Readable simply emits a sequence of individual strings, piped through the stream.Transform which converts those to uppercase and appends a new-line as a final chunk.&lt;/p&gt;&lt;p&gt;The example is straightforward and illustrates the basic operation of the Node.js API. For anyone already familiar with using standard WHATWG streams in Workers the pattern here should be recognizable.&lt;/p&gt;&lt;p&gt;The Node.js streams API is used by countless numbers of modules published on &lt;a href=\&quot;https://www.npmjs.com/\&quot;&gt;npm&lt;/a&gt;. Now that the Node.js streams API is available in Workers, many packages that depend on it can be used in your Workers. For example, the &lt;a href=\&quot;https://www.npmjs.com/package/split2\&quot;&gt;split2 module&lt;/a&gt; is a simple utility that can break a stream of data up and reassemble it so that every line is a distinct chunk. While simple, the module is downloaded over 13 million times each week and has over a thousand direct dependents on npm (and many more indirect dependents). Previously it was not possible to use split2 within Workers without also pulling in a large and complicated polyfill implementation of streams along with it. Now split2 can be used directly within Workers with no modifications and no additional polyfills. This reduces the size and complexity of your Worker by thousands of lines.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import {\n  PassThrough,\n} from &amp;#039;node:stream&amp;#039;;\n\nimport { default as split2 } from &amp;#039;split2&amp;#039;;\n\nconst enc = new TextEncoder();\n\nexport default {\n  async fetch() {\n    const pt = new PassThrough();\n    const readable = pt.pipe(split2());\n\n    pt.end(&amp;#039;hello\\nfrom\\nthe\\nwonderful\\nworld\\nof\\nnode.js\\nstreams!&amp;#039;);\n    for await (const chunk of readable) {\n      console.log(chunk);\n    }\n\n    return new Response(&amp;quot;ok&amp;quot;);\n  }\n};&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;path\&quot;&gt;Path&lt;/h3&gt;\n            &lt;a href=\&quot;#path\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The &lt;a href=\&quot;https://nodejs.org/api/path.html\&quot;&gt;Node.js Path API&lt;/a&gt; provides utilities for working with file and directory paths. For example:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import path from &amp;quot;node:path&amp;quot;\npath.join(&amp;#039;/foo&amp;#039;, &amp;#039;bar&amp;#039;, &amp;#039;baz/asdf&amp;#039;, &amp;#039;quux&amp;#039;, &amp;#039;..&amp;#039;);\n\n// Returns: &amp;#039;/foo/bar/baz/asdf&amp;#039;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Note that in the Workers implementation of path, the &lt;a href=\&quot;https://nodejs.org/api/path.html#pathwin32\&quot;&gt;path.win32&lt;/a&gt; variants of the path API are not implemented, and will throw an exception.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;stringdecoder\&quot;&gt;StringDecoder&lt;/h3&gt;\n            &lt;a href=\&quot;#stringdecoder\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The &lt;a href=\&quot;https://nodejs.org/dist/latest-v20.x/docs/api/string_decoder.html\&quot;&gt;Node.js StringDecoder API&lt;/a&gt; is a simple legacy utility that predates the &lt;a href=\&quot;https://encoding.spec.whatwg.org/\&quot;&gt;WHATWG standard TextEncoder/TextDecoder API&lt;/a&gt; and serves roughly the same purpose. It is used by Node.js&amp;#39; stream API implementation as well as a number of popular npm modules for the purpose of decoding UTF-8, UTF-16, Latin1, Base64, and Hex encoded data.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import { StringDecoder } from &amp;#039;node:string_decoder&amp;#039;;\nconst decoder = new StringDecoder(&amp;#039;utf8&amp;#039;);\n\nconst cent = Buffer.from([0xC2, 0xA2]);\nconsole.log(decoder.write(cent));\n\nconst euro = Buffer.from([0xE2, 0x82, 0xAC]);\nconsole.log(decoder.write(euro)); &lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;In the vast majority of cases, your Worker should just keep on using the standard TextEncoder/TextDecoder APIs, but the StringDecoder is available directly for workers to use now without relying on polyfills.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;node-js-compat-modules\&quot;&gt;Node.js Compat Modules&lt;/h3&gt;\n            &lt;a href=\&quot;#node-js-compat-modules\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;One Worker can already be a &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/configuration/#bundling\&quot;&gt;bundle of multiple assets&lt;/a&gt;. This allows a single Worker to be made up of multiple individual ESM modules, CommonJS modules, JSON, text, and binary data files.&lt;/p&gt;&lt;p&gt;Soon there will be a new type of module that can be included in a Worker bundles: the NodeJsCompatModule.&lt;/p&gt;&lt;p&gt;A NodeJsCompatModule is designed to emulate the Node.js environment as much as possible. Within these modules, common Node.js global variables such as process, Buffer, and even __filename will be available. More importantly, it is possible to require() our Node.js core API implementations without using the node: specifier prefix. This maximizes compatibility with existing NPM packages that depend on globals from Node.js being present, or don’t import Node.js APIs using the node: specifier prefix.&lt;/p&gt;&lt;p&gt;Support for this new module type has landed in the open source &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;workerd&lt;/a&gt; runtime, with deeper integration with Wrangler coming soon.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;whats-next\&quot;&gt;What’s next&lt;/h3&gt;\n            &lt;a href=\&quot;#whats-next\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;We’re adding support for more Node.js APIs each month, and as we introduce new APIs, they will be added under the &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/compatibility-dates/#nodejs-compatibility-flag\&quot;&gt;nodejs_compat compatibility flag&lt;/a&gt; — no need to take any action or update your &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/compatibility-dates/\&quot;&gt;compatibility date&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Have an NPM package that you wish worked on Workers, or an API you’d like to be able to use? Join the &lt;a href=\&quot;https://discord.com/invite/cloudflaredev\&quot;&gt;Cloudflare Developers Discord&lt;/a&gt; and tell us what you’re building, and what you’d like to see next.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;watch-on-cloudflare-tv\&quot;&gt;Watch on Cloudflare TV&lt;/h3&gt;\n            &lt;a href=\&quot;#watch-on-cloudflare-tv\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;!--kg-card-begin: html--&gt;&lt;div style=\&quot;position: relative; padding-top: 56.25%;\&quot;&gt;&lt;iframe src=\&quot;https://customer-rhnwzxvb3mg4wz3v.cloudflarestream.com/56ddbbea460d0e736d45e6b4944c637d/iframe?preload=true&amp;poster=https%3A%2F%2Fcustomer-rhnwzxvb3mg4wz3v.cloudflarestream.com%2F56ddbbea460d0e736d45e6b4944c637d%2Fthumbnails%2Fthumbnail.jpg%3Ftime%3D1s%26height%3D600\&quot; style=\&quot;border: none; position: absolute; top: 0; left: 0; height: 100%; width: 100%;\&quot; allow=\&quot;accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;\&quot; allowfullscreen=\&quot;true\&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;!--kg-card-end: html--&gt;&quot;],&quot;published_at&quot;:[0,&quot;2023-05-19T14:00:47.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:24:20.082Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1eS5lFYcm5AqqSuCOjwNQf/97e8d25cc2aa0bfbaed65fc420f26432/workers-node-js-apis-stream-path.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;2xCnBweKwOI3VXdYsGVbMe&quot;],&quot;name&quot;:[0,&quot;Developer Week&quot;],&quot;slug&quot;:[0,&quot;developer-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3XzVULQKajbCuWudT6JD0p&quot;],&quot;name&quot;:[0,&quot;Node.js&quot;],&quot;slug&quot;:[0,&quot;node-js&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;James M Snell&quot;],&quot;slug&quot;:[0,&quot;jasnell&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dR6CJtYedvLrkAZ6rxv9I/0db3d5a763a8b0a350ac04ac6410da6b/jasnell.jpg&quot;],&quot;location&quot;:[0,&quot;California&quot;],&quot;website&quot;:[0,&quot;https://bsky.app/profile/jasnell.me&quot;],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Today we are announcing support for three additional APIs from Node.js in Cloudflare Workers — stream, crypto, and http/https.request. This increases compatibility with the existing ecosystem of open source NPM packages, allowing you to use your preferred libraries in Workers.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;More Node.js APIs in Cloudflare Workers — Streams, Path, StringDecoder Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/workers-node-js-apis-stream-path&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0],&quot;description&quot;:[0],&quot;imgPreview&quot;:[0,&quot;&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;3sNrfiJGZc4oDIOguVYgq9&quot;],&quot;title&quot;:[0,&quot;Node.js compatibility for Cloudflare Workers – starting with Async Context Tracking, EventEmitter, Buffer, assert, and util&quot;],&quot;slug&quot;:[0,&quot;workers-node-js-asynclocalstorage&quot;],&quot;excerpt&quot;:[0,&quot;Over the coming months, Cloudflare Workers will start to roll out built-in compatibility with Node.js core APIs as part of an effort to support increased compatibility across JavaScript runtimes&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6YKC6jhVmTt96NeN3UNtQ4/b43fd153bbd2d8f3251a804c7368d96e/image1-43.png\&quot; alt=\&quot;Node.js compatibility for Cloudflare Workers – starting with Async Context Tracking, EventEmitter, Buffer, assert, and util\&quot; class=\&quot;kg-image\&quot; width=\&quot;1810\&quot; height=\&quot;1022\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Over the coming months, Cloudflare Workers will start to roll out built-in compatibility with Node.js core APIs as part of an effort to support increased compatibility across JavaScript runtimes.&lt;/p&gt;&lt;p&gt;We are happy to announce today that the first of these Node.js APIs – &lt;code&gt;AsyncLocalStorage&lt;/code&gt;, &lt;code&gt;EventEmitter&lt;/code&gt;, &lt;code&gt;Buffer&lt;/code&gt;, &lt;code&gt;assert&lt;/code&gt;, and parts of &lt;code&gt;util&lt;/code&gt; – are now available for use. These APIs are provided directly by the &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;open-source Cloudflare Workers runtime&lt;/a&gt;, with no need to bundle polyfill implementations into your own code.&lt;/p&gt;&lt;p&gt;These new APIs are available today — start using them by enabling the &lt;code&gt;nodejs_compat&lt;/code&gt; &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/compatibility-dates/\&quot;&gt;compatibility flag&lt;/a&gt; in your Workers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;async-context-tracking-with-the-asynclocalstorage-api\&quot;&gt;Async Context Tracking with the AsyncLocalStorage API&lt;/h3&gt;\n            &lt;a href=\&quot;#async-context-tracking-with-the-asynclocalstorage-api\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The &lt;code&gt;AsyncLocalStorage&lt;/code&gt; API provides a way to track context across asynchronous operations. It allows you to pass a value through your program, even across multiple layers of asynchronous code, without having to pass a context value between operations.&lt;/p&gt;&lt;p&gt;Consider an example where we want to add debug logging that works through multiple layers of an application, where each log contains the ID of the current request. Without AsyncLocalStorage, it would be necessary to explicitly pass the request ID down through every function call that might invoke the logging function:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;function logWithId(id, state) {\n  console.log(`${id} - ${state}`);\n}\n\nfunction doSomething(id) {\n  // We don&amp;#039;t actually use id for anything in this function!\n  // It&amp;#039;s only here because logWithId needs it.\n  logWithId(id, &amp;quot;doing something&amp;quot;);\n  setTimeout(() =&amp;gt; doSomethingElse(id), 10);\n}\n\nfunction doSomethingElse(id) {\n  logWithId(id, &amp;quot;doing something else&amp;quot;);\n}\n\nlet idSeq = 0;\n\nexport default {\n  async fetch(req) {\n    const id = idSeq++;\n    doSomething(id);\n    logWithId(id, &amp;#039;complete&amp;#039;);\n    return new Response(&amp;quot;ok&amp;quot;);\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;While this approach works, it can be cumbersome to coordinate correctly, especially as the complexity of an application grows. Using &lt;code&gt;AsyncLocalStorage&lt;/code&gt; this becomes significantly easier by eliminating the need to explicitly pass the context around. Our application functions (&lt;code&gt;doSomething&lt;/code&gt; and &lt;code&gt;doSomethingElse&lt;/code&gt; in this case) never need to know about the request ID at all while the &lt;code&gt;logWithId&lt;/code&gt; function does exactly what we need it to:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import { AsyncLocalStorage } from &amp;#039;node:async_hooks&amp;#039;;\n\nconst requestId = new AsyncLocalStorage();\n\nfunction logWithId(state) {\n  console.log(`${requestId.getStore()} - ${state}`);\n}\n\nfunction doSomething() {\n  logWithId(&amp;quot;doing something&amp;quot;);\n  setTimeout(() =&amp;gt; doSomethingElse(), 10);\n}\n\nfunction doSomethingElse() {\n  logWithId(&amp;quot;doing something else&amp;quot;);\n}\n\nlet idSeq = 0;\n\nexport default {\n  async fetch(req) {\n    return requestId.run(idSeq++, () =&amp;gt; {\n      doSomething();\n      logWithId(&amp;#039;complete&amp;#039;);\n      return new Response(&amp;quot;ok&amp;quot;);\n    });\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;With the &lt;code&gt;nodejs_compat&lt;/code&gt; &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/compatibility-dates/\&quot;&gt;compatibility flag&lt;/a&gt; enabled, import statements are used to access specific APIs. The Workers implementation of these APIs requires the use of the node: specifier prefix that was introduced recently in Node.js (e.g. &lt;code&gt;node:async_hooks&lt;/code&gt;, &lt;code&gt;node:events&lt;/code&gt;, etc)&lt;/p&gt;&lt;p&gt;We implement &lt;a href=\&quot;https://github.com/wintercg/proposal-common-minimum-api/blob/main/asynclocalstorage.md\&quot;&gt;a subset&lt;/a&gt; of the &lt;code&gt;AsyncLocalStorage&lt;/code&gt; API in order to keep things as simple as possible. Specifically, we&amp;#39;ve chosen not to support the &lt;code&gt;enterWith()&lt;/code&gt; and &lt;code&gt;disable()&lt;/code&gt; APIs that are found in Node.js implementation simply because they make async context tracking more brittle and error prone.&lt;/p&gt;&lt;p&gt;Conceptually, at any given moment within a worker, there is a current &amp;quot;Asynchronous Context Frame&amp;quot;, which consists of a map of storage cells, each holding a store value for a specific &lt;code&gt;AsyncLocalStorage&lt;/code&gt; instance. Calling &lt;code&gt;asyncLocalStorage.run(...)&lt;/code&gt; causes a new frame to be created, inheriting the storage cells of the current frame, but using the newly provided store value for the cell associated with &lt;code&gt;asyncLocalStorage&lt;/code&gt;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;const als1 = new AsyncLocalStorage();\nconst als2 = new AsyncLocalStorage();\n\n// Code here runs in the root frame. There are two storage cells,\n// one for als1, and one for als2. The store value for each is\n// undefined.\n\nals1.run(123, () =&amp;gt; {\n  // als1.run(...) creates a new frame (1). The store value for als1\n  // is set to 123, the store value for als2 is still undefined.\n  // This new frame is set to &amp;quot;current&amp;quot;.\n\n  als2.run(321, () =&amp;gt; {\n    // als2.run(...) creates another new frame (2). The store value\n    // for als1 is still 123, the store value for als2 is set to 321.\n    // This new frame is set to &amp;quot;current&amp;quot;.\n    console.log(als1.getStore(), als2.getStore());\n  });\n\n  // Frame (1) is restored as the current. The store value for als1\n  // is still 123, but the store value for als2 is undefined again.\n});\n\n// The root frame is restored as the current. The store values for\n// both als1 and als2 are both undefined again.&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Whenever an asynchronous operation is initiated in JavaScript, for example, creating a new JavaScript promise, scheduling a timer, etc, the current frame is captured and associated with that operation, allowing the store values at the moment the operation was initialized to be propagated and restored as needed.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;const als = new AsyncLocalStorage();\nconst p1 = als.run(123, () =&amp;gt; {\n  return promise.resolve(1).then(() =&amp;gt; console.log(als.getStore());\n});\n\nconst p2 = promise.resolve(1); \nconst p3 = als.run(321, () =&amp;gt; {\n  return p2.then(() =&amp;gt; console.log(als.getStore()); // prints 321\n});\n\nals.run(&amp;#039;ABC&amp;#039;, () =&amp;gt; setInterval(() =&amp;gt; {\n  // prints &amp;quot;ABC&amp;quot; to the console once a second…\n  setInterval(() =&amp;gt; console.log(als.getStore(), 1000);\n});\n\nals.run(&amp;#039;XYZ&amp;#039;, () =&amp;gt; queueMicrotask(() =&amp;gt; {\n  console.log(als.getStore());  // prints &amp;quot;XYZ&amp;quot;\n}));&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Note that for unhandled promise rejections, the &amp;quot;&lt;code&gt;unhandledrejection&lt;/code&gt;&amp;quot; event will automatically propagate the context that is associated with the promise that was rejected. This behavior is different from other types of events emitted by &lt;code&gt;EventTarget&lt;/code&gt; implementations, which will propagate whichever frame is current when the event is emitted.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;const asyncLocalStorage = new AsyncLocalStorage();\n\nasyncLocalStorage.run(123, () =&amp;gt; Promise.reject(&amp;#039;boom&amp;#039;));\nasyncLocalStorage.run(321, () =&amp;gt; Promise.reject(&amp;#039;boom2&amp;#039;));\n\naddEventListener(&amp;#039;unhandledrejection&amp;#039;, (event) =&amp;gt; {\n  // prints 123 for the first unhandled rejection (&amp;#039;boom&amp;#039;), and\n  // 321 for the second unhandled rejection (&amp;#039;boom2&amp;#039;)\n  console.log(asyncLocalStorage.getStore());\n});&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Workers can use the &lt;code&gt;AsyncLocalStorage.snapshot()&lt;/code&gt; method to create their own objects that capture and propagate the context:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;const asyncLocalStorage = new AsyncLocalStorage();\n\nclass MyResource {\n  #runInAsyncFrame = AsyncLocalStorage.snapshot();\n\n  doSomething(...args) {\n    return this.#runInAsyncFrame((...args) =&amp;gt; {\n      console.log(asyncLocalStorage.getStore());\n    }, ...args);\n  }\n}\n\nconst resource1 = asyncLocalStorage.run(123, () =&amp;gt; new MyResource());\nconst resource2 = asyncLocalStorage.run(321, () =&amp;gt; new MyResource());\n\nresource1.doSomething();  // prints 123\nresource2.doSomething();  // prints 321&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;For more, refer to the &lt;a href=\&quot;https://nodejs.org/dist/latest-v18.x/docs/api/async_context.html#class-asynclocalstorage\&quot;&gt;Node.js documentation&lt;/a&gt; about the &lt;code&gt;AsyncLocalStorage&lt;/code&gt; API.&lt;/p&gt;&lt;p&gt;There is currently an effort underway to add a new &lt;a href=\&quot;https://github.com/tc39/proposal-async-context\&quot;&gt;AsyncContext&lt;/a&gt; mechanism (inspired by &lt;code&gt;AsyncLocalStorage&lt;/code&gt;) to the JavaScript language itself. While it is still early days for the TC-39 proposal, there is good reason to expect it to progress through the committee. Once it does, we look forward to being able to make it available in the Cloudflare Workers platform. We expect our implementation of &lt;code&gt;AsyncLocalStorage&lt;/code&gt; to be compatible with this new API.&lt;/p&gt;&lt;p&gt;The proposal for AsyncContext provides an excellent set of examples and &lt;a href=\&quot;https://github.com/tc39/proposal-async-context#motivation\&quot;&gt;description of the motivation&lt;/a&gt; of why async context tracking is useful.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;events-with-eventemitter\&quot;&gt;Events with EventEmitter&lt;/h3&gt;\n            &lt;a href=\&quot;#events-with-eventemitter\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The EventEmitter API is one of the most fundamental Node.js APIs and is critical to supporting many other higher level APIs, including streams, crypto, net, and more. An EventEmitter is an object that emits named events that cause listeners to be called.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import { EventEmitter } from &amp;#039;node:events&amp;#039;;\n\nconst emitter = new EventEmitter();\nemitter.on(&amp;#039;hello&amp;#039;, (...args) =&amp;gt; {\n  console.log(...args);\n});\n\nemitter.emit(&amp;#039;hello&amp;#039;, 1, 2, 3);&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The &lt;a href=\&quot;https://github.com/cloudflare/workerd/blob/main/src/node/internal/events.ts\&quot;&gt;implementation&lt;/a&gt; in the Workers runtime fully supports the entire Node.js EventEmitter API including the captureRejections option that allows improved handling of async functions as event handlers:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;const emitter = new EventEmitter({ captureRejections: true });\nemitter.on(&amp;#039;hello&amp;#039;, async (...args) =&amp;gt; {\n  throw new Error(&amp;#039;boom&amp;#039;);\n});\nemitter.on(&amp;#039;error&amp;#039;, (err) =&amp;gt; {\n  // the async promise rejection is emitted here!\n});&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Please refer to the Node.js documentation for more details on the use of the &lt;code&gt;EventEmitter&lt;/code&gt; API: &lt;a href=\&quot;https://nodejs.org/dist/latest-v19.x/docs/api/events.html#events\&quot;&gt;https://nodejs.org/dist/latest-v19.x/docs/api/events.html#events&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;buffer\&quot;&gt;Buffer&lt;/h3&gt;\n            &lt;a href=\&quot;#buffer\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The &lt;code&gt;Buffer&lt;/code&gt; API in Node.js predates the introduction of the standard TypedArray and DataView APIs in JavaScript by many years and has persisted as one of the most commonly used Node.js APIs for manipulating binary data. Today, every Buffer instance extends from the standard Uint8Array class but adds a range of unique capabilities such as built-in base64 and hex encoding/decoding, byte-order manipulation, and encoding-aware substring searching.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import { Buffer } from &amp;#039;node:buffer&amp;#039;;\n\nconst buf = Buffer.from(&amp;#039;hello world&amp;#039;, &amp;#039;utf8&amp;#039;);\n\nconsole.log(buf.toString(&amp;#039;hex&amp;#039;));\n// Prints: 68656c6c6f20776f726c64\nconsole.log(buf.toString(&amp;#039;base64&amp;#039;));\n// Prints: aGVsbG8gd29ybGQ=&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Because a Buffer extends from Uint8Array, it can be used in any workers API that currently accepts Uint8Array, such as creating a new Response:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;const response = new Response(Buffer.from(&amp;quot;hello world&amp;quot;));&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Or interacting with streams:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;const writable = getWritableStreamSomehow();\nconst writer = writable.getWriter();\nwriter.write(Buffer.from(&amp;quot;hello world&amp;quot;));&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Please refer to the Node.js documentation for more details on the use of the Buffer API: &lt;a href=\&quot;https://nodejs.org/dist/latest-v19.x/docs/api/buffer.html\&quot;&gt;https://nodejs.org/dist/latest-v19.x/docs/api/buffer.html&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;assertions\&quot;&gt;Assertions&lt;/h3&gt;\n            &lt;a href=\&quot;#assertions\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The assert module in Node.js provides a number of useful assertions that are useful when building tests.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import {\n  strictEqual,\n  deepStrictEqual,\n  ok,\n  doesNotReject,\n} from &amp;#039;node:assert&amp;#039;;\n\nstrictEqual(1, 1); // ok!\nstrictEqual(1, &amp;quot;1&amp;quot;); // fails! throws AssertionError\n\ndeepStrictEqual({ a: { b: 1 }}, { a: { b: 1 }});// ok!\ndeepStrictEqual({ a: { b: 1 }}, { a: { b: 2 }});// fails! throws AssertionError\n\nok(true); // ok!\nok(false); // fails! throws AssertionError\n\nawait doesNotReject(async () =&amp;gt; {}); // ok!\nawait doesNotReject(async () =&amp;gt; { throw new Error(&amp;#039;boom&amp;#039;) }); // fails! throws AssertionError&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;In the Workers implementation of assert, all assertions run in what Node.js calls the &amp;quot;&lt;a href=\&quot;https://nodejs.org/dist/latest-v19.x/docs/api/assert.html#strict-assertion-mode\&quot;&gt;strict assertion mode&lt;/a&gt;&amp;quot;, which means that non-strict methods behave like their corresponding strict methods. For instance, &lt;code&gt;deepEqual()&lt;/code&gt; will behave like &lt;code&gt;deepStrictEqual()&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Please refer to the Node.js documentation for more details on the use of the assertion API: &lt;a href=\&quot;https://nodejs.org/dist/latest-v19.x/docs/api/assert.html\&quot;&gt;https://nodejs.org/dist/latest-v19.x/docs/api/assert.html&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;promisify-callbackify\&quot;&gt;Promisify/Callbackify&lt;/h3&gt;\n            &lt;a href=\&quot;#promisify-callbackify\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The &lt;code&gt;promisify&lt;/code&gt; and callbackify APIs in Node.js provide a means of bridging between a Promise-based programming model and a callback-based model.&lt;/p&gt;&lt;p&gt;The &lt;code&gt;promisify&lt;/code&gt; method allows taking a Node.js-style callback function and converting it into a Promise-returning async function:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import { promisify } from &amp;#039;node:util&amp;#039;;\n\nfunction foo(args, callback) {\n  try {\n    callback(null, 1);\n  } catch (err) {\n    // Errors are emitted to the callback via the first argument.\n    callback(err);\n  }\n}\n\nconst promisifiedFoo = promisify(foo);\nawait promisifiedFoo(args);&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Similarly, callbackify converts a Promise-returning async function into a Node.js-style callback function:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import { callbackify } from &amp;#039;node:util&amp;#039;;\n\nasync function foo(args) {\n  throw new Error(&amp;#039;boom&amp;#039;);\n}\n\nconst callbackifiedFoo = callbackify(foo);\n\ncallbackifiedFoo(args, (err, value) =&amp;gt; {\n  if (err) throw err;\n});&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Together these utilities make it easy to properly handle all of the generally tricky nuances involved with properly bridging between callbacks and promises.&lt;/p&gt;&lt;p&gt;Please refer to the Node.js documentation for more information on how to use these APIs: &lt;a href=\&quot;https://nodejs.org/dist/latest-v19.x/docs/api/util.html#utilcallbackifyoriginal\&quot;&gt;https://nodejs.org/dist/latest-v19.x/docs/api/util.html#utilcallbackifyoriginal&lt;/a&gt;, &lt;a href=\&quot;https://nodejs.org/dist/latest-v19.x/docs/api/util.html#utilpromisifyoriginal\&quot;&gt;https://nodejs.org/dist/latest-v19.x/docs/api/util.html#utilpromisifyoriginal&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;type-brand-checking-with-util-types\&quot;&gt;Type brand-checking with util.types&lt;/h3&gt;\n            &lt;a href=\&quot;#type-brand-checking-with-util-types\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The util.types API provides a reliable and generally more efficient way of checking that values are instances of various built-in types.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import { types } from &amp;#039;node:util&amp;#039;;\n\ntypes.isAnyArrayBuffer(new ArrayBuffer());  // Returns true\ntypes.isAnyArrayBuffer(new SharedArrayBuffer());  // Returns true\ntypes.isArrayBufferView(new Int8Array());  // true\ntypes.isArrayBufferView(Buffer.from(&amp;#039;hello world&amp;#039;)); // true\ntypes.isArrayBufferView(new DataView(new ArrayBuffer(16)));  // true\ntypes.isArrayBufferView(new ArrayBuffer());  // false\nfunction foo() {\n  types.isArgumentsObject(arguments);  // Returns true\n}\ntypes.isAsyncFunction(function foo() {});  // Returns false\ntypes.isAsyncFunction(async function foo() {});  // Returns true\n// .. and so on&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Please refer to the Node.js documentation for more information on how to use the type check APIs: &lt;a href=\&quot;https://nodejs.org/dist/latest-v19.x/docs/api/util.html#utiltypes\&quot;&gt;https://nodejs.org/dist/latest-v19.x/docs/api/util.html#utiltypes&lt;/a&gt;. The workers implementation currently does not provide implementations of the &lt;code&gt;util.types.isExternal()&lt;/code&gt;, &lt;code&gt;util.types.isProxy()&lt;/code&gt;, &lt;code&gt;util.types.isKeyObject()&lt;/code&gt;, or &lt;code&gt;util.type.isWebAssemblyCompiledModule()&lt;/code&gt; APIs.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;whats-next\&quot;&gt;What&amp;#39;s next&lt;/h3&gt;\n            &lt;a href=\&quot;#whats-next\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Keep your eyes open for more Node.js core APIs coming to Cloudflare Workers soon! We currently have implementations of the string decoder, streams and crypto APIs in active development. These will be introduced into the workers runtime incrementally over time and any worker using the &lt;code&gt;nodejs_compat&lt;/code&gt; compatibility flag will automatically pick up the new modules as they are added.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2023-03-23T13:05:00.000+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:23:33.623Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1k2cY3yKZIuzqd1wRuvwoQ/e90c731127209536cd983f5e8fdf0b91/workers-node-js-asynclocalstorage.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3XzVULQKajbCuWudT6JD0p&quot;],&quot;name&quot;:[0,&quot;Node.js&quot;],&quot;slug&quot;:[0,&quot;node-js&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;James M Snell&quot;],&quot;slug&quot;:[0,&quot;jasnell&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dR6CJtYedvLrkAZ6rxv9I/0db3d5a763a8b0a350ac04ac6410da6b/jasnell.jpg&quot;],&quot;location&quot;:[0,&quot;California&quot;],&quot;website&quot;:[0,&quot;https://bsky.app/profile/jasnell.me&quot;],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Over the coming months, Cloudflare Workers will start to roll out built-in compatibility with Node.js core APIs as part of an effort to support increased compatibility across JavaScript runtimes.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Node.js compatibility for Cloudflare Workers – starting with Async Context Tracking, EventEmitter, Buffer, assert, and util Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/workers-node-js-asynclocalstorage&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Node.js compatibility for Cloudflare Workers – starting with Async Context Tracking, EventEmitter, Buffer, assert, and util&quot;],&quot;description&quot;:[0,&quot;Over the coming months, Cloudflare Workers will start to roll out built-in compatibility with Node.js core APIs as part of an effort to support increased compatibility across JavaScript runtimes.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/61Ykz9S3MgLQpFI9DGPagV/591a02117e1c60bbcd9175b6e98d4133/workers-node-js-asynclocalstorage-CiVT0I.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;28F5CUkoJfMahoWir47MND&quot;],&quot;title&quot;:[0,&quot;Locking down your JavaScript: positive blocking with Page Shield policies&quot;],&quot;slug&quot;:[0,&quot;page-shield-positive-blocking-policies&quot;],&quot;excerpt&quot;:[0,&quot;Starting today, using Page Shield, Cloudflare’s client side security solution, you can ensure only vetted and secure JavaScript is being executed by your user’s browsers. Stop unwanted JavaScript and keep your end user data safe with Page Shield policies.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/72U4mGkIMlR2xtRGMJpNhN/ed196886c95d2b2f27e63c5141df7f22/image3-10.png\&quot; alt=\&quot;Locking down your JavaScript: positive blocking with Page Shield policies\&quot; class=\&quot;kg-image\&quot; width=\&quot;1201\&quot; height=\&quot;675\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Web development teams are tasked with delivering feature-rich applications at lightning speeds. To help them, there are thousands of pre-built JavaScript libraries that they can integrate with little effort.&lt;/p&gt;&lt;p&gt;Not always, however, are these libraries backed with hardened security measures to ensure the code they provide is not tampered with by malicious actors. This ultimately leads to an increased risk of an application being compromised.&lt;/p&gt;&lt;p&gt;Starting today, tackling the risk of external JavaScript libraries just got easier. We are adding a new feature to our client side security solution: &lt;a href=\&quot;https://www.cloudflare.com/page-shield/\&quot;&gt;Page Shield&lt;/a&gt; policies. Using policies you can now ensure only allowed and vetted libraries are executed by your application by simply reviewing a checklist.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;client-side-libraries\&quot;&gt;Client side libraries&lt;/h2&gt;\n            &lt;a href=\&quot;#client-side-libraries\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;There are more than 4,373 libraries available on &lt;a href=\&quot;https://cdnjs.com/\&quot;&gt;cdnjs&lt;/a&gt;, a popular JavaScript repository, at the time of writing. These libraries provide access to pre-built functionality to build web applications. The screenshot below shows the most popular on the platform such as &lt;a href=\&quot;https://reactjs.org/\&quot;&gt;React&lt;/a&gt;, &lt;a href=\&quot;https://vuejs.org/\&quot;&gt;Vue.js&lt;/a&gt; and &lt;a href=\&quot;https://getbootstrap.com/\&quot;&gt;Bootstrap&lt;/a&gt;. Bootstrap alone, according to W3Techs, is used &lt;a href=\&quot;https://w3techs.com/technologies/overview/javascript_library\&quot;&gt;on more than 20% of all websites&lt;/a&gt;.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5czifSwe8ugZHJ9pjNlLTw/3b121f648aa38c9c141e3979d8b5b17f/image1-14.png\&quot; alt=\&quot;A list of the most popular libraries on cdnjs\&quot; class=\&quot;kg-image\&quot; width=\&quot;1810\&quot; height=\&quot;1250\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;In addition to library repositories like cdnjs, there are thousands of plugins provided directly by SaaS platforms including from names such as Google, Meta, Microsoft, and more.&lt;/p&gt;&lt;p&gt;According to our Page Shield data, any large enterprise application is loading &lt;b&gt;AND&lt;/b&gt; connecting to tens if not hundreds of different destinations for analytics, payments, real user monitoring, conversion tracking, customer relationship management, and many other features that internal teams “must have”.&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;style type=\&quot;text/css\&quot;&gt;\n.tg  {border-collapse:collapse;border-color:#ccc;border-spacing:0;}\n.tg td{background-color:#fff;border-color:#ccc;border-style:solid;border-width:1px;color:#333;\n  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}\n.tg th{background-color:#f0f0f0;border-color:#ccc;border-style:solid;border-width:1px;color:#333;\n  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}\n.tg .tg-baqh{text-align:center;vertical-align:top}\n.tg .tg-xmkd{background-color:#EFEFEF;text-align:center;vertical-align:top}\n&lt;/style&gt;\n&lt;table class=\&quot;tg\&quot; width=\&quot;100%\&quot;&gt;\n&lt;thead&gt;\n  &lt;tr&gt;\n    &lt;th class=\&quot;tg-xmkd\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Script hosts&lt;/span&gt;&lt;br&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;(JavaScript loaded from...)&lt;/span&gt;&lt;/th&gt;\n    &lt;th class=\&quot;tg-xmkd\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Connection hosts &lt;/span&gt;&lt;br&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;(Data sent to...)&lt;/span&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Google&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Google&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Facebook&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Facebook&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Cloudflare&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Microsoft&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Salesforce&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Hotjar&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Prospect One&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;OneTrust&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Open JS Foundation&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Pinterest&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Microsoft&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;TikTok&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Hotjar&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;PayPal&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;hCaptcha&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Snapchat&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;Fly.io&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-baqh\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;NewRelic&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;Ultimately, it is hard for most organizations to not rely on external JavaScript libraries.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;yet-another-vector-for-attackers\&quot;&gt;Yet another vector for attackers&lt;/h2&gt;\n            &lt;a href=\&quot;#yet-another-vector-for-attackers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Although there are good reasons to embed external JavaScript in an application, the proliferation of client side libraries, especially from SaaS providers, has increased scrutiny from malicious actors seeking new ways to exploit web applications. A single compromised SaaS provider that offers a client side library can provide direct access to thousands of applications drastically increasing return on “hacker” investment.&lt;/p&gt;&lt;p&gt;Client side security issues are not new. Attacks such as “&lt;a href=\&quot;https://en.wikipedia.org/wiki/Web_skimming\&quot;&gt;web skimming&lt;/a&gt;”, also referred to as “Magecart-style” when in the context of payment pages, have been around for a long time. Yet, core &lt;a href=\&quot;https://www.cloudflare.com/application-services/solutions/\&quot;&gt;application security products&lt;/a&gt; often focus on protecting the underlying web application rather than the end user data resulting in a &lt;a href=\&quot;https://www.cloudflare.com/learning/security/what-is-an-attack-surface/\&quot;&gt;large attack surface&lt;/a&gt; that most security teams simply have no visibility on. This gap in visibility, caused by “&lt;a href=\&quot;https://www.cloudflare.com/learning/security/what-is-a-supply-chain-attack/\&quot;&gt;supply chains&lt;/a&gt;”, led us to build &lt;a href=\&quot;/introducing-page-shield/\&quot;&gt;Page Shield&lt;/a&gt;, Cloudflare’s native client-side security solution.&lt;/p&gt;&lt;p&gt;Although the risk of supply chain attacks is becoming widely known, they are still very much an active threat. New research is being published monthly from vendors in this space highlighting ongoing attack campaigns. The Payment Card Industry Security Standards Council has also introduced new requirements in &lt;a href=\&quot;https://blog.pcisecuritystandards.org/pci-dss-v4-0-resource-hub\&quot;&gt;PCI DSS 4.0&lt;/a&gt;* that enforce companies to have &lt;a href=\&quot;https://www.cloudflare.com/learning/privacy/what-is-pci-dss-compliance/\&quot;&gt;systems and processes&lt;/a&gt; in place to tackle client side security threats.&lt;/p&gt;&lt;p&gt;Page Shield itself has already been effective at warning customers of ongoing attacks on their applications, such as the screenshot below highlighting an active malicious outbound connection from a Magecart-style attack on a customer e-commerce application.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6SG4JmBvsppxxCQv3O67L2/f381b9e23b62496555cca45e72dabba0/image5-2.png\&quot; alt=\&quot;Page Shield detecting an active exploit on a customer website\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;393\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7xgWKk4Vh8USmts82AWUCH/0d8d436e8418ab236fa39886e3506258/image6-4.png\&quot; alt=\&quot;Connection details indicating the active exploit on a customer website\&quot; class=\&quot;kg-image\&quot; width=\&quot;1700\&quot; height=\&quot;1006\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;* PCI DSS 4.0 requirements 6.4.3 and 11.6.1 are just two examples focusing on client side security.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;reducing-the-attack-surface\&quot;&gt;Reducing the attack surface&lt;/h2&gt;\n            &lt;a href=\&quot;#reducing-the-attack-surface\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Page Shield aims to detect and alert whenever malicious activity is found within the client environment. That’s still a core focus as we improve detection capabilities further.&lt;/p&gt;&lt;p&gt;We are now also looking at expanding capabilities to also reduce the opportunity for an attacker to compromise an application in the first place. In other words, prevent attacks happening by reducing the attack surface available.&lt;/p&gt;&lt;p&gt;Today we are announcing our first major feature in this space: Page Shield policies. Here’s what it looks like:&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1tfGiisqgDNNi4fMVnMezY/82e81839fd18fda628bc1047223790ea/image7-1.png\&quot; alt=\&quot;Page Shield’s new policies feature\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1092\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;positive-blocking-policies\&quot;&gt;Positive blocking policies&lt;/h3&gt;\n            &lt;a href=\&quot;#positive-blocking-policies\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;By leveraging our position in the network stack as a reverse proxy, and by using Page Shield policies, you can now enforce client browsers to load and execute JavaScript libraries only from your pre-approved list of allowed sources implementing a positive security model.&lt;/p&gt;&lt;p&gt;This ensures that an attacker that is able to inject a script in a page, won’t be successful in compromising users, as browsers will refuse to load it. At the same time, vetted tools will run without issues.&lt;/p&gt;&lt;p&gt;Policies will also soon allow you to specify data destinations (connection endpoints) also enforcing not only where JavaScript files are being loaded from, but also where the browser can send data to drastically reduce the risk of “Magecart-style” attacks.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;csps-as-the-core-mechanism\&quot;&gt;CSPs as the core mechanism&lt;/h3&gt;\n            &lt;a href=\&quot;#csps-as-the-core-mechanism\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Page Shield policies are currently implemented with &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\&quot;&gt;Content Security Policies&lt;/a&gt; (CSPs), a feature natively supported by all major browsers.&lt;/p&gt;&lt;p&gt;CSPs are specially formatted HTTP response headers that are added to HTML page loads. These headers may contain one or more directives that instruct the browser how to and what to execute in the context of the given page.&lt;/p&gt;&lt;p&gt;From today Page Shield policies support the &lt;code&gt;script-src&lt;/code&gt; directive. This directive lets application owners specify “where” JavaScript files are allowed to be loaded from. Support for the &lt;code&gt;connect-src&lt;/code&gt; directive is also being finalized which behaves similarly to &lt;code&gt;script-src&lt;/code&gt;, but specifies where the browser is allowed to send data “to”.&lt;/p&gt;&lt;p&gt;Let’s take a look at a one example and assume we were opening the following web page &lt;code&gt;www.example.com/index.html&lt;/code&gt; and the browser received a CSP header as below:&lt;/p&gt;&lt;p&gt;&lt;code&gt;Content-Security-Policy: script-src &amp;#39;self&amp;#39; *.example.com cdnjs.cloudflare.com https://www.google-analytics.com/analytics.js&lt;/code&gt;&lt;/p&gt;&lt;p&gt;The header instructs the browser to allow scripts (defined by the use of the &lt;code&gt;script-src&lt;/code&gt; directive) to be loaded from the same hostname as the page itself (defined by &lt;code&gt;self&lt;/code&gt;) as well as from any subdomain (&lt;code&gt;*.example.com&lt;/code&gt;). It is additionally allowing any script under cdnjs and only a specific script for Google Analytics and no other scripts under the Google owned domain.&lt;/p&gt;&lt;p&gt;This ensures that any attacker injected script from different hosts would not be executed, drastically reducing the attack surface available.&lt;/p&gt;&lt;p&gt;If rather than &lt;code&gt;Content-Security-Policy&lt;/code&gt; we had received a &lt;code&gt;Content-Security-Policy-Report-Only&lt;/code&gt; header, the policy would not be enforced, but browsers would only send violation reports letting you know what is outside of policy.&lt;/p&gt;&lt;p&gt;This is useful when testing and when investigating new scripts that have been added to your application.&lt;/p&gt;&lt;p&gt;Additional statements are also available and supported by Page Shield within the &lt;code&gt;script-src&lt;/code&gt; directive to block inline JavaScript (&lt;code&gt;unsafe-inline&lt;/code&gt;) or normally unsafe function calls (&lt;code&gt;unsafe-eval&lt;/code&gt;). These directives help prevent other attack types such as &lt;a href=\&quot;https://www.cloudflare.com/learning/security/how-to-prevent-xss-attacks/\&quot;&gt;cross site scripting attacks (XSS)&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;making-policy-management-easy\&quot;&gt;Making policy management easy&lt;/h3&gt;\n            &lt;a href=\&quot;#making-policy-management-easy\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;CSPs, the underlying system used by Page Shield policies, are great but hard to manage. The larger the application, the more complex CSPs become while also causing a bottleneck for application development teams. This leads to CSPs becoming ineffective as security teams broaden the list of allowed hosts to the point that their purpose becomes debatable.&lt;/p&gt;&lt;p&gt;Making policy management easy, and ensuring they are effective, was a core goal of our design process. This led us to build a suggestions feature.&lt;/p&gt;&lt;p&gt;When deploying a policy, the first step is deciding “where” will the policy be applied to. Typical examples may include only your checkout flow or admin pages. This is done using &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/rules-language/\&quot;&gt;wirefilter syntax&lt;/a&gt;, the same syntax that powers &lt;a href=\&quot;https://www.cloudflare.com/waf/\&quot;&gt;Cloudflare’s WAF&lt;/a&gt;.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5grJjTZkxtafDfDnKd1t8R/d0735f9410c8b1946663ba1f3d98af93/image4-9.png\&quot; alt=\&quot;Defining the policy scope\&quot; class=\&quot;kg-image\&quot; width=\&quot;1380\&quot; height=\&quot;562\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Once the filter is specified, using the data already collected by Page Shield, the interface will provide a list of suggested directive values, making it very easy to build the simplest and most effective policy for your application. No need to worry about syntax, the policy preview will be shown before committing.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4Hc6rVyXxcDfEtIIayEHTF/e6e7fb1108aabbb7db561804f672e486/image2-8.png\&quot; alt=\&quot;Page Shield’s policy suggestions interface\&quot; class=\&quot;kg-image\&quot; width=\&quot;1390\&quot; height=\&quot;1020\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Finally, policies can be deployed both in “report only/log” and “enforce/allow”, letting you control and test as required.&lt;/p&gt;&lt;p&gt;We are currently finishing work on our alerting backend to warn you whenever we notice a spike in violation reports. This lets you easily return to the policy builder and update it with any newly seen script that may have been added by your development team.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;positive-blocking-policies-are-not-enough\&quot;&gt;Positive blocking policies are not enough&lt;/h3&gt;\n            &lt;a href=\&quot;#positive-blocking-policies-are-not-enough\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;It is important not to forget that CSPs provide no security or malicious activity detection within the list of allowed endpoints. They are meant to reduce the likelihood of an attack happening by reducing the attack surface available. For this reason, Page Shield’s automated malicious activity detection will continue to function in the background regardless of any policy being deployed.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;secure-your-end-user-data-today\&quot;&gt;Secure your end user data today&lt;/h2&gt;\n            &lt;a href=\&quot;#secure-your-end-user-data-today\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;All Cloudflare paid customers have access to a subset of &lt;a href=\&quot;https://www.cloudflare.com/page-shield/\&quot;&gt;Page Shield&lt;/a&gt; features today. Turning on Page Shield is as simple as clicking a button. Head over to &lt;b&gt;Security&lt;/b&gt; &amp;gt; &lt;b&gt;Page Shield&lt;/b&gt; and give it a go!&lt;/p&gt;&lt;p&gt;If you are an enterprise customer and are interested in Page Shield policies, reach out to your account team to get access to the full feature set.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2023-03-13T13:00:00.000+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:23:08.857Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3QqRf8Pp8SpSokNQ9ypFuu/5f1a35b23155f13a1f84e8415211e5c8/page-shield-positive-blocking-policies.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}],[0,{&quot;id&quot;:[0,&quot;6stQ7u3dAyBmZithR7rBBD&quot;],&quot;name&quot;:[0,&quot;Page Shield&quot;],&quot;slug&quot;:[0,&quot;page-shield&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Michael Tremante&quot;],&quot;slug&quot;:[0,&quot;michael-tremante&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/61VxyepuDMgPc2YC1SLjzq/b40290be32d4c578dab2eb8ec1a3b6da/michael-tremante.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@MichaelTremante&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Starting today, using Page Shield, Cloudflare’s client side security solution, you can ensure only vetted and secure JavaScript is being executed by your user’s browsers. Stop unwanted JavaScript and keep your end user data safe with Page Shield policies.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Locking down your JavaScript: positive blocking with Page Shield policies Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;Translated for Locale&quot;],&quot;deDE&quot;:[0,&quot;Translated for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;Translated for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;Translated for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/page-shield-positive-blocking-policies&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Locking down your JavaScript: positive blocking with Page Shield policies&quot;],&quot;description&quot;:[0,&quot;Starting today, using Page Shield, Cloudflare’s client side security solution, you can ensure only vetted and secure JavaScript is being executed by your user’s browsers. Stop unwanted JavaScript and keep your end user data safe with Page Shield policies.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2llzGzzH8ZCTYkzK3X7azg/d9b1dc0c2a63deee1da228f2362b64e6/page-shield-positive-blocking-policies-WXdH3E.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;zV6omBtZzUdVJucURgijz&quot;],&quot;title&quot;:[0,&quot;The most programmable Supercloud with Cloudflare Snippets&quot;],&quot;slug&quot;:[0,&quot;snippets-announcement&quot;],&quot;excerpt&quot;:[0,&quot;Today we are announcing Cloudflare Snippets. Snippets are a simple way of executing a small piece of Javascript on select HTTP requests, using the ruleset engine filtering logic.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1OJBcvw1RLIv4SmqBQoDVE/12f4e3f81b9aff4ecc7a62c7017c98c2/image3-28.png\&quot; alt=\&quot;The most programmable Supercloud with Cloudflare Snippets\&quot; class=\&quot;kg-image\&quot; width=\&quot;1801\&quot; height=\&quot;1013\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;your-traffic-how-you-like-it\&quot;&gt;Your traffic, how you like it&lt;/h2&gt;\n            &lt;a href=\&quot;#your-traffic-how-you-like-it\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Cloudflare is used by a highly diverse customer base. We offer simple-to-use products for everything from setting HTTP headers to rewriting the URI path and performing URL redirects. Sometimes customers need more than the out-of-the-box functionality, not just adding an HTTP header - but performing some advanced calculation to create the output. Today they would need to create a feature request and wait for it to be shipped, write a &lt;a href=\&quot;https://workers.cloudflare.com/\&quot;&gt;Cloudflare Worker&lt;/a&gt;, or keep this modification ‘on origin’ - on their own infrastructure.&lt;/p&gt;&lt;p&gt;To simplify this, we are delighted to announce Cloudflare Snippets. Snippets are a new way to perform traffic modifications that users either cannot do via our productised offerings, or want to do programmatically. The best part? The vast majority of customers will pay &lt;i&gt;nothing extra&lt;/i&gt; for using Snippets.&lt;/p&gt;&lt;p&gt;Users now have a choice. Perform the action via a rule. Or, if more functionality is needed, write a Snippet.  Neither will mean waiting. Neither will incur additional cost (although a high fair usage cap will apply). Snippets unblocks users to do what they want, when they want. All on Cloudflare.&lt;/p&gt;&lt;p&gt;Snippets will support the import of code written in various languages, such as JavaScript (modern), VCL (legacy) and Apache .htaccess files (legacy). This allows customers to migrate legacy operational code onto our platform - whilst also consolidating their JavaScript operations.&lt;/p&gt;&lt;p&gt;Please use the sign-up form to join the waitlist for Snippets if you are interested in testing. We hope to begin admitting users into the closed beta early 2023.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;why-build-snippets\&quot;&gt;Why build Snippets?&lt;/h2&gt;\n            &lt;a href=\&quot;#why-build-snippets\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Over the past 18 months we have released a number of new rules products such as &lt;a href=\&quot;/introducing-transform-rules-with-url-rewriting-at-the-edge/\&quot;&gt;Transform Rules,&lt;/a&gt; &lt;a href=\&quot;/introducing-cache-rules/\&quot;&gt;Cache Rules&lt;/a&gt;, &lt;a href=\&quot;/origin-rules/\&quot;&gt;Origin Rules&lt;/a&gt;, &lt;a href=\&quot;/configuration-rules/\&quot;&gt;Config Rules&lt;/a&gt; and &lt;a href=\&quot;/dynamic-redirect-rules/\&quot;&gt;Redirect Rules&lt;/a&gt;. These new products give more control to customers on how we process their traffic as it flows through our global network. The feedback on these products so far has been overwhelmingly positive. However, our customers still occasionally need the ability to do more than the out-of-the-box functionality allows.&lt;/p&gt;&lt;p&gt;There are always some use cases where a product doesn’t provide the functionality that a customer needs for their specific situation.  For example, whilst thousands of our customers are now using Transform Rules to solve their HTTP header modification use cases, there remains a small number of use cases that are not possible, such as setting dynamic expiry times with cookies or hashing tokens with a key.&lt;/p&gt;&lt;p&gt;This is where Cloudflare Snippets help. Customers will no longer need to use the full Cloudflare Workers platform to implement these relatively simple use cases. Nor will they need to wait for us to build their feature requests. Instead, they will be able to run a Snippet of JavaScript.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;migrating-legacy-code-to-snippets\&quot;&gt;Migrating legacy code to Snippets&lt;/h2&gt;\n            &lt;a href=\&quot;#migrating-legacy-code-to-snippets\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;&lt;a href=\&quot;https://varnish-cache.org/docs/trunk/users-guide/vcl.html\&quot;&gt;Varnish Control Language&lt;/a&gt; (VCL) is only used within the context of Varnish. Launched around 16 years ago, it has historically been used to configure traffic and routing for &lt;a href=\&quot;https://www.cloudflare.com/learning/cdn/what-is-a-cdn/\&quot;&gt;Content Delivery Networks&lt;/a&gt; as it was extensible to a wide range of use cases.&lt;/p&gt;&lt;p&gt;There are still a good number of businesses out there using VCL to perform routing and traffic modification actions. Whilst other providers are deprecating support for VCL, we want to make sure those of you comfortable using it are still supported.&lt;/p&gt;&lt;p&gt;Snippets won&amp;#39;t run pure VCL. Instead, we will convert VCL into easy to maintain rules or Snippets. To achieve this we’re building a simple-to-use, self-serve VCL converter that analyzes uploaded VCL code and auto-generates suggested Snippets, and if we can find a match, also generates suggested rules for products such as Transform Rules or Cache Rules.&lt;/p&gt;&lt;p&gt;This topic was initially handled via &lt;a href=\&quot;/announcing-turpentine/\&quot;&gt;Project Turpentine&lt;/a&gt;, a suite of tools used by Cloudflare employees to parse a customer’s VCL into a suggested JavaScript configuration. This JavaScript could then be loaded into a Worker, or series of Workers.&lt;/p&gt;&lt;p&gt;Snippets takes the idea and principles of Turpentine further. Much further. By building a parser directly in the dashboard it puts the power directly into the hands of users and gives them a choice. You can tell us to migrate everything we can into Rules with the remaining code migrated into Snippets, or, you can choose to tell us to migrate everything into discrete Snippets. It&amp;#39;s your call.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7783datzERcQclqZ8Ey84u/12736fcb80fffecbdb6a73f7053e9deb/image1-55.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1266\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;We’ll give Apache &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Learn/Server-side/Apache_Configuration_htaccess\&quot;&gt;htaccess&lt;/a&gt; and NGINX &lt;a href=\&quot;https://www.nginx.com/resources/wiki/start/topics/examples/full/\&quot;&gt;configuration files&lt;/a&gt; the same treatment. The goal being users simply upload the files from their websites Apache or NGINX configuration, and we generate suggested Snippets and/or rules.&lt;/p&gt;&lt;p&gt;The days of having to use legacy code for operational tasks are coming to an end. Snippets allow users to migrate these workloads to Cloudflare, and let them focus on the bigger problems of the business vs maintaining legacy systems.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;the-difference-between-snippets-and-workers\&quot;&gt;The difference between Snippets and Workers&lt;/h2&gt;\n            &lt;a href=\&quot;#the-difference-between-snippets-and-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Most readers will already be familiar with Cloudflare Workers, our powerful developer platform which allows businesses to run and build entire products and solutions on Cloudflare&amp;#39;s global network. Snippets is also built on this platform, but has a few key differences.&lt;/p&gt;&lt;p&gt;The first major difference is that a Snippet will run as part of the &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/\&quot;&gt;Ruleset Engine&lt;/a&gt; as dedicated new &lt;i&gt;phases&lt;/i&gt;, similar to Transform Rules and Cache Rules. Customers will be able to select and execute a Snippet based on any &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/rules-language/fields\&quot;&gt;ruleset engine filter&lt;/a&gt;. This allows customers to run a Snippet against every request, or filter for specific HTTP traffic based on the fields we offer, such as traffic with a certain bot score, originating from a specific country, or with a specific cookie. Snippets will be additive, meaning users can have one Snippet to add an HTTP header, and another to rewrite the URL, and both will execute if they match:&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1RAJyoslLJf0Q7yiGjqTiD/1b0b09e884088b571e513fd8225e8892/image2-39.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;824\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Another major difference - Cloudflare Snippets are available for all plan levels, at no additional cost. 99% of users won&amp;#39;t pay a single cent, ever, to use this solution. This allows customers to migrate their simple workloads from legacy solutions like VCL to the Cloudflare platform, and actively reduce their monthly spend.&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;table&gt;\n&lt;thead&gt;\n  &lt;tr&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;Free Plans&lt;/th&gt;\n    &lt;th&gt;Pro Plans&lt;/th&gt;\n    &lt;th&gt; Business Plans&lt;/th&gt;\n    &lt;th&gt;Enterprise Plans&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Snippets available&lt;/td&gt;\n    &lt;td&gt;5 Snippets per zone.&lt;/td&gt;\n    &lt;td&gt;20 Snippets per zone.&lt;/td&gt;\n    &lt;td&gt;50 Snippets per zone.&lt;/td&gt;\n    &lt;td&gt;200 Snippets per zone*&lt;br&gt;(Customers can speak with their Customer Success team to have this increased).&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;Cloudflare Snippets are lightweight when compared with Workers, offering 5ms maximum execution time, 2MB maximum memory and 32KB total package size. This comparably small footprint allows us to offer this to 99% of users at no additional cost, whilst also being sufficient for the identified use cases like HTTP header modification, URL rewriting and traffic routing - all of which don&amp;#39;t need the vast resources offered by Cloudflare Workers.&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;table&gt;\n&lt;thead&gt;\n  &lt;tr&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;Cloudflare Snippets&lt;/th&gt;\n    &lt;th&gt;Cloudflare Workers Unbound&lt;br&gt;(For comparison)&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Runtime support&lt;/td&gt;\n    &lt;td&gt;JavaScript&lt;/td&gt;\n    &lt;td&gt;JavaScript and WASM&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Execution location&lt;/td&gt;\n    &lt;td&gt;Global - All Cloudflare locations&lt;/td&gt;\n    &lt;td&gt;Global - All Cloudflare locations&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Triggers supported&lt;/td&gt;\n    &lt;td&gt;Ruleset Engine Filters&lt;/td&gt;\n    &lt;td&gt;HTTP Request&lt;br&gt;HTTP Response&lt;br&gt;Cron Triggers&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Maximum execution time&lt;/td&gt;\n    &lt;td&gt;5ms&lt;/td&gt;\n    &lt;td&gt;30 Seconds HTTP&lt;br&gt;15 Minutes (Cron Trigger)&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Maximum memory&lt;/td&gt;\n    &lt;td&gt;2MB&lt;/td&gt;\n    &lt;td&gt;128MB&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Total package size&lt;/td&gt;\n    &lt;td&gt;32KB&lt;/td&gt;\n    &lt;td&gt;5MB&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Environment variables&lt;/td&gt;\n    &lt;td&gt;8/Snippet&lt;/td&gt;\n    &lt;td&gt;64/Worker&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Environment variable size&lt;/td&gt;\n    &lt;td&gt;1KB&lt;/td&gt;\n    &lt;td&gt;5KB&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Subrequests&lt;/td&gt;\n    &lt;td&gt;1/request&lt;/td&gt;\n    &lt;td&gt;1000/request&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Terraform Support&lt;/td&gt;\n    &lt;td&gt;✅&lt;/td&gt;\n    &lt;td&gt;✅&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Wrangler Support&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;✅&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Cron Triggers&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;✅&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Key Value Store&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;✅&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Durable Objects&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;✅&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;R2 Integration&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;✅&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;!--kg-card-end: html--&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;what-will-you-be-able-to-build-with-cloudflare-snippets\&quot;&gt;What will you be able to build with Cloudflare Snippets?&lt;/h2&gt;\n            &lt;a href=\&quot;#what-will-you-be-able-to-build-with-cloudflare-snippets\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Snippets will allow customers to migrate their existing workloads to Cloudflare. They will also open up a number of new possible use cases for customers. We have highlighted three common examples below, however there are many more to choose from.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;example-1-sending-suspect-bots-to-a-honeypot\&quot;&gt;Example 1: Sending suspect bots to a honeypot&lt;/h3&gt;\n            &lt;a href=\&quot;#example-1-sending-suspect-bots-to-a-honeypot\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;When creating Snippets customers will be able to access Cloudflare &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/request/\&quot;&gt;features&lt;/a&gt; available in the Workers runtime, such as the bot score field. This enables customers to forward an HTTP request to a honeypot or use the RegExp Javascript function to change the URL construct being sent back to the end user when traffic is assigned a bot score below a certain threshold, e.g. &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/bot-score/#:~:text=A%20bot%20score%20is%20a,request%20came%20from%20a%20human.\&quot;&gt;29 and lower&lt;/a&gt;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;…\nif (request.cf.botManagement.score &amp;lt; 30) {\nconst honeypot = &amp;quot;https://example.com/&amp;quot;;\nreturn await fetch(honeypot, request);\n…\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;example-2-cookie-modification\&quot;&gt;Example 2: Cookie modification&lt;/h3&gt;\n            &lt;a href=\&quot;#example-2-cookie-modification\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Another common use case we foresee Snippets addressing is cookie modification. Usage can range from simply setting an expiry in five minutes by using &lt;code&gt;getTime&lt;/code&gt; and &lt;code&gt;setTime&lt;/code&gt; JavaScript functions to setting a dynamic cookie based on user request attributes for A/B testing purposes.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;…\n{\nlet res = await fetch(request);\nres = new Response(res.body, res);\n// 24h * 60m * 60s * 1000ms = 86400000ms\nconst expiry = new Date(Date.now() + 7 * 86400000).toUTCString();\nconst group = request.headers.get(&amp;quot;userGroup&amp;quot;) == &amp;quot;premium&amp;quot; ? &amp;quot;A&amp;quot; : &amp;quot;B&amp;quot;;\nres.headers.append(\n      &amp;quot;Set-Cookie&amp;quot;,\n`testGroup=${group}; Expires=${expiry}; path=/`\n    );\n…&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;example-3-uri-query-management\&quot;&gt;Example 3: URI query management&lt;/h3&gt;\n            &lt;a href=\&quot;#example-3-uri-query-management\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Customers can also deploy Cloudflare Snippets to do complex operations such as splicing the URI query value to selectively remove or inject additional parameters. Query string manipulation is typically done using Transform Rules. However, with Transform Rules the &lt;code&gt;set/&lt;/code&gt; action is effectively a &lt;code&gt;replace&lt;/code&gt; action. This action when applied to the URI query string will remove the entire value if there is one and set it to what the user specifies, thus overwriting it. This is a problem for customers who wish to selectively inject specific query parameters for matching traffic. For example,  setting an additional query, e.g. &lt;code&gt;?utm_campaign=facebook&lt;/code&gt; when common social media platforms are detected in the user agent. With Snippets, customers will be able to do this selective removal and insertion using a simple piece of JavaScript, e.g.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;…\nif (userAgent.includes(&amp;quot;Facebook&amp;quot;)) {\n      const url = new URL(request.url);\n      const params = new URLSearchParams(url.search);\n      params.set(&amp;quot;utm_campaign&amp;quot;, &amp;quot;facebook&amp;quot;);\n      url.search = params.toString();\n      const transformedRequest = new Request(url, request)\n…\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We are excited to see what other use cases Cloudflare Snippets unlock for our customers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;will-you-stop-adding-actions-to-rulesets\&quot;&gt;Will you stop adding actions to rulesets?&lt;/h2&gt;\n            &lt;a href=\&quot;#will-you-stop-adding-actions-to-rulesets\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;The simple answer is no! We will continue to build out our no-code actions within the ruleset engine, developing new products to solve customer needs.&lt;/p&gt;&lt;p&gt;It may sound obvious - but a core component to feature improvement is talking to customers. Talking to Snippet users will help us understand what real life use cases Snippets help solve and highlight feature gaps we have in our product suite. We can then review if it makes sense to productise that use case, or leave it requiring Snippets.&lt;/p&gt;&lt;p&gt;We also understand that not everyone is a software developer. We are therefore exploring how we can make Snippets accessible to all by creating selectable templates available in a library that can be copied and modified by customers, with minimum coding knowledge required. With Snippets, powerful won’t mean difficult.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;accessing-cloudflare-snippets\&quot;&gt;Accessing Cloudflare Snippets&lt;/h2&gt;\n            &lt;a href=\&quot;#accessing-cloudflare-snippets\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Snippets are currently under development — you can sign up &lt;a href=\&quot;https://www.cloudflare.com/lp/cloudflare-snippets/\&quot;&gt;here&lt;/a&gt; to join the waitlist for access.&lt;/p&gt;&lt;p&gt;We hope to begin admitting users into the closed beta in early 2023, with an open beta to follow.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2022-11-17T14:00:00.000+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:21:12.171Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4mH78GfuqQm6rcPFNAf6rC/02659e9a04ed3a10bb19f7a7f3ea30ad/snippets-announcement.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;2xCnBweKwOI3VXdYsGVbMe&quot;],&quot;name&quot;:[0,&quot;Developer Week&quot;],&quot;slug&quot;:[0,&quot;developer-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;4eBircwQ1VIos6rC8wgALG&quot;],&quot;name&quot;:[0,&quot;Snippets&quot;],&quot;slug&quot;:[0,&quot;snippets&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Sam Marsh&quot;],&quot;slug&quot;:[0,&quot;sam-marsh&quot;],&quot;bio&quot;:[0,&quot;Director of Product Management, Cloudflare. Responsible for CDN and Web Performance&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5kVXxWDGGrehLTLG30sCWm/3cdd7066d4f607106e82444d7e9096ad/Sam-Marsh.jpeg&quot;],&quot;location&quot;:[0,&quot;England, United Kingdom&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Today we are announcing Cloudflare Snippets. Snippets are a simple way of executing a small piece of Javascript on select HTTP requests, using the ruleset engine filtering logic.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;The most programmable Supercloud with Cloudflare Snippets Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;Translated for Locale&quot;],&quot;deDE&quot;:[0,&quot;Translated for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;Translated for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;Translated for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/snippets-announcement&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;The most programmable Supercloud with Cloudflare Snippets&quot;],&quot;description&quot;:[0,&quot;Today we are announcing Cloudflare Snippets. Snippets are a simple way of executing a small piece of Javascript on select HTTP requests, using the ruleset engine filtering logic.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3VtcQpUkz2iEox66ahQQVd/61ea26ae66bbb412ed5aba3e808af35b/snippets-announcement-uuLClj.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;65UG8ITOXBu4pXT5pj8bSj&quot;],&quot;title&quot;:[0,&quot;Building a scheduling system with Workers and Durable Objects&quot;],&quot;slug&quot;:[0,&quot;building-scheduling-system-with-workers-and-durable-objects&quot;],&quot;excerpt&quot;:[0,&quot;In this post we&#39;re going to show you how to build a scalable service that will schedule HTTP requests on a specific schedule or as one-off at a specific time &quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2fjdl7kWRa7MwLUn86agFI/c0523af4c465553a7152ba2d9cf483f9/Scheduling-system-with-Workers-and-Durable-Objects.png\&quot; alt=\&quot;Building a scheduling system with Workers and Durable Objects\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;901\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;We rely on technology to help us on a daily basis – if you are not good at keeping track of time, your calendar can remind you when it&amp;#39;s time to prepare for your next meeting. If you made a reservation at a really nice restaurant, you don&amp;#39;t want to miss it! You appreciate the app to remind you a day before your plans the next evening.&lt;/p&gt;&lt;p&gt;However, who tells the application when it&amp;#39;s the right time to send you a notification? For this, we generally rely on scheduled events. And when you are relying on them, you really want to make sure that they occur. Turns out, this can get difficult. The scheduler and storage backend need to be designed with scale in mind - otherwise you may hit limitations quickly.&lt;/p&gt;&lt;p&gt;Workers, Durable Objects, and Alarms are actually a perfect match for this type of workload. Thanks to the distributed architecture of Durable Objects and their storage, they are a reliable and scalable option. Each Durable Object has access to its own isolated storage and alarm scheduler, both being automatically replicated and failover in case of failures.&lt;/p&gt;&lt;p&gt;There are many use cases where having a reliable scheduler can come in handy: running a webhook service, sending emails to your customers a week after they sign up to keep them engaged, sending invoices reminders, and more!&lt;/p&gt;&lt;p&gt;Today, we&amp;#39;re going to show you how to build a scalable service that will schedule HTTP requests on a specific schedule or as one-off at a specific time as a way to guide you through any use case that requires scheduled events.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5QsLhy4QmfImRWULDDCpRx/07a879528b6632d850fda9c141ba8707/Scheduling-system-with-Workers-and-Durable-Objects---Diagram.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1531\&quot; height=\&quot;871\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;quick-intro-into-the-application-stack\&quot;&gt;Quick intro into the application stack&lt;/h3&gt;\n            &lt;a href=\&quot;#quick-intro-into-the-application-stack\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Before we dive in, here are some of the tools we’re going to be using today:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/get-started/#install\&quot;&gt;Wrangler&lt;/a&gt; - CLI tool to develop and publish Workers&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers\&quot;&gt;Cloudflare Workers&lt;/a&gt; - runtime&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/learning/using-durable-objects/\&quot;&gt;Cloudflare Durable Objects&lt;/a&gt; - storage for HTTP requests and &lt;a href=\&quot;/durable-objects-alarms/\&quot;&gt;Alarms&lt;/a&gt; to schedule them&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The application is going to have the following components:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Scheduling system API to accept scheduled requests and manage Durable Objects&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Unique Durable Object per scheduled request, each with&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Storage - keeping the request metadata, such as URL, body, or headers.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Alarm - a timer (trigger) to wake Durable Object up.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;While we will focus on building the application, the Cloudflare global network will take care of the rest – storing and replicating our data, and making sure to wake our Durable Objects up when the time&amp;#39;s right. Let’s build it!&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;initialize-new-workers-project\&quot;&gt;Initialize new Workers project&lt;/h3&gt;\n            &lt;a href=\&quot;#initialize-new-workers-project\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Get started by generating a completely new Workers project using the &lt;code&gt;wrangler init&lt;/code&gt; command, which makes creating new projects quick &amp;amp; easy.&lt;/p&gt;&lt;p&gt;&lt;b&gt;wrangler init -y durable-objects-requests-scheduler&lt;/b&gt;&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6vgw0sXTG850ifbluBAbEy/57b6965270f884980aa64ebd4d90a914/pasted-image-0.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;562\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;For more information on how to install, authenticate, or update Wrangler, check out &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/get-started\&quot;&gt;https://developers.cloudflare.com/workers/wrangler/get-started&lt;/a&gt;&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;preparing-typescript-types\&quot;&gt;Preparing TypeScript types&lt;/h3&gt;\n            &lt;a href=\&quot;#preparing-typescript-types\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;From my personal experience, at least a draft of TypeScript types significantly helps to be more productive down the road, so let&amp;#39;s prepare and describe our scheduled request in advance. Create a file types.ts in src directory and paste the following TypeScript definitions.&lt;/p&gt;&lt;p&gt;&lt;b&gt;src/types.ts&lt;/b&gt;&lt;/p&gt;\n            &lt;pre class=\&quot;language-typescript\&quot;&gt;&lt;code class=\&quot;language-typescript\&quot;&gt;export interface Env {\n    DO_REQUEST: DurableObjectNamespace\n}\n \nexport interface ScheduledRequest {\n  url: string // URL of the request\n  triggerAt?: number // optional, unix timestamp in milliseconds, defaults to `new Date()`\n  requestInit?: RequestInit // optional, includes method, headers, body\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;a-scheduled-request-durable-object-class-alarm\&quot;&gt;A scheduled request Durable Object class &amp;amp; alarm&lt;/h3&gt;\n            &lt;a href=\&quot;#a-scheduled-request-durable-object-class-alarm\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Based on our architecture design, each scheduled request will be saved into its own Durable Object, effectively separating storage and alarms from each other and allowing our scheduling system to scale horizontally - there is no limit to the number of Durable Objects we create.&lt;/p&gt;&lt;p&gt;In the end, the Durable Object class is a matter of a couple of lines. The code snippet below accepts and saves the request body to a persistent storage and sets the alarm timer. Workers runtime will wake up the Durable Object and call the &lt;code&gt;alarm()&lt;/code&gt; method to process the request.&lt;/p&gt;&lt;p&gt;The alarm method reads the scheduled request data from the storage, then processes the request, and in the end reschedules itself in case it&amp;#39;s configured to be executed on a recurring schedule.&lt;/p&gt;&lt;p&gt;&lt;b&gt;src/request-durable-object.ts&lt;/b&gt;&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;import { ScheduledRequest } from &amp;quot;./types&amp;quot;;\n \nexport class RequestDurableObject {\n  id: string|DurableObjectId\n  storage: DurableObjectStorage\n \n  constructor(state:DurableObjectState) {\n    this.storage = state.storage\n    this.id = state.id\n  }\n \n    async fetch(request:Request) {\n    // read scheduled request from request body\n    const scheduledRequest:ScheduledRequest = await request.json()\n     \n    // save scheduled request data to Durable Object storage, set the alarm, and return Durable Object id\n    this.storage.put(&amp;quot;request&amp;quot;, scheduledRequest)\n    this.storage.setAlarm(scheduledRequest.triggerAt || new Date())\n    return new Response(JSON.stringify({\n      id: this.id.toString()\n    }), {\n      headers: {\n        &amp;quot;content-type&amp;quot;: &amp;quot;application/json&amp;quot;\n      }\n    })\n  }\n \n  async alarm() {\n    // read the scheduled request from Durable Object storage\n    const scheduledRequest:ScheduledRequest|undefined = await this.storage.get(&amp;quot;request&amp;quot;)\n \n    // call fetch on scheduled request URL with optional requestInit\n    if (scheduledRequest) {\n      await fetch(scheduledRequest.url, scheduledRequest.requestInit ? webhook.requestInit : undefined)\n \n      // cleanup scheduled request once done\n      this.storage.deleteAll()\n    }\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;wrangler-configuration\&quot;&gt;Wrangler configuration&lt;/h3&gt;\n            &lt;a href=\&quot;#wrangler-configuration\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Once we have the Durable Object class, we need to create a Durable Object binding by instructing Wrangler where to find it and what the exported class name is.&lt;/p&gt;&lt;p&gt;&lt;b&gt;wrangler.toml&lt;/b&gt;&lt;/p&gt;\n            &lt;pre class=\&quot;language-toml\&quot;&gt;&lt;code class=\&quot;language-toml\&quot;&gt;name = &amp;quot;durable-objects-request-scheduler&amp;quot;\nmain = &amp;quot;src/index.ts&amp;quot;\ncompatibility_date = &amp;quot;2022-08-02&amp;quot;\n \n# added Durable Objects configuration\n[durable_objects]\nbindings = [\n  { name = &amp;quot;DO_REQUEST&amp;quot;, class_name = &amp;quot;RequestDurableObject&amp;quot; },\n]\n \n[[migrations]]\ntag = &amp;quot;v1&amp;quot;\nnew_classes = [&amp;quot;RequestDurableObject&amp;quot;]&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;scheduling-system-api\&quot;&gt;Scheduling system API&lt;/h3&gt;\n            &lt;a href=\&quot;#scheduling-system-api\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The API Worker will accept POST HTTP methods only, and is expecting a JSON body with scheduled request data - what URL to call, optionally what method, headers, or body to send. Any other method than POST will return 405 - Method Not Allowed HTTP error.&lt;/p&gt;&lt;p&gt;HTTP &lt;code&gt;POST /:scheduledRequestId?&lt;/code&gt; will create or override a scheduled request, where :scheduledRequestId is optional Durable Object ID returned from a scheduling system API before.&lt;/p&gt;&lt;p&gt;&lt;b&gt;src/index.ts&lt;/b&gt;&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;import { Env } from &amp;quot;./types&amp;quot;\nexport { RequestDurableObject } from &amp;quot;./request-durable-object&amp;quot;\n \nexport default {\n    async fetch(\n        request: Request,\n        env: Env\n    ): Promise&amp;lt;Response&amp;gt; {\n        if (request.method !== &amp;quot;POST&amp;quot;) {\n            return new Response(&amp;quot;Method Not Allowed&amp;quot;, {status: 405})\n        }\n \n        // parse the URL and get Durable Object ID from the URL\n        const url = new URL(request.url)\n        const idFromUrl = url.pathname.slice(1)\n \n        // construct the Durable Object ID, use the ID from pathname or create a new unique id\n        const doId = idFromUrl ? env.DO_REQUEST.idFromString(idFromUrl) : env.DO_REQUEST.newUniqueId()\n \n        // get the Durable Object stub for our Durable Object instance\n        const stub = env.DO_REQUEST.get(doId)\n \n        // pass the request to Durable Object instance\n        return stub.fetch(request)\n    },\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;It&amp;#39;s good to mention that the script above does not implement any listing of scheduled or processed webhooks. Depending on how the scheduling system would be integrated, you can save each created Durable Object ID to your existing backend, or write your own registry – using one of the &lt;a href=\&quot;https://developers.cloudflare.com/workers/get-started/storage-objects/\&quot;&gt;Workers storage options&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;starting-a-local-development-server-and-testing-our-application\&quot;&gt;Starting a local development server and testing our application&lt;/h3&gt;\n            &lt;a href=\&quot;#starting-a-local-development-server-and-testing-our-application\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;We are almost done! Before we publish our scheduler system to the Cloudflare edge, let&amp;#39;s start Wrangler in a completely local mode to run a couple of tests against it and to see it in action – which will work even without an Internet connection!&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;wrangler dev --local&lt;/pre&gt;&lt;/code&gt;\n            \n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2O2DcPjirepk7sgbtlMpbn/7cef2cc7d230dc4c0010ceb08c84da06/pasted-image-0--1-.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;614\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;The development server is listening on localhost:8787, which we will use for scheduling our first request. The JSON request payload should match the TypeScript schema we defined in the beginning – required URL, and optional &lt;code&gt;triggerEverySeconds&lt;/code&gt; number or &lt;code&gt;triggerAt&lt;/code&gt; unix timestamp. When only the required URL is passed, the request will be dispatched right away.&lt;/p&gt;&lt;p&gt;An example of request payload that will send a GET request to &lt;a href=\&quot;https://example.com\&quot;&gt;https://example.com&lt;/a&gt; every 30 seconds.&lt;/p&gt;\n            &lt;pre class=\&quot;language-json\&quot;&gt;&lt;code class=\&quot;language-json\&quot;&gt;{\n\t&amp;quot;url&amp;quot;:  &amp;quot;https://example.com&amp;quot;,\n\t&amp;quot;triggerEverySeconds&amp;quot;: 30,\n}&lt;/pre&gt;&lt;/code&gt;\n            \n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;&amp;gt; curl -X POST -d &amp;#039;{&amp;quot;url&amp;quot;: &amp;quot;https://example.com&amp;quot;, &amp;quot;triggerEverySeconds&amp;quot;: 30}&amp;#039; http://localhost:8787\n{&amp;quot;id&amp;quot;:&amp;quot;000000018265a5ecaa5d3c0ab6a6997bf5638fdcb1a8364b269bd2169f022b0f&amp;quot;}&lt;/pre&gt;&lt;/code&gt;\n            \n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/74kGUzg7MYccSbLySud2e5/a7cdb2781a32c2b95953d25109f3bcce/pasted-image-0--2-.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;998\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;From the wrangler logs we can see the scheduled request ID &lt;code&gt;000000018265a5ecaa5d3c0ab6a6997bf5638fdcb1a8364b269bd2169f022b0f&lt;/code&gt; is being triggered in 30s intervals.&lt;/p&gt;&lt;p&gt;Need to double the interval? No problem, just send a new POST request and pass the request ID as a pathname.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;&amp;gt; curl -X POST -d &amp;#039;{&amp;quot;url&amp;quot;: &amp;quot;https://example.com&amp;quot;, &amp;quot;triggerEverySeconds&amp;quot;: 60}&amp;#039; http://localhost:8787/000000018265a5ecaa5d3c0ab6a6997bf5638fdcb1a8364b269bd2169f022b0f\n{&amp;quot;id&amp;quot;:&amp;quot;000000018265a5ecaa5d3c0ab6a6997bf5638fdcb1a8364b269bd2169f022b0f&amp;quot;}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Every scheduled request gets a unique Durable Object ID with its own storage and alarm. As we demonstrated, the ID becomes handy when you need to change the settings of the scheduled request, or to deschedule them completely.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;publishing-to-the-network\&quot;&gt;Publishing to the network&lt;/h3&gt;\n            &lt;a href=\&quot;#publishing-to-the-network\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Following command will bundle our Workers application, export and bind Durable Objects, and deploy it to our workers.dev subdomain.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;wrangler publish&lt;/pre&gt;&lt;/code&gt;\n            \n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3p4tcXHgshwEhYihU8blKm/2dd1a3d76fcb72e056e94540228c2c3a/pasted-image-0--3-.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1190\&quot; height=\&quot;500\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;That&amp;#39;s it, we are live! ? The URL of your deployment is shown in the Workers logs. In a reasonably short period of time we managed to write our own scheduling system that is ready to handle requests at scale.&lt;/p&gt;&lt;p&gt;You can check full source code in &lt;a href=\&quot;https://github.com/cloudflare/templates/tree/main/worker-example-request-scheduler\&quot;&gt;Workers templates repository&lt;/a&gt;, or experiment from your browser without installing any dependencies locally using the &lt;a href=\&quot;https://workers.new/example-request-scheduler\&quot;&gt;StackBlitz template&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;b&gt;What to see or build next&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;New to Workers? Check our Get started guide.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Use &lt;a href=\&quot;https://www.cloudflare.com/products/zero-trust/access/\&quot;&gt;Access&lt;/a&gt; or &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/service-bindings/\&quot;&gt;service bindings&lt;/a&gt; if you want to protect your API from unauthorized access.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Got an idea for a Worker, get started in seconds =&amp;gt; &lt;a href=\&quot;https://workers.new/typescript\&quot;&gt;https://workers.new/typescript&lt;/a&gt; (&lt;a href=\&quot;https://workers.new/list\&quot;&gt;full list of StackBlitz supported templates&lt;/a&gt;)&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Dive into more Workers examples&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/examples/\&quot;&gt;https://developers.cloudflare.com/workers/examples/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a href=\&quot;https://github.com/cloudflare/templates\&quot;&gt;https://github.com/cloudflare/templates&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&quot;],&quot;published_at&quot;:[0,&quot;2022-08-05T16:45:57.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-12-12T00:11:09.358Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1C6waWfup8WNAxRhRzJENn/9261d6f38b5106a6e244dec46776fc44/building-scheduling-system-with-workers-and-durable-objects.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5v2UZdTRX1Rw9akmhexnxs&quot;],&quot;name&quot;:[0,&quot;Durable Objects&quot;],&quot;slug&quot;:[0,&quot;durable-objects&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;5cye1Bh5KxFh3pKSnX8Dsy&quot;],&quot;name&quot;:[0,&quot;Serverless&quot;],&quot;slug&quot;:[0,&quot;serverless&quot;]}],[0,{&quot;id&quot;:[0,&quot;3OPPjcK7cKutTdeAjpThfG&quot;],&quot;name&quot;:[0,&quot;Edge&quot;],&quot;slug&quot;:[0,&quot;edge&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Adam Janiš&quot;],&quot;slug&quot;:[0,&quot;adam-janis&quot;],&quot;bio&quot;:[0,&quot;Developer advocate on the Cloudflare Workers team.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/34xEtqcDNnfW4O2wKNecjh/c8847863c1a36797577e5fb2bbcf85aa/adam-janis.png&quot;],&quot;location&quot;:[0,&quot;Lisbon&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@adam_janis&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Building a scheduling system with Workers and Durable Objects&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Building a scheduling system with Workers and Durable Objects Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/building-scheduling-system-with-workers-and-durable-objects&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0],&quot;description&quot;:[0],&quot;imgPreview&quot;:[0,&quot;&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;3RS6LTyJ0qPXDoVT6idq42&quot;],&quot;title&quot;:[0,&quot;Making Page Shield malicious code alerts more actionable&quot;],&quot;slug&quot;:[0,&quot;making-page-shield-malicious-code-alerts-more-actionable&quot;],&quot;excerpt&quot;:[0,&quot;In this post we go over improvements to script status, metadata and categorization.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/611iIDxS0vC9wq23RoyqEF/b4f0a6d87db025913b55277255eb6086/Untitled.png\&quot; alt=\&quot;Page Shield is generally available\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;802\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Last year during CIO week, we announced &lt;a href=\&quot;/page-shield-generally-available/\&quot;&gt;Page Shield in general availability&lt;/a&gt;. Today, we talk about improvements we’ve made to help Page Shield users focus on the highest impact scripts and get more value out of the product. In this post we go over improvements to script status, metadata and categorization.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;what-is-page-shield\&quot;&gt;What is Page Shield?&lt;/h3&gt;\n            &lt;a href=\&quot;#what-is-page-shield\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;&lt;a href=\&quot;https://www.cloudflare.com/page-shield/\&quot;&gt;Page Shield&lt;/a&gt; protects website owners and visitors against malicious 3rd party JavaScript. JavaScript can be leveraged in a number of malicious ways: browser-side crypto mining, data exfiltration and malware injection to mention a few.&lt;/p&gt;&lt;p&gt;For example a single hijacked JavaScript can expose millions of user’s credit card details across a range of websites to a malicious actor. The bad actor would scrape details by leveraging a compromised JavaScript library, skimming inputs to a form and exfiltrating this to a 3rd party endpoint under their control.&lt;/p&gt;&lt;p&gt;Today Page Shield partially relies on &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy\&quot;&gt;Content Security Policies&lt;/a&gt; (CSP), a browser native framework that can be used to control and gain visibility of which scripts are allowed to load on pages (while also reporting on any violations). We use these violation reports to provide detailed information in the Cloudflare dashboard regarding scripts being loaded by end-user browsers.&lt;/p&gt;&lt;p&gt;Page Shield users, via the dashboard, can see which scripts are active on their website and on which pages. Users can be alerted in case a script performs malicious activity, and monitor code changes of the script.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;script-status\&quot;&gt;Script status&lt;/h3&gt;\n            &lt;a href=\&quot;#script-status\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;To help identify malicious scripts, and make it easier to take action on live threats, we have introduced a status field.&lt;/p&gt;&lt;p&gt;When going to the &lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/:zone/security/page-shield\&quot;&gt;Page Shield dashboard&lt;/a&gt;, the customer will now only see scripts with a status of &lt;code&gt;active&lt;/code&gt;. Active scripts are those that were seen in the last seven days and didn’t get served through the “cdn-cgi” endpoint (which is managed by Cloudflare).&lt;/p&gt;&lt;p&gt;We also introduced other statuses:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;infrequent&lt;/code&gt; scripts are scripts that have only been seen in a negligible amount of CSP reports over a period of time. They normally indicate a single user’s browser using a compromised browser extension. The goal of this status is to reduce noise caused by browser plugins that inject their JavaScript in the HTML.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;inactive&lt;/code&gt; scripts are those that have not been reported for seven days and therefore have likely since been removed or replaced.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;cdn-cgi&lt;/code&gt; are scripts served from the ‘/cdn-cgi/’ endpoint which is managed by Cloudflare. These scripts are related to Cloudflare products like our analytics or Bot Management features. Cloudflare closely monitors these scripts, they are fairly static, so they shouldn’t require close monitoring by a customer and therefore are hidden by default unless our detections find anything suspicious.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;If the customer wishes to see the full list of scripts including the non-active scripts they can still do so by clicking ‘All scripts’.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3xQ9R3v61KQLMuT1AL8Cqu/14e35701369d598eb93f01e082864415/Screenshot-2022-06-28-at-13.30.05.png\&quot; alt=\&quot;Page Shield dashboard showing detected scripts.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;988\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;script-metadata-in-alerts\&quot;&gt;Script metadata in alerts&lt;/h3&gt;\n            &lt;a href=\&quot;#script-metadata-in-alerts\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Customers that opt into the enterprise add-on version of Page Shield can also choose to set up notifications for malicious scripts. In the previous version, we offered the script URL, first seen on and last seen on data. These alerts have been revamped to improve the experience for security analysts. Our goal is to provide all data a security analyst would manually look-up in order to validate a script. With this update we’ve made a significant step in that direction through using insights delivered by &lt;a href=\&quot;https://radar.cloudflare.com/\&quot;&gt;Cloudflare Radar&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;At the top of the email alert you will now find where the script was seen along with other information regarding when the script was seen and the full URL (not clickable for security purposes).&lt;/p&gt;&lt;p&gt;As part of the enterprise add-on version of Page Shield we review the scripts through a custom &lt;a href=\&quot;/detecting-magecart-style-attacks-for-pageshield/\&quot;&gt;machine learning classifier&lt;/a&gt; and a range of domain and URL threat feeds. A very common question with any &lt;a href=\&quot;https://www.cloudflare.com/learning/ai/what-is-machine-learning/\&quot;&gt;machine learning&lt;/a&gt; scoring system is “why did it score the way it scored”. Because of this, the machine learning score generated by our system has now been split up to show the components that made up the score; currently: obfuscation and data exfiltration values. This should help to improve the ability for a customer to review a script in case of a false positive.&lt;/p&gt;&lt;p&gt;Threat feeds can be very helpful in detecting new attack styles that our classifier hasn’t been trained for yet. Some of these feeds offer us a range of categories of malicious endpoints such as ‘malware’, ‘spyware’ or ‘phishing’. Our enterprise add-on customers will now be able to see the categorization in our alerts (as shown above) and on the dashboard. The goal is to provide more context on why a script is considered malicious.&lt;/p&gt;&lt;p&gt;We also now provide information on script changes along with the “malicious code score” for each version.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5vH1xUk8cYyqIMeOOmZv7D/0c519074c8a6d85034b93bb5a9685500/Issued-certificates.png\&quot; alt=\&quot;Email alert showing which script was flagged and where it was seen.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1950\&quot; height=\&quot;519\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Right below the most essential information we have added WHOIS information on the party domain that is providing the script. In some cases the &lt;a href=\&quot;https://www.cloudflare.com/learning/dns/glossary/what-is-a-domain-name-registrar/\&quot;&gt;registrar&lt;/a&gt; may hide relevant information such as the organization’s name, however, information on the date of registration and expiration can be very useful in detecting unexpected changes in ownership. For example, we often see malicious scripts being hosted under newly registered domains.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/56zORo51fdYPkTJEUxHOzb/1889297aea56b2f6bf00735a89a8e9c8/Insights.png\&quot; alt=\&quot;email alert showing WhoIs information of the domain the script was delivered from.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1950\&quot; height=\&quot;735\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;We also now offer details regarding the SSL certificates issued for this domain through certificate transparency monitoring. This can be useful in detecting a potential take over. For example, if a 3rd party script endpoint usually uses a Digicert certificate, but recently a Let’s Encrypt certificate has been issued this could be an indicator that another party is trying to take over the domain.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1vfP1JIojvCQFajdhHjIQj/7b51237eb86c6ea01ab73b393aefa232/Main.png\&quot; alt=\&quot;Email alert. Certificate Transparency monitor information of the script:   \&quot; class=\&quot;kg-image\&quot; width=\&quot;1950\&quot; height=\&quot;2256\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Last but not least, we have improved our dashboard link to take users directly to the specific script details page provided by the Page Shield UI.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;whats-next\&quot;&gt;What’s next?&lt;/h3&gt;\n            &lt;a href=\&quot;#whats-next\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;There are many ways to perform malicious activity through JavaScript. Because of this it is important that we build attack type specific detection mechanisms as well as overarching tools that will help detect anomalies. We are currently building a new component purpose built to look for signs of malicious intent in data endpoints by leveraging the &lt;code&gt;connect-src&lt;/code&gt; CSP directive. The goal is to improve the accuracy of our Magecart-style attack detection.&lt;/p&gt;&lt;p&gt;We are also working on providing the ability to generate CSP policies directly through Page Shield making it easy to perform positive blocking and maintain rules over time.&lt;/p&gt;&lt;p&gt;Another feature we are working on is offering the ability to block scripts from accessing a user&amp;#39;s webcam, microphone or location through a single click.&lt;/p&gt;&lt;p&gt;More about this in future blog posts. Many more features to come!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2022-07-05T13:59:11.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-11-06T17:12:21.816Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/42lj7SziVySmsLONkASmyv/af6fd14db2777838df86508f2628dc14/making-page-shield-malicious-code-alerts-more-actionable.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}],[0,{&quot;id&quot;:[0,&quot;6stQ7u3dAyBmZithR7rBBD&quot;],&quot;name&quot;:[0,&quot;Page Shield&quot;],&quot;slug&quot;:[0,&quot;page-shield&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Simon Wijckmans&quot;],&quot;slug&quot;:[0,&quot;swijckmans&quot;],&quot;bio&quot;:[0,&quot;Product Manager for Page Shield. Born and raised in Belgium. Based out of London. Techy by heart.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/55xmV8pe0poKKW4C1cceXC/a9b4459f8383a2211345366477b5c642/swijckmans.jpg&quot;],&quot;location&quot;:[0,&quot;London, UK&quot;],&quot;website&quot;:[0,&quot;https://simonwijckmans.com/&quot;],&quot;twitter&quot;:[0,&quot;@SimonWijckmans&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;In this post we go over improvements to script status, metadata and categorization.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Making Page Shield malicious code alerts more actionable Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/making-page-shield-malicious-code-alerts-more-actionable&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Making Page Shield malicious code alerts more actionable&quot;],&quot;description&quot;:[0,&quot;In this post we go over improvements to script status, metadata and categorization.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/52adEIzAJQG9NnNiC5NbxU/016f4c647db3374cba3895ef40c36965/making-page-shield-malicious-code-alerts-more-actionable-izJJdN.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;q3DlDZ0aYj6Ok5mROKeW3&quot;],&quot;title&quot;:[0,&quot;A Community Group for Web-interoperable JavaScript runtimes&quot;],&quot;slug&quot;:[0,&quot;introducing-the-wintercg&quot;],&quot;excerpt&quot;:[0,&quot;The Web-interoperable Runtimes Community Group is a new effort that brings contributors from Cloudflare Workers, Deno, and Node.js together to collaborate on common Web platform API standards.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1SmC4Eqr4uesSd96brN3bW/1b7df397974a240fc01d86820963c5b4/image1-10.png\&quot; alt=\&quot;A Community Group for Web-interoperable JavaScript runtimes\&quot; class=\&quot;kg-image\&quot; width=\&quot;1800\&quot; height=\&quot;1013\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Today, Cloudflare – in partnership with Vercel, Shopify, and individual core contributors to both &lt;a href=\&quot;https://nodejs.org\&quot;&gt;Node.js&lt;/a&gt; and &lt;a href=\&quot;https://deno.land\&quot;&gt;Deno&lt;/a&gt; – is announcing the establishment of a new &lt;a href=\&quot;https://www.w3.org/community/wintercg/\&quot;&gt;Community Group&lt;/a&gt; focused on the interoperable implementation of standardized &lt;a href=\&quot;https://www.cloudflare.com/learning/security/api/what-is-an-api/\&quot;&gt;web APIs&lt;/a&gt; in non-web browser, JavaScript-based development environments.&lt;/p&gt;&lt;p&gt;The &lt;a href=\&quot;https://w3.org\&quot;&gt;W3C&lt;/a&gt; and the &lt;a href=\&quot;https://whatwg.org/\&quot;&gt;Web Hypertext Application Technology Working Group&lt;/a&gt; (or WHATWG) have long pioneered the efforts to develop standardized APIs and features for the web as a development environment. APIs such as &lt;a href=\&quot;https://fetch.spec.whatwg.org/\&quot;&gt;fetch()&lt;/a&gt;, &lt;a href=\&quot;https://streams.spec.whatwg.org/\&quot;&gt;ReadableStream and WritableStream&lt;/a&gt;, &lt;a href=\&quot;https://url.spec.whatwg.org/\&quot;&gt;URL&lt;/a&gt;, &lt;a href=\&quot;https://wicg.github.io/urlpattern\&quot;&gt;URLPattern&lt;/a&gt;, &lt;a href=\&quot;https://encoding.spec.whatwg.org/\&quot;&gt;TextEncoder&lt;/a&gt;, and more have become ubiquitous and valuable components of modern web development. However, the charters of these existing groups have always been &lt;a href=\&quot;https://whatwg.org/faq#what-is-the-whatwg-working-on\&quot;&gt;explicitly limited to&lt;/a&gt; considering only the specific needs of web browsers, resulting in the development of standards that are not readily optimized for any environment that does not look exactly like a web browser. A good example of this effect is that some non-browser implementations of the &lt;a href=\&quot;https://streams.spec.whatwg.org/\&quot;&gt;Streams standard&lt;/a&gt; are an order of magnitude &lt;a href=\&quot;https://github.com/nodejs/undici/issues/1203\&quot;&gt;&lt;i&gt;slower&lt;/i&gt;&lt;/a&gt; than the equivalent Node.js streams and Deno reader implementations due largely to how the API is specified in the standard.&lt;/p&gt;&lt;p&gt;Serverless environments such as &lt;a href=\&quot;https://workers.cloudflare.com/\&quot;&gt;Cloudflare Workers&lt;/a&gt;, or runtimes like Node.js and Deno, have a broad wide range of requirements, issues, and concerns that are simply not relevant to web browsers, and vice versa. This disconnect and the lack of clear consideration of these differences while the various specifications have been developed, has led to a situation where the non-browser runtimes have implemented their own bespoke, ad-hoc solutions for functionality that is actually common across the environments.&lt;/p&gt;&lt;p&gt;This new effort is changing that by providing a venue to discuss and advocate for the common requirements of &lt;i&gt;all&lt;/i&gt; web environments, deployed anywhere throughout the stack.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;whats-in-it-for-developers\&quot;&gt;What&amp;#39;s in it for developers?&lt;/h2&gt;\n            &lt;a href=\&quot;#whats-in-it-for-developers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Developers want their code to be portable. Once they write it, if they choose to move to a different environment (from Node.js to Deno, for instance) they don&amp;#39;t want to have to completely &lt;i&gt;rewrite&lt;/i&gt; it just to make it keep doing the exact same thing it already was.&lt;/p&gt;&lt;p&gt;One of the more common questions we get from Cloudflare users is how they can make use of some arbitrary module published to &lt;a href=\&quot;https://npmjs.org\&quot;&gt;npm&lt;/a&gt; that makes use of some set of Node.js-specific or Deno-specific APIs. The answer usually involves pulling in some arbitrary combination of polyfill implementations. The situation is similar with the Deno project, which has opted to integrate a polyfill of the full Node.js core API directly into their standard library. The more these environments implement the same common standards, the more the developer ecosystem can depend on the code they write just working, regardless of where it is being run.&lt;/p&gt;&lt;p&gt;Cloudflare Workers, Node.js, Deno, and web browsers are all very different from each other, but they share a good number of common functions. For instance, they all provide APIs for generating cryptographic hashes; they all deal in some way with streaming data; they all provide the ability to send an HTTP request somewhere. Where this overlap exists, and where the requirements and functionality are the same, the environments should all implement the same standardized mechanisms.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;the-web-interoperable-runtimes-community-group\&quot;&gt;The Web-interoperable Runtimes Community Group&lt;/h2&gt;\n            &lt;a href=\&quot;#the-web-interoperable-runtimes-community-group\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;The new &lt;a href=\&quot;https://github.com/wintercg\&quot;&gt;Web-interoperable Runtimes Community Group&lt;/a&gt; (or &amp;quot;WinterCG&amp;quot;) operates under the established processes of the &lt;a href=\&quot;https://www.w3.org/community/about/\&quot;&gt;W3C&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;The naming of this group is something that took us a while to settle on because it is critical to understand the goals the group is trying to achieve (and what it is &lt;i&gt;not&lt;/i&gt;). The key element is the phrase &amp;quot;web-interoperable&amp;quot;.&lt;/p&gt;&lt;p&gt;We use &amp;quot;web&amp;quot; in exactly the same sense that the W3C and WHATWG communities use the term – precisely: &lt;i&gt;web browsers&lt;/i&gt;. The term &amp;quot;web-interoperable&amp;quot;, then, means implementing features in a manner that is &lt;i&gt;either identical or at least as consistent as possible&lt;/i&gt; with the way those features are implemented in web browsers. For instance, the way that the new URL() constructor works in browsers is exactly how the new URL() constructor should work in Node.js, in Deno, and in Cloudflare Workers.&lt;/p&gt;&lt;p&gt;It is important, however, to acknowledge the fact that Node.js, Deno, and Cloudflare Workers are explicitly &lt;b&gt;not&lt;/b&gt; web browsers. While this point should be obvious, it is important to call out because the differences between the various JavaScript environments can greatly impact the design decisions of standardized APIs. Node.js and Deno, for instance, each provide full access to the local file system. Cloudflare Workers, in contrast, has no local file system; and web browsers necessarily restrict applications from manipulating the local file system. Likewise, while web browsers inherently include a concept of a website&amp;#39;s &amp;quot;origin&amp;quot; and implement mechanisms such as &lt;a href=\&quot;https://fetch.spec.whatwg.org/#http-cors-protocol\&quot;&gt;CORS&lt;/a&gt; to protect users against a variety of security threats, there is no equivalent concept of &amp;quot;origins&amp;quot; on the server-side where Node.js, Deno, and Cloudflare Workers operate.&lt;/p&gt;&lt;p&gt;Up to now, the W3C and WHATWG have concerned themselves strictly with the needs of web browsers. The new Web-interoperable Runtimes Community Group is explicitly addressing and advocating for the needs of everyone else.&lt;/p&gt;&lt;p&gt;It is not intended that WinterCG will go off and publish its own set of independent standard APIs. Ideas for new specifications that emerge from WinterCG will first be submitted for consideration by existing work streams in the W3C and WHATWG with the goal of gaining the broadest possible consensus. However, should it become clear that web browsers have no particular need for, or interest in, a feature that the other environments (such as Cloudflare Workers) have need for, WinterCG will be empowered to move forward with a specification of its own – with the constraint that nothing will be introduced that intentionally conflicts with or is incompatible with the established web standards.&lt;/p&gt;&lt;p&gt;WinterCG will be open for anyone to participate; it will operate under the established W3C processes and policies; all work will be openly accessible via the &lt;a href=\&quot;https://github.com/wintercg\&quot;&gt;&amp;quot;wintercg&amp;quot; GitHub organization&lt;/a&gt;; and everything it does will be centered on the goal of maximizing interoperability.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;work-in-progress\&quot;&gt;Work in Progress&lt;/h2&gt;\n            &lt;a href=\&quot;#work-in-progress\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;WinterCG has already started work on a number of important work items.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-minimum-common-web-api\&quot;&gt;The Minimum Common Web API&lt;/h3&gt;\n            &lt;a href=\&quot;#the-minimum-common-web-api\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;From the introduction in the current &lt;a href=\&quot;https://github.com/wintercg/proposal-common-minimum-api\&quot;&gt;draft of the specification&lt;/a&gt;:&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&amp;quot;The Minimum Common Web Platform API is a curated subset of standardized web platform APIs intended to define a minimum set of capabilities common to Browser and Non-Browser JavaScript-based runtime environments.&amp;quot;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Or put another way: It is a minimal set of &lt;i&gt;existing&lt;/i&gt; web APIs that will be implemented consistently and correctly in Node.js, Deno, and Cloudflare Workers. Most of the APIs, with some exceptions and nuances, already exist in these environments, so the bulk of the work remaining is to ensure that those implementations are conformant to their relative specifications and portable across environments.&lt;/p&gt;&lt;p&gt;The table below lists all the APIs currently included in this subset (along with an indication of whether the API is currently or likely soon to be supported by Node.js, Deno, and Cloudflare Workers):&lt;/p&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;b&gt;Node.js&lt;/b&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;b&gt;Deno&lt;/b&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;b&gt;Cloudflare Workers&lt;/b&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://dom.spec.whatwg.org/#abortcontroller\&quot;&gt;AbortController&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://dom.spec.whatwg.org/#abortsignal\&quot;&gt;AbortSignal&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#bytelengthqueuingstrategy\&quot;&gt;ByteLengthQueueingStrategy&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://wicg.github.io/compression/#compression-stream\&quot;&gt;CompressionStream&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#countqueuingstrategy\&quot;&gt;CountQueueingStrategy&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://w3c.github.io/webcrypto/#dfn-Crypto\&quot;&gt;Crypto&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://w3c.github.io/webcrypto/#dfn-CryptoKey\&quot;&gt;CryptoKey&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://wicg.github.io/compression/#decompression-stream\&quot;&gt;DecompressionStream&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://webidl.spec.whatwg.org/#idl-DOMException\&quot;&gt;DOMException&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://dom.spec.whatwg.org/#event\&quot;&gt;Event&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://dom.spec.whatwg.org/#eventtarget\&quot;&gt;EventTarget&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#readablebytestreamcontroller\&quot;&gt;ReadableByteStreamController&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#readablestream\&quot;&gt;ReadableStream&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#readablestreambyobreader\&quot;&gt;ReadableStreamBYOBReader&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#readablestreambyobrequest\&quot;&gt;ReadableStreamBYOBRequest&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#readablestreamdefaultcontroller\&quot;&gt;ReadableStreamDefaultController&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#readablestreamdefaultreader\&quot;&gt;ReadableStreamDefaultReader&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://w3c.github.io/webcrypto/#dfn-SubtleCrypto\&quot;&gt;SubtleCrypto&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://encoding.spec.whatwg.org/#textdecoder\&quot;&gt;TextDecoder&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://encoding.spec.whatwg.org/#textdecoderstream\&quot;&gt;TextDecoderStream&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;(soon)&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://encoding.spec.whatwg.org/#textencoder\&quot;&gt;TextEncoder&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://encoding.spec.whatwg.org/#textencoderstream\&quot;&gt;TextEncoderStream&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#transformstream\&quot;&gt;TransformStream&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#transformstreamdefaultcontroller\&quot;&gt;TransformStreamDefaultController&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;(soon)&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://url.spec.whatwg.org/#url\&quot;&gt;URL&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://wicg.github.io/urlpattern/#urlpattern-class\&quot;&gt;URLPattern&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;?&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://url.spec.whatwg.org/#urlsearchparams\&quot;&gt;URLSearchParams&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#writablestream\&quot;&gt;WritableStream&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://streams.spec.whatwg.org/#writablestreamdefaultcontroller\&quot;&gt;WritableStreamDefaultController&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/window-object.html#dom-self\&quot;&gt;self&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;?&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;(soon)&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/webappapis.html#dom-atob\&quot;&gt;atob()&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/webappapis.html#dom-btoa\&quot;&gt;btoa()&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://console.spec.whatwg.org/#namespacedef-console\&quot;&gt;console&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://w3c.github.io/webcrypto/#dom-windoworworkerglobalscope-crypto\&quot;&gt;crypto&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.navigator.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/system-state.html#dom-navigator-useragent\&quot;&gt;userAgent&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;?&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-queuemicrotask\&quot;&gt;queueMicrotask()&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-settimeout\&quot;&gt;setTimeout()&lt;/a&gt;/ globalthis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-cleartimeout\&quot;&gt;clearTimeout()&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-setinterval\&quot;&gt;setInterval()&lt;/a&gt;/ globalThis.&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-clearinterval\&quot;&gt;clearInterval()&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;globalThis.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://html.spec.whatwg.org/multipage/structured-data.html#dom-structuredclone\&quot;&gt;structuredClone()&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;✔️&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;Whenever one of the environments diverges from the standardized definition of the API (such as Node.js implementation of setTimeout() and setInterval()), clear documentation describing the differences will be made available. Such differences should only exist for backwards compatibility with existing code.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;web-cryptography-streams\&quot;&gt;Web Cryptography Streams&lt;/h3&gt;\n            &lt;a href=\&quot;#web-cryptography-streams\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The &lt;a href=\&quot;https://www.w3.org/TR/WebCryptoAPI/\&quot;&gt;Web Cryptography API&lt;/a&gt; provides a minimal (and very &lt;i&gt;limited&lt;/i&gt;) APIs for  common cryptography operations. One of its key limitations is the fact that – unlike Node.js&amp;#39; &lt;a href=\&quot;https://nodejs.org/dist/latest-v18.x/docs/api/crypto.html\&quot;&gt;built-in crypto module&lt;/a&gt; – it does not have any support for streaming inputs and outputs to symmetric cryptographic algorithms. All Web Cryptography features operate on chunks of data held in memory, all at once. This strictly limits the performance and scalability of cryptographic operations. Using these APIs in any environment that is not a web browser, and trying to make them perform well, quickly becomes painful.&lt;/p&gt;&lt;p&gt;To address that issue, WinterCG has started &lt;a href=\&quot;https://github.com/wintercg/proposal-webcrypto-streams\&quot;&gt;drafting a new specification for Web Crypto Streams&lt;/a&gt; that will be submitted to the W3C for consideration as part of a larger effort currently being bootstrapped by the W3C to update the Web Cryptography specification. The goal is to bring streaming crypto operations to the whole of the web, including web browsers, in a way that conforms with existing standards.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;a-subset-of-fetch-for-servers\&quot;&gt;A subset of fetch() for servers&lt;/h3&gt;\n            &lt;a href=\&quot;#a-subset-of-fetch-for-servers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;With the recent release of version 18.0.0, &lt;a href=\&quot;https://nodejs.org/dist/latest-v18.x/docs/api/globals.html#fetch\&quot;&gt;Node.js has joined&lt;/a&gt; the collection of JavaScript environments that provide an implementation of the WHATWG standardized fetch() API. There are, however, a number of important differences between the way Node.js, Deno, and Cloudflare Workers implement fetch() versus the way it is implemented in web browsers.&lt;/p&gt;&lt;p&gt;For one, server environments do not have a concept of &amp;quot;origin&amp;quot; like a web browser does. Features such as CORS intended to protect against cross-site scripting vulnerabilities are simply irrelevant on the server. Likewise, where web browsers are generally used by one individual user at a time and have a concept of a globally-scoped cookie store, server and serverless applications can be used by millions of users simultaneously and a globally-scoped cookie store that potentially contains session and authentication details would be both impractical and dangerous.&lt;/p&gt;&lt;p&gt;Because of the acute differences in the environments, it is often difficult to reason about, and gain consensus on, proposed changes in the fetch standard. Some proposed new API, for instance, might be fantastically relevant to fetch users on a server but completely useless to fetch users in a web browser. Some set of security concerns that are relevant to the Browser might have no impact whatsoever on the server.&lt;/p&gt;&lt;p&gt;To address this issue, and to make it easier for non-web browser environments to implement fetch consistently, WinterCG is &lt;a href=\&quot;http://web.archive.org/web/20230801055012/https://github.com/wintercg/fetch\&quot;&gt;working on documenting a subset of the fetch&lt;/a&gt; standard that deals specifically with those different requirements and constraints.&lt;/p&gt;&lt;p&gt;Critically, this subset will be fully compatible with the fetch standard; and is being cooperatively developed by the same folks who have worked on fetch in Node.js, Deno, and Cloudflare Workers. It is not intended that this will become a competing definition of the fetch standard, but rather a set of documented guidelines on how to implement fetch correctly in these other environments.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;were-just-getting-started\&quot;&gt;We&amp;#39;re just getting started&lt;/h2&gt;\n            &lt;a href=\&quot;#were-just-getting-started\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;The Web-interoperable Runtimes Community Group is just getting started, and we have a number of ambitious goals. Participation is open to everyone, and all work will be done in the open via GitHub at &lt;a href=\&quot;https://github.com/wintercg\&quot;&gt;https://github.com/wintercg&lt;/a&gt;. We are actively seeking collaboration with the W3C, the WHATWG, and the JavaScript community at large to ensure that web features are available, work consistently, and meet the requirements of all web developers working anywhere across the stack.&lt;/p&gt;&lt;p&gt;For more information on the WinterCG, refer to &lt;a href=\&quot;https://wintercg.org\&quot;&gt;https://wintercg.org&lt;/a&gt;. For details on how to participate, refer to &lt;a href=\&quot;https://github.com/wintercg/admin\&quot;&gt;https://github.com/wintercg/admin&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;join-us-at-cloudflare-connect\&quot;&gt;&lt;i&gt;Join us at Cloudflare Connect!&lt;/i&gt;&lt;/h3&gt;\n            &lt;a href=\&quot;#join-us-at-cloudflare-connect\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;&lt;i&gt;Interested in learning more about building with Cloudflare Pages? If you’re based in the New York City area, join us on Thursday, May 12th for a series of workshops on how to build a full stack application on Pages! Follow along with a fully hands-on lab featuring Pages in conjunction with other products like Workers, Images and Cloudflare Gateway, and hear directly from our product managers. &lt;/i&gt;&lt;a href=\&quot;https://events.www.cloudflare.com/flow/cloudflare/connect2022nyc/landing/page/page\&quot;&gt;&lt;i&gt;Register now&lt;/i&gt;&lt;/a&gt;&lt;i&gt;!&lt;/i&gt;&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2022-05-09T14:00:27.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-02-27T07:05:30.022Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2oiyQRURELrpOTLWj1GXAS/164f2cd59bb7b4c2870ce164bbc906fb/introducing-the-wintercg.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1VkRSlsXf1AYB3QvlWU1JK&quot;],&quot;name&quot;:[0,&quot;Platform Week&quot;],&quot;slug&quot;:[0,&quot;platform-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;1AyqklWs7kExQEHm1fe6po&quot;],&quot;name&quot;:[0,&quot;Community&quot;],&quot;slug&quot;:[0,&quot;community&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3XzVULQKajbCuWudT6JD0p&quot;],&quot;name&quot;:[0,&quot;Node.js&quot;],&quot;slug&quot;:[0,&quot;node-js&quot;]}],[0,{&quot;id&quot;:[0,&quot;5cye1Bh5KxFh3pKSnX8Dsy&quot;],&quot;name&quot;:[0,&quot;Serverless&quot;],&quot;slug&quot;:[0,&quot;serverless&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;James M Snell&quot;],&quot;slug&quot;:[0,&quot;jasnell&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dR6CJtYedvLrkAZ6rxv9I/0db3d5a763a8b0a350ac04ac6410da6b/jasnell.jpg&quot;],&quot;location&quot;:[0,&quot;California&quot;],&quot;website&quot;:[0,&quot;https://bsky.app/profile/jasnell.me&quot;],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare is excited to be a part of the launch of the Web-interoperable Runtimes Community Group, a new effort that brings contributors from Cloudflare Workers, Deno, and Node.js together to collaborate on common Web platform API standards.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;A Community Group for Web-interoperable JavaScript runtimes Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;Translated for Locale&quot;],&quot;deDE&quot;:[0,&quot;Translated for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;Translated for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/introducing-the-wintercg&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;A Community Group for Web-interoperable JavaScript runtimes&quot;],&quot;description&quot;:[0,&quot;Cloudflare is excited to be a part of the launch of the Web-interoperable Runtimes Community Group, a new effort that brings contributors from Cloudflare Workers, Deno, and Node.js together to collaborate on common Web platform API standards.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/45HeUtREOczy8kkTGejAAI/7427f0191e2812cd36c929f5c2f8292e/introducing-the-wintercg-DmAw6w.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;2jyffZ43SV9rphtVcGSHbM&quot;],&quot;title&quot;:[0,&quot;Announcing native support for Stripe’s JavaScript SDK in Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;announcing-stripe-support-in-workers&quot;],&quot;excerpt&quot;:[0,&quot;Handling payments inside your apps is crucial to building a business online. For many developers, the leading choice for handling payments is Stripe. &quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6Pnl0vB1GT7f3KcKLZCipU/30bc07a84f240e18e12c7a4e325f48c7/image1-50.png\&quot; alt=\&quot;Announcing native support for Stripe’s JavaScript SDK in Cloudflare Workers\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;675\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Handling payments inside your apps is crucial to building a business online. For many developers, the leading choice for handling payments is &lt;a href=\&quot;https://stripe.com/\&quot;&gt;Stripe&lt;/a&gt;. Since my first encounter with Stripe about seven years ago, the service has evolved far beyond simple payment processing. In the &lt;a href=\&quot;/building-black-friday-e-commerce-experiences-with-jamstack-and-cloudflare-workers/\&quot;&gt;e-commerce example application I shared last year&lt;/a&gt;, Stripe managed a complete seller marketplace, using the &lt;a href=\&quot;https://stripe.com/connect\&quot;&gt;Connect&lt;/a&gt; product. Stripe&amp;#39;s product suite is great for developers looking to go beyond accepting payments.&lt;/p&gt;&lt;p&gt;Earlier versions of Stripe&amp;#39;s SDK had core Node.js dependencies, like many popular JavaScript packages. In Stripe’s case, it interacted directly with core Node.js libraries like &lt;code&gt;net/http&lt;/code&gt;, to handle HTTP interactions. For Cloudflare Workers, a V8-based runtime, this meant that the official Stripe JS library didn’t work; you had to fall back to using Stripe’s (very well-documented) REST API. By doing so, you’d lose the benefits of using Stripe’s native JS library — things like automatic type-checking in your editor, and the simplicity of function calls like &lt;code&gt;stripe.customers.create()&lt;/code&gt;, instead of manually constructed HTTP requests, to interact with Stripe’s various pieces of functionality.&lt;/p&gt;&lt;p&gt;In April, we wrote that we were &lt;a href=\&quot;/node-js-support-cloudflare-workers/\&quot;&gt;focused on increasing&lt;/a&gt; the number of JavaScript packages that are &lt;a href=\&quot;https://workers.cloudflare.com/works\&quot;&gt;compatible with Workers&lt;/a&gt;:&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;We won’t stop until our users can import popular Node.js libraries seamlessly. This effort will be large-scale and ongoing for us, but we think it’s well worth it.&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;I’m excited to announce general availability for the &lt;a href=\&quot;https://github.com/stripe/stripe-node\&quot;&gt;&lt;code&gt;stripe&lt;/code&gt;&lt;/a&gt; JS package for Cloudflare Workers. You can now use the native Stripe SDK directly in your projects! To get started, install &lt;code&gt;stripe&lt;/code&gt; in your project: &lt;code&gt;npm i stripe&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;This also opens up a great opportunity for developers who have deployed sites to Cloudflare Pages to begin using Stripe right alongside their applications. With this week’s announcement of serverless function support in Cloudflare Pages, you can accept payments for your digital product, or handle subscriptions for your membership site, with a few lines of JavaScript added to your Pages project. There’s no additional configuration, and it scales automatically, just like your Pages site.&lt;/p&gt;&lt;p&gt;To showcase this, we’ve prepared an example open-source repository, showing how you can integrate &lt;a href=\&quot;https://stripe.com/payments/checkout\&quot;&gt;Stripe Checkout&lt;/a&gt; into your Pages application. There’s no additional configuration needed — as we announced yesterday, Pages’ new Workers Functions features allows you to deploy infinitely-scalable functions just by adding a new &lt;code&gt;functions&lt;/code&gt; folder to your project. See it in action at &lt;a href=\&quot;https://stripe.pages.dev\&quot;&gt;stripe.pages.dev&lt;/a&gt;, or &lt;a href=\&quot;https://github.com/cloudflare/stripe.pages.dev\&quot;&gt;check out the open-source repository on GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;With the SDK installed, you can begin accepting payments directly in your applications. The below example shows &lt;a href=\&quot;https://stripe.com/docs/payments/accept-a-payment?integration=checkout\&quot;&gt;how to initiate a new Checkout session&lt;/a&gt; and redirect to Stripe’s hosted checkout page:&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;import Stripe from &amp;#039;stripe/lib/stripe.js&amp;#039;;\n\n// use web crypto \nexport const webCrypto = Stripe.createSubtleCryptoProvider();\n\nexport function getStripe({env}){\n  if(!env?.STRIPE_KEY){\n    throw new Error(&amp;#039;Can not initialize Stripe without STRIPE_KEY&amp;#039;);\n  }\n  const client = Stripe(env.STRIPE_KEY, {\n      httpClient: Stripe.createFetchHttpClient(), // ensure we use a Fetch client, and not Node&amp;#039;s `http`\n  });\n  return client;\n}\n\n\n\nexport default {\n  async fetch(request, env) {\n    const stripe = getStripe({ env })\n    const session = await stripe.checkout.sessions.create({\n      line_items: [{\n        price_data: {\n          currency: &amp;#039;usd&amp;#039;,\n          product_data: {\n            name: &amp;#039;T-shirt&amp;#039;,\n          },\n          unit_amount: 2000,\n        },\n        quantity: 1,\n      }],\n      payment_method_types: [\n        &amp;#039;card&amp;#039;,\n      ],\n      mode: &amp;#039;payment&amp;#039;,\n      success_url: `${YOUR_DOMAIN}/success.html`,\n      cancel_url: `${YOUR_DOMAIN}/cancel.html`,\n    });\n\n    return Response.redirect(session.url)\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;With support for the Stripe SDK natively in Cloudflare Workers, you aren’t just limited to payment processing either. Any JavaScript example that&amp;#39;s currently in &lt;a href=\&quot;https://stripe.com/docs/api?lang=node\&quot;&gt;Stripe’s extensive documentation&lt;/a&gt; works directly in Workers, without needing to make any changes.&lt;/p&gt;&lt;p&gt;In particular, using Workers to handle the multitude of available Stripe webhooks means that you can get better visibility into how your existing projects are working, without needing to spin up any new infrastructure. The below example shows how you can securely validate incoming webhook requests to a Workers function, and perform business logic by parsing the data inside that webhook:&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;import Stripe from &amp;#039;stripe/lib/stripe.js&amp;#039;;\n\n// use web crypto \nexport const webCrypto = Stripe.createSubtleCryptoProvider();\n\nexport function getStripe({env}){\n  if(!env?.STRIPE_KEY){\n    throw new Error(&amp;#039;Can not initialize Stripe without STRIPE_KEY&amp;#039;);\n  }\n  const client = Stripe(env.STRIPE_KEY, {\n      httpClient: Stripe.createFetchHttpClient(), // ensure we use a Fetch client, and not Node&amp;#039;s `http`\n  });\n  return client;\n}\n\nexport default {\n  async fetch(request, env) {\n    const stripe = getStripe({ env })\n    const body = await request.text()\n    const sig = request.headers.get(&amp;#039;stripe-signature&amp;#039;)\n    \nconst event = await stripe.webhooks.constructEventAsync(\n      body\n      sig,\n      env.STRIPE_ENDPOINT_SECRET,\n      undefined,\n      webCrypto\n    );\n\n\n    // Handle the event\n    switch (event.type) {\n      case &amp;#039;payment_intent.succeeded&amp;#039;:\n        const paymentIntent = event.data.object;\n        // Then define and call a method to handle the successful payment intent.\n        // handlePaymentIntentSucceeded(paymentIntent);\n        break;\n      case &amp;#039;payment_method.attached&amp;#039;:\n        const paymentMethod = event.data.object;\n        // Then define and call a method to handle the successful attachment of a PaymentMethod.\n        // handlePaymentMethodAttached(paymentMethod);\n        break;\n      // ... handle other event types\n      default:\n        console.log(`Unhandled event type ${event.type}`);\n    }\n\n    // Return a response to acknowledge receipt of the event\n    return new Response(JSON.stringify({ received: true }), {\n      headers: { &amp;#039;Content-type&amp;#039;: &amp;#039;application/json&amp;#039; }\n    })\n  }\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We’re also announcing &lt;a href=\&quot;https://github.com/stripe-samples/stripe-node-cloudflare-worker-template\&quot;&gt;a new Workers template&lt;/a&gt; in partnership with Stripe. The template will help you get up and running with Stripe and Workers, using our best practices.&lt;/p&gt;&lt;p&gt;In less than five minutes, you can begin accepting payments for your next digital product or membership business. You can also handle and validate incoming webhooks at the edge, from a single codebase. This comes with no upfront cost, server provisioning, or any of the standard scaling headaches. Take your serverless functions, deploy them to Cloudflare’s edge, and start making money!&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;“We&amp;#39;re big fans of Cloudflare Workers over here at Stripe. Between the wild performance at the edge and fantastic serverless development experience, we&amp;#39;re excited to see what novel ways you all use Stripe to make amazing apps.”— &lt;b&gt;Brian Holt, Stripe&lt;/b&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;We’re thrilled with this incredible update to Stripe’s JavaScript SDK. We’re also excited to see what you’ll build with native Stripe support in Workers. Join our Discord server and share what you’ve built in the #what-i-built channel — &lt;a href=\&quot;https://cloudflare.community/\&quot;&gt;get your invite here&lt;/a&gt;.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2021-11-19T13:59:58.000+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:16:19.211Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5eN4PbPb1cRLCGDVj71hGn/e81b3c2ee61264828f5e1155599ad29f/announcing-stripe-support-in-workers.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;4Q1oXZOskZczYetWpWXIsl&quot;],&quot;name&quot;:[0,&quot;Full Stack Week&quot;],&quot;slug&quot;:[0,&quot;full-stack-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Kristian Freeman&quot;],&quot;slug&quot;:[0,&quot;kristian&quot;],&quot;bio&quot;:[0,&quot;Manager, Developer Advocacy team at Cloudflare. We help developers build amazing apps on Cloudflare, with tools like Workers, Pages, and more!&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3VUYoHwDSenpoOr2qQ5rQe/5aae862918663bc3e682ede2eb385c22/kristian.jpg&quot;],&quot;location&quot;:[0,&quot;Austin, TX&quot;],&quot;website&quot;:[0,&quot;https://www.signalnerve.com&quot;],&quot;twitter&quot;:[0,&quot;@kristianf_&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Handling payments inside your apps is crucial to building a business online. For many developers, the leading choice for handling payments is Stripe. &quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Announcing native support for Stripe’s JavaScript SDK in Cloudflare Workers Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/announcing-stripe-support-in-workers&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Announcing native support for Stripe’s JavaScript SDK in Cloudflare Workers&quot;],&quot;description&quot;:[0,&quot;Handling payments inside your apps is crucial to building a business online. For many developers, the leading choice for handling payments is Stripe. &quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/WbcnhTX7HiS0eVSFU3VA3/9d9a8b0dd4c54dfe02698bfee2567de9/announcing-stripe-support-in-workers-SMyg1o.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;7Alvb0yCnnm4ly3qnIFPk7&quot;],&quot;title&quot;:[0,&quot;JavaScript modules are now supported on Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers-javascript-modules&quot;],&quot;excerpt&quot;:[0,&quot;Now you can use JavaScript modules, also known as ECMAScript or “ES” modules, on Cloudflare Workers. This replaces the old “addEventListener” syntax with a new “import” and “export” semantics that makes it really easy to write reusable, modular code.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/baJtGnmh2zR5W5bkcrrG7/14a1ca82fb8ecbcbde619a9cd957fe0b/image1-27.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;675\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;We’re excited to announce that JavaScript modules are now supported on Cloudflare Workers. If you’ve ever taken look at an example Worker written in JavaScript, you might recognize the following code snippet that has been floating around the Internet the past few years:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;addEventListener(&amp;quot;fetch&amp;quot;, (event) =&amp;gt; {\n  event.respondWith(new Response(&amp;quot;Hello Worker!&amp;quot;));\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The above syntax is known as the “&lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API\&quot;&gt;Service Worker&lt;/a&gt;” API, and it was proposed to be standardized for use in web browsers. The idea is that you can attach a JavaScript file to a web page to modify its HTTP requests and responses, acting like a virtual endpoint. It was exactly what we needed for Workers, and it even integrated well with standard Web APIs like &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/fetch\&quot;&gt;&lt;code&gt;fetch()&lt;/code&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/cache\&quot;&gt;&lt;code&gt;caches&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Before introducing modules, we want to make it clear that we will continue to support the Service Worker API. No developer wants to get an email saying that &lt;i&gt;you&lt;/i&gt; need to rewrite &lt;i&gt;your&lt;/i&gt; code because an &lt;a href=\&quot;https://www.cloudflare.com/learning/security/api/what-is-an-api/\&quot;&gt;API&lt;/a&gt; or feature is being deprecated; and you won’t be getting one from us. If you’re interested in learning why we made this decision, you can read about our commitment to &lt;a href=\&quot;/backwards-compatibility-in-cloudflare-workers/\&quot;&gt;backwards-compatibility&lt;/a&gt; for Workers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;what-are-javascript-modules\&quot;&gt;What are JavaScript modules?&lt;/h3&gt;\n            &lt;a href=\&quot;#what-are-javascript-modules\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;JavaScript modules, also known as ECMAScript (abbreviated. “ES”) modules, is the standard API for importing and exporting code in JavaScript. It was introduced by the “ES6” language specification for JavaScript, and has been implemented by most Web browsers, Node.js, Deno, and now Cloudflare Workers. Here’s an example to demonstrate how it works:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// filename: ./src/util.js\nexport function getDate(time) {\n  return new Date(time).toISOString().split(&amp;quot;T&amp;quot;)[0]; // &amp;quot;YYYY-MM-DD&amp;quot;\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The &amp;quot;export&amp;quot; keyword indicates that the &amp;quot;getDate&amp;quot; function should be exported from the current module. Then, you can use &amp;quot;import&amp;quot; from another module to use that function.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// filename: ./src/index.js\nimport { getDate } from &amp;quot;./util.js&amp;quot;\n\nconsole.log(&amp;quot;Today’s date:&amp;quot;, getDate());&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Those are the basics, but there’s a lot more you can do with modules. It allows you to organize, maintain, and re-use your code elegantly that just works. While we can’t go over &lt;i&gt;every&lt;/i&gt; aspect of modules here, if you’d like to learn more we’d encourage you to read the &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules\&quot;&gt;MDN guide&lt;/a&gt; on modules, or a more &lt;a href=\&quot;https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/\&quot;&gt;technical deep-dive&lt;/a&gt; by Lin Clark.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;how-can-i-use-modules-in-workers\&quot;&gt;How can I use modules in Workers?&lt;/h3&gt;\n            &lt;a href=\&quot;#how-can-i-use-modules-in-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;You can export a default module, which will represent your Worker. Instead of using &amp;quot;addEventListener,&amp;quot; each event handler is defined as a function on that module. Today, we support &amp;quot;&lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/fetch-event#syntax-module-worker\&quot;&gt;fetch&lt;/a&gt;&amp;quot; for HTTP and WebSocket requests and &amp;quot;&lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/scheduled-event#syntax-module-worker\&quot;&gt;scheduled&lt;/a&gt;&amp;quot; for cron triggers.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;export default {\n  async fetch(request, environment, context) {\n    return new Response(&amp;quot;I’m a module!&amp;quot;);\n  },\n  async scheduled(controller, environment, context) {\n    // await doATask();\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You may also notice some other differences, such as the parameters on each event handler. Instead of a single &amp;quot;Event&amp;quot; object, the parameters that you need the most are spread out on their own. The first parameter is specific to the event type: for &amp;quot;fetch&amp;quot; it’s the &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/request\&quot;&gt;Request&lt;/a&gt; object, and for &amp;quot;scheduled&amp;quot; it’s a &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/scheduled-event#properties-1\&quot;&gt;controller&lt;/a&gt; that contains the cron schedule.&lt;/p&gt;&lt;p&gt;The second parameter is an object that contains your environment variables (also known as &amp;quot;&lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/environment-variables\&quot;&gt;bindings&lt;/a&gt;&amp;quot;). Previously, each variable was inserted into the global scope of the Worker. While a simple solution, it was confusing to have variables magically appear in your code. Now, with an environment object, you can control which modules and libraries get access to your environment variables. This mechanism is more secure, as it can prevent a compromised or nosy third-party library from enumerating all your variables or secrets.&lt;/p&gt;&lt;p&gt;The third parameter is a context object, which allows you to register background tasks using &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/fetch-event#waituntil\&quot;&gt;&lt;code&gt;waitUntil()&lt;/code&gt;&lt;/a&gt;. This is useful for tasks like logging or error reporting that should not block the execution of the event.&lt;/p&gt;&lt;p&gt;When you put that all together, you can import and export multiple modules, as well as use the new event handler syntax.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// filename: ./src/error.js\nexport async function logError(url, error) {\n  await fetch(url, {\n     method: &amp;quot;POST&amp;quot;,\n     body: error.stack\n  })\n}&lt;/pre&gt;&lt;/code&gt;\n            \n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// filename: ./src/worker.js\nimport { logError } from &amp;quot;./error.js&amp;quot;\n\nexport default {\n  async fetch(request, environment, context) {\n    try {\n       return await fetch(request);\n    } catch (error) {\n       context.waitUntil(logError(environment.ERROR_URL, error));\n       return new Response(&amp;quot;Oops!&amp;quot;, { status: 500 });\n    }\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Let’s not forget about Durable Objects, which became &lt;a href=\&quot;/durable-objects-ga\&quot;&gt;generally available&lt;/a&gt; earlier this week! You can also export classes, which is how you define a Durable Object class. Here’s another example with a &amp;quot;Counter&amp;quot; Durable Object, that responds with an incrementing value.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// filename: ./src/counter.js\nexport class Counter {\n  value = 0;\n  fetch() {\n    this.value++;\n    return new Response(this.value.toString());\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            \n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// filename: ./src/worker.js\n// We need to re-export the Durable Object class in the Worker module.\nexport { Counter } from &amp;quot;./counter.js&amp;quot;\n\nexport default {\n  async fetch(request, environment) {\n    const clientId = request.headers.get(&amp;quot;cf-connecting-ip&amp;quot;);\n    const counterId = environment.Counter.idFromName(clientId);\n    // Each IP address gets its own Counter.\n    const counter = environment.Counter.get(counterId);\n    return counter.fetch(&amp;quot;https://counter.object/increment&amp;quot;);\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;are-there-non-javascript-modules\&quot;&gt;Are there non-JavaScript modules?&lt;/h3&gt;\n            &lt;a href=\&quot;#are-there-non-javascript-modules\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Yes! While modules are primarily for JavaScript, we also support other modules types, some of which are not yet standardized.&lt;/p&gt;&lt;p&gt;For instance, you can import &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/WebAssembly\&quot;&gt;WebAssembly&lt;/a&gt; as a &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/Module/Module#synchronously_compiling_a_webassembly_module\&quot;&gt;module&lt;/a&gt;. Previously, with the Service Worker API, WebAssembly was included as a binding. We think that was a mistake, since WebAssembly should be represented as code and not an external resource. With modules, here’s the new way to import WebAssembly:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import module from &amp;quot;./lib/hello.wasm&amp;quot;\n\nexport default {\n  async fetch(request) {\n    const instance = await WebAssembly.instantiate(module);\n    const result = instance.exports.hello();\n    return new Response(result);\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;While not supported today, we look forward to a future where WebAssembly and JavaScript modules can be more tightly integrated, as outlined in this &lt;a href=\&quot;https://github.com/WebAssembly/esm-integration/tree/main/proposals/esm-integration#webassemblyes-module-integration\&quot;&gt;proposal&lt;/a&gt;. The ergonomics improvement, demonstrated below, can go a long way to make WebAssembly more included in the JavaScript ecosystem.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import { hello } from &amp;quot;./lib/hello.wasm&amp;quot;\n\nexport default {\n  async fetch(request) {\n    return new Response(hello());\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We’ve also added support for text and binary modules, which allow you to import a &lt;code&gt;String&lt;/code&gt; and &lt;code&gt;ArrayBuffer&lt;/code&gt;, respectively. While not standardized, it allows you to easily import resources like an HTML file or an image.&lt;/p&gt;\n            &lt;pre class=\&quot;language-html\&quot;&gt;&lt;code class=\&quot;language-html\&quot;&gt;&amp;lt;!-- filename: ./public/index.html --&amp;gt;\n&amp;lt;!DOCTYPE html&amp;gt;\n&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;\n&amp;lt;p&amp;gt;Hello!&amp;lt;/p&amp;gt;\n&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&lt;/pre&gt;&lt;/code&gt;\n            \n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import html from &amp;quot;../public/index.html&amp;quot;\n\nexport default {\n  fetch(request) {\n    if (request.url.endsWith(&amp;quot;/index.html&amp;quot;) {\n       return new Response(html, {\n          headers: { &amp;quot;Content-Type&amp;quot;: &amp;quot;text/html&amp;quot; }\n       });\n    }\n    return fetch(request);\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;how-can-i-get-started\&quot;&gt;How can I get started?&lt;/h3&gt;\n            &lt;a href=\&quot;#how-can-i-get-started\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;There are many ways to get started with modules.&lt;/p&gt;&lt;p&gt;First, you can try out modules in your browser using our &lt;a href=\&quot;https://cloudflareworkers.com/#a47f44190209e87bc95d5127ae0b2c84:https://welcome.developers.workers.dev\&quot;&gt;playground&lt;/a&gt; (which doesn’t require an account) or by using the dashboard &lt;a href=\&quot;https://workers.new\&quot;&gt;quick editor&lt;/a&gt;. Your browser will automatically detect when you’re using modules to allow you to seamlessly switch from the Service Worker API. For now, you’ll only be able to create one JavaScript module in the browser, though supporting multiple modules is something we’ll be improving soon.&lt;/p&gt;&lt;p&gt;If you’re feeling adventurous and want to start a &lt;i&gt;new&lt;/i&gt; project using modules, you can try out the beta release of &lt;a href=\&quot;/wrangler-v2-beta\&quot;&gt;wrangler 2.0&lt;/a&gt;, the next-generation of the command-line interface (CLI) for Workers.&lt;/p&gt;&lt;p&gt;For existing projects, we still recommend using &lt;a href=\&quot;https://github.com/cloudflare/wrangler\&quot;&gt;wrangler 1.0&lt;/a&gt; (release 1.17 or later). To enable modules, you can adapt your &amp;quot;&lt;a href=\&quot;https://developers.cloudflare.com/workers/cli-wrangler/configuration#modules\&quot;&gt;wrangler.toml&lt;/a&gt;&amp;quot; configuration to the following example:&lt;/p&gt;\n            &lt;pre class=\&quot;language-toml\&quot;&gt;&lt;code class=\&quot;language-toml\&quot;&gt;name = &amp;quot;my-worker&amp;quot;\ntype = &amp;quot;javascript&amp;quot;\nworkers_dev = true\n\n[build.upload]\nformat = &amp;quot;modules&amp;quot;\ndir = &amp;quot;./src&amp;quot;\nmain = &amp;quot;./worker.js&amp;quot; # becomes &amp;quot;./src/worker.js&amp;quot;\n\n[[build.upload.rules]]\ntype = &amp;quot;ESModule&amp;quot;\nglobs = [&amp;quot;**/*.js&amp;quot;]\n\n# Uncomment if you have a build script.\n# [build]\n# command = &amp;quot;npm run build&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We’ve updated our &lt;a href=\&quot;https://developers.cloudflare.com/workers/\&quot;&gt;documentation&lt;/a&gt; to provide more details about &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/fetch-event#syntax-module-worker\&quot;&gt;modules&lt;/a&gt;, though some examples will still be using the Service Worker API as we transition to showing both formats. (and TypeScript as a bonus!)&lt;/p&gt;&lt;p&gt;If you experience an issue or notice something strange with modules, please &lt;a href=\&quot;mailto:workers-modules@cloudflare.com\&quot;&gt;let us know&lt;/a&gt;, and we’ll take a look. Happy coding, and we’re excited to see what you build with modules!&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3ZcNNYExuFZtWS9zT5TZ9E/04b138284d4ba8bfbf3b73eba1f18cdf/image2-11.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;385\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;watch-on-cloudflare-tv\&quot;&gt;Watch on Cloudflare TV&lt;/h3&gt;\n            &lt;a href=\&quot;#watch-on-cloudflare-tv\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;!--kg-card-begin: html--&gt;&lt;div style=\&quot;position: relative; padding-top: 56.25%;\&quot;&gt;&lt;iframe src=\&quot;https://iframe.videodelivery.net/07356fcb9d66ada45f8dcc2217b8c1d7?preload=true&amp;poster=https%3A%2F%2Fvideodelivery.net%2F07356fcb9d66ada45f8dcc2217b8c1d7%2Fthumbnails%2Fthumbnail.jpg%3Ftime%3D0m4s%26height%3D600\&quot; style=\&quot;border: none; position: absolute; top: 0; left: 0; height: 100%; width: 100%;\&quot; allow=\&quot;accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;\&quot; allowfullscreen=\&quot;true\&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2021-11-16T13:58:42.000+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:16:06.746Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7HTaKzPO9I9k25CvOiTyEs/959cb3d715a44a013186ecc013f117f5/workers-javascript-modules.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;4Q1oXZOskZczYetWpWXIsl&quot;],&quot;name&quot;:[0,&quot;Full Stack Week&quot;],&quot;slug&quot;:[0,&quot;full-stack-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Ashcon Partovi&quot;],&quot;slug&quot;:[0,&quot;ashcon&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6mLS6e7vpfh6V98eiR9MQH/f0f35aee7cf8f2300f222e85aff9abc1/ashcon.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@ashconpartovi&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Now you can use JavaScript modules, also known as ECMAScript or “ES” modules, on Cloudflare Workers. This replaces the old “addEventListener” syntax with a new “import” and “export” semantics that makes it really easy to write reusable, modular code.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;JavaScript modules are now supported on Cloudflare Workers Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/workers-javascript-modules&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;JavaScript modules are now supported on Cloudflare Workers&quot;],&quot;description&quot;:[0,&quot;Now you can use JavaScript modules, also known as ECMAScript or “ES” modules, on Cloudflare Workers. This replaces the old “addEventListener” syntax with a new “import” and “export” semantics that makes it really easy to write reusable, modular code.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3dZFHwRYeq7iv42CAkzWFT/e246a3754047bfcfb1fc27a71fd9379d/workers-javascript-modules-QAiws1.png&quot;]}],&quot;publicly_index&quot;:[0,true]}]]],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;MorePosts&quot;,&quot;value&quot;:true}" await-children><div class="w-100 bt-l b--gray8"><h3 data-testid="more-posts-title" class="orange fw5 f4 ph3 mt4">MORE POSTS</h3></div><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2024-11-19T14:00-08:00">November 19, 2024  10:00 PM</p><a href="/do-it-again/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">DO it again: how we used Durable Objects to add WebSockets support and authentication to AI Gateway</h6></a><p class="gray1 lh-copy">We used Cloudflare’s Developer Platform and Durable Objects to build authentication and a WebSockets API that developers can use to call AI Gateway, enabling continuous communication over a single<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/catarina-pires-mota/" class="fw5 f2 black no-underline">Catarina Pires Mota</a></div></li><li class="list flex items-center"><div class="author-name-tooltip"><span class="fw5 f2 black no-underline">, </span><a href="/author/gabriel-massadas/" class="fw5 f2 black no-underline">Gabriel Massadas</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/ai/" class="no-underline f1 fw2 blue3 underline-hover">AI</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/ai-gateway/" class="no-underline f1 fw2 blue3 underline-hover">AI Gateway</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developers/" class="no-underline f1 fw2 blue3 underline-hover">Developers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developer-platform/" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2024-09-09T14:00-07:00">September 09, 2024  9:00 PM</p><a href="/more-npm-packages-on-cloudflare-workers-combining-polyfills-and-native-code/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">More NPM packages on Cloudflare Workers: Combining polyfills and native code to support Node.js APIs</h6></a><p class="gray1 lh-copy">Workers now supports more NPM packages and Node.js APIs using an overhauled hybrid compatibility layer.<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/jasnell/" class="fw5 f2 black no-underline">James M Snell</a></div></li><li class="list flex items-center"><div class="author-name-tooltip"><span class="fw5 f2 black no-underline">, </span><a href="/author/igor/" class="fw5 f2 black no-underline">Igor Minar</a></div></li><li class="list flex items-center"><div class="author-name-tooltip"><span class="fw5 f2 black no-underline">, </span><a href="/author/james-culveyhouse/" class="fw5 f2 black no-underline">James Culveyhouse</a></div></li><li class="list flex items-center"><div class="author-name-tooltip"><span class="fw5 f2 black no-underline">, </span><a href="/author/mike-nomitch/" class="fw5 f2 black no-underline">Mike Nomitch</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/node-js/" class="no-underline f1 fw2 blue3 underline-hover">Node.js</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/serverless/" class="no-underline f1 fw2 blue3 underline-hover">Serverless</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2024-06-26T21:23:41.000+01:00">June 26, 2024  8:23 PM</p><a href="/automatically-replacing-polyfill-io-links-with-cloudflares-mirror-for-a-safer-internet/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Automatically replacing polyfill.io links with Cloudflare’s mirror for a safer Internet</h6></a><p class="gray1 lh-copy">polyfill.io, a popular JavaScript library service, can no longer be trusted and should be removed from websites<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/matthew-prince/" class="fw5 f2 black no-underline">Matthew Prince</a></div></li><li class="list flex items-center"><div class="author-name-tooltip"><span class="fw5 f2 black no-underline">, </span><a href="/author/john-graham-cumming/" class="fw5 f2 black no-underline">John Graham-Cumming</a></div></li><li class="list flex items-center"><div class="author-name-tooltip"><span class="fw5 f2 black no-underline">, </span><a href="/author/michael-tremante/" class="fw5 f2 black no-underline">Michael Tremante</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/cdnjs/" class="no-underline f1 fw2 blue3 underline-hover">CDNJS</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/vulnerabilities/" class="no-underline f1 fw2 blue3 underline-hover">Vulnerabilities</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/application-security/" class="no-underline f1 fw2 blue3 underline-hover">Application Security</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/application-services/" class="no-underline f1 fw2 blue3 underline-hover">Application Services</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2024-02-29T17:51:32.000+00:00">February 29, 2024  5:51 PM</p><a href="/polyfill-io-now-available-on-cdnjs-reduce-your-supply-chain-risk/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">polyfill.io now available on cdnjs: reduce your supply chain risk</h6></a><p class="gray1 lh-copy">Polyfill.io is now available on cdnjs to reduce the risk of supply chain attacks. Replace your polyfill.io links today for a seamless experience<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/sven/" class="fw5 f2 black no-underline">Sven Sauleau</a></div></li><li class="list flex items-center"><div class="author-name-tooltip"><span class="fw5 f2 black no-underline">, </span><a href="/author/michael-tremante/" class="fw5 f2 black no-underline">Michael Tremante</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/cdnjs/" class="no-underline f1 fw2 blue3 underline-hover">CDNJS</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/supply-chain-attacks/" class="no-underline f1 fw2 blue3 underline-hover">Supply Chain Attacks</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2023-11-14T14:00:33.000+00:00">November 14, 2023  2:00 PM</p><a href="/workers-ai-streaming/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Streaming and longer context lengths for LLMs on Workers AI</h6></a><p class="gray1 lh-copy">Workers AI now supports streaming text responses for the LLM models in our catalog, including Llama-2, using server-sent events<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/jesse/" class="fw5 f2 black no-underline">Jesse Kipp</a></div></li><li class="list flex items-center"><div class="author-name-tooltip"><span class="fw5 f2 black no-underline">, </span><a href="/author/celso/" class="fw5 f2 black no-underline">Celso Martinho</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/workers-ai/" class="no-underline f1 fw2 blue3 underline-hover">Workers AI</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developer-platform/" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/serverless/" class="no-underline f1 fw2 blue3 underline-hover">Serverless</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2023-09-28T14:00:38.000+01:00">September 28, 2023  1:00 PM</p><a href="/running-serverless-puppeteer-workers-durable-objects/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Running Serverless Puppeteer with Workers and Durable Objects</h6></a><p class="gray1 lh-copy">We’ve heard from developers that configuring and maintaining their own serverless browser automation systems can be quite painful. The Workers Browser Rendering API solves this<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/tanushree/" class="fw5 f2 black no-underline">Tanushree Sharma</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/birthday-week/" class="no-underline f1 fw2 blue3 underline-hover">Birthday Week</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/product-news/" class="no-underline f1 fw2 blue3 underline-hover">Product News</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/durable-objects/" class="no-underline f1 fw2 blue3 underline-hover">Durable Objects</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developers/" class="no-underline f1 fw2 blue3 underline-hover">Developers</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2023-05-19T14:00:47.000+01:00">May 19, 2023  1:00 PM</p><a href="/workers-node-js-apis-stream-path/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">More Node.js APIs in Cloudflare Workers — Streams, Path, StringDecoder</h6></a><p class="gray1 lh-copy">Today we are announcing support for three additional APIs from Node.js in Cloudflare Workers — stream, crypto, and http/https.request. This increases compatibility with the existing ecosystem of open source NPM packages, allowing you to use your preferred libraries in Workers.<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/jasnell/" class="fw5 f2 black no-underline">James M Snell</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/developer-week/" class="no-underline f1 fw2 blue3 underline-hover">Developer Week</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developers/" class="no-underline f1 fw2 blue3 underline-hover">Developers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/node-js/" class="no-underline f1 fw2 blue3 underline-hover">Node.js</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2023-03-23T13:05:00.000+00:00">March 23, 2023  1:05 PM</p><a href="/workers-node-js-asynclocalstorage/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Node.js compatibility for Cloudflare Workers – starting with Async Context Tracking, EventEmitter, Buffer, assert, and util</h6></a><p class="gray1 lh-copy">Over the coming months, Cloudflare Workers will start to roll out built-in compatibility with Node.js core APIs as part of an effort to support increased compatibility across JavaScript runtimes<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/jasnell/" class="fw5 f2 black no-underline">James M Snell</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/node-js/" class="no-underline f1 fw2 blue3 underline-hover">Node.js</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developers/" class="no-underline f1 fw2 blue3 underline-hover">Developers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developer-platform/" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2023-03-13T13:00:00.000+00:00">March 13, 2023  1:00 PM</p><a href="/page-shield-positive-blocking-policies/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Locking down your JavaScript: positive blocking with Page Shield policies</h6></a><p class="gray1 lh-copy">Starting today, using Page Shield, Cloudflare’s client side security solution, you can ensure only vetted and secure JavaScript is being executed by your user’s browsers. Stop unwanted JavaScript and keep your end user data safe with Page Shield policies.<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/michael-tremante/" class="fw5 f2 black no-underline">Michael Tremante</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/security-week/" class="no-underline f1 fw2 blue3 underline-hover">Security Week</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/security/" class="no-underline f1 fw2 blue3 underline-hover">Security</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/page-shield/" class="no-underline f1 fw2 blue3 underline-hover">Page Shield</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2022-11-17T14:00:00.000+00:00">November 17, 2022  2:00 PM</p><a href="/snippets-announcement/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">The most programmable Supercloud with Cloudflare Snippets</h6></a><p class="gray1 lh-copy">Today we are announcing Cloudflare Snippets. Snippets are a simple way of executing a small piece of Javascript on select HTTP requests, using the ruleset engine filtering logic.<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/sam-marsh/" class="fw5 f2 black no-underline">Sam Marsh</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/developer-week/" class="no-underline f1 fw2 blue3 underline-hover">Developer Week</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/snippets/" class="no-underline f1 fw2 blue3 underline-hover">Snippets</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2022-08-05T16:45:57.000+01:00">August 05, 2022  3:45 PM</p><a href="/building-scheduling-system-with-workers-and-durable-objects/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Building a scheduling system with Workers and Durable Objects</h6></a><p class="gray1 lh-copy">In this post we&#x27;re going to show you how to build a scalable service that will schedule HTTP requests on a specific schedule or as one-off at a specific time <!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/adam-janis/" class="fw5 f2 black no-underline">Adam Janiš</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/durable-objects/" class="no-underline f1 fw2 blue3 underline-hover">Durable Objects</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/serverless/" class="no-underline f1 fw2 blue3 underline-hover">Serverless</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/edge/" class="no-underline f1 fw2 blue3 underline-hover">Edge</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2022-07-05T13:59:11.000+01:00">July 05, 2022  12:59 PM</p><a href="/making-page-shield-malicious-code-alerts-more-actionable/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Making Page Shield malicious code alerts more actionable</h6></a><p class="gray1 lh-copy">In this post we go over improvements to script status, metadata and categorization.<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/swijckmans/" class="fw5 f2 black no-underline">Simon Wijckmans</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/security/" class="no-underline f1 fw2 blue3 underline-hover">Security</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/page-shield/" class="no-underline f1 fw2 blue3 underline-hover">Page Shield</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2022-05-09T14:00:27.000+01:00">May 09, 2022  1:00 PM</p><a href="/introducing-the-wintercg/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">A Community Group for Web-interoperable JavaScript runtimes</h6></a><p class="gray1 lh-copy">The Web-interoperable Runtimes Community Group is a new effort that brings contributors from Cloudflare Workers, Deno, and Node.js together to collaborate on common Web platform API standards.<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/jasnell/" class="fw5 f2 black no-underline">James M Snell</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/platform-week/" class="no-underline f1 fw2 blue3 underline-hover">Platform Week</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/community/" class="no-underline f1 fw2 blue3 underline-hover">Community</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/node-js/" class="no-underline f1 fw2 blue3 underline-hover">Node.js</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2021-11-19T13:59:58.000+00:00">November 19, 2021  1:59 PM</p><a href="/announcing-stripe-support-in-workers/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Announcing native support for Stripe’s JavaScript SDK in Cloudflare Workers</h6></a><p class="gray1 lh-copy">Handling payments inside your apps is crucial to building a business online. For many developers, the leading choice for handling payments is Stripe. <!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/kristian/" class="fw5 f2 black no-underline">Kristian Freeman</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/full-stack-week/" class="no-underline f1 fw2 blue3 underline-hover">Full Stack Week</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developers/" class="no-underline f1 fw2 blue3 underline-hover">Developers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developer-platform/" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2021-11-16T13:58:42.000+00:00">November 16, 2021  1:58 PM</p><a href="/workers-javascript-modules/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">JavaScript modules are now supported on Cloudflare Workers</h6></a><p class="gray1 lh-copy">Now you can use JavaScript modules, also known as ECMAScript or “ES” modules, on Cloudflare Workers. This replaces the old “addEventListener” syntax with a new “import” and “export” semantics that makes it really easy to write reusable, modular code.<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/ashcon/" class="fw5 f2 black no-underline">Ashcon Partovi</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/full-stack-week/" class="no-underline f1 fw2 blue3 underline-hover">Full Stack Week</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developers/" class="no-underline f1 fw2 blue3 underline-hover">Developers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developer-platform/" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform</a></div></div></article><!--astro:end--></astro-island> <div class="pagination mw-100 center mv5 ph3 w-100 tc"><div class="center w-50-l w-100"><div class="flex items-center justify-center justify-around-m "><ul class="flex list ml3" style="padding-inline-start:inherit"><li class="gray"><a class="no-underline  underline-hover  dib-m dib-l mr1 gray3 " href="/tag/javascript/">1</a></li><li class=""><a class="no-underline  underline-hover  dib-m dib-l mr1 blue3" href="/tag/javascript/page/2/">2</a></li><li class="ml">…</li><li><a class="no-underline  underline-hover dib-m dib-l mr3 blue3" href="/tag/javascript/page/6/">6</a></li></ul><span><a class="no-underline blue3 underline-hover" data-testid="pagination-toggle-next" href="/tag/javascript/page/2/" rel="prev"><span class="underline-hover dn dib-m dib-l">Older Posts</span> →</a></span></div></div></div> </main>  <footer class="pt4 pb4 pl1 pr1 main-footer"><div class="mw8 center dn db-l ph3"><div class="flex flex-row justify-between"><div class="main-footer__menu-group"><ul id="getting-started-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="getting-started-menu">Getting Started<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/free/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="free-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Free plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/enterprise/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="enterprise" class="f1 blue3 no-underline underline-hover" rel="noreferrer">For enterprises</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compare-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compare plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-your-website/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="get-a-recommendation" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Get a recommendation</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/demo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="request-a-demo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Request a demo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/contact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="contact-sales" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Contact Sales</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1" data-submenu="company-menu">Resources<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/learning/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="learning-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Learning Center</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/analysts/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="analysts-report" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Analyst reports</a></li><li class="pt1 pb1"><a href="https://radar.cloudflare.com/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Radar</a></li><li class="pt1 pb1"><a href="https://cloudflare.tv/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="tv" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare TV</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/case-studies/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="case-studies" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Case Studies</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Webinar" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="webinars" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Webinars</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Whitepaper" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="white-papers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">White Papers</a></li><li class="pt1 pb1"><a href="https://developers.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-docs" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer docs</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/the-net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="theNet" class="f1 blue3 no-underline underline-hover" rel="noreferrer">theNet</a></li></ul></div><div class="main-footer__menu-group"><ul id="sales-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="sales-menu">Solutions<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connectivity-cloud/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connectivity-cloud" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connectivity cloud</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/zero-trust/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="zero-trust" class="f1 blue3 no-underline underline-hover" rel="noreferrer">SSE and SASE services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/application-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="application-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Application services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/developer-platform/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer services</a></li></ul></div><div class="main-footer__menu-group"><ul id="community-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="community-menu">Community<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://community.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="community_hub" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Community Hub</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/galileo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="galileo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Project Galileo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/athenian/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="athenian" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Athenian Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/campaigns/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="cloudflare-for-campaigns" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare for Campaigns</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/technology-partners/cidp/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="critical-infrastructure-defense-project" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Critical Infrastructure Defense Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connect2024/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connect-2024" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connect 2024</a></li></ul></div><div class="main-footer__menu-group"><ul id="support-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="support-menu">Support<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://support.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="help-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Help center</a></li><li class="pt1 pb1"><a href="https://www.cloudflarestatus.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="status" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Status</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/compliance/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compliance" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compliance</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/gdpr/introduction/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="gdpr" class="f1 blue3 no-underline underline-hover" rel="noreferrer">GDPR</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/trust-hub/abuse-approach/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="trust-and-safety" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Trust &amp; Safety</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="company-menu">Company<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-overview/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">About Cloudflare</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/people/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="our_team" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Our team</a></li><li class="pt1 pb1"><a href="https://cloudflare.net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="investor-relations" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Investor relations</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Press</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/careers/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="careers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Careers</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/diversity-equity-and-inclusion/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="diversity-equity-inclusion" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Diversity, equity &amp; inclusion</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/impact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="impact-ESG" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Impact/ESG</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network_map" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network Map</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press-kit/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press-kit" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Logos &amp; press kit</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="partners" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Become a partner</a></li></ul></div></div></div><div class="mw8 center ph3"><div class="flex flex-row flex-wrap justify-center md:justify-between items-center pt4"><div class="flex flex-row space-x-4 items-start w-25-l pb4 pb0-l"><a target="_blank" rel="noreferrer" href="https://www.facebook.com/Cloudflare/" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/facebook.svg" alt="facebook"/></a><a target=" _blank" rel="noreferrer" href="https://x.com/Cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/twitter.svg" alt="X"/></a><a target="_blank" rel="noreferrer" href="https://www.linkedin.com/company/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/linkedin.svg" alt="linkedin"/></a><a target="_blank" rel="noreferrer" href="https://www.youtube.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/youtube.svg" alt="youtube"/></a><a target="_blank" rel="noreferrer" href="https://www.instagram.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/instagram.svg" alt="instagram"/></a></div><div class="w-70-l tr-l tl-ns"><div><span class="main-footer__copyright f1">© <!-- -->2025<!-- --> Cloudflare, Inc.<!-- --> </span><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/privacypolicy/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Privacy Policy<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/website-terms/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Terms of Use<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/disclosure/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Report Security Issues<!-- --> </a><span class="main-footer__copyright f1">|</span><img class="mw2 ph1" src="/images/privacy-options.svg" alt="Privacy Options"/><a href="#cookie-settings" id="ot-sdk-btn" class="ot-sdk-show-settings main-footer__copyright f1 no-underline underline-hover"><span class="brandGray5">Cookie Preferences</span> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/trademark/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Trademark<!-- --> </a></div></div></div></div></footer></html>
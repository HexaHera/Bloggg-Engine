<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://blog.cryptographyengineering.com/xmlrpc.php">

<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>A Few Thoughts on Cryptographic Engineering &#8211; Some random thoughts about crypto. Notes from a course I teach. Pictures of my dachshunds.</title>
<meta name='robots' content='max-image-preview:large' />

<!-- Async WordPress.com Remote Login -->
<script id="wpcom_remote_login_js">
var wpcom_remote_login_extra_auth = '';
function wpcom_remote_login_remove_dom_node_id( element_id ) {
	var dom_node = document.getElementById( element_id );
	if ( dom_node ) { dom_node.parentNode.removeChild( dom_node ); }
}
function wpcom_remote_login_remove_dom_node_classes( class_name ) {
	var dom_nodes = document.querySelectorAll( '.' + class_name );
	for ( var i = 0; i < dom_nodes.length; i++ ) {
		dom_nodes[ i ].parentNode.removeChild( dom_nodes[ i ] );
	}
}
function wpcom_remote_login_final_cleanup() {
	wpcom_remote_login_remove_dom_node_classes( "wpcom_remote_login_msg" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_validate" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_js" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_iframe" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_styles" );
}

// Watch for messages back from the remote login
window.addEventListener( "message", function( e ) {
	if ( e.origin === "https://r-login.wordpress.com" ) {
		var data = {};
		try {
			data = JSON.parse( e.data );
		} catch( e ) {
			wpcom_remote_login_final_cleanup();
			return;
		}

		if ( data.msg === 'LOGIN' ) {
			// Clean up the login check iframe
			wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );

			var id_regex = new RegExp( /^[0-9]+$/ );
			var token_regex = new RegExp( /^.*|.*|.*$/ );
			if (
				token_regex.test( data.token )
				&& id_regex.test( data.wpcomid )
			) {
				// We have everything we need to ask for a login
				var script = document.createElement( "script" );
				script.setAttribute( "id", "wpcom_remote_login_validate" );
				script.src = '/remote-login.php?wpcom_remote_login=validate'
					+ '&wpcomid=' + data.wpcomid
					+ '&token=' + encodeURIComponent( data.token )
					+ '&host=' + window.location.protocol
					+ '//' + window.location.hostname
					+ '&postid=8540'
					+ '&is_singular=';
				document.body.appendChild( script );
			}

			return;
		}

		// Safari ITP, not logged in, so redirect
		if ( data.msg === 'LOGIN-REDIRECT' ) {
			window.location = 'https://wordpress.com/log-in?redirect_to=' + window.location.href;
			return;
		}

		// Safari ITP, storage access failed, remove the request
		if ( data.msg === 'LOGIN-REMOVE' ) {
			var css_zap = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } @media screen and ( max-width: 782px ) { html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } }';
			var style_zap = document.createElement( 'style' );
			style_zap.type = 'text/css';
			style_zap.appendChild( document.createTextNode( css_zap ) );
			document.body.appendChild( style_zap );

			var e = document.getElementById( 'wpcom_request_access_iframe' );
			e.parentNode.removeChild( e );

			document.cookie = 'wordpress_com_login_access=denied; path=/; max-age=31536000';

			return;
		}

		// Safari ITP
		if ( data.msg === 'REQUEST_ACCESS' ) {
			console.log( 'request access: safari' );

			// Check ITP iframe enable/disable knob
			if ( wpcom_remote_login_extra_auth !== 'safari_itp_iframe' ) {
				return;
			}

			// If we are in a "private window" there is no ITP.
			var private_window = false;
			try {
				var opendb = window.openDatabase( null, null, null, null );
			} catch( e ) {
				private_window = true;
			}

			if ( private_window ) {
				console.log( 'private window' );
				return;
			}

			var iframe = document.createElement( 'iframe' );
			iframe.id = 'wpcom_request_access_iframe';
			iframe.setAttribute( 'scrolling', 'no' );
			iframe.setAttribute( 'sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-top-navigation-by-user-activation' );
			iframe.src = 'https://r-login.wordpress.com/remote-login.php?wpcom_remote_login=request_access&origin=' + encodeURIComponent( data.origin ) + '&wpcomid=' + encodeURIComponent( data.wpcomid );

			var css = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 46px !important; } * html body { margin-top: 46px !important; } @media screen and ( max-width: 660px ) { html { margin-top: 71px !important; } * html body { margin-top: 71px !important; } #wpcom_request_access_iframe { display: block; height: 71px !important; } } #wpcom_request_access_iframe { border: 0px; height: 46px; position: fixed; top: 0; left: 0; width: 100%; min-width: 100%; z-index: 99999; background: #23282d; } ';

			var style = document.createElement( 'style' );
			style.type = 'text/css';
			style.id = 'wpcom_request_access_styles';
			style.appendChild( document.createTextNode( css ) );
			document.body.appendChild( style );

			document.body.appendChild( iframe );
		}

		if ( data.msg === 'DONE' ) {
			wpcom_remote_login_final_cleanup();
		}
	}
}, false );

// Inject the remote login iframe after the page has had a chance to load
// more critical resources
window.addEventListener( "DOMContentLoaded", function( e ) {
	var iframe = document.createElement( "iframe" );
	iframe.style.display = "none";
	iframe.setAttribute( "scrolling", "no" );
	iframe.setAttribute( "id", "wpcom_remote_login_key" );
	iframe.src = "https://r-login.wordpress.com/remote-login.php"
		+ "?wpcom_remote_login=key"
		+ "&origin=aHR0cHM6Ly9ibG9nLmNyeXB0b2dyYXBoeWVuZ2luZWVyaW5nLmNvbQ%3D%3D"
		+ "&wpcomid=9549322"
		+ "&time=1750578761";
	document.body.appendChild( iframe );
}, false );
</script>
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//fonts-api.wp.com' />
<link rel="alternate" type="application/rss+xml" title="A Few Thoughts on Cryptographic Engineering &raquo; Feed" href="https://blog.cryptographyengineering.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="A Few Thoughts on Cryptographic Engineering &raquo; Comments Feed" href="https://blog.cryptographyengineering.com/comments/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1743601627i&ver=6.8.1-alpha-60199"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\ud83d\udd25","\ud83d\udc26\u200b\ud83d\udd25")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-1' href='https://s0.wp.com/wp-content/mu-plugins/jetpack-plugin/moon/modules/infinite-scroll/infinity.css?m=1745916430i&cssminify=yes' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-2-1' href='https://s1.wp.com/wp-content/plugins/gutenberg-core/v20.6.0/build/block-library/style.css?m=1744959081i&cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
.has-text-align-justify{text-align:justify;}
</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-4-1' href='https://s1.wp.com/_static/??-eJyVzDEOgCAMQNELiQU1Jg7Gs2AlDYpAaInx9ro5O/7hfbiywhTFRYEcKvnIQPXN1RVSa0h4MOxOssVDBXunKoqK34DlDq5F5gb+LIoVH4k/vpyzGYe+03oyw/4AcmU1KQ==&cssminify=yes' type='text/css' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-6-1' href='https://s2.wp.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpoZmFkYGRuZGmQBAHPvL0Y=&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-8-1' href='https://s0.wp.com/_static/??-eJx9jUsOwjAMRC+EY6UgCAvEWZrEKoG4jWq3hduTLvisurFG1nszuBQIQ6/UK5Y8dakXDIPPQ3gINsY6Y0ESl0ww0mwOGJPolwDRVyYTRHb4V8QT/LpGqn8ura4EU0wtZeKKbWlLih1p1eWTQem5rZQ6A96XkUSgXk4Tg97qlqzelS/26KzbN835dH8DjlpbIA==&cssminify=yes' type='text/css' media='all' />
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link rel='stylesheet' id='independent-publisher-fonts-css' href='https://fonts-api.wp.com/css?family=PT+Sans%3A400%2C700%2C400italic%2C700italic%7CPT+Serif%3A400%2C700%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-12-1' href='https://s0.wp.com/_static/??-eJyVj9EKwjAMRX/IGiYy54P4KbLV2HW2SWkyhn9vJz4UFMGXcA/kXBJYkrFMiqQQZ5PC7DwJTKipt/c3Q2QmuHiy4JAw+2LI97i1IhuoSnXEiAJpHsDTFROWQWoKBy8jZhB9BPxfW495qWZJluNHQfVMxiGwK9FB2arwl+SQTWDbqy+v12Buofd5Vc/x1Bz2bbc7dk07PQHK5Hxl&cssminify=yes' type='text/css' media='all' />
<style id='independent-publisher-style-inline-css'>
#hero-header { background: url("https://blog.cryptographyengineering.com/wp-content/uploads/2016/07/2274252795_918bcffc01_b.jpg") no-repeat center; background-size: cover; background-attachment: scroll; }
</style>
<link crossorigin='anonymous' rel='stylesheet' id='print-css-13-1' href='https://s1.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035i&cssminify=yes' type='text/css' media='print' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-16-1' href='https://s2.wp.com/wp-content/themes/h4/global.css?m=1420737423i&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"9549322","postID":"0","siteURL":"https:\/\/blog.cryptographyengineering.com","xhrURL":"https:\/\/blog.cryptographyengineering.com\/wp-admin\/admin-ajax.php","nonce":"8c7c4cc9d6","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/reader\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","shortLinkCopied":"Shortlink copied to clipboard."}};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/s1.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/moon\/jetpack_vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/_static/??-eJzTLy/QTc7PK0nNK9HPKtYvyinRLSjKr6jUyyrW0QfKZeYl55SmpBaDJLMKS1OLKqGUXm5mHkFFurmZ6UWJJalQxfa5tobmRgamxgZmFpZZACbyLJI='></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
/* ]]> */
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://matthewdgreen.wordpress.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress.com" />
<link rel='shortlink' href='https://wp.me/E4dk' />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website" />
<meta property="og:title" content="A Few Thoughts on Cryptographic Engineering" />
<meta property="og:description" content="Some random thoughts about crypto. Notes from a course I teach. Pictures of my dachshunds." />
<meta property="og:url" content="https://blog.cryptographyengineering.com/" />
<meta property="og:site_name" content="A Few Thoughts on Cryptographic Engineering" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon" href="https://s2.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://blog.cryptographyengineering.com/?openidserver=1' />
<link rel='openid.delegate' href='https://blog.cryptographyengineering.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://blog.cryptographyengineering.com/osd.xml" title="A Few Thoughts on Cryptographic Engineering" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<meta name="description" content="Some random thoughts about crypto. Notes from a course I teach. Pictures of my dachshunds." />
			<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s2.wp.com/?custom-css=1&#038;csblog=E4dk&#038;cscache=6&#038;csrev=14" />
			</head>

<body class="home blog wp-theme-pubindependent-publisher customizer-styles-applied has-header-image has-sidebar gravatar-logo-disabled jetpack-reblog-enabled">

<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
<div id="hero-header" class="site-hero-section">
			<a id="slide-menu-toggle" class="menu-toggle" href="#slide-menu" aria-controls="slide-menu" aria-expanded="false" role="button" onclick="return false;">
			Menu		</a><!-- #slide-menu-toggle -->
	
	<div class="inner">
				<h1 class="site-title"><a href="https://blog.cryptographyengineering.com/" rel="home">A Few Thoughts on Cryptographic Engineering</a></h1>
		<h2 class="site-description">Some random thoughts about crypto. Notes from a course I teach. Pictures of my dachshunds.</h2>

			</div><!-- .inner -->
</div><!-- #hero-header -->


	<div id="content-wrapper">
		<header id="masthead" class="site-header" role="banner">
			
			
<div id="secondary" class="widget-area" role="complementary">
	<aside id="media_image-3" class="widget widget_media_image"><style>.widget.widget_media_image { overflow: hidden; }.widget.widget_media_image img { height: auto; max-width: 100%; }</style><img class="image alignnone" src="https://matthewdgreen.files.wordpress.com/2016/08/matthew-green.jpg?w=200&#038;h=300" alt="" width="160" height="240" /></aside><aside id="text-4" class="widget widget_text"><h1 class="widget-title">Matthew Green</h1>			<div class="textwidget">I'm a cryptographer and professor at Johns Hopkins University. I've designed and analyzed cryptographic systems used in wireless networks, payment systems and digital content protection platforms. In my research I look at the various ways cryptography can be used to promote user privacy. 
<p>
<a href="https://matthewgreen.io">My academic website</a><br>
<a href="https://bsky.app/profile/did:plc:xvgztewzbfh7bpnklayrsvds">BlueSky</a><br>
<a href="https://ioc.exchange/@matthew_d_green">Mastodon</a><br>
<a href="https://twitter.com/matthew_d_green">Twitter</a><br>
<a href="https://blog.cryptographyengineering.com/top-posts/">Top Posts</a><br>
<a href="https://staging.cryptographyengineering.com/useful-cryptography-resources/">Useful crypto resources</a><br>
<a href="https://blog.cryptographyengineering.com/p/bitcoin-tipjar.html">
Bitcoin tipjar</a><br>
<a href="http://cryptopals.com/">Cryptopals challenges</a><br>
<a href="https://acrab.isi.jhu.edu/">Applied Cryptography Research: A Board</a><p>

<a href="http://www.springer.com/computer/security+and+cryptology/journal/13389">Journal of Cryptographic Engineering
(not related to this blog)</a></div>
		</aside><aside id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://blog.cryptographyengineering.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside><aside id="top-posts-4" class="widget widget_top-posts"><h1 class="widget-title">Top Posts &amp; Pages</h1><ul><li><a href="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/" class="bump-view" data-bump-view="tp">Is Telegram really an encrypted messaging app?</a></li><li><a href="https://blog.cryptographyengineering.com/2014/11/27/zero-knowledge-proofs-illustrated-primer/" class="bump-view" data-bump-view="tp">Zero Knowledge Proofs: An illustrated primer</a></li><li><a href="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/" class="bump-view" data-bump-view="tp">A bit more on Twitter/X&#039;s new encrypted messaging</a></li><li><a href="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/" class="bump-view" data-bump-view="tp">Let&#039;s talk about AI and end-to-end encryption</a></li><li><a href="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/" class="bump-view" data-bump-view="tp">Dear Apple: add &quot;Disappearing Messages&quot; to iMessage right now</a></li><li><a href="https://blog.cryptographyengineering.com/2014/08/13/whats-matter-with-pgp/" class="bump-view" data-bump-view="tp">What&#039;s the matter with PGP?</a></li><li><a href="https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/" class="bump-view" data-bump-view="tp">The Many Flaws of Dual_EC_DRBG</a></li><li><a href="https://blog.cryptographyengineering.com/useful-cryptography-resources/" class="bump-view" data-bump-view="tp">Useful Cryptography Resources</a></li><li><a href="https://blog.cryptographyengineering.com/2021/03/25/whats-in-your-browser-backup/" class="bump-view" data-bump-view="tp">Why the FBI can’t get your browsing history from Apple iCloud (and other scary stories)</a></li><li><a href="https://blog.cryptographyengineering.com/2013/03/12/attack-of-week-rc4-is-kind-of-broken-in/" class="bump-view" data-bump-view="tp">Attack of the week: RC4 is kind of broken in TLS</a></li></ul></aside><aside id="text-6" class="widget widget_text">			<div class="textwidget"><i>Banner image by Matt Blaze</i></div>
		</aside><aside id="archives-6" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<label class="screen-reader-text" for="archives-dropdown-6">Archives</label>
		<select id="archives-dropdown-6" name="archive-dropdown">
			
			<option value="">Select Month</option>
				<option value='https://blog.cryptographyengineering.com/2025/06/'> June 2025 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2025/03/'> March 2025 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2025/02/'> February 2025 &nbsp;(5)</option>
	<option value='https://blog.cryptographyengineering.com/2025/01/'> January 2025 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2024/08/'> August 2024 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2024/04/'> April 2024 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2024/01/'> January 2024 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2023/11/'> November 2023 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2023/10/'> October 2023 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2023/08/'> August 2023 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2023/05/'> May 2023 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2023/04/'> April 2023 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2023/03/'> March 2023 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2022/12/'> December 2022 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2022/10/'> October 2022 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2022/06/'> June 2022 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2022/01/'> January 2022 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2021/08/'> August 2021 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2021/07/'> July 2021 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2021/03/'> March 2021 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2020/11/'> November 2020 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2020/08/'> August 2020 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2020/07/'> July 2020 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2020/04/'> April 2020 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2020/03/'> March 2020 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2020/01/'> January 2020 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2019/12/'> December 2019 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2019/10/'> October 2019 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2019/09/'> September 2019 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2019/06/'> June 2019 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2019/02/'> February 2019 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2018/12/'> December 2018 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2018/10/'> October 2018 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2018/09/'> September 2018 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2018/07/'> July 2018 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2018/05/'> May 2018 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2018/04/'> April 2018 &nbsp;(3)</option>
	<option value='https://blog.cryptographyengineering.com/2018/02/'> February 2018 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2018/01/'> January 2018 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2017/12/'> December 2017 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2017/11/'> November 2017 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2017/10/'> October 2017 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2017/09/'> September 2017 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2017/07/'> July 2017 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2017/03/'> March 2017 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2017/02/'> February 2017 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2017/01/'> January 2017 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2016/11/'> November 2016 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2016/08/'> August 2016 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2016/07/'> July 2016 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2016/06/'> June 2016 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2016/03/'> March 2016 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2015/12/'> December 2015 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2015/11/'> November 2015 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2015/10/'> October 2015 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2015/09/'> September 2015 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2015/08/'> August 2015 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2015/07/'> July 2015 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2015/05/'> May 2015 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2015/04/'> April 2015 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2015/03/'> March 2015 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2015/02/'> February 2015 &nbsp;(3)</option>
	<option value='https://blog.cryptographyengineering.com/2015/01/'> January 2015 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2014/12/'> December 2014 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2014/11/'> November 2014 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2014/10/'> October 2014 &nbsp;(3)</option>
	<option value='https://blog.cryptographyengineering.com/2014/09/'> September 2014 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2014/08/'> August 2014 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2014/07/'> July 2014 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2014/04/'> April 2014 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2014/03/'> March 2014 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2014/02/'> February 2014 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2014/01/'> January 2014 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2013/12/'> December 2013 &nbsp;(4)</option>
	<option value='https://blog.cryptographyengineering.com/2013/10/'> October 2013 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2013/09/'> September 2013 &nbsp;(4)</option>
	<option value='https://blog.cryptographyengineering.com/2013/08/'> August 2013 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2013/07/'> July 2013 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2013/06/'> June 2013 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2013/05/'> May 2013 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2013/04/'> April 2013 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2013/03/'> March 2013 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2013/02/'> February 2013 &nbsp;(3)</option>
	<option value='https://blog.cryptographyengineering.com/2013/01/'> January 2013 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2012/12/'> December 2012 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2012/11/'> November 2012 &nbsp;(1)</option>
	<option value='https://blog.cryptographyengineering.com/2012/10/'> October 2012 &nbsp;(4)</option>
	<option value='https://blog.cryptographyengineering.com/2012/09/'> September 2012 &nbsp;(3)</option>
	<option value='https://blog.cryptographyengineering.com/2012/08/'> August 2012 &nbsp;(4)</option>
	<option value='https://blog.cryptographyengineering.com/2012/07/'> July 2012 &nbsp;(2)</option>
	<option value='https://blog.cryptographyengineering.com/2012/06/'> June 2012 &nbsp;(3)</option>
	<option value='https://blog.cryptographyengineering.com/2012/05/'> May 2012 &nbsp;(5)</option>
	<option value='https://blog.cryptographyengineering.com/2012/04/'> April 2012 &nbsp;(6)</option>
	<option value='https://blog.cryptographyengineering.com/2012/03/'> March 2012 &nbsp;(4)</option>
	<option value='https://blog.cryptographyengineering.com/2012/02/'> February 2012 &nbsp;(7)</option>
	<option value='https://blog.cryptographyengineering.com/2012/01/'> January 2012 &nbsp;(8)</option>
	<option value='https://blog.cryptographyengineering.com/2011/12/'> December 2011 &nbsp;(11)</option>
	<option value='https://blog.cryptographyengineering.com/2011/11/'> November 2011 &nbsp;(13)</option>
	<option value='https://blog.cryptographyengineering.com/2011/10/'> October 2011 &nbsp;(7)</option>
	<option value='https://blog.cryptographyengineering.com/2011/09/'> September 2011 &nbsp;(8)</option>

		</select>

			<script type="text/javascript">
/* <![CDATA[ */

(function() {
	var dropdown = document.getElementById( "archives-dropdown-6" );
	function onSelectChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value !== '' ) {
			document.location.href = this.options[ this.selectedIndex ].value;
		}
	}
	dropdown.onchange = onSelectChange;
})();

/* ]]> */
</script>
</aside></div><!-- #secondary -->		</header><!-- #masthead -->

		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
						
				
<article id="post-8540" class="post-8540 post type-post status-publish format-standard has-post-thumbnail hentry category-messaging category-protocols tag-security tag-technology">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/" rel="bookmark">A bit more on Twitter/X&#8217;s new encrypted&nbsp;messaging</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/"><img width="700" height="430" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/xlogo.jpg?w=700&amp;h=430&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="A bit more on Twitter/X&#8217;s new encrypted&nbsp;messaging" decoding="async" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/xlogo.jpg?w=700&amp;h=430&amp;crop=1 700w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/xlogo.jpg?w=150&amp;h=92&amp;crop=1 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/xlogo.jpg?w=300&amp;h=184&amp;crop=1 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/xlogo.jpg?w=768&amp;h=472&amp;crop=1 768w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/xlogo.jpg?w=1024&amp;h=629&amp;crop=1 1024w" sizes="(max-width: 700px) 100vw, 700px" data-attachment-id="8634" data-permalink="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/xlogo/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/xlogo.jpg" data-orig-size="1260,840" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="XLogo" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/xlogo.jpg?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/xlogo.jpg?w=700" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p><strong>Update 6/10: </strong><em>Based on a short <a href="https://x.com/cambridgemike/status/1932260008278012265?s=46">conversation</a> with an engineering lead at X, some of the devices used at X are claimed to be using HSMs. See more further below. </em></p>



<p>Matthew Garrett has a <a href="https://mjg59.dreamwidth.org/71646.html">nice post</a> about Twitter (uh, X)&#8217;s new end-to-end encryption messaging protocol, which is now called XChat. The TL;DR of Matthew&#8217;s post is that from a cryptographic perspective, XChat isn&#8217;t great. The details are all contained within Matthew&#8217;s post, but here&#8217;s a quick TL;DR:</p>



<ul class="wp-block-list">
<li><strong>There&#8217;s no forward secrecy.</strong> Unlike Signal protocol, which uses a <a href="https://signal.org/docs/specifications/doubleratchet/">double-ratchet</a> to continuously update the user&#8217;s secret keys, the XChat cryptography just encrypts each message under a recipient&#8217;s long-term public key. The actual encryption mechanism is based on an encryption scheme from <a href="https://doc.libsodium.org/">libsodium</a>.</li>



<li><strong>User private keys are stored at X. </strong>XChat stores user <em>private key</em>s at its own servers. To obtain your private keys, you first log into X&#8217;s key-storage system using a password such as PIN. This is needed to support stateless clients like web browsers, and in fairness it&#8217;s not dissimilar to what Meta has done with its encryption for <a href="https://about.fb.com/news/2023/12/default-end-to-end-encryption-on-messenger/">Facebook Messenger and Instagram</a>. Of course, those services use Hardware Security Modules (HSMs.)</li>



<li><strong>X&#8217;s key storage is based on &#8220;Juicebox.&#8221; </strong>To implement their secret-storage system, XChat uses a protocol called <a href="https://juicebox.xyz/">Juicebox</a>. Juicebox &#8220;shards&#8221; your key material across three servers, so that in principle the loss or compromise of one server won&#8217;t hurt you. </li>
</ul>



<p>Matthew&#8217;s post correctly identifies that the major vulnerability in X&#8217;s system is this key storage approach. If decryption keys live in three non-HSM servers that are all under X&#8217;s control, then <span style="text-decoration: underline">X could probably obtain anyone&#8217;s key and decrypt their messages.</span><em> </em>X could do this for their own internal purposes: for example because their famously chill owner got angry at some user. Or they could do it because a warrant or subpoena compels them to. If we judge XChat as an end-to-end encryption scheme, this seems like a pretty game-over type of vulnerability.</p>



<p>So in a sense, everything comes down to the security of Juicebox <span style="text-decoration: underline">and the specific deployment choices that X made.</span> Since Matthew wrote his post, I&#8217;ve learned a bit more about both of these things. In this post I&#8217;d like to go on a slightly deeper dive into the Juicebox portion of X&#8217;s system. This will hopefully shed some light on what X is up to, and why you shouldn&#8217;t use XChat.</p>



<h3 class="wp-block-heading">What&#8217;s Juicebox even for?</h3>



<p>Many end-to-end encryption (E2E) apps have run into a specific problem: these systems require users to store their own secret keys. Unfortunately, users are just plain bad at this. </p>



<p>Sometimes we forget keys because we lose our devices. Often we have more than one device, which means our keys end up in the wrong place. A much worse situation occurs when apps want to work in ordinary web browsers: this means that secret keys have to be airlifted into that context as well. </p>



<p>The obvious remedy for this problem is just to store secret keys with the service provider itself. This is convenient, but completely misses the <em>whole point of end-to-end encryption</em>, which is that service providers should not have access to your secrets! Storing decryption keys — in an accessible form — on the provider&#8217;s servers is absolutely a no-go.</p>



<p>One way out of this conundrum is for the user to <span style="text-decoration: underline">encrypt</span> their secret key, then upload the encrypted value to the service provider. In theory, they can download their secret keys anytime they want and they should know that their secrets are safe. But of course there&#8217;s a problem: <em>what secret key are you going to use to encrypt your secret key!?</em> Answering this question quickly leads you into an infinite pile of turtles.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image.png"><img data-attachment-id="8555" data-permalink="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/image-81/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image.png" data-orig-size="1224,1226" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image.png?w=700" width="1022" height="1023" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image.png?w=1022" alt="" class="wp-image-8555" style="aspect-ratio:0.9980395361893903;width:191px;height:auto" /></a><figcaption class="wp-element-caption">Source: XKCD. </figcaption></figure></div>


<p>Rather than descend into paradox, systems like Juicebox, Signal SVR, and <a href="https://blog.cryptographyengineering.com/2016/08/13/is-apples-cloud-key-vault-crypto/">iCloud Key Vault</a> offer an alternative. Their observation is that while <em>cryptographic keys are hard to hang on to</em>, users generally <span style="text-decoration: underline">do</span> remember simple passwords like PINs, particularly if they&#8217;re asked to re-enter them periodically. <em>What if we use the user&#8217;s PIN/password to encrypt the stronger cryptographic key that we upload to the server?</em></p>



<p>While this is better than nothing, it isn&#8217;t good. Most human-selected passwords and PINs make for terrible cryptographic keys. In particular, short PINs (like the 6-digit decimal pins many people use for their phone passcode) are vulnerable to efficient brute-force guessing attacks. A six-digit PIN provides at most 2<sup>20</sup> security, which is what cryptographers call &#8220;a pretty small number.&#8221; Even if you use a &#8220;hard&#8221; key derivation function like <a href="https://en.wikipedia.org/wiki/Scrypt">scrypt</a> or <a href="https://en.wikipedia.org/wiki/Argon2">Argon2</a> with insane difficulty settings, you&#8217;re still probably still going to lose your data.</p>



<p>Fortunately there is another way.</p>



<p>For many years, cryptographers have considered the problem of turning &#8220;weak secrets&#8221; into strong ones. The problem is sometimes known as <em><a href="https://www.usenix.org/system/files/conference/usenixsecurity17/sec17-lai.pdf">password</a> <a href="https://dl.acm.org/doi/10.1145/3372297.3417266">hardening</a></em>, and doing it well usually requires additional components. First, you need to have some strong cryptographic secret that can be &#8220;mixed&#8221; into the user&#8217;s password to make a produce a truly strong encryption key. Second, you need some mechanism to <em>limit</em> the number of guessing attempts that the user makes, so an attacker can&#8217;t simply run an online attack to work through the PIN-space. <span style="text-decoration: underline">This cannot be enforced using cryptography alone</span>: you must add a server (or servers) to enforce these checks. Critically, the  server will place limits on how many <em>incorrect passwords</em> the user can enter: <em>e.g., </em>after ten incorrect attempts, the user&#8217;s account gets locked or erased.</p>



<p>In one sense, we&#8217;re right back where we started: someone needs to operate a a server. If that server is under the control of the service provider, then they can disable the guessing limits and/or extract the server&#8217;s secret key material, at which point you&#8217;re back to square one. </p>



<p>Many services have engineered some reasonable solutions to this problem, however. They boil down to the following alternatives, which can be implemented separately or together:</p>



<ol class="wp-block-list">
<li>The server can be implemented inside of a specialized Hardware Security Module, which is set up so that the provider cannot reprogram it or access its key material (at least, after it&#8217;s been configured.) This approach was pioneered by Apple, and is now in use by <a href="https://blog.cryptographyengineering.com/2016/08/13/is-apples-cloud-key-vault-crypto/">iCloud Key Vault</a>, <a href="https://blog.cryptographyengineering.com/2020/07/10/a-few-thoughts-about-signals-secure-value-recovery/">Signal SVR</a>, <a href="https://engineering.fb.com/2021/09/10/security/whatsapp-e2ee-backups/">WhatsApp</a> and <a href="https://about.fb.com/news/2023/12/default-end-to-end-encryption-on-messenger/">Facebook Messenger</a>.</li>



<li>Alternatively, the server can be &#8220;split up&#8221; into multiple pieces that are each run by different parties. The idea here is that the user must contact <em>T</em> out of <em>N</em> different servers in order to obtain the correct key (a common example is 2-of-3.) As long as an attacker cannot compromise <em>T</em> different servers, the combined system will still be able to enforce the guessing limits and prevent attackers from getting the key. Naturally this idea fundamentally depends on the assumption that the servers are not run by the same party!</li>
</ol>



<p>And at last, we come to Juicebox.</p>



<p>Juicebox is an software-based distributed key hardening service that can be implemented across multiple servers. Users can &#8220;enroll&#8221; their account into the system, at which point the Juicebox servers will convert their PIN/password into a strong cryptographic key (by mixing it with a secret stored on the Juicebox servers.) Later on, they can contact the Juicebox servers and — assuming they enter the right password, and don&#8217;t try too many incorrect guesses —&nbsp;they can obtain that same cryptographic key from the system. Users can specify the number of servers (<em>N</em>) and the threshold (<em>T</em>), and the goal is that the system can survive the loss (or unavailability) of N-T servers, and it should retain its security even if an attacker compromises <em>A&lt;T</em> of them. Most critically, Juicebox enforces limits: if too many incorrect passwords are entered, Juicebox will lock or destroy the user&#8217;s account.</p>



<p>In principle, Juicebox servers (called &#8220;<em>realms</em>&#8221; in the project&#8217;s lingo) can be either &#8220;software based&#8221; or they can be deployed inside of HSMs. <span style="text-decoration: underline">However, to the best of my knowledge the HSM capability is not fully supported outside of </span><u>Juicebox</u><span style="text-decoration: underline">’s one <a href="https://bsky.app/profile/superfell.bsky.social/post/3lr765dux5c2b">test deployment</a></span>, and has not been used in deployments (at X or anywhere else.) <strong>Update 6/10:</strong><em> but see further below! </em>This means the security of XChat&#8217;s version of Juicebox probably comes down to a question of who runs the servers.</p>



<h3 class="wp-block-heading">So who runs X&#8217;s Juicebox servers, and do they use HSMs?</h3>



<p>To the best of my knowledge, all of the XChat servers are run in software by Twitter/X itself. If this turns out to be incorrect, I will be thrilled to update this post. </p>



<p><strong>Update: </strong><em><a href="https://x.com/cambridgemike/status/1932260008278012265?s=46">this tweet by an engineering lead claims that they are actually HSMs</a>, and Twitter has just not publicized this or published the key ceremonies that were used to set them up. I am very confused by this because it seems extremely backwards! The problem with this late claim is that there&#8217;s really no way to verify this fact other than one or two tweets from someone at X.</em></p>



<p>To put this more explicitly, without any protections like the verifiable use of HSMs and/or distributing Juicebox servers across mutually-distrustful operators, having three servers does relatively little to protect users&#8217; secrets against the service operator. And even if X is secretly implementing these protections, implementing them in secret is <span style="text-decoration: underline">stupid.</span> As a wise man once said:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-3.png"><img data-attachment-id="8577" data-permalink="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/image-84/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-3.png" data-orig-size="720,405" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-3.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-3.png?w=700" width="720" height="405" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-3.png?w=720" alt="" class="wp-image-8577" style="aspect-ratio:1.777714178559087;width:456px;height:auto" /></a></figure></div>


<p>Verifying that the XChat Juicebox servers are software-only is more complicated. Digging around in the Juicebox Github, you&#8217;ll find a software-only as well as an HSM-specific implementation of their &#8220;realms.&#8221; Specifically, there is an <a href="https://github.com/juicebox-systems/juicebox-hsm-realm">entire repository</a> dedicated to supporting Juicebox on <a href="https://www.entrust.com/products/hsm/nshield-solo">Entrust nShield Solo XC HSMs</a> (see here for <a href="https://juicebox.xyz/blog/running-a-hsm-realm">instructions</a>) although this same code can also be deployed outside of HSMs. There is even a cool &#8220;<a href="https://github.com/juicebox-systems/ceremony">ceremony</a>&#8221; document that a group of administrators can perform to certify that they set the HSM up correctly, and that they destroyed all of the cards that could allow it to be re-programmed! </p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-4.png"><img data-attachment-id="8578" data-permalink="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/image-85/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-4.png" data-orig-size="1812,490" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-4.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-4.png?w=700" loading="lazy" width="1024" height="276" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-4.png?w=1024" alt="" class="wp-image-8578" /></a><figcaption class="wp-element-caption"><em>Just one step from the Juicebox HSM <a href="https://github.com/juicebox-systems/ceremony">ceremony document</a>. I love this stuff! </em></figcaption></figure></div>


<p>However, after speaking to Juicebox&#8217;s protocol designer <a href="https://github.com/imperiopolis">Nora Trapp</a>, I&#8217;m doubtful that any of this is in use at X. Nora told me that the Juicebox project shut down over a year ago and the engineers moved on, and what code there is now open source and not actively maintained (this matches with project commits I can see.) Nora also looked at XChat&#8217;s Juicebox deployment and sent me the following commentary:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>From what I’ve seen, there are four realms currently in use by Twitter: <code><a href="http://realm-a.x.com" target="_blank" rel="noreferrer noopener">realm-a.x.com</a></code>, <code><a href="http://realm-b.x.com" target="_blank" rel="noreferrer noopener">realm-b.x.com</a></code>, <code><a href="http://realm-east1.x.com" target="_blank" rel="noreferrer noopener">realm-east1.x.com</a></code>, and <code><a href="http://realm-west1.x.com" target="_blank" rel="noreferrer noopener">realm-west1.x.com</a></code>.</p>



<ul class="wp-block-list">
<li><code>realm-a</code> and <code>realm-b</code> are definitely software realms. They don’t use Noise (only true of software realms) and rely solely on TLS. In contrast, HSM-backed realms use Noise within TLS, with TLS terminated at the LB and Noise inside the HSM.</li>



<li><code>realm-east1</code> and <code>realm-west1</code> appear to run code from <a href="https://github.com/juicebox-systems/juicebox-hsm-realm" target="_blank" rel="noreferrer noopener">juicebox-hsm-realm</a>. For example, hitting <code><a href="https://realm-east1.x.com/livez" target="_blank" rel="noreferrer noopener">https://realm-east1.x.com/livez</a></code> shows they&#8217;re likely using the repo unmodified from <code>main</code>. However, this doesn&#8217;t mean they&#8217;re HSM-backed. The repo includes a &#8220;software HSM&#8221; for testing, which is insecure and doesn&#8217;t provide actual HSM properties.</li>
</ul>



<p>Timing analysis (e.g. via the convenient&nbsp;<code>x-exec-time</code>&nbsp;response header X left in place) suggests these are indeed using the software HSM. Real HSMs are typically significantly slower. And even if by some chance they&#8217;re running real HSMs, no ceremony has been published, so there&#8217;s no reason to trust they’re secure or that the key material isn’t exfiltrated.</p>
</blockquote>



<p>Nora also <a href="https://juicebox.xyz/blog/dont-put-all-your-juice-in-one-box">wrote a post very recently warning deployers to stop placing all servers under the control of a single service provider</a>, which seems very applicable to what Twitter/X is doing.</p>



<p>Obviously this doesn&#8217;t prove that X isn&#8217;t using HSMs. Though, obviously, there&#8217;s no reason that you should hope something is secure when the deployer is going out of their way not to tell you it is. When it comes to XChat, my advice is that you should assume this deployment is (1) entirely in software, and (2) all Juicebox &#8220;realms&#8221; are run by the same organization. This means you should assume that <em>your decryption keys could be recovered by X&#8217;s server administrators</em> with at most a little fuss, unless you use a very strong password.</p>



<h3 class="wp-block-heading">That&#8217;s bad, but let&#8217;s talk more about the Juicebox protocol anyway!</h3>



<p>If all you came for was a bit of discussion about the security posture of XChat, then <a href="https://mjg59.dreamwidth.org/71646.html">Matthew&#8217;s post</a> and the additional notes above are all you need. Unless and until X proves that they&#8217;re using HSMs (and have destroyed all programming cards) you should just assume that their Juicebox instantiation is based on software realms under X&#8217;s control, and that means it is likely vulnerable to brute-force password-guessing attacks.</p>



<p>The rest of this post is going to look past X. </p>



<p>Let&#8217;s assume that a deployer has configured Juicebox intelligently: meaning that some/all realms will be deployed inside of HSMs, and/or realms are spread across multiple organizational trust boundaries — such that no single organization can easily demand recovery of anyone&#8217;s password. The question we want to ask now is: what guarantees does Juicebox provide in this setting, and how does the protocol work?</p>



<p><strong>Threshold OPRFs. </strong>The core cryptographic primitive <a href="https://juicebox.xyz/assets/whitepapers/juiceboxprotocol_revision7_20230807.pdf">inside of Juicebox</a> is called a <em>threshold oblivious pseudorandom function</em>, or t-OPRF. I&#8217;ve written about OPRFs before, specifically <a href="https://blog.cryptographyengineering.com/2018/10/19/lets-talk-about-pake/">in the context of Password-Authenticated Key Agreement</a> (PAKE schemes.) Nonetheless, I think it&#8217;s helpful to start from the top.</p>



<p>Let&#8217;s leave aside the &#8220;oblivious&#8221; part for a minute. <a href="https://blog.cryptographyengineering.com/2023/05/08/prfs-prps-and-other-fantastic-things/">PRFs are functions</a> that take in a key <em>K</em> and a string <em>P</em> (for example, a password), and output a string of bits. We might write as: </p>



<p class="has-text-align-center"><em>O</em> = PRF(<em>K, P</em>)</p>



<p>Provided that an attacker does not know the key, the resulting string <em>O</em> should <span style="text-decoration: underline">look</span> random, meaning that the output of a PRF makes for excellent cryptographic keys. In many practical implementations, PRFs are realized using functions like <a href="https://en.wikipedia.org/wiki/HMAC">HMAC</a> or <a href="https://en.wikipedia.org/wiki/CBC-MAC">CBC-MAC</a>; however, there are many different ways to build them.</p>



<p>An <span style="text-decoration: underline">oblivious</span> PRF (OPRF) is a two-party cryptographic protocol that helps a client and server jointly compute the output of a PRF. It works like this:</p>



<ol class="wp-block-list">
<li>Imagine a server has the cryptographic key <em>K.</em></li>



<li>The client has their string <em>P</em> (such as a password.)</li>



<li>At the end of a successful protocol run, the <span style="text-decoration: underline">client</span> should obtain <em>O</em> = PRF(<em>K, P</em>). The server gets no output at all.</li>



<li>Critically: <span style="text-decoration: underline">neither party should learn the other party&#8217;s input</span>, and the server <span style="text-decoration: underline">should not learn the client&#8217;s result</span>, either.</li>
</ol>



<p>With this tool in hand, it&#8217;s easy to build a very simple password-hardening protocol. Simply configure the server with a key <em>K </em>(preferably a different key for every user account), and then have the client run the OPRF protocol with the server to obtain <em>O</em> = PRF(<em>K, P</em>). The resulting value <em>O</em> will make for an excellent encryption key, which the client can use to encrypt any secret values it wants. The best part of this arrangement is that the OPRF protocol ensures that the server never learns the user&#8217;s password <em>P</em>, so no information leaks even if the server is fully malicious!</p>



<p>This basic design has some limitations, of course. It does not allow the server to <span style="text-decoration: underline">limit</span> the number password guesses, nor does it allow us to spread the process over many different servers.</p>



<p>Addressing the first problem is easy. When the client first registers their account with the server, they can run the OPRF protocol to obtain <em>O</em> = PRF(<em>K, P</em>). Next, they compute some &#8220;authenticator tag&#8221; <em>T </em>that&#8217;s derived in some way from the secret <em>O</em>. They can then store that tag <em>T</em> on the server. When a user returns to log back into the system, the client and server can run the OPRF protocol, and then conduct some process to verify that the <em>O</em> received by the client is consistent with the tag <em>T</em> stored at the server. (<span style="text-decoration: underline">The exact process for doing this is important, and I&#8217;ll discuss it further below.)</span> If this is <em>unsuccessful</em>, then the server can increment a counter to indicate an incorrect password guess on that user&#8217;s account. If the protocol completes successfully, then the server should reset that counter back to zero.<sup>1</sup></p>



<p>Critically, when the counter reaches some maximum (usually ten incorrect attempts), the server must lock the user&#8217;s account — or much better, delete the account-specific key <em>K</em>. This is what prevents attackers from systematically guessing their way through every possible PIN.</p>



<p>Splitting up the PRF into multiple servers is only slightly more complicated. The basic idea relies on the fact that the <a href="https://datatracker.ietf.org/doc/rfc9497/">specific OPRF used by Juicebox</a> is based on elliptic curves, and this makes it very amenable to threshold implementations. I&#8217;m going to put the details into a <a href="https://blog.cryptographyengineering.com/some-quick-notes-on-t-oprfs/">separate page right here </a>since it&#8217;s a little boring. But you should just take away that (1) the service operator can split up the key <em>K</em> across multiple servers, and (2) a client can talk to any <em>T</em> of them and eventually obtain PRF(K, P). </p>



<h3 class="wp-block-heading"><strong>How does the client prove it got the right key</strong>, and what attacks are there?</h3>



<p>You&#8217;ll notice that these &#8220;incorrect attempt&#8221; counters are a big part of the protection inside of a system like Juicebox. As long as an attacker can only make, say, a maximum of ten incorrect guessing attempts, then even a relatively weak password like 234984 is probably not too bad. If an attacker can make <em>many possible</em> guesses, then the whole system is fairly weak.</p>



<p>Note that in most of these attacks we are going to make the very strong assumption that <span style="text-decoration: underline">the server operator is the attacker</span><em> </em>and that they&#8217;ve deployed Juicebox in such a way that they can&#8217;t just read the secrets out of their own instance (e.g., in this hypothetical scenario, they have deployed Juicebox using HSMs or distributed trust.) Since the whole point of end-to-end encryption is that users&#8217; secret keys should not be known to a server operator, this isn&#8217;t too strong of an assumption. Moreover, we&#8217;ve recently <a href="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/">seen governments make secret requests to companies like Apple</a> to force them to bypass their end-to-end encrypted services. This means that both hacking and legal compulsion are real concerns. </p>



<p>Within this setting there exist a handful of attacks that could come up in a system like Juicebox. Some are easier than others to prevent:</p>



<ol class="wp-block-list">
<li>An attacker could try to enter a few password guesses, then wait for the real user to log in. As long as the real user enters the correct password, the attempt counter on the server(s) will drop back to zero. This attack could allow you to make up to, say, nine invalid guesses for each genuine user login.<sup>2</sup> <br><br>The existence of this attack is kind of unavoidable in systems like Juicebox. Fortunately it&#8217;s probably not a very <em>efficient</em> attack. Unless the user is logging on constantly (say, because a web browser caches the user&#8217;s password and runs the protocol automatically), the rate of attacker guesses is going to be very low. Moreover: this attack can be mitigated by having the server inform the client of the number of incorrect guesses it&#8217;s seen since the last time the user logged in, which should help the user to detect the fact that they&#8217;re under attack.</li>



<li>If the servers don&#8217;t coordinate with each other, a smart attacker could try to guess passwords against different subsets of the Juicebox servers: for example if 2-of-10 servers are needed to recover the key, then an attacker actually could actually obtain many more than ten guesses. This is because the attacker could make at least ten attempts with each <em>subset</em> comprising two servers, before all the necessary servers locked them out. Juicebox&#8217;s <a href="https://github.com/juicebox-systems/juicebox-hsm-realm?tab=readme-ov-file">HSM implementation</a> actually goes to some lengths to prevent this (as <a href="https://github.com/signalapp/SecureValueRecovery2">SVR</a> did before them) by having servers share the current password counter values with each other using a <a href="https://en.wikipedia.org/wiki/Consensus_(computer_science)">consensus protocol</a>.</li>
</ol>



<p>Another possibility is that a malicious (software) server operator could try to attack the protocol directly. Just for fun, I thought it might be interesting to conclude with one <em>possible</em> attack I noticed while perusing the protocol description. I&#8217;m almost certain this won&#8217;t work in practice — and the Juicebox developers agree, but I thought it was a fun illustration of the <em>types</em> of vulnerabilities that show up in these systems.</p>



<p>Recall that whenever a Juicebox client successfully completes the protocol with a set of <em>T</em> servers, it must somehow convince those servers that it obtained the right key. This is necessary because a correct password entry should <span style="text-decoration: underline">reset</span> those servers&#8217; attempt counters back to zero, whereas an <em>incorrect</em> guess will increase the attempt counter. (Without a mechanism to reset the counter, the counter will keep rising until the user&#8217;s account gets permanently locked.)</p>



<p><a href="https://juicebox.xyz/assets/whitepapers/juiceboxprotocol_revision7_20230807.pdf">The client deals with this</a> by first computing a value called the unlockKey from the t-OPRF output, and then calculating a set of &#8220;tags&#8221; called the unlockKeyTags, one for each server (realm) in the system:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-5.png"><img data-attachment-id="8612" data-permalink="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/image-86/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-5.png" data-orig-size="1518,1332" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-5.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-5.png?w=700" loading="lazy" width="1024" height="898" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-5.png?w=1024" alt="" class="wp-image-8612" style="aspect-ratio:1.1396269393136498;width:544px;height:auto" /></a></figure></div>


<p>The calculation of each unlockKeyTags[i] value is customized to include the &#8220;realm ID&#8221; of the server, which means that the tag for server <em>i</em> is specific only to that server. It cannot be extracted from a malicious server <em>i </em>and replayed against server <em>j</em>, which would be very bad. The client then sends each value unlockKeyTags[i] to the appropriate server. The servers can verify the received tag against a copy they stored during the account registration process. If it matches, they reset their counter back to zero as follows:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-6.png"><img data-attachment-id="8614" data-permalink="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/image-87/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-6.png" data-orig-size="1246,408" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-6.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-6.png?w=700" loading="lazy" width="1024" height="335" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/06/image-6.png?w=1024" alt="" class="wp-image-8614" style="aspect-ratio:3.053990319142539;width:468px;height:auto" /></a></figure></div>


<p>However, the only thing that differentiates these tags from one another is the notion that realm IDs for different servers will always be different. What if this assumption isn&#8217;t correct?</p>



<p>The attack I&#8217;m concerned about is pretty bizarre, but it looks like this. Imagine a user has previously registered its key into several real HSM-based servers. Now someone hacks into the service provider. This hacker &#8220;tricks&#8221; clients into sending subsequent login requests to a <span style="text-decoration: underline">new set of malicious servers</span> that the attacker spins up using software (i.e., no HSM protections.)</p>



<p>Ordinarily this attack wouldn&#8217;t be a disaster, since the OPRF should prevent those new servers from learning the user&#8217;s password inputs. But let&#8217;s imagine that the hacker sets the &#8220;realm ID&#8221; of these new servers to be identical to the realm ID of the real (HSM) servers. In this case, the value of unlockKeyTag[i] sent to the malicious servers will be <em>identical</em> to the value that would have been stored within the HSM-based servers. Once the attacker learns this value, they can make an unlimited number of guesses against the HSM server with the same realm ID: this is because the stolen unlockKeyTags[i] value will reset the HSM server&#8217;s counter. </p>



<p>I ran this past Nora and she pointed out a number of practical issues that will probably make this sort of attack much less likely to work, but it&#8217;s still fun to find this sort of thing. More importantly, I think it shows how delicate distributed protocols like this can be, and how sometimes one&#8217;s assumptions may not always be valid. </p>



<p><em>Post image: Noah Berger/AP Photo</em></p>



<p><em>Notes:</em></p>



<ol class="wp-block-list">
<li>Obviously this can be dangerous. An attacker who just wants to deny service to the user can enter deliberately-incorrect guesses until the user&#8217;s account becomes permanently locked. To prevent this, most services require that you log In using a traditional password first, then you can access the password strengthening server second. Some systems also add time delays, to ensure that an attacker cannot quickly exhaust the counter.</li>



<li>The &#8220;try N attempts and then let the client log in normally&#8221; attack was outlined to me by Ian Miers.</li>
</ol>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/messaging/" rel="category tag">messaging</a>, <a href="https://blog.cryptographyengineering.com/category/protocols/" rel="category tag">protocols</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/" rel="bookmark"><time class="entry-date published" datetime="2025-06-09T18:22:31+00:00">June 9, 2025</time><time class="updated" datetime="2025-06-10T12:49:51+00:00">June 10, 2025</time></a></span><span class="word-count">3,917 Words</span><span class="comments-link"><a href="https://blog.cryptographyengineering.com/2025/06/09/a-bit-more-on-twitter-xs-new-encrypted-messaging/#comments">2 Comments</a></span><!-- .comments-link -->		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
				
<article id="post-8488" class="post-8488 post type-post status-publish format-standard has-post-thumbnail hentry category-apple category-messaging tag-apple tag-cybersecurity tag-iphone tag-security">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/" rel="bookmark">Dear Apple: add &#8220;Disappearing Messages&#8221; to iMessage right&nbsp;now</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/"><img width="666" height="430" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/untitled-4.png?w=666&amp;h=430&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Dear Apple: add &#8220;Disappearing Messages&#8221; to iMessage right&nbsp;now" decoding="async" loading="lazy" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/untitled-4.png?w=666&amp;h=430&amp;crop=1 666w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/untitled-4.png?w=150&amp;h=97&amp;crop=1 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/untitled-4.png?w=300&amp;h=194&amp;crop=1 300w" sizes="(max-width: 666px) 100vw, 666px" data-attachment-id="8522" data-permalink="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/untitled-4-3/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/untitled-4.png" data-orig-size="666,736" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled 4" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/untitled-4.png?w=271" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/untitled-4.png?w=666" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p>This is a cryptography blog and I always feel the need to apologize for any post that isn&#8217;t &#8220;straight cryptography.&#8221; I&#8217;m actually getting a little tired of apologizing for it (though if you want some hard-core cryptography content, there&#8217;s plenty <a href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/">here</a> and <a href="https://blog.cryptographyengineering.com/2023/10/06/to-schnorr-and-beyond-part-1/">here</a>.)</p>



<p>Sometimes I have to remind my colleagues that out in the real world, our job is not to solve exciting mathematical problems: <em>it&#8217;s to help people communicate securely</em>. And people, at this very moment, need a lot of help. Many of my friends are Federal employees or work for contractors, and they&#8217;re terrified that they&#8217;re going to lose their job based on <span style="text-decoration: underline">speech they post online.</span> Unfortunately, &#8220;online&#8221; to many people includes thoughts <span style="text-decoration: underline">sent over private text messages</span> — so even private conversations are becoming chilled. And while this is hardly the worst thing happening to people in this world, it&#8217;s something that&#8217;s happening to my friends and neighbors.</p>



<p>(And just in case you think this is partisan: many of the folks I&#8217;m talking about are Republicans, and some are military veterans who work for the agencies that keep Americans safe. They&#8217;re afraid for their jobs and their kids, and that stuff transcends politics.)</p>



<p>So let me get to the point of this relatively short post.</p>



<h3 class="wp-block-heading">Apple iMessage is encrypted, but is it &#8220;secure&#8221;?</h3>



<p>A huge majority of my &#8220;normie&#8221; friends are iPhone users, and while some have started downloading Signal app (and you should too!) — many of them favor one communications protocol: <a href="https://www.google.com/search?client=firefox-b-1-d&amp;q=apple+imessage">Apple iMessage</a>. This is mostly because iMessage is just the built-in messaging app used on Apple phones. If you don&#8217;t know the branding, all you need to know is that iMessage is &#8220;blue bubbles&#8221; you get when talking to other Apple users.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image.png"><img data-attachment-id="8494" data-permalink="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/image-75/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image.png" data-orig-size="532,380" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image.png?w=532" loading="lazy" width="532" height="380" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image.png?w=532" alt="" class="wp-image-8494" style="width:251px;height:auto" /></a></figure></div>


<p>Apple <a href="https://www.cyberdaily.au/tech/10217-apple-s-imessage-gets-post-quantum-end-to-end-encryption">boasts</a> that the iMessage app <a href="https://staringatphones.com/2015/07/26/a-brief-history-of-imessage/">encrypts your messages end-to-end, and that it has done so since 2011</a>. This means that all your messages and attachments are encrypted under keys that <span style="text-decoration: underline">Apple does not know</span><em><span style="text-decoration: underline">.</span></em> The company has been extremely consistent about this, discusses it in their <a href="https://support.apple.com/guide/security/welcome/web">platform security guide</a>, and in recent years they&#8217;ve even extended their protocol to provide <a href="https://security.apple.com/blog/imessage-pq3/">post-quantum security.</a> (A few years ago my students and I<a href="https://blog.cryptographyengineering.com/2016/03/21/attack-of-week-apple-imessage/"> found a bug in the protocol</a>, but Apple fixed it quickly — so I am very personally confident in their encryption.)</p>



<p>This is nice. And it&#8217;s all true.</p>



<p>But encryption <em>in transit</em> is only one part of the story. After delivering your messages with its uncompromising post-quantum security, Apple allows two things that aren&#8217;t so great:</p>



<ol class="wp-block-list">
<li>iMessages stick around your phone <span style="text-decoration: underline">forever</span> unless you manually delete them (a process that may need to happen on both sides, and is <a href="https://forums.macrumors.com/threads/how-is-deleting-texts-still-so-insanely-bad.2386668/">painfully annoying</a>.)</li>



<li>iMessages are automatically backed up to Apple&#8217;s iCloud backup service, if you have that feature on — and since Apple sets this up as the default during iPhone setup, most ordinary people do.</li>
</ol>



<p>The combination of these two features turn iMessage into a Star-Trek style Captain&#8217;s Log of your entire life. Searching around right now, I can find messages from 2015. Even though my brain tells me this was three years ago, I&#8217;m reliably informed that this is a <span style="text-decoration: underline">whole decade</span> in the past.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-1.png"><img data-attachment-id="8500" data-permalink="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/image-76/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-1.png" data-orig-size="1290,1041" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-1.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-1.png?w=700" loading="lazy" width="1024" height="826" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-1.png?w=1024" alt="" class="wp-image-8500" style="width:266px;height:auto" /></a></figure></div>


<p>Now, while the messages above are harmless, I want to convince you that this is often a very bad thing. People want to have private conversations. They <em>deserve to have private conversations</em>. And their technology should make them feel safe doing so. That means they should know that their messaging software has their back and will make sure those embarrassing or political or risque text messages are not stored forever on someone&#8217;s phone or inside a backup. </p>



<h3 class="wp-block-heading">We know exactly how to fix this, and every other messenger did so long ago</h3>



<p>If you install <a href="https://faq.whatsapp.com/673193694148537">WhatsApp</a>, <a href="https://www.facebook.com/help/messenger-app/1039542879410863">Facebook Messenger</a>, <a href="https://support.signal.org/hc/en-us/articles/360007320771-Set-and-manage-disappearing-messages">Signal</a>, <a href="https://help.snapchat.com/hc/en-us/articles/7012334940948-When-does-Snapchat-delete-Snaps-and-Chats">Snap</a> or even <a href="https://www.howtogeek.com/710073/how-to-send-disappearing-messages-in-telegram/">Telegram</a> (please <a href="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/">don&#8217;t</a>!) you&#8217;ll encounter a simple feature that addresses this problem. It&#8217;s usually called &#8220;<a href="https://faq.whatsapp.com/673193694148537">disappearing messages</a>&#8220;, but sometimes goes by other names.</p>



<p>I&#8217;m almost embarrassed to explain what this feature does, since it&#8217;s like explaining how a steering wheel works. <em>Nevertheless</em>. When you start a chat, you can decide how long the messages should stick around for. If your answer is <span style="text-decoration: underline">forever</span>, you don&#8217;t need to do anything. However, if it&#8217;s a sensitive conversation and you want it to be ephemeral in the same way that a phone call is, you can pick a time, typically ranging from 5 minutes to 90 days. When that time expires, your messages just get erased — on both your phone and the phones of the people you&#8217;re talking to.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0219.jpg"><img data-attachment-id="8529" data-permalink="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/img_0219/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0219.jpg" data-orig-size="1290,638" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="IMG_0219" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0219.jpg?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0219.jpg?w=700" loading="lazy" width="700" height="346" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0219.jpg?w=700" alt="" class="wp-image-8529" style="width:355px;height:auto" /></a></figure></div>


<p>A separate feature of disappearing messages is that some platforms will omit these conversations from device backups, or at least they&#8217;ll make sure expired messages can&#8217;t be restored. This makes sense because <em>those conversations are supposed to be ephemeral</em>: people are clearly not expecting those text messages to be around in the future, so they&#8217;re not as angry if they lose them a few days early.</p>



<p>Beyond the basic technical functionality, a disappearing messages feature <span style="text-decoration: underline">says something.</span> It announces to your users that a conversation is actually intended to be private and short-lived, that its blast radius will be contained. You won&#8217;t have to think about it years or months down the line when it&#8217;s embarrassing. This is valuable not just for what it does <em>technically</em> but for the confidence it gives to users, who are already plenty insecure after years of abuse by tech companies. </p>



<h3 class="wp-block-heading">Why won&#8217;t Apple add a disappearing messages feature? </h3>



<p>I don&#8217;t know. I honestly cannot tell you. It is baffling and weird and wrong, and completely out of step with the industry they&#8217;re embedded in. It is particularly bizarre for a company that has formed its entire brand image around stuff like this:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-3.png"><img data-attachment-id="8511" data-permalink="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/image-78/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-3.png" data-orig-size="940,529" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-3.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-3.png?w=700" loading="lazy" width="940" height="529" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-3.png?w=940" alt="" class="wp-image-8511" style="width:384px;height:auto" /></a></figure></div>


<p>To recap, nearly <span style="text-decoration: underline">every single other messaging product</span> that people use in large numbers (at least here in the US) has some kind of disappearing messages feature. Apple&#8217;s omission is starting to be very unique.</p>



<p>I do have some friends who work for Apple Security and I&#8217;ve tried to talk to them about this. They usually try to avoid me when I do stuff like this — sometimes they mention lawyers — but when I&#8217;m annoying enough (and I catch them in situations where exit is impossible) I can occasionally get them to answer my questions. For example, when I ask &#8220;<em>why don&#8217;t you turn on <a href="https://support.apple.com/en-us/108756">end-to-end encrypted iCloud backup </a>by default</em>,&#8221; they give me thoughtful answers. They&#8217;ll tell me how users are afraid of losing data, and they&#8217;ll tell me sad stories of how difficult it is to make those features as usable as unencrypted backup. (<a href="https://blog.cryptographyengineering.com/2022/12/07/apple-icloud-and-why-encrypted-backup-is-the-only-privacy-issue/">I <em>half</em> believe them</a>.)</p>



<p>When I ask about disappearing messages, I get embarrassed sighs and crickets. Nobody can explain why Apple is so far behind on this basic feature even <span style="text-decoration: underline">as an option</span>, long after it became standard in every other messenger. Hence the best I can do is speculate. Maybe the Apple executives are afraid that <a href="https://blog.cryptographyengineering.com/2025/02/23/three-questions-about-apple-encryption-and-the-u-k/">governments will pressure them if they activate a security feature like this</a>? Maybe the Messages app is written in some obsolete language and they can&#8217;t update it? Maybe the iMessage servers have become sentient and now control Tim Cook like a puppet? <em>These are not great answers, but they are better than anything the company has offered</em>&nbsp;— and everyone at Apple Security kind of knows it.</p>



<p>In a monument to misaligned priorities, Apple even spent time adding <a href="https://security.apple.com/blog/imessage-pq3/">post-quantum encryption to its iMessage protocol</a> — this means Apple users are now safe from <a href="https://www.nist.gov/cybersecurity/what-post-quantum-cryptography">quantum computers that don&#8217;t exist</a>. And yet users&#8217; most intensely private secrets can still be read off their phone or from a backup by anyone who can guess their passcode and use a search box. This is not a good place to be in 2025, and Apple needs to do better.</p>



<h3 class="wp-block-heading">A couple of technical notes</h3>



<p>Since this is a technical blog I feel compelled to say a few things that are just a tad more detailed than the plea above.</p>



<p>First off, <a href="https://x.com/hoffmang?s=11">Gene Hoffman</a> points me to a small feature in the Settings of your phone called &#8220;Keep Messages&#8221; (buried under &#8220;Messages&#8221; in Settings, and then scrolling way down.) This determines how long your messages will be kept around on your own phone. You cannot set this per conversation, but you can set it to something shorter than &#8220;Forever&#8221;, say, one year. This is a big decision for some people to make, however, since it will immediately delete any old messages you actually cared about. </p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0220.jpg"><img data-attachment-id="8535" data-permalink="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/img_0220/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0220.jpg" data-orig-size="1290,1303" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="IMG_0220" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0220.jpg?w=297" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0220.jpg?w=700" loading="lazy" width="1014" height="1024" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/img_0220.jpg?w=1014" alt="" class="wp-image-8535" style="width:298px;height:auto" /></a></figure></div>


<p>More importantly (as mentioned in comments) this only affects <em>your</em> phone. Messages erased via this process will remain on the phones of your conversation partners. </p>



<p>Second, if you really want to secure your iMessages, <a href="https://support.apple.com/en-us/108756">you should turn on Apple&#8217;s Advanced Data Protection feature</a>. This will activate end-to-end encryption for your iCloud backups, and will ensure that nobody but you can access those messages. </p>



<p><em>This is not the same thing as disappearing messages, because all it protects is backups. Your messages will still exist on your phone and in your encrypted backups. But it at least protects your backups better.</em></p>



<p>Third, Apple advertises a feature called <a href="https://support.apple.com/guide/icloud/set-up-messages-mm0de0d4528d/icloud">Messages in iCloud</a>, which is designed to back up and sync your messages between devices. Apple even advertises that this feature is <a href="https://support.apple.com/en-us/102651">end-to-end encrypted</a>!</p>



<figure class="wp-block-image size-large"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-4.png"><img data-attachment-id="8516" data-permalink="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/image-79/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-4.png" data-orig-size="1642,222" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-4.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-4.png?w=700" loading="lazy" width="1024" height="138" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-4.png?w=1024" alt="" class="wp-image-8516" /></a></figure>



<p>I hate this phrasing because it is <em>disastrously</em> misleading. Messages in iCloud may be encrypted, however&#8230; If you use iCloud Backup without ADP (which is the default for new iPhones) <span style="text-decoration: underline"><a href="https://support.apple.com/en-us/102651">the Messages in iCloud encryption key itself</a></span> will be backed up to Apple&#8217;s servers in a form that Apple itself can access. And so the content of the Messages in iCloud database will be completely available to Apple, or anyone who can guess your Apple account password.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-5.png"><img data-attachment-id="8518" data-permalink="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/image-80/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-5.png" data-orig-size="2500,522" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-5.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-5.png?w=700" loading="lazy" width="1024" height="213" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/03/image-5.png?w=1024" alt="" class="wp-image-8518" style="width:651px;height:auto" /></a></figure></div>


<p>None of this has anything to do with disappearing messages. However: that feature, with proper anti-backup protections, would go a long way to make these backup concerns obsolete.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/apple/" rel="category tag">Apple</a>, <a href="https://blog.cryptographyengineering.com/category/messaging/" rel="category tag">messaging</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/" rel="bookmark"><time class="entry-date published" datetime="2025-03-01T16:53:30+00:00">March 1, 2025</time><time class="updated" datetime="2025-03-02T13:56:14+00:00">March 2, 2025</time></a></span><span class="word-count">1,636 Words</span><span class="comments-link"><a href="https://blog.cryptographyengineering.com/2025/03/01/dear-apple-add-disappearing-messages-to-imessage-right-now/#comments">10 Comments</a></span><!-- .comments-link -->		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
				
<article id="post-8438" class="post-8438 post type-post status-publish format-standard has-post-thumbnail hentry category-apple category-backdoors tag-apple tag-cybersecurity tag-encryption tag-security">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2025/02/23/three-questions-about-apple-encryption-and-the-u-k/" rel="bookmark">Three questions about Apple, encryption, and the&nbsp;U.K.</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2025/02/23/three-questions-about-apple-encryption-and-the-u-k/"><img width="700" height="430" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg?w=700&amp;h=430&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Three questions about Apple, encryption, and the&nbsp;U.K." decoding="async" loading="lazy" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg?w=700&amp;h=430&amp;crop=1 700w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg?w=1400&amp;h=860&amp;crop=1 1400w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg?w=150&amp;h=92&amp;crop=1 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg?w=300&amp;h=184&amp;crop=1 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg?w=768&amp;h=472&amp;crop=1 768w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg?w=1024&amp;h=629&amp;crop=1 1024w" sizes="(max-width: 700px) 100vw, 700px" data-attachment-id="8475" data-permalink="https://blog.cryptographyengineering.com/2025/02/23/three-questions-about-apple-encryption-and-the-u-k/sony-dsc/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg" data-orig-size="1599,1064" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;SONY DSC&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;SONY DSC&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="SONY DSC" data-image-description="" data-image-caption="&lt;p&gt;SONY DSC&lt;/p&gt;
" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/1599px-the_union_flag_union_jack_uk_flag_326_7294538516.jpg?w=700" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p>Two weeks ago, the Washington Post reported that the <a href="https://www.washingtonpost.com/technology/2025/02/07/apple-encryption-backdoor-uk/">U.K. government had issued a secret order to Apple</a> demanding that the company include a &#8220;backdoor&#8221; into the company&#8217;s <a href="https://support.apple.com/en-us/108756">end-to-end encrypted iCloud Backup </a>feature. From the <a href="https://www.washingtonpost.com/technology/2025/02/07/apple-encryption-backdoor-uk/">article</a>:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>The British government’s undisclosed order, issued last month, requires blanket capability to view fully encrypted material, not merely assistance in cracking a specific account, and has no known precedent in major democracies. Its application would mark a significant defeat for tech companies in their decades-long battle to avoid being wielded as government tools against their users, the people said, speaking under the condition of anonymity to discuss legally and politically sensitive issues.</p>
</blockquote>



<p>That same report predicted that Apple would soon be disabling their end-to-end encrypted iCloud backup feature (called <a href="https://support.apple.com/en-us/108756">Advanced Data Protection</a>) for all U.K. users. On Friday, <a href="https://www.bbc.com/news/articles/cgj54eq4vejo">this prediction was confirmed:</a></p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-22.png"><img data-attachment-id="8462" data-permalink="https://blog.cryptographyengineering.com/2025/02/23/three-questions-about-apple-encryption-and-the-u-k/image-73/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-22.png" data-orig-size="1706,448" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-22.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-22.png?w=700" loading="lazy" width="1024" height="268" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-22.png?w=1024" alt="" class="wp-image-8462" style="width:522px;height:auto" /></a></figure></div>


<p>Apple’s decision to disable their encrypted cloud backup feature has  triggered many reactions, including a few angry <a href="https://x.com/timsweeneyepic">takes by Apple critics</a>, accusing Apple of selling out its users:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-19.png"><img data-attachment-id="8446" data-permalink="https://blog.cryptographyengineering.com/2025/02/23/three-questions-about-apple-encryption-and-the-u-k/image-70/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-19.png" data-orig-size="1268,1161" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-19.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-19.png?w=700" loading="lazy" width="1024" height="937" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-19.png?w=1024" alt="" class="wp-image-8446" style="width:302px;height:auto" /></a></figure></div>


<p>With all this in mind, I think it&#8217;s time to take a sober look at what might really happening here. This will require some speculation and educated guesswork. But I think that exercise will be a lot more helpful to us if we want to find out what&#8217;s really going on.</p>



<h3 class="wp-block-heading">Question 1: does Apple really care about encryption?</h3>



<p>Encryption is a tool that protects user data by processing it using a key, so that only the holder of the appropriate key can read it. A variant called <em>end-to-end encryption </em>(E2EE) uses keys that only the user (or <em>users</em>) knows. The benefit of this approach is that data is protected from many threats that face centralized repositories: theft, cyber attacks, and even access by <a href="https://en.wikipedia.org/wiki/Salt_Typhoon">sophisticated</a> <a href="https://cloud.google.com/blog/topics/threat-intelligence/russia-targeting-signal-messenger">state-sponsored attackers.</a> One downside of this encryption is that it can also block <a href="https://www.fbi.gov/news/speeches/going-dark-are-technology-privacy-and-public-safety-on-a-collision-course">governments and law enforcement agencies from accessing the same data</a>.</p>



<p>Navigating this tradeoff has been a thorny problem for Apple. Nevertheless, Apple has <em>mostly</em> opted to err on the side of aggressive deployment of (end-to-end) encryption. For some examples:</p>



<ol class="wp-block-list">
<li>In 2008, the company began <a href="https://media.blackhat.com/bh-ad-11/Belenko/bh-ad-11-Belenko-iOS_Data_Protection.pdf">encrypting all iPhone internal data storage</a> by default. This is why you can feel safe (about your data) if you ever leave your iPhone in a cab.</li>



<li>In 2011, the company launched <a href="https://www.cnet.com/tech/tech-industry/apples-imessage-encryption-trips-up-feds-surveillance/">iMessage</a>, a built-in messaging service with default end-to-end encryption for all users. This was the first widely-deployed end-to-end encrypted messaging service. Today <a href="https://investigations.cooley.com/2025/01/15/federal-law-enforcement-recommends-encrypted-and-ephemeral-messaging/">these systems are recommended even by the FBI</a>.</li>



<li>In 2013, Apple <a href="https://www.cnet.com/tech/tech-industry/apples-imessage-encryption-trips-up-feds-surveillance/">launched iCloud Key Vault,</a> which encrypts your backed-up passwords and browser history using encryption that even Apple can&#8217;t access.</li>
</ol>



<p>Apple faced law enforcement backlash on each of these moves. But perhaps the most famous example of Apple&#8217;s aggressive stance on encryption occurred during the 2016 Apple v. FBI case, where the company <a href="https://en.wikipedia.org/wiki/Apple%E2%80%93FBI_encryption_dispute">actively fought U.S. government&#8217;s demands</a> to bypass encryption mechanisms on an iPhone belonging to an alleged terrorist. Apple argued that satisfying the government’s demand would have required Apple to weaken encryption on all of the company&#8217;s phones. Tim Cook even took the unusual step of signing <a href="https://www.apple.com/customer-letter/">a public letter</a> defending the company&#8217;s use of encryption:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-21.png"><img data-attachment-id="8451" data-permalink="https://blog.cryptographyengineering.com/2025/02/23/three-questions-about-apple-encryption-and-the-u-k/image-72/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-21.png" data-orig-size="1698,940" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-21.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-21.png?w=700" loading="lazy" width="1024" height="566" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-21.png?w=1024" alt="" class="wp-image-8451" style="width:431px;height:auto" /></a></figure></div>


<p>I wouldn&#8217;t be telling you the truth if I failed to mention that Apple has also made some big mistakes. In 2021, the company announced a plan to <a href="https://educatedguesswork.org/posts/apple-csam-intro/">implement client-side scanning of iCloud Photos</a> to search for evidence of illicit material in private photo libraries. This would have opened the door for many different types of government-enforced data scanning, scanning that would work even if data was backed up in an end-to-end encrypted form. In that instance, technical experts quickly <a href="https://github.com/anishathalye/neural-hash-collider">found flaws in Apple&#8217;s proposal</a> and it was first <a href="https://www.accessnow.org/press-release/apple-pauses-device-scanning-csam-plan/">paused</a>, then completely <a href="https://www.cnn.com/2022/12/08/tech/apple-csam-tool/index.html">abandoned</a> in 2022.</p>



<p>This is not intended to be a hagiography for Apple. I&#8217;m simply pointing out that the company has, in the past, taken major public risks to deploy and promote encryption. Based on this history, I&#8217;m going to give Apple the benefit of the doubt and assume that the company is <span style="text-decoration: underline">not</span> racing to sell out its users.</p>



<h3 class="wp-block-heading">Question 2: what was the U.K. really asking for?</h3>



<p>Way back in 2016, the U.K. passed a bill called the <a href="https://www.legislation.gov.uk/ukdsi/2018/9780111163610">Investigatory Powers Act</a>, sometimes called the &#8220;<a href="https://techcrunch.com/2017/05/05/uk-surveillance-law-still-fuzzy-on-decryption-rules-for-comms-providers/">Snooper&#8217;s Charter.</a>&#8221; At the time the law was enacted, many critics argued that it could be used to <a href="https://techcrunch.com/2017/05/05/uk-surveillance-law-still-fuzzy-on-decryption-rules-for-comms-providers/">secretly weaken security systems</a>, potentially making them much more vulnerable to hacking.</p>



<p>This was due to a critical feature of the new law: it enables the U.K. government to issue secret &#8220;<a href="https://assets.publishing.service.gov.uk/media/5a81ffbf40f0b6230269a4c7/TCRs_EM.pdf#:~:text=A%20technical%20capability%20notice%20imposes%20obligations%20on,issued%20under%20the%20Investigatory%20Powers%20Act%202016">Technical Capability Notices</a>&#8221; that can force a provider, such as Apple, to <em>secretly</em> <em>change the operation of their system</em> — for example, altering an end-to-end encrypted system so that Apple would be forced to hold a copy of the user&#8217;s key. With this modification in place, the U.K. government could then demand access to any user&#8217;s data on demand.</p>



<p>By far the most concerning part of the U.K. law is that it does not clearly distinguish between U.K. customers and non-U.K. customers, such as those of us in the U.S. or other European nations. Apple&#8217;s lawyers called this out in a <a href="https://publications.parliament.uk/pa/cm5804/cmpublic/InvestigatoryPowersAmendment/memo/IPAB10.htm">2024 filing to Parliament</a>:</p>



<figure class="wp-block-image"><img data-attachment-id="8274" data-permalink="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/image-65/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-14.png" data-orig-size="2500,426" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-14.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-14.png?w=700" loading="lazy" width="2500" height="426" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-14.png" alt="" class="wp-image-8274" /></figure>



<p>In the <em>worst-case</em> interpretation of the law, the U.K. might now be the arbiter of all cybersecurity defense measures <span style="text-decoration: underline">globally</span>. Her Majesty&#8217;s Government could effectively &#8220;cap&#8221; the amount of digital security that customers <span style="text-decoration: underline">anywhere in the world</span> can depend on, without users even knowing that cap was in place. This could expose vast amounts of data to state-sponsored attackers, such as the ones who recently <a href="https://cyberscoop.com/salt-typhoon-telecom-breach-remarkable-for-its-indiscriminate-targeting-fbi-official-says/">compromised the entire U.S. telecom industry</a>. Worse, because the U.K.&#8217;s Technical Capability Notices are <span style="text-decoration: underline">secret</span>, companies like Apple would be effectively forced to lie to their customers — convincing them that their devices are secure, when in fact they are not.</p>



<p>It goes without saying that this is a very dangerous road to start down.</p>



<h3 class="wp-block-heading">Question 3: how might Apple respond to a broad <span style="text-decoration: underline">global</span> demand from the U.K.?</h3>



<p>Let us imagine, hypothetically, that this worst-case demand is <span style="text-decoration: underline">exactly</span> what Apple is faced with. The U.K. government asks Apple to secretly modify their system for all users globally, so that it is no longer end-to-end encrypted anywhere in the world. </p>



<p>(<em>And if you think about it practically: </em>that flavor of demand seems almost unavoidable in practice. Even if you imagine that Apple is only being asked only to target users in the U.K., the company would either need to build this capability globally, or it would need to deploy a new version or &#8220;zone&#8221;<sup>1</sup> for U.K. users that would work differently from the version for, say, U.S. users. From a technical perspective, this would be tantamount to admitting that the U.K.&#8217;s version is somehow operationally distinct from the U.S. version. That would invite reverse-engineers to ask very pointed questions and the secret would almost certainly be out.)</p>



<p>But if you&#8217;re Apple, you absolutely cannot entertain, or even engage with this possibility. The minute you engage with it, you&#8217;re dead. One single nation — the U.K. — becomes the governor of all of your security products, and will now dictate how they work globally. Worse, engage with this demand would open a hell-mouth of unfortunate possibilities. Do you tell China and Europe and the U.S. that you&#8217;ve given the U.K. a backdoor into their data? What if they object? What if they want one too? </p>



<p>There is nothing down that road but catastrophe.</p>



<p>So if you&#8217;re Apple and faced with this demand from the U.K., engaging with the demand is not really an option. You have a relatively small number of choices available to you. In order of increasing destructiveness:</p>



<ol class="wp-block-list">
<li>Hire a bunch of very expensive lawyers and hope you can convince the U.K. to back down.</li>



<li>Shut down iCloud end-to-end encryption in the U.K. and hope that this renders the issue moot.</li>



<li>???</li>



<li>Exit the U.K. market entirely.</li>
</ol>



<p>If we can believe the <a href="https://www.washingtonpost.com/technology/2025/02/07/apple-encryption-backdoor-uk/">reporting so far</a>, I think it&#8217;s safe to say that Apple has almost certainly tried the legal route. I can&#8217;t even imagine what the secret court process in the U.K. looks like (does it involve wigs?) but if it&#8217;s anything like the <a href="https://www.fisc.uscourts.gov/">U.S.&#8217;s FISA courts</a>, I would tend to assume that it is unlikely to be a fair fight for a target company, particularly a foreign one.</p>



<p>In this model, Apple&#8217;s decision to <a href="https://www.bbc.com/news/articles/cgj54eq4vejo">disable end-to-end encrypted iCloud Backup means</a> we have now reached Stage 2. U.K. users will no longer be able to sign up for Apple&#8217;s end-to-end encrypted backup as of February 21. (We aren&#8217;t told how existing users will be handled, but I imagine they&#8217;ll be forced to voluntarily downgrade to unencrypted service, or else lose their data.) Any request for a backdoor <span style="text-decoration: underline">for U.K. users</span> is now completely moot, because effectively the system no longer exists for U.K. users.</p>



<p>At this point I suppose it remains to see what happens next. Perhaps the U.K. government blinks, and relaxes its demands for access to Apple&#8217;s keys. In that case, I suppose this story will sink beneath the waves, and we&#8217;ll never hear anything about it ever again, at least until next time.</p>



<p>In another world, the U.K. government keeps pushing. If that happens, I imagine we&#8217;ll be hearing quite a bit more about this in the future.</p>



<p><em>Top photo due to <a href="https://www.flickr.com/people/58996719@N07">Rian (Ree) Saunders.</a></em></p>



<p><em>Notes:</em></p>



<ol class="wp-block-list">
<li>Apple already deploys a separate &#8220;zone&#8221; for many of its <a href="https://blog.cryptographyengineering.com/2018/01/16/icloud-in-china/">iCloud security products in China</a>. This is due to Chinese laws that mandate domestic hosting of Apple server hardware and keys. We have been assured by Apple (in various reporting) that Apple does not violate its end-to-end encryption for the Chinese government. The various people I&#8217;d expect to quit — if that claim was not true — all seem to be still working there.</li>
</ol>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/apple/" rel="category tag">Apple</a>, <a href="https://blog.cryptographyengineering.com/category/backdoors/" rel="category tag">backdoors</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2025/02/23/three-questions-about-apple-encryption-and-the-u-k/" rel="bookmark"><time class="entry-date published" datetime="2025-02-23T16:46:05+00:00">February 23, 2025</time><time class="updated" datetime="2025-02-23T17:27:00+00:00">February 23, 2025</time></a></span><span class="word-count">1,643 Words</span><span class="comments-link"><a href="https://blog.cryptographyengineering.com/2025/02/23/three-questions-about-apple-encryption-and-the-u-k/#comments">9 Comments</a></span><!-- .comments-link -->		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
				
<article id="post-8230" class="post-8230 post type-post status-publish format-standard has-post-thumbnail hentry category-attacks category-fundamentals tag-cryptography tag-math">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2025/02/19/how-to-prove-false-statements-part-3/" rel="bookmark">How to prove false statements? (Part&nbsp;3)</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2025/02/19/how-to-prove-false-statements-part-3/"><img width="279" height="357" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/the_empire_of_light_belgium.jpg?w=279&amp;h=357&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="How to prove false statements? (Part&nbsp;3)" decoding="async" loading="lazy" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/the_empire_of_light_belgium.jpg 279w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/the_empire_of_light_belgium.jpg?w=117&amp;h=150&amp;crop=1 117w" sizes="(max-width: 279px) 100vw, 279px" data-attachment-id="8385" data-permalink="https://blog.cryptographyengineering.com/2025/02/19/how-to-prove-false-statements-part-3/the_empire_of_light_belgium/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/the_empire_of_light_belgium.jpg" data-orig-size="279,357" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="The_Empire_of_Light_Belgium" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/the_empire_of_light_belgium.jpg?w=234" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/the_empire_of_light_belgium.jpg?w=279" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p><em>This is the third and <span style="text-decoration: underline">penultimate</span> post in a series about theoretical weaknesses in Fiat-Shamir as applied to proof systems. The first post is <a href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/">here</a>, the second post is <a href="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/">here</a>, and you should probably read them.</em></p>



<p>Over the past two posts I&#8217;ve given a bit of background on four subjects: (1) interactive proof systems (for general programs/circuits), (2) the Fiat-Shamir heuristic, (3) random oracles. We&#8217;ve also talked about (4) recursive proofs, which will be important but are not <em>immediately</em> relevant.</p>



<p>With all that background we are <em>finally</em> almost ready to talk about the new result by Khovratovich, Rothblum and Soukhanov entitled “<a href="https://eprint.iacr.org/2025/118">How to Prove False Statements: Practical Attacks on Fiat-Shamir</a>” (which we will call KRS for short.)</p>



<h3 class="wp-block-heading">Let&#8217;s get situated</h3>



<p>The KRS result deals with a very common situation that we introduced in the previous post. Namely, that many new proving systems are first developed as <span style="text-decoration: underline">interactive protocols</span> (usually called <a href="https://en.wikipedia.org/wiki/Interactive_proof_system#Public_coin_protocol_versus_private_coin_protocol">public-coin</a> protocols, or sometimes <a href="https://en.wikipedia.org/wiki/Proof_of_knowledge#Sigma_protocols">Sigma protocols</a>.) These protocols fit into a template: first, a Prover first sends a <em>commitment</em> message, then interacts with some (honest) Verifier who &#8220;challenges&#8221; the Prover in various ways that are specific to the protocol; for each challenge, the Prover must respond correctly, either once or multiple times. The nature of the challenges can vary from scheme to scheme. For now we don&#8217;t care about the details: the commonality is that <span style="text-decoration: underline">in the interactive setting</span> the Verifier picks its challenges honestly, using <span style="text-decoration: underline">real randomness</span>.</p>


<div class="wp-block-image">
<figure class="aligncenter is-resized"><img data-attachment-id="8200" data-permalink="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/image-57/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-6.png" data-orig-size="2000,604" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-6.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-6.png?w=700" loading="lazy" width="2000" height="604" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-6.png" alt="" class="wp-image-8200" style="width:538px;height:auto" /></figure></div>


<p>In many cases, these protocols are then &#8220;flattened&#8221; down into a <span style="text-decoration: underline">non-interactive proof</span> using the Fiat-Shamir heuristic. The neat thing is that the Prover can run the interactive protocol all by itself, by running a deterministic &#8220;copy&#8221; of the Verifier. Specifically, the Prover will:</p>



<ol class="wp-block-list">
<li>Cryptographically hash its own Commitment message — along with some extra information, such as the input/output and &#8220;circuit&#8221; (or program, or statement.)<sup>1</sup></li>



<li>Use the resulting hash digest bits to sample a challenge.</li>



<li>Compute the Prover&#8217;s response to the challenge (many times if the protocol calls for this.)</li>



<li>Publish the whole transcript for anyone to verify. </li>
</ol>



<p>Protocol designers focus on the <span style="text-decoration: underline">interactive</span> setting because it&#8217;s relatively easy to analyze the security of the protocol. They can make strong claims about the nature of the challenges that will be chosen, and can then reason about the probability that a cheating Prover can lie in response. The hope with Fiat-Shamir is that, if the hash function is &#8220;as good as&#8221; a random oracle, it should be nearly as secure as the interactive protocol.</p>



<p>Of course none of this applies to practice. When we deploy the protocol onto a blockchain, we don&#8217;t have interactive Verifiers and we certainly don&#8217;t have random oracles. Instead we replace the random oracle in Fiat-Shamir with a standard hash function like SHA-3. Whether or not any security guarantees still hold once we do this is an open question. And into the maw of that question is where we shall go.</p>



<h3 class="wp-block-heading">The GKR15 succinct proof system (but not with details)</h3>



<p>The new KRS paper starts by considering a specific interactive proof system designed back in 2015 by <a href="https://dl.acm.org/doi/10.1145/1374376.1374396">Goldwasser, Kalai and Rothblum</a>, which we will refer to as GKR15 (note that the &#8220;R&#8221; is the <span style="text-decoration: underline">not</span> the same in both papers — thanks Aditya!) This is a relatively early result on interactive proving systems and has many interesting theoretical features that we will mostly ignore.</p>



<p>At the surface level, what you need to know about the GKR15 proof system is that it works over <a href="https://medium.com/@Scoper/arithmetic-circuits-for-dummies-by-a-dummie-9a32c4b54a43">arithmetic <span style="text-decoration: underline">circuit</span>s.</a> The Prover and Verifier agree on a circuit <strong>C </strong>(which can be thought of as the &#8220;program&#8221;). The Prover also provides some<em> </em><span style="text-decoration: underline">input</span> to the circuit <strong>x</strong> as well as a <span style="text-decoration: underline">witness</span> <strong>w</strong>, and a purported output <strong>y</strong>, which ought to satisfy <strong>y</strong> = <strong>C</strong>(<strong>w</strong>, <strong>x</strong>) if the Prover is honest.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-17.png"><img data-attachment-id="8393" data-permalink="https://blog.cryptographyengineering.com/2025/02/19/how-to-prove-false-statements-part-3/image-68/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-17.png" data-orig-size="1316,444" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-17.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-17.png?w=700" loading="lazy" width="1024" height="345" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-17.png?w=1024" alt="" class="wp-image-8393" style="width:319px;height:auto" /></a></figure></div>

<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-11.png"><img data-attachment-id="8247" data-permalink="https://blog.cryptographyengineering.com/2025/02/19/how-to-prove-false-statements-part-3/image-62/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-11.png" data-orig-size="1948,556" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-11.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-11.png?w=700" loading="lazy" width="1024" height="292" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-11.png?w=1024" alt="" class="wp-image-8247" style="width:404px;height:auto" /></a></figure></div>


<p>There are some restrictions on the nature of the circuits that can be used in GKR15 — which we will ignore for the purposes of this high-level intuition. The important feature is that the circuits can be relatively<em> <span style="text-decoration: underline">deep</span></em>. That is to say, they can implement reasonably complex programs, such as cryptographic hashing algorithms.</p>



<p>(The authors of the recent KRS paper also refer to GKR15 as a &#8220;popular&#8221; scheme. I don&#8217;t know how to evaluate that claim. But they cite some features in the protocol that are re-used in more <a href="https://github.com/PolyhedraZK/Expander">recent proof systems</a> that might be deployed in practice, so let&#8217;s go with this!)</p>



<p>The GKR15 scheme (like most proving schemes) is designed to be interactive. All you need to know for the moment is that:</p>



<ol class="wp-block-list">
<li>The Prover and Verifier agree on <strong>C</strong>.</li>



<li>The Prover sends the input and output (<strong>x, y</strong>) to the Verifier.</li>



<li>It also sends a (polynomial) <span style="text-decoration: underline">commitment</span> to the witness <strong>w</strong> in the first &#8220;Commitment&#8221; message.</li>



<li>The Verifier picks a random challenge <strong>c</strong> and the Prover/Verifier interact (multiple times) to do stuff in response to this challenge.</li>
</ol>



<p>Finally: GKR15 possesses a security analysis (&#8220;soundness proof&#8221;) that is quite powerful, provided we are discussing the <em>interactive</em> version of the protocol. This argument does not claim GKR15 is &#8220;perfect&#8221;! It leaves room for some tiny probability that a cheating Prover can get away with its crimes: however, it does bound the probability of successful cheating to something (asymptotically and, presumably, practically with the right parameters) <a href="https://en.wikipedia.org/wiki/Negligible_function">negligible</a>.</p>



<p>Since the GKR15 authors are careful theoretical cryptographers, they <em>don&#8217;t</em> suggest that their protocol would be a good fit for Fiat-Shamir. In fact, they hint that this is a problematic idea. But, in the 2015 paper anyway, the don&#8217;t actually show there&#8217;s a problem with the idea. This leaves open a question: what happens if we <em>do</em> flatten it using Fiat-Shamir? Could bad things happen?</p>



<h3 class="wp-block-heading">A first thought experiment: &#8220;weak challenges&#8221;</h3>



<p>I am making a deliberate decision to stay &#8220;high level&#8221; and not dive into the details of the GKR15 system quite yet, not because I think they&#8217;re boring and off-putting — ok, it&#8217;s partly because I think they&#8217;re boring and off-putting — but mostly because I think leading with those details will make understanding more difficult. I promise I&#8217;ll get to the details later.</p>



<p>Up here at the abstract level I want to remind us, one final time, what we know. We know that proving systems like GKR15 involve a Verifier making a &#8220;challenge&#8221; to the Prover, which the Prover must answer successfully. A good proving system should ensure that an honest Prover can answer those challenges successfully — but a <span style="text-decoration: underline">cheating</span> Prover (any algorithm that is trying to prove a false statement) will fail to respond correctly to these challenges, at least with overwhelming probability.</p>



<p>Now I want to add a new wrinkle. </p>



<p>Let&#8217;s first imagine that the set of all possible challenges a Verifier could issue to a Prover is quite large. For one example: the the challenge might be a random 256-bit string, i.e., there are 2<sup>256</sup> to choose from. For fun, let&#8217;s further imagine that somewhere within this huge set of possible challenge values there exists a single &#8220;weak challenge.&#8221; This value <strong>c*</strong> — which I&#8217;ll exemplify by the number &#8220;53&#8221; for this discussion —&nbsp;is special. A cheating Prover who is fortunate enough to be challenged at this point <span style="text-decoration: underline">will always be able to come up with a valid response</span>, even if the statement they are &#8220;proving&#8221; is totally false (that is, if <strong>y</strong> is not equal to <strong>C</strong>(<strong>w</strong>, <strong>x</strong>).)</p>



<p>Now it goes without saying that having such a &#8220;weak challenge&#8221; in your scheme is not great! Clearly we don&#8217;t like to have weird vulnerabilities in our schemes. And yet, perhaps it&#8217;s not really a problem? To decide, we need to ask: <em>how likely is it that a Verifier will select this weak challenge value?</em> </p>



<p>If we are thinking about the <span style="text-decoration: underline">interactive setting</span> with an honest Verifier, the analysis is easy. There are 2<sup>256</sup> possible challenge values, and just one &#8220;weak challenge&#8221; at <strong>c*</strong> = 53. If the honest Verifier picks challenges uniformly at random, this bad challenge will be chosen with probability 2<sup>-256</sup> during one run of the protocol. This is so astronomically improbable that we can more or less pretend it will never happen.</p>



<h3 class="wp-block-heading">How does Fiat-Shamir handle &#8220;bad challenges&#8221;?</h3>



<p>We now need to think about what happens when we flatten this scheme using Fiat-Shamir.</p>



<p>To do that we need to be more specific about how the scheme will be Fiat-Shamir-ified. In our scheme, we assumed that the Prover will generate a <em>Commitment</em> message first. The deterministic Fiat-Shamir &#8220;Verifier&#8221; will hash this message using a hash function <strong>H</strong>, probably tossing in some other inputs just to be safe. For example, it might include the input/output values as well as a hash of the circuit h(<strong>C)</strong> — note that we&#8217;re using a separate hash function out of an abundance of caution. Our challenge will now be computed as follows:</p>



<p class="has-text-align-center"><strong>c = </strong>H( h(<strong>C</strong>), <strong>x</strong>, <strong>y</strong>, <em>Commitment</em> )</p>



<p>Our strawman protocol has a weak challenge point at <strong>c* </strong>= 53. So now we should ask: can a cheating Prover somehow convince the Fiat-Shamir hash &#8220;Verifier&#8221; to challenge them at this weak point?</p>



<p>The good news for Fiat-Shamir is that this also seems pretty difficult. A cheating Prover might <span style="text-decoration: underline">want</span> to get itself challenged on <strong>c</strong>* = 53. But to do this, they&#8217;d need to find some input (<a href="https://en.wikipedia.org/wiki/Preimage_attack">pre-image</a>) to the hash function <strong>H</strong> that produces the output &#8220;53&#8221;. For any hash function worth its salt (pun intended!) this should be pretty difficult!<sup>4</sup></p>



<p>Of course, in Fiat-Shamir world, the cheating Prover has a slight advantage: if it doesn&#8217;t get the hash challenge it wants, it can always throw away the result and try again. To do this it could formulate a new <em>Commitment</em> message (or even pick a new input/output pair <strong>x, y</strong>) and then try hashing again. It can potentially repeat this process millions of times! This attack is sometimes called &#8220;grinding&#8221; and it&#8217;s a real attack that actual cheating Provers can <a href="https://eprint.iacr.org/2023/1071">run in the real world</a>. Fortunately even grinding isn&#8217;t necessarily a disaster: if we assume that the Prover can only compute, say, 2<sup>50</sup> hashes, then (in the ROM) the probability of finding an input that produces <strong>c</strong> = 53 is still 2<sup>50</sup> * 2<sup>-256</sup> = 2<sup>-206</sup>, yet another very unlikely outcome.</p>



<p>Another victory for Fiat-Shamir! Even if we have one or more <span style="text-decoration: underline">fixed</span> &#8220;weak challenge&#8221; points in our protocol, it seems like Fiat-Shamir protects us.</p>



<h3 class="wp-block-heading">What if a cheating Prover can <span style="text-decoration: underline">pick</span> the &#8220;weak challenge&#8221;?</h3>



<p>I realize I&#8217;m being exhaustive (or exhausting), but I now want to consider another weird possibility: what if the &#8220;bad challenge&#8221; value can change when we switch circuits (or even circuit inputs)?</p>



<p>For fun, let&#8217;s crank this concern into absolute overdrive. Imagine we&#8217;re using a proving system that&#8217;s as helpful as possible to the cheating Prover: in this system, the &#8220;weak challenge value&#8221; will be equal to whatever the <span style="text-decoration: underline">real</span> output of the circuit <strong>C</strong> is. Concretely, if the circuit outputs <strong>c*</strong> = <strong>C</strong>(<strong>w</strong>, <strong>x</strong>) <span style="text-decoration: underline">and also</span> <strong>c*</strong> happens to be challenge value selected by the Verifier, then the Prover can cheat.</p>



<p>(Notice that I&#8217;m specifying that this vulnerability depends on the &#8220;real&#8221; output of the circuit. The prover also sends over a value <strong>y</strong>, which is the <span style="text-decoration: underline">purported</span> output of the circuit that the Prover is claiming, but that might be different if the Prover is cheating.)</p>



<p>In the interactive world this really isn&#8217;t an issue. In that setting, the Verifier selects the challenge randomly <span style="text-decoration: underline">after</span> the Prover has committed to everything. In that setting, the Prover genuinely cannot &#8220;cook&#8221; the circuit to produce the challenge value as output (except with a tiny probability.) Our concern is that In Fiat-Shamir world we should be a bit more worried. The value <strong>c*</strong> is chosen by hashing. A cheating Prover could theoretically compute <strong>c* </strong>in advance. It now has several options:</p>



<ul class="wp-block-list">
<li>The cheater could alter the circuit <strong>C</strong> so that it hard-codes in <strong>c*</strong>.</li>



<li>Alternatively, it could feed the value <strong>c*</strong> (or some function of it) into the circuit via the input <strong>x</strong>.</li>



<li>It could sneak <strong>c*</strong> in within the witness <strong>w</strong>.</li>



<li>Or any combination of the above.</li>
</ul>



<p>The problem here is that even in Fiat-Shamir world, this attack doesn&#8217;t work. A cheating Prover might first pick a circuit <strong>C</strong> and some input/output <strong>x</strong>, witness <strong>w</strong>, and a (purported) output <strong>y</strong>. It could then compute a <em>Commitment</em> by using the proving scheme&#8217;s commitment protocol to commit to <strong>w</strong>. It will then compute the anticipated Fiat-Shamir challenge as:</p>



<p class="has-text-align-center"><strong>c* = </strong>H( h(<strong>C</strong>), <strong>x</strong>, <strong>y</strong>, <em>Commitment</em> )</p>



<p>To exploit the vulnerability in our proving system, the cheating Prover must now somehow cause the circuit <strong>C</strong> to output <strong>C</strong>(<strong>w</strong>, <strong>x</strong>) = <strong>c*</strong>. However, once again we encounter a problem. The cheating Prover had to feed <strong>x</strong>, as well as a (commitment to) <strong>w</strong> and (a hash of) the circuit <strong>C</strong> into the Fiat-Shamir hash function in order to learn <strong>c*.</strong> (It should not have been able to predict <strong>c*</strong> before performing the hash computation above, so it&#8217;s extremely unlikely that <strong>C</strong>(<strong>w</strong>, <strong>x</strong>) would just happen to output <strong>c*</strong>.) However, in order to make <strong>C</strong>(w, x) output <strong>c*</strong>, the cheater must subsequently manipulate either (1) the design of <strong>C </strong>or (2) the circuit&#8217;s inputs <strong>w</strong>, <strong>x</strong>. </p>



<p>But if the cheating Prover does any of those things, they will be completely foiled. If the cheating Prover changes <span style="text-decoration: underline">any</span> of the inputs to the circuit or the Circuit itself <span style="text-decoration: underline">after</span> it hashes to learn <strong>c*</strong>, then the actual Fiat-Shamir challenge used in the protocol will change.<sup>3</sup></p>



<h3 class="wp-block-heading">What if the circuit can <span style="text-decoration: underline">compute</span> the &#8220;weak challenge&#8221; value?</h3>



<p>Phew. So what have we learned?</p>



<p>Even if our proving system allows us to literally pick the &#8220;weak challenge&#8221; <strong>c*</strong> — have it be the output of the circuit <strong>C</strong>(<strong>w</strong>, <strong>x</strong>) —&nbsp;we cannot exploit this fact very easily. Changing the structure of <strong>C</strong>, <strong>x </strong>or <strong>w</strong> <span style="text-decoration: underline">after we&#8217;ve learned <strong>c*</strong> </span>will cause the actual Fiat-Shamir challenge used to simply hop to a different value, like the timeline of a traveler who goes back in time and kills their own grandfather.</p>


<div class="wp-block-image">
<figure class="aligncenter is-resized"><img data-attachment-id="8376" data-permalink="https://blog.cryptographyengineering.com/2025/02/19/how-to-prove-false-statements-part-3/terminator1/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/terminator1.jpg" data-orig-size="970,546" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="terminator1" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/terminator1.jpg?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/terminator1.jpg?w=700" loading="lazy" width="970" height="546" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/terminator1.jpg" alt="" class="wp-image-8376" style="width:374px;height:auto" /></figure></div>


<p>Clearly we need a different strategy: one where none of the inputs to the circuit, or the &#8220;code&#8221; of the circuit itself, depend on the output of the Fiat-Shamir hash function.</p>



<p>An important observation, and one that is critical to the KRS result, is that the &#8220;circuit&#8221; we are proving is fundamentally a kind of program that computes things. What if, instead of computing <strong>c*</strong> and feeding it to the circuit, or hard-coding it within the circuit, we instead design a circuit that <span style="text-decoration: underline">itself</span> computes <strong>c*</strong>?</p>



<p>Let&#8217;s look one last time at the way that Fiat-Shamir challenges are computed:</p>



<p class="has-text-align-center"><strong>c* = </strong>H( h(<strong>C</strong>), <strong>x</strong>, <strong>y</strong>, <em>Commitment</em>)</p>



<p>We are now going to build a circuit <strong>C*</strong> that is able to compute <strong>c*</strong> when given the right inputs. </p>



<p>To make this interesting, we are going to design a very silly circuit. It is silly in a specific way: it can never output one specific output, which in this case will be the binary string &#8220;BANANAS&#8221;. Looking forward, our cheating Prover is then going to try to falsely claim that for some <strong>x</strong>, <strong>w</strong>, the relation <strong>C*</strong>(<strong>w</strong>, <strong>x</strong>) = &#8220;BANANAS&#8221; actually does hold. </p>



<p>Critically, this circuit will contain a copy of the Fiat-Shamir hashing algorithm H() and it will — quite coincidentally — actually output a value that happens to be identical to the Fiat-Shamir challenge (most of the time.) Here’s how it works:</p>



<ol class="wp-block-list">
<li>The cheating Prover will pass <strong>w</strong> and <strong>x</strong> = ( h(<strong>C</strong>*), <strong>y</strong>* = &#8220;BANANAS&#8221; ) as input.</li>



<li>It will then use the proving system&#8217;s commitment algorithm on <strong>w</strong> to compute <em>Commitment</em>.</li>



<li>The circuit will parse <strong>x</strong> into its constituent values.</li>



<li>The circuit will internally compute <strong>c*</strong> = H<strong>(</strong> h(<strong>C</strong>*), <strong>x</strong>, <strong>y</strong>*, <em>Commitment</em> ).</li>



<li>In the (highly unlikely) case that <strong>c*</strong> = &#8220;BANANAS&#8221;, it will set <strong>c* </strong>= &#8220;APPLES&#8221;.</li>



<li>Finally, the circuit will output <strong>c*</strong>. </li>
</ol>



<p>Notice first that this circuit can <em>never, ever</em> output <strong>C</strong>*(<strong>w, x</strong>) = &#8220;BANANAS&#8221; for any inputs <strong>w</strong>, <strong>x</strong>. Indeed, it is incredibly likely that this output would happen to occur naturally after step (4) — how likely is it that a hash function outputs the name of a fruit? — but just to be certain, we have step (5) to reduce this occurrence from &#8220;incredibly unlikely&#8221; to &#8220;absolutely impossible.&#8221;</p>



<p>Second, we should observe that the &#8220;code&#8221; of the circuit above does not in any way depend on <strong>c*.</strong> We can write this circuit before we ever hash to learn <strong>c*</strong>! The same goes for the inputs <strong>w</strong> and <strong>x</strong>. None of the proposed inputs require the cheating Prover to know <strong>c*</strong> before it chooses them.</p>



<p>Now imagine that some Prover shows up and tells you that, in fact, they know some <strong>w</strong>, <strong>x</strong> such that <strong>C*</strong>(<strong>w</strong>, <strong>x</strong>) = &#8220;BANANAS&#8221;. By definition they must be lying! When they try to convince you of this using the proving system, a correctly-functioning system should (with overwhelming probability) catch them in their lie and inform you (the Verifier) that the proof is invalid.</p>



<p>However: we stipulated that this particular proving system becomes totally insecure in the special case where the real calculation <strong>C*(w</strong>,<strong> x) </strong>happens to equal the Fiat-Shamir challenge <strong>c*</strong> that will be chosen during the protocol execution. If and when this remarkable event ever happens, the cheating Prover will be able to successfully complete the protocol <span style="text-decoration: underline">even if the statement they are proving is totally bogus</span>.  And finally it seems we have an exploitable vulnerability! A cheating Prover can show up with the ridiculous false statement that <strong>C*(w</strong>,<strong> x) </strong>= &#8220;BANANAS&#8221;, and then hand us a Fiat-Shamir proof that will verify just fine. They can do this because in real life, <strong>C*</strong>(<strong>w, x</strong>) = <strong>c*</strong> and, thanks to the &#8220;weak challenge&#8221; feature of the proving system, that Prover successfully answer all the challenges on that point. </p>



<p>And thus <em><span style="text-decoration: underline">in Fiat-Shamir land</span> </em>we have finally proved a false statement! Note that in the interactive protocol none of this matters, since the Prover cannot predict the Verifier&#8217;s (honest) challenge, and so has no real leverage to cheat. In the Fiat-Shamir world — at least when considering this one weird circuit <strong>C* </strong>— a cheating Prover can get away with murder.</p>



<h3 class="wp-block-heading">This is not terribly satisfying!</h3>



<p>Well, not murder maybe.</p>



<p>I realize this may seem a bit contrived. First we had to introduce a made-up proving system with a &#8220;weird&#8221; vulnerability, then we exploited it in a very nutty way. And the way we exploited it is kind of silly. But there is a method to the madness. I hope I&#8217;ve loaded us up with the basic concepts that we will need to really understand the KRS result.</p>



<p>What remains is to show how the real GKR15 scheme actually maps to some of these ideas.</p>



<p>As a second matter: I <a href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/">started these posts out</a> by proposing all kinds of flashy ideas: <span style="text-decoration: underline">we could steal billions of dollars in Ethereum transactions by falsely &#8220;proving&#8221; that a set of invalid transactions is actually valid!</span> Now having promised the moon, I&#8217;m delivering the incredibly lame false statement <strong>C*</strong>(<strong>w</strong>, <strong>x</strong>) = &#8220;BANANAS&#8221;, where <strong>C*</strong> is a silly circuit that mostly computes a hash function. This should disappoint you. It disappoints me.</p>



<p>But keep in mind that cryptographic protocols are very delicate. Sometimes an apparently useless vulnerability can be expanded into something that actually matters. It turns out that something similar will apply to this vulnerability, when we apply it to the GKR15 scheme. In the next post.</p>



<p><em>There will be only one last post, I promise.</em></p>



<p><em>Notes:</em></p>



<ol class="wp-block-list">
<li>There is a <a href="https://blog.trailofbits.com/2024/06/24/disarming-fiat-shamir-footguns/">class of attacks on Fiat-Shamir-ified protocols</a> that stems from putting <span style="text-decoration: underline">too little</span> information into the hash function. Usually the weakness here is that the hash does not get fed stuff like &#8220;the public key&#8221; (in signature schemes), which weakly corresponds to &#8220;the circuit&#8221; in a proving system. Sneaky attackers can switch these out and do bad thing.</li>



<li>I&#8217;ve been extremely casual about the problem of converting hash function outputs into &#8220;challenges&#8221; for arbitrary protocols. Sometimes this is easy — for example, if the challenge space consists of fixed-length random bit-strings, then we can just pick a hash function with the appropriate output length. Sometimes it is <span style="text-decoration: underline">moderately</span> easy, for example if the challenges are sampled from some reasonably-sized field. A few protocols might pick the challenges from genuinely weird distibutions. If you&#8217;re annoyed with me on this technical detail, I might stipulate that we have (A) a Fiat-Shamir hash function that outputs (enough) random bits, and (B) a way to convert those bits into whatever form of challenge you need for the protocol.</li>



<li>I said this is not scientific, but clearly we <span style="text-decoration: underline">could</span> make some kind of argument in the random oracle model. There we&#8217;d argue (something like): assume the scheme is secure using random challenges chosen by an honest (interactive) Verifier, now let&#8217;s consider whether it&#8217;s possible for the attacker to have pre-queried the oracle on the inputs that will produce the actual Fiat-Shamir. We could then analyze every possible case and hopefully determine that the answer is &#8220;no.&#8221; And that would be &#8220;science.&#8221; </li>



<li>In the random oracle model we can convert this intuition into a stronger argument: each time the Prover hashes something for the first time, the oracle effectively samples a uniformly random string as its response. Since there are 2<sup>256</sup> possible digests, the probability that it returns <strong>c </strong>= 53 after one hash attempt should still be 2<sup>-256</sup>, which again is very low.</li>
</ol>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/attacks/" rel="category tag">attacks</a>, <a href="https://blog.cryptographyengineering.com/category/fundamentals/" rel="category tag">fundamentals</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2025/02/19/how-to-prove-false-statements-part-3/" rel="bookmark"><time class="entry-date published" datetime="2025-02-19T23:18:36+00:00">February 19, 2025</time><time class="updated" datetime="2025-02-20T18:52:12+00:00">February 20, 2025</time></a></span><span class="word-count">3,523 Words</span><span class="comments-link"><a href="https://blog.cryptographyengineering.com/2025/02/19/how-to-prove-false-statements-part-3/#comments">6 Comments</a></span><!-- .comments-link -->		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
				
<article id="post-8255" class="post-8255 post type-post status-publish format-standard has-post-thumbnail hentry category-apple category-backdoors tag-apple tag-cybersecurity tag-iphone tag-security">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/" rel="bookmark">U.K. asks to backdoor iCloud Backup&nbsp;encryption</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/"><img width="700" height="430" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cdpw6tmsvts3tpwmyuvxz6-1200-80.png-1.webp?w=700&amp;h=430&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="U.K. asks to backdoor iCloud Backup&nbsp;encryption" decoding="async" loading="lazy" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cdpw6tmsvts3tpwmyuvxz6-1200-80.png-1.webp?w=700&amp;h=430&amp;crop=1 700w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cdpw6tmsvts3tpwmyuvxz6-1200-80.png-1.webp?w=150&amp;h=92&amp;crop=1 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cdpw6tmsvts3tpwmyuvxz6-1200-80.png-1.webp?w=300&amp;h=184&amp;crop=1 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cdpw6tmsvts3tpwmyuvxz6-1200-80.png-1.webp?w=768&amp;h=472&amp;crop=1 768w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cdpw6tmsvts3tpwmyuvxz6-1200-80.png-1.webp?w=1024&amp;h=629&amp;crop=1 1024w" sizes="(max-width: 700px) 100vw, 700px" data-attachment-id="8295" data-permalink="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/cdpw6tmsvts3tpwmyuvxz6-1200-80-png-2/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cdpw6tmsvts3tpwmyuvxz6-1200-80.png-1.webp" data-orig-size="1200,675" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Cdpw6TMsvTS3tPWmYuVXz6-1200-80.png" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cdpw6tmsvts3tpwmyuvxz6-1200-80.png-1.webp?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cdpw6tmsvts3tpwmyuvxz6-1200-80.png-1.webp?w=700" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p><em>I&#8217;m supposed to be finishing a wonky series on proof systems (<a href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/">here</a> and <a href="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/">here</a>) and I promise I will do that this week. In the midst of this I&#8217;ve been a bit distracted by world events.</em></p>



<p>Last week the Washington Post <a href="https://www.washingtonpost.com/technology/2025/02/07/apple-encryption-backdoor-uk/">published a bombshell story</a> announcing that the U.K. had filed &#8220;technical capability notices&#8221; demanding that Apple modify the encryption used in their <a href="https://support.apple.com/en-us/108756">Advanced Data Protection (ADP) system</a> for iCloud. For those who don&#8217;t know about ADP, it&#8217;s a system that enables full &#8220;end-to-end&#8221; encryption for iCloud backups, including photos and other data. This means that your backup data should be encrypted under your phone&#8217;s passcode — and critically, neither Apple nor hackers can access it. The U.K. request would secretly weaken that feature for at least some users.</p>



<p>Along with Alex Stamos, I wrote a <a href="https://www.wsj.com/opinion/u-k-kicks-apples-door-open-for-china-encryption-data-protection-deb4bc2b">short opinion piece</a> (version <a href="https://archive.is/CnTke">without paywall</a>) at the Wall Street Journal and I wanted to elaborate on the news a bit more here.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-12.png"><img data-attachment-id="8257" data-permalink="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/image-63/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-12.png" data-orig-size="2092,932" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-12.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-12.png?w=700" loading="lazy" width="1024" height="456" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-12.png?w=1024" alt="" class="wp-image-8257" style="width:438px;height:auto" /></a></figure></div>


<h3 class="wp-block-heading">What&#8217;s iCloud and what&#8217;s ADP?</h3>



<p>Most Apple phones and tablets are configured to automatically back their contents up to a service called iCloud Backup, which maintains a nearly-mirror copy of every file on your phone. This includes your private notes, contacts, private iMessage conversations, personal photos, and so on. So far I doubt I&#8217;m saying anything too surprising to the typical Apple user.</p>



<p>What many people don&#8217;t know is that in normal operation, this <a href="https://blog.cryptographyengineering.com/2022/12/07/apple-icloud-and-why-encrypted-backup-is-the-only-privacy-issue/">backup is not end-to-end encrypted.</a> That is, Apple is given a decryption key that can access all your data. This is good in some ways — if you lose your phone and also forget your password, Apple <em>might</em> still be able to help you access your data. But it also creates a huge weakness. Two different types of &#8220;bad guys&#8221; can walk through the hole created by this vulnerability: one type includes hackers and criminals, including sophisticated <a href="https://en.wikipedia.org/wiki/Salt_Typhoon">state-sponsored cyber-intrusion groups</a>. The other is national <span style="text-decoration: underline">governments</span>: typically, law enforcement and national intelligence agencies. </p>



<p>Since Apple&#8217;s servers hold the decryption key, the company can be asked (or their servers can be hacked) to provide a complete backup copy of your phone at any moment. Notably, since this all happens on the server side, you&#8217;ll never even know it happened. Every night your phone sends up a copy of its contents, and then you just have to <a href="https://blog.cryptographyengineering.com/2022/12/07/apple-icloud-and-why-encrypted-backup-is-the-only-privacy-issue/">hope that nobody else obtains them</a>. </p>



<p>This is a bad situation, and Apple has been somewhat slow to remedy it. This is surprising, since <a href="https://security.googleblog.com/2018/10/google-and-android-have-your-back-by.html">Google has enabled end-to-end encrypted backup since 2018</a>. Usually Apple is the company leading the way on privacy and security, but in this case they&#8217;re trailing? Why?</p>



<p>In the past we&#8217;ve seen various hints about this. For example, in 2020, Reuters published a story claiming that the FBI had <a href="https://www.reuters.com/article/world/exclusive-apple-dropped-plan-for-encrypting-backups-after-fbi-complained-sour-idUSKBN1ZK1CO/">convinced Apple to drop its plans for encrypted backups as a result of agency pressure.</a> This is bad! Of course, Apple never confirmed this, but Apple never confirms anything.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-13.png"><img data-attachment-id="8269" data-permalink="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/image-64/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-13.png" data-orig-size="1538,820" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-13.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-13.png?w=700" loading="lazy" width="1024" height="545" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-13.png?w=1024" alt="" class="wp-image-8269" style="width:379px;height:auto" /></a></figure></div>


<p>In 2021, Apple proposed a <a href="https://www.wired.com/story/apple-photo-scanning-csam-communication-safety-messages/">byzantine new system for performing client-side scanning of iCloud Photos</a>, in order to detect child sexual abuse material (CSAM). Technical experts pointed out that this was a bizarre architecture, since client-side scanning is something you do when you <span style="text-decoration: underline">can&#8217;t</span> scan photos on the server — usually because that data is encrypted. However at that time Apple refused to countenance the notion that they were considering end-to-end encryption for backup data.</p>



<p>Then, at the end of 2022, Apple finally dropped the other shoe. The <a href="https://www.nytimes.com/wirecutter/reviews/how-to-set-up-apples-new-icloud-encryption-security-feature/">new feature they were deploying was called Advanced Data Protection (ADP)</a>, and it would finally enable end-to-end encryption for iCloud Backup and iCloud Photos. This was an <span style="text-decoration: underline">opt-in mode</span> and so you&#8217;d have to turn it on manually. But if you did this, your backups would be encrypted securely under your phone&#8217;s passcode&nbsp;— something you <em>should</em> remember because you have to type it in every day —&nbsp;and even Apple would not be able to access them.</p>



<p>The FBI found this <a href="https://www.macrumors.com/2022/12/08/fbi-privacy-groups-icloud-encryption/">very upsetting</a>. But, in a country with a Fourth and First Amendment, at least in principle, there wasn&#8217;t much they could do if a U.S. firm wanted to deploy software that enabled users to encrypt their own data.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-16.png"><img data-attachment-id="8296" data-permalink="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/image-67/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-16.png" data-orig-size="1290,757" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-16.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-16.png?w=700" loading="lazy" width="1024" height="600" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-16.png?w=1024" alt="" class="wp-image-8296" style="width:280px;height:auto" /></a><figcaption class="wp-element-caption"><em>Go into &#8220;Settings&#8221;, type &#8220;Advanced data&#8221; and turn it on.</em></figcaption></figure></div>


<h3 class="wp-block-heading">But&#8230; what about other countries?</h3>



<p>Apple operates in hundreds of different countries, and not all of them have laws similar to the United States. I&#8217;ve written before about <a href="https://blog.cryptographyengineering.com/2018/01/16/icloud-in-china/">Apple&#8217;s stance in China</a> —&nbsp;which, surprisingly, does not appear to involve any encryption backdoors. But of course, this story involves countries that are closer to the US, both geographically and politically.</p>



<p>In 2016, the U.K. passed the Investigatory Powers Act (IPA), sometimes known as the &#8220;Snooper&#8217;s Charter.&#8221; The IPA includes a clause that allows His Majesty&#8217;s government to submit <a href="https://www.legislation.gov.uk/ukdsi/2018/9780111163610">Technical Capabiilty Notices</a> to technology firms like Apple. A Technical Capability Notice (TCN) under U.K. law is a <span style="text-decoration: underline">secret</span> request in which the government demands that a technical provider <em>quietly modify the operation of its systems so that they no longer provide the security feature advertised to users</em>. In this case, presumably, that would involve weakening the end-to-end encryption system built into iCloud/ADP so that the U.K. could request downloads of encrypted user backups <em>even without access to the user&#8217;s passcode or device.</em></p>



<p>The secrecy implicit in the TCN process is a massive problem here, since it effectively requires that Apple <span style="text-decoration: underline">lie</span> to its users. To comply with U.K. law, they must swear that a product is safe and works one way — and this lying must be directed to both civilian users and U.S. government users, commercial users, and so on —&nbsp;while Apple is forced to actively re-design their products to work differently. The dangers here should be obvious, along with the enormous risks to Apple&#8217;s reputation as a trustworthy provider. <span style="text-decoration: underline">I will reiterate that this is not something that even China has demanded of Apple</span>, as far as we know, so it is quite alarming.</p>



<p>The second risk here is that the U.K. law does not obviously limit these requests to U.K. customers. In a <a href="https://publications.parliament.uk/pa/cm5804/cmpublic/InvestigatoryPowersAmendment/memo/IPAB10.htm">filing that Apple submitted back in 2024</a>, the company&#8217;s lawyers make this point explicitly:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-14.png"><img data-attachment-id="8274" data-permalink="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/image-65/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-14.png" data-orig-size="2500,426" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-14.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-14.png?w=700" loading="lazy" width="1024" height="174" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-14.png?w=1024" alt="" class="wp-image-8274" /></a></figure></div>


<p>And when you think about it — this part I am admittedly speculating about —&nbsp;it seems really surprising that the U.K. would make these requests of a U.S. company without at least speaking to their counterparts in the United States. After all, the U.K. and the U.S. are part of an intelligence alliance known as <a href="https://en.wikipedia.org/wiki/Five_Eyes">Five Eyes</a>. They work together on this stuff! There are at least two possibilities here:</p>



<ol class="wp-block-list">
<li>The U.K. is operating alone in a manner that poses serious cybersecurity and business risks to U.S. companies.</li>



<li>The U.S. and the U.K. intelligence (and perhaps some law enforcement agencies) have discussed the request, and both see significant benefit from the U.K. possessing this capability.</li>
</ol>



<p>We can&#8217;t really know what&#8217;s going on here, but both options should make us uncomfortable. The first implies that the U.K. is going rogue and possibly harming U.S. security and business, while the latter implies that some level of U.S. agencies are at tacitly signing off on a capability that could be used illegally against U.S. users. </p>



<p>What we do know from the <a href="https://www.washingtonpost.com/technology/2025/02/07/apple-encryption-backdoor-uk/">recent Post article</a> is that Apple was allegedly so uncomfortable with the recent U.K. request that they are &#8220;<a href="https://www.washingtonpost.com/technology/2025/02/07/apple-encryption-backdoor-uk/">likely to stop offering encrypted storage in the U.K.</a>&#8220;, <em>i.e., </em>they were at least going to turn off Advanced Data Protection in the U.K. This might or might not have resolved the controversy with the U.K. government, but it at least it indicated that Apple is not going to quietly entertain these requests.</p>



<h2 class="wp-block-heading">What about <span style="text-decoration: underline">other</span> countries?</h2>



<p>There are about 68 million people in the U.K., which is not a small number. But compared to other markets Apple sells in, it&#8217;s not a big place.</p>



<p>In the past, U.S. firms like WhatsApp and Signal <a href="https://www.wired.com/story/britain-admits-defeat-online-safety-bill-encryption/?_sp=9b61bbe8-394d-4879-a81e-321c0f2379f8.1739383078506">have in the past made plausible threats to exit the U.K. market</a> if the U.K. government makes good on threats to demand encryption backdoors. I have no doubt that Apple is willing to go to the mat for this as well if they&#8217;re forced to — <em>as long as we&#8217;re only talking about the U.K.</em> This is really sad for U.K. users, who deserve to have nice things and secure devices.</p>



<p>But there are bigger markets than the U.K. The European Union has 449.2 million customers and has been <a href="https://www.patrick-breyer.de/en/posts/chat-control/">debating laws that would demand some access to encrypted messaging</a>. China has somewhere between two to three times that. These are big markets to risk over encryption! Moreover, Apple builds a lot of its phones (and phone parts) in China. While I&#8217;m an optimist about human ethics — even within big companies — I doubt that Apple can convince its shareholders that their relationship with China is worth risking, over something abstract like the value of trust, or over end-to-end encrypted messages or iCloud.</p>



<p>And that&#8217;s what&#8217;s at stake if Apple gives in to the U.K. demands. If Apple gives in here, there&#8217;s zero reason for China not to ask for the same thing, perhaps this time applied to Apple’s popular iMessage service. And honestly, they&#8217;re not wrong? Agreeing to the U.K.&#8217;s request might allow the U.K. and Five Eyes to do things that would harm China&#8217;s own users. In short, abandoning Apple&#8217;s principles one place means they ultimately have to give in anywhere (or worse), or — <em>and this is a realistic alternative — </em>Apple is forced to leave many parts of the world. Both are bad for the United States, and both are bad for people in all countries.</p>



<h3 class="wp-block-heading">So what should we do <span style="text-decoration: underline">legally</span>?</h3>



<p>If you <a href="https://www.wsj.com/opinion/u-k-kicks-apples-door-open-for-china-encryption-data-protection-deb4bc2b">read the editorial,</a> it has a simple recommendation. The U.S. should pass laws that forbid U.S. companies from installing encryption backdoors at the request of foreign countries. This would put companies like Apple in a bind. But it would be a good bind! To satisfy the laws of one nation, Apple would have to break the laws of their home country. This creates a &#8220;conflict of laws&#8221; situation where, at very least, simple, quiet compliance against the interest of U.S. citizens and customers is no longer an option for Apple — even if the shareholders might theoretically prefer it.</p>



<p>I hope this is a policy that many people could agree on, regardless of where they stand politically.</p>



<h3 class="wp-block-heading">So what should we do <span style="text-decoration: underline">technically?</span></h3>



<p>I am going to make one more point here that can&#8217;t fit in an editorial, but deserves to be said anyway. <span style="text-decoration: underline">We wouldn&#8217;t be in this jam if Apple had sucked it up and deployed end-to-end encrypted backup more broadly</span>, and much earlier in the game.</p>



<p>Over the past decade I&#8217;ve watched various governments make a strong push to stop device encryption, add &#8220;warrant&#8221; capability to end-to-end encrypted messaging, and then install scanning systems to monitor for illicit content. Nearly all of these attempts failed. The biggest contributor to the failure was <span style="text-decoration: underline">widespread deployment and adoption of encryption</span>. </p>



<p>Once a system is widely deployed and people realize it&#8217;s adding value and safety to a system, they are loath to mess with that system. You see this pattern <a href="https://carnegieendowment.org/research/2019/09/moving-the-encryption-policy-conversation-forward?lang=en">first with on-device encryption</a>, and <a href="https://www.nbcnews.com/tech/security/us-officials-urge-americans-use-encrypted-apps-cyberattack-rcna182694">then with messaging</a>. A technology is at first controversial, at first untenable, and then suddenly it&#8217;s mandatory for digital security. Even law enforcement agencies eventually start begging people to turn it on:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-15.png"><img data-attachment-id="8287" data-permalink="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/image-66/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-15.png" data-orig-size="2004,580" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-15.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-15.png?w=700" loading="lazy" width="1024" height="296" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-15.png?w=1024" alt="" class="wp-image-8287" style="width:593px;height:auto" /></a></figure></div>


<p>A key ingredient for this transition to occur is <span style="text-decoration: underline">that lots of people must be leaning on that technology</span>. If 1-2% of the customer base uses optional iCloud encryption, then it&#8217;s easy to turn the feature off. Annoying for a small subset of the population, maybe, but probably politically viable for governments to risk it. The same thing is less true at 25% adoption, and it is not true at 50% or 100% adoption.</p>



<p>Apple built the technology to deploy iCloud end-to-end <a href="https://blog.cryptographyengineering.com/2016/08/13/is-apples-cloud-key-vault-crypto/">encryption way back in 2016</a>. They then fiddled around, not deploying it <em>even as an option</em>, for more than six years. Finally at the end of 2022 they allowed people to opt-in to Advanced Data Protection. But even then they didn&#8217;t make it a default, they don&#8217;t <span style="text-decoration: underline">ask you if you want to turn it on during setup.</span> They barely even advertise it to anyone.</p>



<p>If someone built an encryption feature but nobody heard about it, would it still exist?</p>



<p>This news from the U.K. is a wake up call to Apple that they need to move more quickly. They may feel intimidated due to blowback from Five Eyes nations, and that might be driving their reticence. But it&#8217;s too late, the cat is out of the bag. People are noticing their failure to turn this feature on and — while I&#8217;m certain there are excellent reasons for them to go slow — the silence and slow-rolling is starting to look like weakness, or even collaboration with foreign governments.</p>



<p>Hell, even <a href="https://www.androidcentral.com/how-googles-backup-encryption-works-good-bad-and-ugly">Google offers this feature, on by default!</a></p>



<p>So what I would like, as a technologist, is for Apple to act serious about this technology. It&#8217;s important, and the ball is very much in Apple&#8217;s court to start pushing those numbers up. The world is not a safe place, and it&#8217;s <a href="https://en.wikipedia.org/wiki/Salt_Typhoon">not getting safer</a>. Apple should do the right thing here because they want to. But if not, they should do it because doing otherwise is too much of a liability.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/apple/" rel="category tag">Apple</a>, <a href="https://blog.cryptographyengineering.com/category/backdoors/" rel="category tag">backdoors</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2025/02/12/u-k-asks-to-backdoor-icloud-backup-encryption/" rel="bookmark"><time class="entry-date published" datetime="2025-02-12T18:49:30+00:00">February 12, 2025</time><time class="updated" datetime="2025-02-13T00:02:07+00:00">February 13, 2025</time></a></span><span class="word-count">2,255 Words</span>		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
				
<article id="post-8155" class="post-8155 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized tag-blockchain tag-crypto tag-security">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/" rel="bookmark">How to prove false statements? (Part&nbsp;2)</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/"><img width="306" height="164" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-5.png?w=306&amp;h=164&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="How to prove false statements? (Part&nbsp;2)" decoding="async" loading="lazy" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-5.png 306w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-5.png?w=150&amp;h=80&amp;crop=1 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-5.png?w=300&amp;h=161&amp;crop=1 300w" sizes="(max-width: 306px) 100vw, 306px" data-attachment-id="8198" data-permalink="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/image-56/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-5.png" data-orig-size="306,164" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-5.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-5.png?w=306" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p><em>This is the second part of a <a href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/"><s>two</s> <s>three</s> four-part series</a>, which covers some recent results on &#8220;verifiable computation&#8221; and possible pitfalls that could occur there. This post won&#8217;t make much sense on its own, so I urge you to <a href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/">start with the first part</a>. </em></p>



<p>In the previous post we introduced a handful of concepts, including (1) the notion of &#8220;verifiable computation&#8221; proof systems (sometimes inaccurately called &#8220;ZK&#8221; by the <a href="https://ethereum.org/en/developers/docs/scaling/zk-rollups/">Ethereum community</a>), (2) <a href="https://simple.wikipedia.org/wiki/Cryptographic_hash_function">hash functions,</a> and (3) some ideal models that we use for our security proofs, and (4) the idea that these &#8220;ideal models&#8221; are bogus — and sometimes they can make us confident in schemes that are totally insecure in the real world.</p>



<p>Today I want to move forward and (get closer) to actually talking about the recent result alluded to in the title: the recent paper by Khovratovich, Rothblum and Soukhanov entitled &#8220;<a href="https://eprint.iacr.org/2025/118">How to Prove False Statements: Practical Attacks on Fiat-Shamir</a>&#8221; (henceforth: <em>KRS</em>.) This paper shows that a proving scheme that <em>appears</em> to be secure in one setting, might not actually be secure.</p>



<p>One approach to discussing this paper would be to start at the beginning of the paper and then move towards the end. <em>We will not do that.</em> Instead, I plan to pursue an approach that involves a lot of jumping around. There is a method to my madness.</p>



<p>Before we can get there, we need to cover a bit more essential background. </p>



<h3 class="wp-block-heading">Background Part One: Interactive proof systems </h3>



<p>I have introduced these posts by reiterating a critique of something called the <a href="https://blog.cryptographyengineering.com/2011/09/29/what-is-random-oracle-model-and-why-3/">random oracle model</a> paradigm, in which we pretend that <a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">hash functions</a> are actually <a href="https://blog.cryptographyengineering.com/2023/05/08/prfs-prps-and-other-fantastic-things/">random functions</a>. Thoughtful cryptographers will no doubt be upset with me about this, since in fact the KRS paper is not about random oracles at all! Instead it demonstrates a problem with a different &#8220;heuristic&#8221; that cryptographers use everywhere: this is called the <a href="https://en.wikipedia.org/wiki/Fiat%E2%80%93Shamir_heuristic">Fiat-Shamir heuristic</a>. </p>



<p>While Fiat-Shamir is <span style="text-decoration: underline">not the same</span> as the random oracle model, the two live in the same neighborhood and send their kids to the same school. What I mean is: Fiat-Shamir can (in some very limited theoretical senses) live without the random oracle model, but in practice the two are usually interdependent.</p>



<p>To explain this new result I therefore need to explain what Fiat-Shamir does. And before I can do that, I need to explain what interactive proofs are. (Feel free to skip forward if you already know this part.)</p>



<p>Many of the verifiable computation &#8220;proof systems&#8221; we use today are members of a class of protocols called <em>interactive proofs. </em>These are protocols in which two parties, a Prover and a Verifier, exchange messages so that the Prover can convince a Verifier of the truth of a given statement (such as &#8220;I know an input x that makes this particular program happy.&#8221;, and maybe a witness <strong>w</strong> to help me prove that) In <a href="https://en.wikipedia.org/wiki/Proof_of_knowledge#Sigma_protocols">many cases</a>, these protocols obey a pattern of interaction that takes the following form:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-6.png"><img data-attachment-id="8200" data-permalink="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/image-57/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-6.png" data-orig-size="2000,604" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-6.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-6.png?w=700" loading="lazy" width="1024" height="309" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-6.png?w=1024" alt="" class="wp-image-8200" style="width:390px;height:auto" /></a></figure></div>


<ol class="wp-block-list">
<li>The Prover sends a message that &#8220;commits&#8221; to the input and <span style="text-decoration: underline">witness</span>, and maybe some other things. This <em>commitment</em> message is sent to the Verifier.</li>



<li>The Verifier then generates one or more <span style="text-decoration: underline">challenges</span> that the Prover must respond to. The exact nature of what happens here can change from scheme to scheme.</li>



<li>The Prover then computes <span style="text-decoration: underline">responses</span> to each of the challenges, and the Verifier checks that each response is valid (again, in a manner that is highly specific to the proving scheme.) It <span style="text-decoration: underline">rejects</span> the proof if any of the responses don&#8217;t check out.</li>



<li>The pair may repeat the above steps many times —&nbsp;either sequentially or in parallel.</li>
</ol>



<p><em>Yes I know</em> that I&#8217;m being incredibly vague about what&#8217;s happening with these challenges and responses! The truth is that, for the moment, we don&#8217;t care. All you need to know is that the challenge/response bits should be <span style="text-decoration: underline">easy</span> for the Prover to respond to <em>if it is being honest,</em> that is — that is, if the witness (input) really satisfies the program. It should be <span style="text-decoration: underline">unlikely</span> that the Prover can correctly respond to a random challenge if it&#8217;s cheating, i.e., if it does not have a proper witness.</p>



<p>(Note that we don&#8217;t demand that the challenges be <span style="text-decoration: underline">impossible</span> for a cheating Prover to sneak past! This is why proving systems often repeat the challenge/response phase many times: even if there&#8217;s a small chance that a cheating Prover could cheat their way through one challenge, we&#8217;d argue that they have a much lower probability of cheating many times.)</p>



<p>What you may notice about this entire setup is that (1) interactive proofs require lots of (duh) interaction. What might not be so obvious is that (2) they assume an <span style="text-decoration: underline">honest</span> Verifier who formulates &#8220;good&#8221; challenges. </p>



<p>This need for interaction is pretty annoying in many applications. It is particularly aggravating for systems like blockchains, where there can be <span style="text-decoration: underline">thousands (or millions) of computers</span> who will all need to verify that a given statement (say, a transaction) is correct. It would be <em>much, much</em> easier if the Prover could run the proof just once time with a single Verifier, then the pair could just publish the <em>transcript</em> of their interaction. Anyone could just check the transcript to make sure the Prover answered all the challenges correctly!</p>



<p><strong>Unfortunately, there is a critical problem with that idea!</strong> The security of these protocols rides on the idea that the Verifier&#8217;s challenges are <span style="text-decoration: underline">random</span>, or at least highly <span style="text-decoration: underline">unpredictable</span> to the Prover. If the Prover can somehow <em>anticipate</em> which values it will be challenged on <span style="text-decoration: underline">before it commits to its inputs in step (1)</span>, it can often cheat by altering its approach in the first message. To be more concrete: a dishonest Verifier can &#8220;collude&#8221; with the Prover to help it prove a false statement, by sneakily letting it know the challenges in advance. <em>For this reason it is: critically important that the Verifier must be honest, and <span style="text-decoration: underline">not colluding</span> with the Prover. </em></p>



<p>But the whole point of these systems is that we shouldn&#8217;t need to trust individual parties at all! If we&#8217;re just going to trust that people are behaving honestly, what&#8217;s the point of any of this?</p>



<h3 class="wp-block-heading">More background: Fiat-Shamir</h3>



<p>Now I want to take you way back in time. All the way back to the mid-1980s.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-2.png"><img data-attachment-id="8174" data-permalink="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/image-53/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-2.png" data-orig-size="890,962" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-2.png?w=278" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-2.png?w=700" loading="lazy" width="890" height="962" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-2.png?w=890" alt="" class="wp-image-8174" style="width:177px;height:auto" /></a></figure></div>


<p>Back in 1986, two cryptographers named Amos Fiat and Adi Shamir (pictured above) were stuck on a problem very much like this one. They had an interactive proof system — a much simpler one, since it was the 1980s after all —&nbsp;and they wanted to turn their <span style="text-decoration: underline">interactive</span> proofs into <em><span style="text-decoration: underline">non-interactive</span></em> proofs that any party could verify. They thought about the transcript idea described above, and they realized it wouldn&#8217;t work — a Verifier could simply collude with the Prover to help it cheat. To address this, they came up with <a href="https://link.springer.com/content/pdf/10.1007/3-540-47721-7_12.pdf">an ingenious solution</a> that was elegant, simple, and <em>also</em> <em>would open up a yawning chasm of theory</em> that we are still trying to dig out of today.</p>



<p>Fiat turned to Shamir (I imagine) and outlined the overall problem. Fiat (or Shamir) said: &#8220;Perhaps we could find a way for a Verifier to select the challenges in some random but <span style="text-decoration: underline">reproducible</span> way — one that would allow anyone to ensure that the challenges were actually random and unpredictable.&#8221; And then one of them said: <em>that sounds a lot like a hash function.</em></p>



<p>And thus was born the <a href="https://link.springer.com/content/pdf/10.1007/3-540-47721-7_12.pdf">Fiat-Shamir heuristic. </a></p>



<p>Instead of choosing the challenge values at random, <a href="https://link.springer.com/content/pdf/10.1007/3-540-47721-7_12.pdf">Fiat and Shamir proposed that</a> the &#8220;Verifier&#8221; would select the challenge values by hashing the &#8220;commitment&#8221; message sent by the Prover, perhaps along with other junk (such as the &#8220;program&#8221; or circuit being proved.) The Prover would then respond to these challenge messages, and output a transcript of the whole proof. </p>



<p>And that&#8217;s it. That&#8217;s the entire trick.</p>



<p>Despite its simplicity, there are some obvious attractive features to this Fiat-Shamir approach:</p>



<ol class="wp-block-list">
<li>Good hash functions typically output stuff that looks pretty &#8220;random&#8221;, which is what we want for challenges.</li>



<li>Any third party can easily check a transcript, simply by verifying that the challenge values match the hash of the Prover&#8217;s &#8220;commitment&#8221; message. (In other words, there&#8217;s no more room for the Verifier to collude or cheat, since it is now fully <em>deterministic</em>.</li>
</ol>



<p><strong>Critically, there is a cool &#8220;circular&#8221; paradox in here.</strong> A cheating Prover might try the following trick to predict the values it will be challenged on. Specifically, it might (1) pick a commitment message and then (2) hash that message to find the challenges. Once it knows the challenge values, it might try to <em>change its inputs</em> to step (1) so it can more easily cheat on those specific challenge points. <strong><span style="text-decoration: underline">But critically that approach creates a paradox</span></strong><span style="text-decoration: underline">&#8230;</span><strong>!</strong> if the Prover changes its inputs to step (1), that will result in a whole new &#8220;commitment&#8221; message! Once hashed, <em>that new commitment message</em> will produce a very different set of challenge messages, and our cheater is locked in an <a href="https://www.youtube.com/watch?v=LrHTR22pIhw">infinite time-loop</a> that it can never escape!<sup>1</sup></p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-9.png"><img data-attachment-id="8218" data-permalink="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/image-60/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-9.png" data-orig-size="787,415" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-9.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-9.png?w=700" loading="lazy" width="787" height="415" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-9.png?w=787" alt="" class="wp-image-8218" style="width:514px;height:auto" /></a></figure></div>


<p>The great thing about Fiat-Shamir is that once your (challenge-generating) Verifier is fully deterministic, there&#8217;s no more reason to even have that code run by a separate party. The Prover can run the deterministic challenge-generation code all by itself, i.e., performing all necessary hashing to make the challenges, and then outputting the final transcript. So the Prover and (original) &#8220;Verifier&#8221; code collapse into a single party (that we will now just call the Prover), and the <span style="text-decoration: underline">new</span> <em>Verifier</em> is an algorithm that checks the transcript — performing all the necessary hashes and challenge/response checks to make sure everything is kosher.</p>



<p>The resulting proofs (&#8220;transcripts&#8221;) do not require any interaction to verify, and so we can even post them on blockchains. They can be verified by thousands or millions of people, and we are now set to hang big piles of money off of them.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-3.png"><img data-attachment-id="8183" data-permalink="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/image-54/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-3.png" data-orig-size="2422,962" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-3.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-3.png?w=700" loading="lazy" width="1024" height="406" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-3.png?w=1024" alt="" class="wp-image-8183" style="width:616px;height:auto" /></a><figcaption class="wp-element-caption"><em>Starknet is just one of the cryptocurrency systems hanging real money off of Fiat-Shamir-style proof systems. There are others! </em></figcaption></figure></div>


<h3 class="wp-block-heading">I bet you&#8217;re going to yammer on about the provable security of Fiat-Shamir now, right?</h3>



<p><em>Wait, how did you know that&#8217;s what I was going to talk about?</em> Oh that&#8217;s right: &#8220;you&#8221; are me, and so I&#8217;m just answering my own questions. (Wasn&#8217;t that a cute illustration of the paradox that Fiat-Shamir helps to solve!)</p>



<p>I am going to make this as quick and painless as I can, but here&#8217;s the deal. Fiat-Shamir seems like a nutty trick. We even call it a <em>heuristic</em>, which is literally an admission of this. And yet. Literally hundreds of papers have been written about the provable security of Fiat-Shamir and schemes that use it.</p>



<p>The <span style="text-decoration: underline">general</span> TL;DR is that Fiat-Shamir can often be proven secure (for various definitions of &#8220;secure&#8221;) if we make one helpful assumption. Specifically: that the hash function we use is actually a <a href="https://blog.cryptographyengineering.com/2011/09/29/what-is-random-oracle-model-and-why-3/">random oracle</a> (please see this footnote for more pedantic stuff!<sup>2</sup>) I&#8217;m not going to get very deep into the argument, but I just want you to remember how random oracles work:</p>



<ol class="wp-block-list">
<li>In the random oracle model, the hash function is <span style="text-decoration: underline">a random function</span>. Phrased imprecisely, this means that (when queried on some fresh value) it outputs random bits that are completely <em>uncorrelated</em> with the input.</li>



<li>The hash function &#8220;lives&#8221; inside a totally separate party called an oracle. You send things to be hashed, if the input has not been hashed before, you get back unpredictable random values.</li>
</ol>



<p>This clearly looks a lot like the interactive proof setting! Put succinctly (no pun): if an appropriate scheme can be proven secure in an <span style="text-decoration: underline">interactive</span> setting where the Prover interacts with an honest Verifier (who picks random challenges), then it seems likely that the Fiat-Shamir version of that protocol should also work with a random oracle. The random oracle is essentially acting like the Verifier in the original interactive scheme: it is generating random challenges that everyone can &#8220;trust&#8221; to be truly random, and yet any third party can also ask it to reproduce the same challenges later on, when they want to check a transcript!</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-7.png"><img data-attachment-id="8202" data-permalink="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/image-58/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-7.png" data-orig-size="2058,830" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-7.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-7.png?w=700" loading="lazy" width="1024" height="412" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-7.png?w=1024" alt="" class="wp-image-8202" style="width:383px;height:auto" /></a></figure></div>


<p>And for many purposes, this random oracle approach usually works ok. Some folks have come up with <a href="https://eprint.iacr.org/2003/034.pdf">crazy theoretical counterexamples</a> (meaning, contrived interactive protocols that are secure in the random oracle model, yet blow apart when used with real hash functions.) But mostly practitioners just ignore these because they&#8217;re so obviously full of weird nonsense. </p>



<p>Out in the real world where applied cryptographers design new proving systems on a daily basis, we&#8217;ve adopted a pretty standard pattern. A new proof system will be specified as an interactive protocol first. Ultimately everyone knows this proof system <span style="text-decoration: underline">won&#8217;t</span> be used interactively, it will be Fiat-Shamir flattened and used on a blockchain. Yet the authors won&#8217;t spend a lot of time arguing about the Fiat-Shamir part. They&#8217;ll simply describe an interactive protocol with the right structure, then they say something like &#8220;<em>of course this can be flattened using Fiat-Shamir</em>, <em>if we assume a random oracle or something</em>&#8221; and everyone nods and deposits a billion dollars onto it.</p>



<h3 class="wp-block-heading">But there&#8217;s a catch, isn&#8217;t there?</h3>



<p>Indeed, there is a major <em>asterisk (*)</em> about this whole strategy that I must now raise.</p>



<p>Even though we can sometimes prove Fiat-Shamir protocols secure, usually in the ROM, a critical feature of these ROM proofs is that we (the participants in the protocol) do not know a compact description of the hash function. This is inevitable, since the hash function used in the random oracle model is a giant random function that cannot possibly expressed in a compact form.</p>



<p>In the real world we will naturally replace the random oracle with something like <a href="https://en.wikipedia.org/wiki/SHA-3">SHA-3</a> or an even more exciting hash function like <a href="https://www.poseidon-hash.info/">Poseidon</a>. Suddenly, everyone in the protocol <span style="text-decoration: underline">will</span> know a compact description of the hash function. As I mentioned above, this can lead to theoretical problems. Way back in 2004, <a href="https://eprint.iacr.org/2003/034.pdf">Goldwasser and Tauman (now Kalai)</a> designed a specific interactive protocol that exploded when the hash was instantiated with any concrete hash function.</p>



<p>But the Goldwasser/Tauman protocol was very artificial. It did silly things you could see in the protocol description. So obviously as long as <em>we don&#8217;t do those things, we were fine</em>, maybe?</p>



<p>The problem now is that we are deploying proof systems that can prove the satisfaction of literally any reasonable program (or &#8220;NP-relation&#8221;.) These programs might contain an implementation of the Fiat-Shamir hash function. In the random oracle model, this is literally impossible — so we just assume it cannot happen. In the real world it&#8217;s eminently possible, and we kind of have to assume it can and will happen.</p>



<p>In fact <span style="text-decoration: underline">it is extremely likely that some circuits really will contain an implementation of the Fiat-Shamir hash function</span>! The reason is because of those <em>recursive proofs</em> I mentioned in the previous post.</p>



<p>Let&#8217;s say we want to build a <span style="text-decoration: underline">recursive</span> proof system that works to verify one of our flattened Fiat-Shamir proofs. Recall that to do this, we have to take the Verify algorithm that checks a Fiat-Shamir transcript, and implement it within a program (or circuit.) We then need to run that program and generate a proof that we ran <em>that program</em> successfully! And to make all this work, we really do need to include a copy of the Fiat-Shamir hash function inside our programs — this is not optional at all. </p>



<p>The crazy thing is that we can&#8217;t even prove these recursive Fiat-Shamir-based proofs secure in the random oracle model! In the random oracle model there is no compact description of the hash function, and so no there is no compact recursive Verify program/circuit that we could write. Recursion of this sort is totally impossible. Indeed, recursive Fiat-Shamir proofs can only exist <span style="text-decoration: underline">outside</span> of the random oracle model, where we use something like SHA-3 to implement the hash function. But of course, outside of the ROM we can&#8217;t prove anything about their security. As a result: anytime you see a recursive Fiat-Shamir proof we&#8217;re just basically tossing provable security out the window and full-on YOLOing it. </p>



<p>This situation is very bad and many theoreticians have died (inside) thinking about it.</p>



<p>I have now written an entire <span style="text-decoration: underline">second</span> post and I have not yet gotten to the KRS result I came here to talk about! Is anyone still reading? Is this thing still on? I sure hope so.</p>



<p>We are now ready to talk about <em>KRS</em>, and I am going to do that immediately in the next post. Before I close this post and get ready for the <em>big</em> <em>one I will tackle next</em>, allow me recap where we are. </p>



<ol class="wp-block-list">
<li>We know that Fiat-Shamir can be proven secure, but generally (for full-on SNARKs) only in the random oracle model.<sup>2</sup> </li>



<li>Once we actually <em>instantiate</em> Fiat-Shamir with real hash functions, any weird thing could happen: especially if the same hash function is implemented within the programs/circuits we want to prove things about.</li>



<li>Recursive (Fiat-Shamir) proofs actually <span style="text-decoration: underline">require</span> us to implement the hash function inside of the programs we&#8217;re going to prove things about, so that&#8217;s ultra-worrying. </li>
</ol>



<p>What remains, however, is to demonstrate that Fiat-Shamir can actually be insecure in practice. Or more concretely: that there exist &#8220;evil&#8221; programs/circuits that can somehow break a perfectly good proof system that uses Fiat-Shamir. </p>



<p>In the <a href="https://blog.cryptographyengineering.com/2025/02/19/how-to-prove-false-statements-part-3/">next post I&#8217;m finally going to talk about that</a>.</p>



<p><em>Notes:</em></p>



<ol class="wp-block-list">
<li>The Fiat-Shamir technique isn&#8217;t immune to a few obvious attacks, of course. For example: a cheating Prover (who is typically also the &#8220;Verifier&#8221;) can &#8220;grind&#8221; the proof — by trying many different inputs to the first message and then, for each one, testing the resulting challenges to see if they&#8217;re amenable to cheating. If there is a small probability of cheating, this &#8220;try the game many times&#8221; approach can significantly <em>boost</em> a cheater&#8217;s probability of getting lucky at cheating on a challenge/response, since they now have millions (or billions!) of attempts to find a lucky challenge.<br><br>However, a realistic assumption here is that real-world cheating Provers only have so much computing power. Even if a Prover can try a huge number of hashing attempts (say 2<sup>50</sup>) you can easily set up your scheme so that the probability they succeed is still arbitrarily small. Not everyone does this perfectly, of course: my PhD student Pratyush recently <a href="https://eprint.iacr.org/2023/1071">co-authored a nice paper about the parameter choices made by some real-world blockchain Proving systems.</a><br></li>



<li>When I say that the provable security of Fiat-Shamir depends on the random oracle model, I am being slightly imprecise. The random oracle model is usually sufficient to prove claims about Fiat-Shamir. But in fact there are some (relatively) recent results that show how to construct Fiat-Shamir <span style="text-decoration: underline">for very specific interactive protocols</span> using hash functions that are not random oracles: these are called <em>correlation intractable</em> functions. To the best of my knowledge, it is not possible to prove Fiat-Shamir-based SNARKs that work with arbitrary (adaptively-chosen) programs/circuits using these functions. But I am open to being wrong on this detail.</li>
</ol>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/uncategorized/" rel="category tag">Uncategorized</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/" rel="bookmark"><time class="entry-date published" datetime="2025-02-06T22:40:00+00:00">February 6, 2025</time><time class="updated" datetime="2025-02-22T15:32:24+00:00">February 22, 2025</time></a></span><span class="word-count">3,142 Words</span><span class="comments-link"><a href="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/#comments">3 Comments</a></span><!-- .comments-link -->		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
				
<article id="post-8074" class="post-8074 post type-post status-publish format-standard has-post-thumbnail hentry category-fundamentals tag-blockchain tag-cryptocurrency tag-cryptography">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/" rel="bookmark">How to prove false statements? (Part&nbsp;1)</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/"><img width="700" height="430" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cuckoo-2-jpg.webp?w=700&amp;h=430&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="How to prove false statements? (Part&nbsp;1)" decoding="async" loading="lazy" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cuckoo-2-jpg.webp?w=700&amp;h=430&amp;crop=1 700w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cuckoo-2-jpg.webp?w=150&amp;h=92&amp;crop=1 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cuckoo-2-jpg.webp?w=300&amp;h=184&amp;crop=1 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cuckoo-2-jpg.webp?w=768&amp;h=472&amp;crop=1 768w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cuckoo-2-jpg.webp?w=1024&amp;h=629&amp;crop=1 1024w" sizes="(max-width: 700px) 100vw, 700px" data-attachment-id="8126" data-permalink="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/cuckoo-2-jpg/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cuckoo-2-jpg.webp" data-orig-size="1200,800" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Cuckoo-2-jpg" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cuckoo-2-jpg.webp?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/cuckoo-2-jpg.webp?w=700" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p><em>Trigger warning: incredibly wonky theoretical cryptography post (written by a non-theorist)!</em> <em>Also, this will be in two parts. I plan to be back with some more thoughts on practical stuff, like cloud backup, in the near future.</em></p>



<p>If you&#8217;ve read my blog over the years, you should understand that I have basically two obsessions. One is my interest in building &#8220;practical&#8221; schemes that solve real problems that come up in the real world. The other is a weird fixation on the theoretical models that underpin (the security of) many of those same schemes. In particular, one of my favorite bugaboos is a particular model, or &#8220;heuristic&#8221;, called the <a href="https://blog.cryptographyengineering.com/2011/09/29/what-is-random-oracle-model-and-why-3/">random oracle model</a> (ROM) — essentially a fancy way to think about <a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">hash functions</a>.</p>



<p>Along those lines, my interest was recently piqued by a new theoretical result by Khovratovich, Rothblum and Soukhanov entitled &#8220;<a href="https://eprint.iacr.org/2025/118">How to Prove False Statements: Practical Attacks on Fiat-Shamir</a>.&#8221; This is a doozy of a paper! It touches nearly every sensitive part of my brain: it urges us towards a better understanding of our theoretical models for proving security of protocols. It includes the words &#8220;<em><span style="text-decoration: underline">practical</span></em>&#8221; and &#8220;<span style="text-decoration: underline"><em>attacks</em></span>&#8221; in the title! And <em>most importantly</em> it demonstrates a real (albeit wildly contrived) attack on the kinds of &#8220;ZK&#8221; (note: not actually ZK, more on that later) &#8220;proving systems&#8221; that we are now using inside of real systems like blockchains.</p>



<p>I confess I am still struggling hard to figure out how I &#8220;feel&#8221; about this result. I understand how odd it seems that my feelings should even matter: this is <em>science</em> after all. <em>Shouldn&#8217;t the math speak for itself? </em>The worrying thing is that, in this case, I don&#8217;t think it does. In fact, this is what I find most fundamentally exciting about the result: <em>it really does matter how we think about it</em>. (Here I should add that we don&#8217;t all think the same say. My theory-focused PhD student <a href="https://adishegde.github.io/">Aditya Hegde</a> has been vigorously debating me on my interpretation — and mostly winning on points. So anything non-stupid I say here is probably due to him.)</p>



<p>Oh yes, and I should also mention that there are <a href="https://defillama.com/chains/Rollup">billions and billions of dollars riding on these questions</a>? I&#8217;m not being dramatic. This is really true.</p>



<p>I mentioned that this post is going to be long and wonky, that&#8217;s just unavoidable. But I promise it will be <em>fun</em>. (Ok, I can&#8217;t even promise that.) Screw it, let&#8217;s go.</p>



<h3 class="wp-block-heading">The shortest background ever (and it will still be really long)</h3>



<p>If you&#8217;ve read this blog over the long term, you know that I&#8217;m obsessed with one particular &#8220;trick&#8221; we use in proving our schemes secure. This trick is known as the <a href="https://blog.cryptographyengineering.com/2011/09/29/what-is-random-oracle-model-and-why-3/">random oracle model</a>, and it&#8217;s one of the worst (or best) things to happen to cryptography.</p>



<p>Let me try to break this down as quickly as I can. In cryptography we have a tendency to use an ingredient called a <em><a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">cryptographic hash function</a></em>. These functions take in a (potentially) long string and output a short <em>digest</em>. In cryptography courses, we present these functions along with various &#8220;security definitions&#8221; they should meet, properties like <a href="https://en.wikipedia.org/wiki/Collision_resistance">collision resistance</a>, <a href="https://en.wikipedia.org/wiki/Preimage_attack">pre-image resistance</a> and so on. But out in the real world most schemes require much stronger assumptions in order to be proven secure. When we argue for the security of these schemes, we often demand that our hash functions be even stronger: we require that they must behave like <a href="https://blog.cryptographyengineering.com/2023/05/08/prfs-prps-and-other-fantastic-things/"><em>random functions.</em></a></p>



<p>If you&#8217;re not sure what a random function is, you can <a href="https://blog.cryptographyengineering.com/2023/05/08/prfs-prps-and-other-fantastic-things/">read about it in depth here</a>. You should just trust that it is a very strong and beautiful requirement for a hash function! But there is a fly in the ointment. Real-world hash functions <em>cannot possibly be random functions.</em> Specifically: concrete hash functions like <a href="https://en.wikipedia.org/wiki/SHA-2">SHA-2</a>, <a href="https://en.wikipedia.org/wiki/SHA-3">SHA-3</a> etc. are characterized by the inevitable requirement that they possess compact, efficient <a href="https://github.com/codegasms/sha256/blob/main/sha256.js">algorithms</a> that can compute their output. Random functions (of any usefulness) must not. Indeed, the most efficient description of a random function is essentially a giant (<em>i.e., </em>exponentially-sized in the length of the inputs to the function) lookup table. These functions cannot even be <em>computed</em> efficiently, because they&#8217;re so big.</p>



<p>So when we analyze schemes where hash functions must behave in this manner, we have to do some pretty suspicious things. The approach we take is bonkers. First, we analyze our schemes inside of an artificial &#8220;model&#8221; where efficient (polynomial-time) participants can somehow evaluate random functions, despite the fact that this is literally impossible. To make this apparent contradiction work, we &#8220;yank&#8221; the hash function logic into a magical box that lives outside that participants — this includes both honest participants in a protocol, as well as any adversaries who try to attack the scheme —&nbsp;and we force everyone to call out to that functionality. This new thing is called a &#8220;random oracle.&#8221;</p>



<p>One weird implication of this approach is that no party can ever know the code of the &#8220;hash function&#8221; they&#8217;re evaluating. They literally <em>cannot know it,</em> since in this model the hash function is comprised of an enormous random lookup table that&#8217;s much too big for anyone to actually know! <strong>This may seem like a not-very big deal</strong>, but it will be exceptionally important going forward.</p>



<p>Of course in the real world we do not have random oracles. I guess we could set up a special server that everyone in the world can call out to in order to compute their hash function values! But we don&#8217;t do that because it&#8217;s ridiculous. When want to deploy a scheme IRL, we do a terrible thing: we &#8220;<em>instantiate the random oracle</em>&#8221; by replacing it with an actual hash function like SHA-2 or SHA-3. Then everyone goes on their merry way, hoping that the security proof still has some meaning.</p>



<p>Let me be abundantly clear about this last part. <em>From a theoretical perspective, any scheme &#8220;proven secure&#8221; in the random oracle model <span style="text-decoration: underline">ceases to be provably secure</span> the instant you replace the random oracle with a real (concrete) hash function like SHA-3. </em>Put differently, it&#8217;s the equivalent of replacing your engine oil with <a href="https://makeagif.com/i/5-sidd">Crisco</a>. Your car may still run, but you are absolutely <em>voiding the warranty</em>. </p>



<p><span style="text-decoration: underline"><em>But, but, but</em></span> — and I stress the stammer — <em>voiding your warranty does not mean your engine will become broken!</em> In most of the places where we&#8217;ve done this awful random oracle &#8220;instantiation&#8221; thing (let&#8217;s be honest: almost every real-world deployed protocol) the instantiated protocols all seemed to work just fine.</p>



<p>(To be sure: we have certainly <a href="https://blog.cryptographyengineering.com/2012/06/05/flame-certificates-collisions-oh-my/">seen cryptographic protocols break down</a> due to broken hash functions! But these breaks are almost always due to <a href="https://www.mscs.dal.ca/~selinger/md5collision/">obvious hash function bugs</a> that anyone can see, such as meaningful <a href="https://en.wikipedia.org/wiki/Hash_collision">collisions</a> being found. They were not magical breaks that come about because you rubbed the &#8220;theory lamp&#8221; wrong. As far as we can tell, in most cases if you use a &#8220;good enough&#8221; secure hash function to instantiate the random oracle, everything mostly goes fine.)</p>



<p>Now it should be noted that theoreticians were not happy about this cavalier approach. In the late 1990s, they rebelled and demonstrated something shocking: <a href="https://blog.cryptographyengineering.com/2020/01/05/what-is-the-random-oracle-model-and-why-should-you-care-part-5/">it was possible to build &#8220;contrived&#8221; cryptographic schemes</a> that were <em>provably secure in the random oracle model</em> but totally broken <em>when the oracle was &#8220;instantiated&#8221; with any hash function. </em></p>



<p>This was shocking, but honestly not that surprising once you&#8217;ve had someone else explain the basic idea. Most of these &#8220;counterexample schemes&#8221; followed from four simple observations:</p>



<ol class="wp-block-list">
<li>In the (totally artificial) random oracle model, you don&#8217;t know a compact description of the hash function. <em>You literally can&#8217;t know one, since it&#8217;s an exponentially-sized random function.</em></li>



<li>In the &#8220;instantiated&#8221; protocol, where you&#8217;ve replaced the random oracle with e.g., SHA-2, you very clearly must know a compact description of the hash function (for example, <a href="https://github.com/codegasms/sha256/blob/main/sha256.js">here is one</a>.)</li>



<li>We can build a <a href="https://blog.cryptographyengineering.com/2020/01/05/what-is-the-random-oracle-model-and-why-should-you-care-part-5/">&#8220;contrived&#8221; scheme</a> in which &#8220;knowledge of the description of the hash algorithm&#8221; forms a kind of <a href="https://en.wikipedia.org/wiki/Backdoor_(computing)">backdoor</a> that allows you to break the scheme!</li>



<li>In the random oracle model where you can&#8217;t ever possess this knowledge, the backdoor can never be triggered — hence the scheme is &#8220;secure.&#8221; In the real world where you instantiate the scheme with SHA-2, any clown can break it.</li>
</ol>



<p>These results straddle the line between &#8220;brilliant&#8221; and &#8220;fundamentally kind of silly&#8221;. Brilliant because, <em>wow</em>! These schemes will be insecure when instantiated with any possible hash function! The random oracle model is a trap! But stupid because, I mean&#8230; <em>duh</em>!? In fact what we&#8217;re really showing is that our artificial model is artificial. If you build schemes that deliberately fall apart when any adversary knows the code for a hash function, then <em>of course your schemes are going to be broken</em>. You don&#8217;t need to be a genius to see that this is going to go poorly.</p>



<p>Nonetheless: theoreticians took the a victory lap and then moved on to <a href="https://www.iacr.org/archive/crypto2001/21390001.pdf">ruining other people&#8217;s fun</a>. Practitioners waited until every last one of them had lost interest, rolled their eyes, and said &#8220;<em>let&#8217;s agree not to deploy schemes that do obviously stupid things.&#8221; </em>And then they all went on deploying schemes that were only proven secure in the random oracle model. And this has described our world for 28 years or so.</p>



<h3 class="wp-block-heading">But the theoreticians weren&#8217;t totally wrong, were they?</h3>



<p>That is the $10,000,000,000 question. </p>



<p>As discussed above, many &#8220;contrived counterexample&#8221; schemes were built to demonstrate the danger of the random oracle model. But each of them was so obviously cartoonish that nobody would ever deploy one of them in practice. If your signature scheme includes 40 lines of code that essentially scream &#8220;FYI: THIS IS A BACKDOOR THAT UNLOCKS FOR ANYONE WHO KNOWS THE CODE OF SHA2&#8221;, the best solution is <em>not </em>to have a theoretical argument about whether this code is &#8220;valid.&#8221; The best solution is to delete the code and maybe write over your hard disk three times with random numbers before you burn it. Practitioners generally do not feel threatened by artificial counterexamples. </p>



<p>But a danger remains. </p>



<p>Cryptographic schemes have been getting more complicated and powerful over time. Since I explained the danger in a <a href="https://blog.cryptographyengineering.com/2020/01/05/what-is-the-random-oracle-model-and-why-should-you-care-part-5/">previous blog post</a> I wrote five years ago, I&#8217;m going to save myself some trouble — and also make myself look prescient:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p><em>The probability of [a malicious scheme slipping past detection] accidentally seems low, but it gets higher as deployed cryptographic schemes get more complex. For example, people at Google are now starting to deploy complex <a href="https://threatpost.com/google-computational-privacy/145835/">multi-party computation</a> <strong>and others are launching <a href="https://blog.cryptographyengineering.com/2014/11/27/zero-knowledge-proofs-illustrated-primer/">zero-knowledge protocols</a> that are actually capable of running (or proving things about the execution of) arbitrary programs in a cryptographic way</strong>. We can’t absolutely rule out the possibility that the CGH and MRH-type counterexamples could actually be made to happen in these weird settings, if someone is a just a little bit careless.</em></p>
</blockquote>



<p>Let&#8217;s drill down on this a moment.</p>



<p>One relatively recent development in cryptography is the rise of succinct &#8220;<a href="https://ethereum.org/en/developers/docs/scaling/zk-rollups/">ZK</a>&#8221; or &#8220;<a href="https://en.wikipedia.org/wiki/Verifiable_computing">verifiable computation</a>&#8221; schemes that allow an untrusted person to prove statements about arbitrary programs. In general terms, these systems allow a Prover (e.g., me) to prove statements of the following form: (1) I know an <span style="text-decoration: underline">input</span> to a [publicly-known] program, such that (2) the program, when run on that input, will output &#8220;True.&#8221; </p>



<p>The neat thing about these systems is that after running the program, I can author a short (aka &#8220;succinct&#8221;) proof that will convince you that both of these things are true. Even better, I can hand that short proof (sometimes called an &#8220;argument&#8221;) to anyone in the world. They can run a Verify algorithm to check that the proof is valid, and if it agrees, then they never need to repeat the original computation. Critically, the time required to verify the proof is usually much less than the time required to re-check the program execution, even for really complicated program executions. The resulting systems are called <span style="text-decoration: underline"><em>arguments of knowledg</em>e</span> and they go by various cool acronyms: SNARGs, SNARKs, STARKs, and sometimes IVC. (The Ethereum world sometimes lumps these together under the moniker &#8220;ZK&#8221;, for historical reasons we will not dig into.)</p>



<p>This technology has proven to be an exciting and necessary solution for the cryptocurrency world, because that world happens to have a real problem on its hands. Concretely: they&#8217;ve all noticed that <em>blockchains</em> <em>are very slow.</em> Those systems require thousands of different computers to verify (&#8220;check the validity of&#8221;) every financial transaction they see, which places enormous limitations on transaction throughput.</p>



<p>&#8220;Succinct&#8221; proof systems offer a perfect solution to this conundrum. </p>



<p>Rather than submitting millions of individual transactions to a big, slow blockchain, the blockchain can be broken up. Distinct servers called &#8220;rollups&#8221; can verify big batches of transactions independently. They can each <em>use a succinct proof system to prove that they ran the transaction-verification program correctly</em> on all those transactions<em>.</em> The base-level blockchains no longer need to look at every single transaction. They only need to verify the short &#8220;proofs&#8221; authored by the rollup servers, and (magically!) this ensures that all of the transactions are verified — but with the base-level blockchain doing vastly less work. In theory this allows a massive improvement in blockchain throughput, mostly <em>without</em> sacrificing security.</p>



<p>An even cooler fact is that these proof systems can in some cases be <a href="https://medium.com/@denniswon/unlocking-the-power-of-recursive-zk-snarks-applications-and-implementations-83666a22b54a">applied <em>recursively</em></a><em>. </em>This is due to a cute feature: the algorithm for <em>verifying a proof</em> is, after all, itself just a computer program. So I can run that program on some other proofs as input — and then I can use the proof system to prove that <span style="text-decoration: underline">I ran that program</span><em> </em>correctly.<em> </em></p>



<p>To give a more concrete application:</p>



<ol class="wp-block-list">
<li>Imagine 1,000 different servers each run a program that verifies a distinct batch of 1,000 transactions. Each server produces a succinct proof that they ran their program correctly (i.e., their batch is correct.)</li>



<li>Now a different server can take in each of those 1,000 different proofs. And <em>it</em> can run a Verify program that goes through each of those 1,000 proofs and verifies that each one is correct. It outputs a proof that it ran this program correctly. </li>



<li>The result is a single &#8220;short&#8221; proof that proves all 1,000,000 transactions are correct!</li>
</ol>



<p>I even made a not-very-excellent picture to try to illustrate how this can look:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image.png"><img data-attachment-id="8118" data-permalink="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/image-51/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image.png" data-orig-size="2198,1268" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image.png?w=700" loading="lazy" width="1024" height="590" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image.png?w=1024" alt="" class="wp-image-8118" style="width:615px;height:auto" /></a><figcaption class="wp-element-caption"><em>Example of recursive proof usage. At the bottom we have some real programs, each of which gets its own proof. Then one level up we have a program that simply verifies the proofs from the bottom level. And at the top we have another program that verifies many proofs from the second level! (Many programs not shown.) </em></figcaption></figure></div>


<p>This recursive stuff is really useful, and I promise that it will be relevant later.</p>



<h3 class="wp-block-heading">So what?</h3>



<p>The question you might be asking is: <em>what in the world does this have to do with random oracle counterexamples?!</em></p>



<p>Since these proof systems are now powerful enough to <em>run arbitrary programs </em>(sometimes implemented in the form of arithmetic or boolean &#8220;circuits&#8221;), there is now a possibility that sneaky counterexample &#8220;backdoors&#8221; could be smuggled in within the <em>programs we are proving things about.</em> This would mean that even if the actual proving scheme has no obvious backdoors in its code, the actual programs would be able to do creepy stuff that would undermine security for the whole system. Our practitioner friends would no longer be able to exercise their (very reasonable) heuristic of &#8220;<em>don&#8217;t deploy code that does obviously suspicious things</em>&#8221; because, while <span style="text-decoration: underline">their</span> implementation might not do stupid things, some user try to run it with a malicious program that does.</p>



<p>(A good analogy is to imagine that your Nintendo system has no exploits built into it, but any <em><a href="https://gbatemp.net/threads/is-zelda-oot-3d-the-only-exploit-for-gateway-3ds.385134/">specific game</a></em> might sneak in a nasty piece of code that could blow everything up.)</p>



<h3 class="wp-block-heading">A philosophical interlude</h3>



<p>This has been a whole lot, and there&#8217;s lots more to come.</p>



<p>To give you a break, I want pause for a moment to talk about philosophy, metaphysics (meta-<em>cryptography?</em>), or maybe just the Meaning of Life. More concretely, at this point we need to stop and ask a very reasonable question: <em>how much does this threat model even matter?</em> <em>And what even is this threat model?</em></p>



<p>Allow me to explain. Imagine that we have a proving system that is basically <span style="text-decoration: underline">not</span> backdoored. It may or may not be <em>provably secure</em>, but by itself the proving system itself does not contain any obvious backdoors that will cause it to malfunction, even if you implement it using a concrete hash function like SHA-3.</p>



<p class="has-text-align-left">Now imagine that someone comes along and writes a program called &#8220;<span style="text-decoration: underline"><code>Verify_Ethereum_Transactions_EVIL.py</code></span>&#8221; that we will want to run and prove using our proof system. Based on the name, we can assume this program was developed by a shady engineer who maliciously decide to add a &#8220;backdoor&#8221; to the code! Instead of merely verifying Ethereum transactions as you might hope for, the functionality of this program does something nastier:</p>



<p class="has-text-align-center">&#8220;Given some input, output <strong>True</strong> if the input comprises 1,000 <em>valid</em> Ethereum transactions&#8230; <br><strong><span style="text-decoration: underline">OR</span></strong> <br>output <strong>True</strong> if the input (or the program code itself) contains a description of the hash function used by the proving system.&#8221;</p>



<p>This would be really bad for your cryptocurrency network! Any clever user could submit <em>invalid</em> Ethereum transactions to be verified by this program and it would happily output &#8220;<strong>True</strong>.&#8221; If any cryptocurrency network then <em>trusted</em> the proof (to mean &#8220;these transactions are actually valid&#8221;) then you could potentially use this trick to steal lots of money.</p>



<p>But also let me be clear: <em>this would also be an incredibly stupid program to deploy in your cryptocurrency network.</em></p>



<p>The whole point of a proof system is that it proves you ran a program successfully, including whatever logic happens to be within those programs. If those programs have obvious backdoors inside of them, then proving you ran those programs means you&#8217;re also proving that you might have exercised any backdoors in those programs. If the person writing your critical software is out to get you, and/or you don&#8217;t carefully audit their output, you will end up being very regretful. And there are <em>many, many ways to add backdoors to software! </em>(Just to illustrate this, there used to be an entire competition called the &#8220;<a href="https://www.underhanded-c.org/">Underhanded C Contest</a>&#8221; where people would compete to write C programs full of malicious code that was hard to catch. The results were pretty impressive!)</p>



<p>So it&#8217;s worthwhile to ask whether this is really a surprise. In the past we knew that (1) if your silly cryptographic scheme had weird code that made it insecure &#8220;<em>to anyone who knows how to compute SHA-2</em>&#8220;, then (2) it would <em>really be</em> <em>insecure in the real world</em>, since any idiot can <a href="https://www.npmjs.com/package/js-sha256">download the code for SHA-2</a>, and (3) you should not deploy schemes that have obvious backdoors.</p>



<p>So with this context in mind, let&#8217;s talk about what kind of bad things might happen. These can be divided into &#8220;<em>best case</em>&#8220;, &#8220;<em>second worst case</em>&#8221; and &#8220;<em>oh hell, holy sh*t.</em>&#8220;</p>



<p><strong>In the best case,</strong> this type of attack might simply move the scary backdoor code out from the cryptographic proving system, and into the modular &#8220;application programs&#8221; that can be fed into the proving system You still need to make sure the scheme implementation doesn&#8217;t have silly backdoors — like special code that breaks everything if you know the code for SHA-2. But now you also need to make sure every <span style="text-decoration: underline">program you run</span> using this system doesn&#8217;t have a similar backdoors. But to be clear: you kind of had to audit your programs for backdoors anyway!</p>



<p>In fairness, the nature of these cryptographic backdoors is that they might be more <em>subtle</em> than a typical software backdoor. What I mean here is that ordinary software reviewers might not recognize it, and only only an experienced cryptographer will identify that something sketchy is happening. But even if the bug is hard to identify, it&#8217;s still a bug — a bug in one specific piece of code — and most critically, it would only affect <span style="text-decoration: underline"><em>your own</em></span> application if you deployed it.</p>



<p>Of course there are worse possibilities as well.</p>



<p><strong>In the second worst case, </strong>perhaps the bugdoor can be built into the application code in some clever way that is <em>deeply subtle and fundamentally difficult for code auditors to detect</em> — even if they know how to look for it. Perhaps it could somehow be cryptographically obfuscated, so <em>no</em> code review will detect it! Recursive proof systems are worrying when it comes to this concern, since the &#8220;bug&#8221; might exist multiple layers down in a tree of recursive proofs, and you might not have the code for all those lower-level programs.<sup>1</sup> It&#8217;s possible that the set of &#8220;bad code behaviors&#8221; we we&#8217;d need to audit the code for is so large and undefined that we can no longer apply simple heuristics to catch the bad stuff!</p>



<p>This would be very scary. But it is certainly not the worst case.</p>



<p><strong>The (&#8220;oh crap!&#8221;) worst case:</strong> with recursive proofs there is an even more terrible thing that could theoretically happen. Recall that a single top-level recursive proof can recursively verify thousands of <span style="text-decoration: underline">different</span> programs. Many of those programs will likely be written by careful, honest developers. Others could be written by scammers. Clearly if the scammers&#8217; code contains bugs (or flaws) then we should expect those bugs to make <em>the scammers&#8217; own programs </em>less secure, at whatever goal they&#8217;re supposed to accomplish. So far none of this is surprising. But ideally what we should hope is that any backdoors in the scammers&#8217; programs will remain <span style="text-decoration: underline">isolated</span> to the scammers&#8217; code. They should not &#8220;jump across program boundaries&#8221; and thus undermine the security of the well-written, honest programs elsewhere in the recursive proof stack.</p>



<p>Now imagine a situation where this is not true. That is, a clever bug in one &#8220;program&#8221; <span style="text-decoration: underline">anywhere in the tree</span> could somehow <em>make any other program (proof) in the entire tree of proofs</em> insecure. This is akin to getting one malicious program onto a Linux box, then using it to compromise the Linux kernel and thus undermine the security of any application running on the system. Maybe this seems unlikely? Actually to me it seems genuinely fantastic, but again, we&#8217;re in Narnia at this point. Who knows what&#8217;s possible!</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-1.png"><img data-attachment-id="8123" data-permalink="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/image-52/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-1.png" data-orig-size="2198,1386" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-1.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-1.png?w=700" loading="lazy" width="1024" height="645" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/02/image-1.png?w=1024" alt="" class="wp-image-8123" style="width:537px;height:auto" /></a><figcaption class="wp-element-caption"><em>This is the very worst case. I don&#8217;t think it could happen, but&#8230; who knows?</em></figcaption></figure></div>


<p>This is the scary thing about what can happen once we leave the world of provable security. Without some fundamental security guarantees we can rely on, it&#8217;s possible that the set of attacks we might suffer could be very limited. But they could also be fundamentally <span style="text-decoration: underline">unbounded!</span> And that&#8217;s where I have to leave this post for the moment.</p>



<p><em><a href="https://blog.cryptographyengineering.com/2025/02/06/how-to-prove-false-statements-part-2/">This post is continued in Part 2.</a></em></p>



<p>Notes:</p>



<ol class="wp-block-list">
<li>We might imagine, for example, that a recursive Verify program might just take in the hash (or commitment) to a program. And then a Prover could simply state &#8220;well, I know a real program that matches this commitment AND ALSO I know an input that satisfies the program.&#8221; This means the program wouldn&#8217;t technically be available to every auditor, only the hash of the program. I am doing a lot of handwaving here, but this is all possible.</li>
</ol>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/fundamentals/" rel="category tag">fundamentals</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/" rel="bookmark"><time class="entry-date published" datetime="2025-02-04T21:40:14+00:00">February 4, 2025</time><time class="updated" datetime="2025-02-06T22:41:22+00:00">February 6, 2025</time></a></span><span class="word-count">3,846 Words</span><span class="comments-link"><a href="https://blog.cryptographyengineering.com/2025/02/04/how-to-prove-false-statements-part-1/#comments">1 Comment</a></span><!-- .comments-link -->		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
				
<article id="post-7943" class="post-7943 post type-post status-publish format-standard has-post-thumbnail hentry category-ai category-imessage category-messaging tag-cybersecurity tag-encryption tag-privacy tag-security tag-technology">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/" rel="bookmark">Let&#8217;s talk about AI and end-to-end&nbsp;encryption</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/"><img width="700" height="430" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/apple-security-encryption.jpg?w=700&amp;h=430&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Let&#8217;s talk about AI and end-to-end&nbsp;encryption" decoding="async" loading="lazy" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/apple-security-encryption.jpg?w=700&amp;h=430&amp;crop=1 700w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/apple-security-encryption.jpg?w=150&amp;h=92&amp;crop=1 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/apple-security-encryption.jpg?w=300&amp;h=184&amp;crop=1 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/apple-security-encryption.jpg?w=768&amp;h=472&amp;crop=1 768w, https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/apple-security-encryption.jpg?w=1024&amp;h=629&amp;crop=1 1024w" sizes="(max-width: 700px) 100vw, 700px" data-attachment-id="8013" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/apple-security-encryption/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/apple-security-encryption.jpg" data-orig-size="1120,630" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="apple-security-encryption" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/apple-security-encryption.jpg?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/apple-security-encryption.jpg?w=700" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p>Recently I came across a fantastic new paper by a group of NYU and Cornell researchers entitled &#8220;<a href="https://eprint.iacr.org/2024/2086">How to think about end-to-end encryption and AI</a>.&#8221; I&#8217;m extremely grateful to see this paper, because while I don&#8217;t agree with every one of its conclusions, it&#8217;s a good first stab at an incredibly important set of questions.</p>



<p>I was particularly happy to see people thinking about this topic, since it&#8217;s been on my mind in a half-formed state this past few months. On the one hand, my interest in the topic was piqued by the deployment of new AI assistant systems like <a href="https://security.googleblog.com/2024/11/new-real-time-protections-on-Android.html">Google&#8217;s scam call protection</a> and <a href="https://www.apple.com/apple-intelligence/">Apple Intelligence</a>, both of which aim to put AI basically everywhere on your phone — even, critically, right in the middle of your private messages. On the other hand, I&#8217;ve been thinking about the negative privacy implications of AI due to the recent European debate over &#8220;<a href="https://www.patrick-breyer.de/en/posts/chat-control/">mandatory content scanning</a>&#8221; laws that would require machine learning systems to scan virtually every private message you send.</p>



<p>While these two subjects arrive from very different directions, I&#8217;ve come to believe that they&#8217;re going to end up in the same place. And as someone who has been worrying about encryption — and debating the &#8220;crypto wars&#8221; for over a decade — this has forced me to ask some uncomfortable questions about what the future of end-to-end encrypted privacy will look like. Maybe, even, whether it actually <em>has</em> a future.</p>



<p>But let&#8217;s start from an easier place.</p>



<h3 class="wp-block-heading">What is end-to-end encryption, and what does AI have to do with it?</h3>



<p>From a privacy perspective, the most important story of the past decade or so has been the rise of end-to-end encrypted communications platforms. Prior to 2011, most cloud-connected devices simply uploaded their data in plaintext. For many people this meant their private data was <a href="https://en.wikipedia.org/wiki/2014_celebrity_nude_photo_leak">exposed to hackers</a>, civil subpoenas, government warrants, or business exploitation by the platforms themselves. Unless you were an advanced user who used tools like <a href="https://blog.cryptographyengineering.com/2014/08/13/whats-matter-with-pgp/">PGP</a> and <a href="https://otr.cypherpunks.ca/">OTR</a>, most end-users had to suffer the consequences.<br><br>And (spoiler alert) oh boy, did those consequences <a href="https://en.wikipedia.org/wiki/Operation_Aurora">turn out to be</a> <a href="https://en.wikipedia.org/wiki/Salt_Typhoon">terrible</a>.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png"><img data-attachment-id="8009" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-49/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png" data-orig-size="2028,800" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png?w=700" loading="lazy" width="1024" height="403" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png?w=1024" alt="" class="wp-image-8009" style="width:505px;height:auto" /></a><figcaption class="wp-element-caption">Headline about the <a href="https://en.wikipedia.org/wiki/Salt_Typhoon">Salt Typhoon</a> group, an APT threat that has essentially owned US telecom infrastructure by compromising &#8220;wiretapping&#8221; systems. Oh how the worm has turned.</figcaption></figure></div>


<p>Around 2011 our approach to data storage began to evolve. This began with messaging apps like <a href="https://support.signal.org/hc/en-us/articles/360007320391-Is-it-private-Can-I-trust-it">Signal</a>, <a href="https://support.apple.com/guide/security/imessage-security-overview-secd9764312f/web">Apple iMessage</a> and <a href="https://faq.whatsapp.com/820124435853543">WhatsApp</a>, all of which began to roll out default end-to-end encryption for private messaging. This technology changed the way that keys are managed, to ensure that servers would <em>never see the plaintext content of your messages.</em> Shortly afterwards, phone (OS) designers like Google, Samsung and Apple began encrypting the data stored locally on your phone, a move that occasioned some famous <a href="https://epic.org/documents/apple-v-fbi-2/">arguments with law enforcement</a>. More recently, Google <a href="https://www.androidcentral.com/how-googles-backup-encryption-works-good-bad-and-ugly">introduced default end-to-end encryption for phone backups</a>, and (somewhat <a href="https://www.reuters.com/article/world/exclusive-apple-dropped-plan-for-encrypting-backups-after-fbi-complained-sour-idUSKBN1ZK1CO/">belatedly</a>) Apple has <a href="https://support.apple.com/en-us/108756">begun to follow.</a></p>



<p>Now I don&#8217;t want to minimize the engineering effort required here, which was massive. But these projects were also relatively simple. By this I mean: all of the data encrypted in these projects shared a common feature, which is that <em>none of it needed to be processed by a server.</em></p>



<p>The obvious limitation of end-to-end encryption is that while it can hide content from servers, it can also make it very difficult for servers to compute on that data.<sup>1</sup> This is basically fine for data like cloud backups and private messages, since that content is mostly interesting to clients. For data that actually requires serious processing, the options are much more limited. Wherever this is the case — for example, consider a phone that applies <a href="https://support.apple.com/guide/iphone/use-live-text-iphcf0b71b0e/ios">text recognition</a> to the photos in your camera roll — designers typically get forced into a binary choice. On the one hand they can (1) send plaintext off to a server, in the process resurrecting many of the earlier vulnerabilities that end-to-end encryption sought to close. Or else (2) they can limit their processing to whatever can be <a href="https://www.theverge.com/2017/9/13/16300464/apple-iphone-x-ai-neural-engine">performed</a> <a href="https://developers.google.com/ml-kit/vision/text-recognition/v2/android">on the device</a> itself.</p>



<p>The problem with the second solution is that your typical phone only has a limited amount of processing power, not to mention RAM and battery capacity. Even the top-end iPhone will typically perform photo processing while it&#8217;s plugged in at night, just to avoid burning through your battery when you might need it. Moreover, there is a huge amount of variation in phone hardware. Some flagship phones will run you $1400 or more, and contain onboard GPUs and neural engines. But these phones aren&#8217;t typical, in the US and particularly around the world. Even in the US it&#8217;s still possible to buy a decent Android phone for a couple hundred bucks, and a lousy one for much less. There is going to be a vast world of difference between these devices in terms of what they can process.</p>



<p>So now we&#8217;re finally ready to talk about AI.</p>



<p>Unless you&#8217;ve been living under a rock, you&#8217;ve probably noticed the explosion of powerful new AI models with amazing capabilities. These include Large Language Models (LLMs) which can generate and understand complex human text, as well as new image processing models that can do amazing things in that medium. You&#8217;ve probably also noticed Silicon Valley&#8217;s enthusiasm to find applications for this tech. And since phone and messaging companies <em>are</em> Silicon Valley, your phone and its apps are no exception. Even if these firms don&#8217;t quite know <em>how</em> AI will be useful to their customers, they&#8217;ve already decided that models are the future. In practice this has already manifested in the deployment of applications such as <a href="https://arstechnica.com/apple/2024/11/apple-intelligence-notification-summaries-are-honestly-pretty-bad/">text message summarization</a>, systems that listen to and detect <a href="https://support.google.com/pixelphone/thread/307725284/learn-more-about-the-new-scam-detection-beta?hl=en">scam phone calls</a>, models that detect <a href="https://support.apple.com/en-us/105069">offensive images</a>, as well as new systems that help you <a href="https://support.apple.com/guide/iphone/use-writing-tools-iph6f08da1d2/ios">compose text</a>.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png"><img data-attachment-id="7959" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-44/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png" data-orig-size="1128,581" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png?w=700" loading="lazy" width="1024" height="527" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png?w=1024" alt="" class="wp-image-7959" style="width:376px;height:auto" /></a></figure></div>


<p>And these are obviously just the beginning.</p>



<p>If you believe the AI <a href="https://www.youtube.com/watch?v=_-8j28KFXvQ">futurists</a> — and in this case, I actually think you should — all these toys are really just a palate cleanser for the<em> </em>main entrée still to come: the deployment of &#8220;AI agents,&#8221; aka, <a href="https://www.goodreads.com/quotes/985552-the-encyclopedia-galactica-defines-a-robot-as-a-mechanical-apparatus">Your Plastic Pal Who&#8217;s Fun To Be With</a>. </p>



<p><em>In theory</em> these new agent systems will remove your need to ever bother messing with your phone again. They&#8217;ll read your email and text messages and they&#8217;ll answer for you. They&#8217;ll order your food and find the best deals on shopping, swipe your dating profile, negotiate with your lenders, and generally anticipate your every want or need. The only ingredient they&#8217;ll need to realize this blissful future is <em>virtually unrestricted access to all your private data</em>, plus a whole gob of computing power to process it.</p>



<p>Which finally brings us to the sticky part. </p>



<p>Since most phones currently don&#8217;t have the compute to run very powerful models, and since models keep getting better and in some cases <a href="https://techcrunch.com/2025/01/10/vcs-say-ai-companies-need-proprietary-data-to-stand-out-from-the-pack/">more proprietary</a>, it is likely that much of this processing (and the data you need processed) will have to be offloaded to remote servers.</p>



<p>And that&#8217;s the first reason that I would say that AI is going to be the biggest privacy story of the decade. Not only will we soon be doing more of our compute off-device, but we&#8217;ll be sending a lot more of our private data. This data will be examined and summarized by increasingly powerful systems, producing relatively compact but valuable summaries of our lives. In principle those systems will eventually know everything about us and about our friends. They&#8217;ll read our most intimate private conversations, maybe they&#8217;ll even intuit our deepest innermost thoughts. We are about to face many hard questions about these systems, including some difficult questions about <em>whether they will actually be working for us at all.</em></p>



<p>But I&#8217;ve gone about two steps farther than I intended to. Let&#8217;s start with the easier questions.</p>



<h3 class="wp-block-heading">What does AI mean for end-to-end encrypted messaging?</h3>



<p>Modern end-to-end encrypted messaging systems provide a very specific set of technical guarantees. Concretely, an end-to-end encrypted system is designed to ensure that plaintext message content <span style="text-decoration: underline">in transit</span> is not available anywhere except for the end-devices of the participants and (here comes the Big Asterisk) <em>anyone the participants or their devices choose to share it with.</em></p>



<p>The last part of that sentence is very important, and it&#8217;s obvious that non-technical users get pretty confused about it. End-to-end encrypted messaging systems are intended to deliver data securely. <em>They don&#8217;t dictate what happens to it next.</em> If you take screenshots of your messages, back them up in plaintext, copy/paste your data onto Twitter, or hand over your device in response to a civil lawsuit — well, that has really nothing to do with end-to-end encryption. Once the data has been delivered from one end to the other, end-to-end encryption washes its hands and goes home</p>



<p>Of course there&#8217;s a difference between <em>technical guarantees</em> and the promises that individual service providers make to their customers. For example, Apple says this about its iMessage service:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png"><img data-attachment-id="7968" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-45/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png" data-orig-size="2398,404" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png?w=700" loading="lazy" width="1024" height="172" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png?w=1024" alt="" class="wp-image-7968" style="width:784px;height:auto" /></a></figure></div>


<p>I can see how these promises might get a little bit confusing! For example, imagine that Apple keeps its promise to deliver messages securely, but then your (Apple) phone goes ahead and uploads (the plaintext) message content to a different set of servers where <span style="text-decoration: underline">Apple really can</span> decrypt it. Apple is absolutely using end-to-end encryption in the dullest technical sense&#8230; yet is the statement above really accurate? Is Apple keeping its broader promise that it &#8220;can&#8217;t decrypt the data&#8221;?</p>



<p>Note: I am not picking on Apple here! This is just one paragraph from a <a href="https://support.apple.com/guide/security/welcome/web">security overview</a>. In a separate legal document, Apple&#8217;s lawyers have written a <a href="https://www.apple.com/legal/privacy/data/en/messages/">zillion words to cover their asses</a>. My point here is just to point out that a <em>technical guarantee</em> is different from a <em>user promise</em>.</p>


<div class="wp-block-image">
<figure class="alignright size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg"><img data-attachment-id="7970" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/img_9881/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg" data-orig-size="1059,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="IMG_9881" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg?w=700" loading="lazy" width="1024" height="362" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg?w=1024" alt="" class="wp-image-7970" style="width:383px;height:auto" /></a></figure></div>


<p>Making things more complicated, this might not be a question about your own actions. Consider the promise you receive every time you start a WhatsApp group chat (at right.) Now imagine that some other member of the group — not you, but one of your idiot friends —&nbsp;decides to turn on some service that uploads (your) received plaintext messages to WhatsApp. Would you still say the message you received still accurately describes how WhatsApp treats your data? If not, how should it change?</p>



<p>In general, what we&#8217;re asking here is a question about <em>informed</em> <em>consent. </em>Consent is complicated because it&#8217;s both a moral concept and also a legal one, and because the law is different in every corner of the world. The <a href="https://eprint.iacr.org/2024/2086.pdf">NYU/Cornell paper</a> does an excellent job giving an overview of the legal bits, but — and sorry to be a bummer here — I really don&#8217;t want you to expect the law to protect you. I imagine that some companies will do a good job informing their users, as a way to earn trust. Other companies, won&#8217;t. Here in the US, they&#8217;ll bury your consent inside of an inscrutable &#8220;terms of service&#8221; document you never read. In the EU they&#8217;ll probably just invent a new type of cookie banner.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png"><img data-attachment-id="7973" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-46/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png" data-orig-size="2054,908" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png?w=700" loading="lazy" width="1024" height="452" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png?w=1024" alt="" class="wp-image-7973" style="width:373px;height:auto" /></a><figcaption class="wp-element-caption"><em>This is obviously a joke. But, like, maybe not?</em></figcaption></figure></div>


<p>So to summarize: in the near term we&#8217;re headed to a world where we should expect increasing amounts of our data to be processed by AI, and a lot of that processing will (very likely) be off-device. Good end-to-end encrypted services will actively inform you that this is happening, so maybe you&#8217;ll have the chance to opt-in or opt-out. But if it&#8217;s <em>truly ubiquitous</em> (as our futurist friends tell us it will be) then probably your options will be end up being pretty limited.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png"><img data-attachment-id="7979" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-47/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png" data-orig-size="672,186" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png?w=672" loading="lazy" width="672" height="186" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png?w=672" alt="" class="wp-image-7979" style="width:323px;height:auto" /></a><figcaption class="wp-element-caption">Some ideas for avoiding AI inference on your private messages (cribbed from <a href="https://www.usenix.org/system/files/1401_08-12_mickens.pdf">Mickens</a>.) </figcaption></figure></div>


<p>Fortunately all is not lost. In the short term, a few people have been thinking hard about this problem.</p>



<h3 class="wp-block-heading">Trusted Hardware and Apple&#8217;s &#8220;Private Cloud Compute&#8221;</h3>



<p>The good news is that our coming AI future isn&#8217;t going to be a total privacy disaster. And in large part that&#8217;s because a few privacy-focused companies like Apple have anticipated the problems that ML inference will create (namely the need to outsource processing to better hardware) and have tried to do something about it. This something is essentially a new type of cloud-based computer that Apple believes is trustworthy enough to hold your private data. </p>



<p>Quick reminder: as we already discussed, Apple can&#8217;t rely on every device possessing enough power to perform inference locally. This means inference will be outsourced to a remote cloud machine. Now the <em>connection</em> from your phone to the server can be encrypted, but the remote machine will still receive confidential data that it must see in cleartext. This poses a huge risk at that machine. It could be compromised and the data stolen by hackers, or worse, Apple&#8217;s business development executives could find out about it.</p>



<p>Apple&#8217;s <a href="https://security.apple.com/blog/private-cloud-compute/">approach to this problem</a> is called &#8220;Private Cloud Compute&#8221; and it involves the use of special <em>trusted hardware</em> devices that run in Apple&#8217;s data centers. A &#8220;trusted hardware device&#8221; is a kind of computer that is locked-down in both the physical and logical sense. Apple&#8217;s devices are house-made, and use custom silicon and software features. One of these is Apple&#8217;s <a href="https://support.apple.com/guide/security/boot-process-for-iphone-and-ipad-devices-secb3000f149/web">Secure Boot</a>, which ensures that only &#8220;allowed&#8221; operating system software is loaded. The OS then uses code-signing to verify that only permitted software images can run. Apple ensures that no long-term state is stored on these machines, and also load-balances your request to a different random server every time you connect. The machines &#8220;attest&#8221; to the application software they run, meaning that they announce a hash of the software image (which must itself be stored in a verifiable <a href="https://en.wikipedia.org/wiki/Certificate_Transparency">transparency log</a> to prevent any new software from surreptitiously being added.) Apple even says it will <a href="https://security.apple.com/blog/pcc-security-research/">publish its software</a> images (though unfortunately not [<strong>update:</strong> <a href="https://github.com/apple/security-pcc/">all of</a>] the source code) so that security researchers can check them over for bugs.</p>



<p>The goal of this system is to make it hard for both attackers <em>and </em>Apple employees to exfiltrate data from these devices. I won&#8217;t say I&#8217;m thrilled about this. It goes without saying that Apple&#8217;s approach is a vastly weaker guarantee than encryption — it still centralizes a huge amount of valuable data, and its security relies on Apple getting a bunch of complicated software and hardware security features right, rather than the mathematics of an encryption algorithm. Yet this approach is obviously much better than what&#8217;s being done at companies like OpenAI, where the data is processed by servers that employees (presumably) can log into and access.</p>



<p>Although PCC is currently unique to Apple, we can hope that other privacy-focused services will soon crib the idea — after all, imitation is the best form of flattery. In this world, if we absolutely must have AI everywhere, at least the result will be a bit more secure than it might otherwise be.</p>



<h3 class="wp-block-heading">Who does your AI agent actually work for?</h3>



<p>There are <em>so</em> many important questions that I haven&#8217;t discussed in this post, and I feel guilty because I&#8217;m not going to get to them. I have not, for example, discussed the very important problem of the data used to <em>train</em> (and fine-tune) future AI models, something that opens entire oceans of privacy questions. If you&#8217;re interested, these problems are discussed in the <a href="https://eprint.iacr.org/2024/2086.pdf">NYU/Cornell paper.</a>  </p>



<p>But rather than go into that, I want to turn this discussion towards a different question: namely, <em>who are these models actually going to be working <span style="text-decoration: underline">for</span>? </em></p>



<p>As I mentioned above, over the past couple of years I&#8217;ve been watching <a href="https://www.gov.uk/government/publications/end-to-end-encryption-and-child-safety/end-to-end-encryption-and-child-safety">the UK</a> and <a href="https://www.europarl.europa.eu/RegData/etudes/ATAG/2023/751473/EPRS_ATA(2023)751473_EN.pdf">EU</a> debate new laws that would mandate automated &#8220;scanning&#8221; of private, encrypted messages. The EU&#8217;s proposal is focused on detecting both existing and <em>novel</em> child sexual abuse material (CSAM); it has at various points also included proposals to detect <a href="https://www.edpb.europa.eu/system/files/2024-02/edpb_statement_202401_proposal_regulation_prevent_combat_child_sexual_abuse_en.pdf">audio and textual conversations</a> that represent &#8220;<a href="https://thehackernews.com/2022/05/eu-proposes-new-rules-for-tech.html">grooming behavior</a>.&#8221; The UK&#8217;s proposal is a bit wilder and covers many different types of illegal content, including hate speech, terrorism content and fraud — one proposed amendment even covered &#8220;<a href="https://edri.org/our-work/the-uk-will-treat-online-images-of-immigrants-crossing-the-channel-as-a-criminal-offence/">images of immigrants crossing the Channel in small boats</a>.&#8221;</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png"><img data-attachment-id="7995" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-48/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png" data-orig-size="1500,1000" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png?w=700" loading="lazy" width="1024" height="682" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png?w=1024" alt="" class="wp-image-7995" style="width:228px;height:auto" /></a></figure></div>


<p>While scanning<em> </em>for known<em> </em>CSAM does not require AI/ML, detecting nearly every one of the other types of content would require powerful ML inference that can operate on your private data. (Consider, for example, what is involved in detecting <a href="https://blog.google/technology/safety-security/how-we-detect-remove-and-report-child-sexual-abuse-material/">novel CSAM content</a>.) Plans to detect audio or textual &#8220;grooming behavior&#8221; and hate speech will require even more powerful capabilities: not just speech-to-text capabilities, but also some ability to truly understand the topic of human conversations without false positives. It is hard to believe that politicians even understand what they&#8217;re asking for. And yet some of them <a href="https://www.euractiv.com/section/politics/news/swedish-parliament-divided-over-eus-new-controversial-chat-control-bill/"><span style="text-decoration: underline">are</span> asking for it</a>, in a few cases very eagerly.</p>



<p>These proposals haven&#8217;t been implemented yet. But to some degree this is because ML systems that securely process private data are very challenging to build, and technical platforms have <a href="https://www.politico.eu/article/meta-encryption-uk-fight/">been resistant to building them.</a> Now I invite you to imagine a world where we <em>voluntarily go ahead and build </em>general-purpose agents that are capable of all of these tasks and more. You might do everything in your technical power to keep them under the user&#8217;s control, but can you guarantee that they will remain that way?</p>



<p>Or put differently: would you even blame governments for demanding access to a resource like this? And how would you stop them? After all, think about how much time and money a law enforcement agency could save by asking your agent sophisticated questions about your behavior and data, questions like: &#8220;does this user have any potential CSAM,&#8221; or &#8220;have they written anything that could potentially be hate speech in their private notes,&#8221; or &#8220;do you think maybe they&#8217;re cheating on their taxes?&#8221; You might even convince yourself that these questions are &#8220;privacy preserving,&#8221; since no human police officer would ever rummage through your papers, and law enforcement would only learn the answer if you were (probably) doing something illegal.</p>



<p>This future worries me because it doesn&#8217;t really matter what technical choices we make around privacy. It does not matter if your model is running locally, or if it uses trusted cloud hardware — <em>once a sufficiently-powerful general-purpose agent has been deployed on your phone</em>, <em>the only question that remains is who is given access to talk to it.</em> Will it be only you? Or will we prioritize the government&#8217;s interest in monitoring its citizens over various fuddy-duddy notions of individual privacy.</p>



<p>And while I&#8217;d like to hope that we, as a society, will make the right political choice in this instance, frankly I&#8217;m just not that confident.</p>



<p><em>Notes:</em></p>



<ol class="wp-block-list">
<li>(A quick note: some will suggest that Apple should use <a href="https://blog.cryptographyengineering.com/2012/01/02/very-casual-introduction-to-fully/">fully-homomorphic encryption</a> [FHE] for this calculation, so the private data can remain encrypted. This is <em>theoretically</em> possible, but unlikely to be practical. The best FHE schemes we have today really only work for evaluating very tiny ML models, of the sort that would be practical to run on a weak client device. While schemes will get better and hardware will too, I suspect this barrier will exist for a long time to come.)</li>
</ol>



<p></p>



<p></p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/ai/" rel="category tag">AI</a>, <a href="https://blog.cryptographyengineering.com/category/imessage/" rel="category tag">imessage</a>, <a href="https://blog.cryptographyengineering.com/category/messaging/" rel="category tag">messaging</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/" rel="bookmark"><time class="entry-date published" datetime="2025-01-17T05:01:30+00:00">January 17, 2025</time><time class="updated" datetime="2025-01-18T17:04:49+00:00">January 18, 2025</time></a></span><span class="word-count">3,142 Words</span><span class="comments-link"><a href="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/#comments">10 Comments</a></span><!-- .comments-link -->		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
				
<article id="post-7859" class="post-7859 post type-post status-publish format-standard has-post-thumbnail hentry category-messaging">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/" rel="bookmark">Is Telegram really an encrypted messaging&nbsp;app?</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/"><img width="700" height="430" src="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg?w=700&amp;h=430&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Is Telegram really an encrypted messaging&nbsp;app?" decoding="async" loading="lazy" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg?w=700&amp;h=430&amp;crop=1 700w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg?w=1400&amp;h=860&amp;crop=1 1400w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg?w=150&amp;h=92&amp;crop=1 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg?w=300&amp;h=184&amp;crop=1 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg?w=768&amp;h=472&amp;crop=1 768w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg?w=1024&amp;h=629&amp;crop=1 1024w" sizes="(max-width: 700px) 100vw, 700px" data-attachment-id="7895" data-permalink="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/52770168096_a43776424c_k/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg" data-orig-size="2048,1326" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="52770168096_a43776424c_k" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/52770168096_a43776424c_k.jpg?w=700" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p>This blog is reserved for more serious things, and ordinarily I wouldn&#8217;t spend time on questions like the above. But much as I&#8217;d like to spend my time writing about exciting topics, sometimes the world requires a bit of what <a href="https://braddelong.substack.com/">Brad Delong </a>calls &#8220;Intellectual Garbage Pickup,&#8221; namely: correcting wrong, or mostly-wrong ideas that spread unchecked across the Internet. </p>



<p>This post is inspired by the recent and concerning news that <a href="http://app is accused of failure to cooperate with law enforcement over drug trafficking, child sexual content and fraud.">Telegram&#8217;s CEO Pavel Durov has been arrested by French authorities</a> for its failure to sufficiently moderate content. While I don&#8217;t know the details, the use of criminal charges to coerce social media companies is a pretty worrying escalation, and I hope there&#8217;s more to the story.</p>



<p>But this arrest is not what I want to talk about today.</p>



<p>What I do want to talk about is one specific detail of the reporting. Specifically: the fact that nearly every news report about the arrest refers to Telegram as an &#8220;encrypted messaging app.&#8221; Here are <a href="https://www.politico.eu/article/telegram-app-ceo-pavel-durov-reportedly-arrested-at-french-airport/">just a</a> <a href="https://abcnews.go.com/Technology/wireStory/french-authorities-arrest-telegram-ceo-pavel-durov-paris-113132319">few</a> <a href="https://www.france24.com/en/live-news/20240825-telegram-chief-pavel-durov-arrested-at-french-airport">examples</a>: </p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png"><img data-attachment-id="7864" data-permalink="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/image-34/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png" data-orig-size="1182,274" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png?w=700" loading="lazy" width="1024" height="237" src="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png?w=1024" alt="" class="wp-image-7864" style="width:306px;height:auto" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png?w=1024 1024w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png?w=150 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png?w=300 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png?w=768 768w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-1.png 1182w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure></div>

<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png"><img data-attachment-id="7865" data-permalink="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/image-35/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png" data-orig-size="2466,562" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png?w=700" loading="lazy" width="1024" height="233" src="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png?w=1024" alt="" class="wp-image-7865" style="width:314px;height:auto" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png?w=1024 1024w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png?w=2045 2045w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png?w=150 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png?w=300 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-2.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure></div>

<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png"><img data-attachment-id="7867" data-permalink="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/image-36/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png" data-orig-size="2040,582" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png?w=700" loading="lazy" width="1024" height="292" src="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png?w=1024" alt="" class="wp-image-7867" style="width:329px;height:auto" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png?w=1024 1024w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png?w=150 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png?w=300 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png?w=768 768w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-3.png 2040w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure></div>


<p>This phrasing drives me nuts because in a very limited technical sense it&#8217;s <em>not wrong.</em> Yet in every sense that matters, it fundamentally misrepresents what Telegram is and how it works in practice. And this misrepresentation is bad for both journalists and particularly for Telegram&#8217;s users, many of whom could be badly hurt as a result.</p>



<p>Now to the details. </p>



<h3 class="wp-block-heading">Does Telegram have encryption or doesn&#8217;t it?</h3>



<p>Many systems use encryption in some way or another. However, when we talk about encryption in the context of modern private messaging services, the word typically has a very specific meaning: it refers to the use of default <a href="https://en.wikipedia.org/wiki/End-to-end_encryption">end-to-end</a> encryption to protect users&#8217; message content. When used in an industry-standard way, this feature ensures that every message will be encrypted using encryption keys that are only known to the communicating parties, and not to the service provider.</p>



<p>From your perspective as a user, an &#8220;encrypted messenger&#8221; ensures that each time you start a conversation, your messages will only be readable by the folks you intend to speak with. If the operator of a messaging service tries to view the content of your messages, all they&#8217;ll see is useless encrypted junk. That same guarantee holds for anyone who might hack into the provider&#8217;s servers, and also, for better or for worse, to <a href="https://www.theguardian.com/technology/2023/apr/20/crime-agencies-condemn-facebook-instagram-encryption-plans">law enforcement agencies that serve providers with a subpoena</a>. </p>



<p>Telegram clearly fails to meet this stronger definition for a simple reason: it does not end-to-end encrypt conversations by default. If you want to use end-to-end encryption in Telegram, you must manually activate an <a href="https://core.telegram.org/blackberry/secretchats">optional end-to-end encryption feature</a> called &#8220;Secret Chats&#8221; for every single private conversation you want to have. The feature is explicitly <span style="text-decoration: underline">not turned on</span> for the vast majority of conversations, and is only available for one-on-one conversations, and never for group chats with more than two people in them. </p>



<p>As a kind of a weird bonus, activating end-to-end encryption in Telegram is oddly difficult for non-expert users to actually do.</p>



<p>For one thing, the button that activates Telegram&#8217;s encryption feature is not visible from the main conversation pane, or from the home screen. To find it in the iOS app, I had to click at least four times — once to access the user&#8217;s profile, once to make a hidden menu pop up showing me the options, and a final time to &#8220;confirm&#8221; that I wanted to use encryption. And even after this I was not able to actually have an encrypted conversation, since <em>Secret Chats only works if your conversation partner happens to be online </em>when you do this. </p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png"><img data-attachment-id="7884" data-permalink="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/image-40/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png" data-orig-size="2908,658" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png?w=700" loading="lazy" width="1024" height="231" src="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png?w=1024" alt="" class="wp-image-7884" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png?w=1024 1024w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png?w=1021 1021w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png?w=2042 2042w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png?w=150 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png?w=300 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/08/image-7.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><figcaption class="wp-element-caption"><em>Starting a &#8220;secret chat&#8221; with my friend Michael on the latest Telegram iOS app. From an ordinary chat screen this option isn&#8217;t directly visible. Getting it activated requires four clicks: <strong>(1)</strong> to get to Michael&#8217;s profile (left image), <strong>(2)</strong> on the &#8220;&#8230;&#8221; button to display a hidden set of options (center image), <strong>(3)</strong> on &#8220;Start Secret Chat&#8221;, and <strong>(4)</strong> on the &#8220;Are you sure&#8230;&#8221; confirmation dialog. After that I&#8217;m still unable to send Michael any messages, because Telegram&#8217;s Secret Chats can only be turned on if the other user is also online. </em></figcaption></figure></div>


<p>Overall this is quite different from the experience of starting a new encrypted chat in an industry-standard modern messaging application, which simply requires you to open a new chat window.</p>



<p>While it might seem like I&#8217;m being picky, the difference in adoption between default end-to-end encryption and this experience is likely very significant. The practical impact is that the vast majority of one-on-one Telegram conversations — and literally <em>every single group chat</em> — are probably visible on Telegram&#8217;s servers, which can see and record the content of all messages sent between users. That may or may not be a problem for every Telegram user, but it&#8217;s certainly not something we&#8217;d advertise as particularly well encrypted.</p>



<p>(If you&#8217;re interested in the details, as well as a little bit of further criticism of Telegram&#8217;s actual encryption protocols, I&#8217;ll get into what we know about that further below.)</p>



<h3 class="wp-block-heading">But wait, does default encryption really matter?</h3>



<p>Maybe yes, maybe no! There are two different ways to think about this.</p>



<p>One is that <em>Telegram&#8217;s lack of default encryption is just fine</em> <em>for many people</em>. The reality is that many users don&#8217;t choose Telegram for encrypted private messaging at all. For plenty of people, Telegram is used more like a social media network than a private messenger. </p>



<p>Getting more specific, Telegram has two popular features that makes it ideal for this use-case. One of those is the ability to create and subscribe to &#8220;<a href="https://telegram.org/tour/channels">channels</a>&#8220;, each of which works like a broadcast network where one person (or a small number of people) can push content out to millions of readers. When you&#8217;re <em>broadcasting</em> messages to thousands of strangers in public, maintaining the secrecy of your chat content isn&#8217;t as important. </p>



<p>Telegram also supports large public <a href="https://telegram.org/tour/groups">group chats</a> that can include thousands of users. These groups can be made open for the general public to join, or they can set up as invite-only. While I&#8217;ve never personally wanted to share a group chat with thousands of people, I&#8217;m told that many people enjoy this feature. In the large and <em>public</em> instantiation, it also doesn&#8217;t really matter that Telegram group chats are unencrypted — after all, who cares about confidentiality if you&#8217;re talking in the public square?</p>



<p>But Telegram is not limited to just those features, and many users who join for them will also do other things.</p>



<p>Imagine you&#8217;re in a &#8220;public square&#8221; having a large group conversation. In that setting there may be no expectation of strong privacy, and so end-to-end encryption doesn&#8217;t really matter to you. But let&#8217;s say that you and five friends step out of the square to have a side conversation. Does <em>that</em> conversation deserve strong privacy? It doesn&#8217;t really matter what you want, because <em>Telegram won&#8217;t provide it</em>, at least not with encryption that protects you from sharing your content with Telegram servers. </p>



<p>Similarly, imagine you use Telegram for its social media-like features, meaning that you mainly consume content rather than producing it. But one day your friend, who also uses Telegram for similar reasons, notices you&#8217;re on the platform and decides she wants to send you a private message. Are you concerned about privacy now? And are you each going to manually turn on the &#8220;Secret Chat&#8221; feature —&nbsp;even though it requires four explicit clicks through hidden menus, and even though it will prevent you from communicating immediately if one of you is offline?</p>



<p>My strong suspicion is that many people who join Telegram for its social media features also end up using it to communicate privately. And I think Telegram knows this, and tends to advertise itself as a &#8220;secure messenger&#8221; and talk about the platform&#8217;s encryption features precisely because they know it makes people feel more comfortable. But in practice, I also suspect that very few of those users are actually <em>using Telegram&#8217;s encryption</em>. Many of those users may not even realize they have to turn encryption on manually, and think they&#8217;re already using it. </p>



<p>Which brings me to my next point.</p>



<h3 class="wp-block-heading">Telegram knows its encryption is difficult to turn on, and they continue to promote their product as a secure messenger</h3>



<p>Telegram&#8217;s encryption has <a href="https://threadreaderapp.com/thread/1474067549574688768.html">been subject to</a> <a href="https://grugq.tumblr.com/post/133453305233/operational-telegram">heavy criticism</a> <a href="https://www.dailydot.com/debug/telegram-isis-encryption-cryptography/">since</a> <a href="https://cpj.org/2016/05/why-telegrams-security-flaws-may-put-irans-journal/">at least 2016</a> (and possibly earlier) for many of the reasons I outlined in this post. In fact, many of these criticisms were made by experts including myself, in years-old conversations with Pavel Durov on Twitter.<sup>1</sup></p>



<p>Although the interaction with Durov could sometimes be harsh, I still mostly assumed good faith from Telegram back in those days. I believed that Telegram was busy growing their network and that, in time, they would improve the quality and usability of the platform&#8217;s end-to-end encryption: for example, by activating it as a default, providing support for group chats, and making it possible to start encrypted chats with offline users. I assumed that while Telegram might be a follower rather than a leader, it would eventually reach feature parity with the encryption protocols offered by Signal and WhatsApp. Of course, a second possibility was that Telegram would abandon encryption entirely — and just focus on being a social media platform.</p>



<p>What&#8217;s actually happened is a lot more confusing to me.</p>



<p>Instead of improving the usability of Telegram&#8217;s end-to-end encryption, the owners of Telegram have more or less kept their encryption UX unchanged since 2016. While there have been a <a href="https://core.telegram.org/mtproto">few upgrades to the underlying encryption algorithms</a> used by the platform, the user-facing experience of Secret Chats in 2024 is almost identical to the one <a href="https://grugq.tumblr.com/post/133453305233/operational-telegram">you&#8217;d have seen eight years ago</a>. This, despite the fact that the number of Telegram users has grown by 7-9x during the same time period.</p>



<p>At the same time, Telegram CEO Pavel Durov has continued to aggressively market Telegram as a &#8220;secure messenger.&#8221; Most recently he <a href="https://www.theregister.com/2024/05/14/telegram_ceo_calls_out_rival/">issued a scathing criticism of</a> Signal and WhatsApp on his personal Telegram channel, implying that those systems were backdoored by the US government, and only Telegram&#8217;s independent encryption protocols were really trustworthy. </p>



<p>While this might be a reasonable nerd-argument if it was taking place between two platforms that both supported default end-to-end encryption, Telegram really has no legs to stand on in this particular discussion. Indeed, it no longer feels amusing to see the Telegram organization urge people away from default-encrypted messengers, while <em>refusing to implement essential features that would widely encrypt their own users&#8217; messages</em>. In fact, it&#8217;s starting to feel a bit malicious.</p>



<h3 class="wp-block-heading">What about the boring encryption details? </h3>



<p>This is a cryptography blog and so I&#8217;d be remiss if I didn&#8217;t spend at least a little bit of time on the boring encryption protocols. I&#8217;d also be missing a good opportunity to <em>let my mouth gape open in amazement</em>, which is pretty much what happens every time I look at the internals of Telegram&#8217;s encryption. </p>



<p>I&#8217;m going to handle this in one paragraph to reduce the pain, and you can feel free to skip past it if you&#8217;re not interested.</p>



<p>According to <a href="https://core.telegram.org/api/end-to-end">what I <em>think</em> is the latest encryption spec</a>, Telegram&#8217;s Secret Chats feature is based on a custom protocol called MTProto 2.0. This system uses 2048-bit* finite-field <a href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange">Diffie-Hellman</a> key agreement, with group parameters (I think) chosen by the server.* (Since the Diffie-Hellman protocol is only executed interactively, this is why Secret Chats cannot be set up when one user is offline.*) MITM protection is handled by the end-users, who must compare key fingerprints. There are some weird random nonces provided by the server, which I don&#8217;t fully understands the purpose of* — and that <a href="https://words.filippo.io/dispatches/telegram-ecdh/">in the past used to actively make the key exchange totally insecure against a malicious server</a> (but this has long since been fixed.*) The resulting keys are then used to power the most amazing, <a href="https://eprint.iacr.org/2015/1177.pdf">non-standard</a> authenticated encryption mode ever invented, something called &#8220;<a href="https://core.telegram.org/api/end-to-end">Infinite Garble Extension</a>&#8221; (IGE) based on AES and with SHA2 handling authentication.*</p>



<p>NB: Every place I put a &#8220;*&#8221; in the paragraph above is a point where expert cryptographers would, in the context of something like a professional security audit, raise their hands and ask <em>a lot</em> of questions. I&#8217;m not going to go further than this. Suffice it to say that Telegram&#8217;s encryption is unusual. </p>



<p>If you ask me to guess whether the protocol and implementation of Telegram Secret Chats is secure, I would say <em>quite</em> <em>possibly.</em> To be honest though, it doesn&#8217;t matter how secure something is if people aren&#8217;t actually using it.</p>



<h3 class="wp-block-heading">Is there anything else I should know?</h3>



<p>Yes, unfortunately. Even though end-to-end encryption is one of the best tools we&#8217;ve developed to prevent data compromise, it is hardly the end of the story. One of the biggest privacy problems in messaging is the availability of loads of meta-data — essentially data about who uses the service, who they talk to, and when they do that talking. </p>



<p>This data is not typically protected by end-to-end encryption. Even in applications that are broadcast-only, such as Telegram&#8217;s channels, there is plenty of useful metadata available about <em>who is listening to a broadcast.</em> That information alone is valuable to people, as evidenced by the enormous amounts of money that traditional broadcasters <a href="https://www.komando.com/news/security/stop-smart-tv-tracking/">spend to collect it</a>. Right now all of that information likely exists on Telegram&#8217;s servers, where it is available to anyone who wants to collect it.</p>



<p>I am not specifically calling out Telegram for this, since the same problem exists with virtually every other social media network and private messenger. But it should be mentioned, just to avoid leaving you with the conclusion that encryption is all we need. </p>



<p><em>Main photo &#8220;privacy screen&#8221; by <a href="https://www.flickr.com/photos/sjgolding/">Susan Jane Golding</a>, used under CC license. </em></p>



<p>Notes:</p>



<ol class="wp-block-list">
<li>I will never find all of these conversations again, thanks to Twitter search being so broken. If anyone can turn them up I&#8217;d appreciate it. </li>
</ol>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/messaging/" rel="category tag">messaging</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/" rel="bookmark"><time class="entry-date published" datetime="2024-08-25T18:36:30+00:00">August 25, 2024</time><time class="updated" datetime="2024-08-25T23:15:29+00:00">August 25, 2024</time></a></span><span class="word-count">2,290 Words</span><span class="comments-link"><a href="https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/#comments">52 Comments</a></span><!-- .comments-link -->		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
				
<article id="post-7785" class="post-7785 post type-post status-publish format-standard has-post-thumbnail hentry category-academics category-attacks category-pqc category-quantum tag-cryptography tag-cybersecurity tag-innovation tag-quantum-computing tag-technology">
			<header class="entry-header">
			<h1 class="entry-title"><a href="https://blog.cryptographyengineering.com/2024/04/16/a-quick-post-on-chens-algorithm/" rel="bookmark">A quick post on Chen&#8217;s&nbsp;algorithm</a></h1>		</header><!-- .entry-header -->	<div class="post-image-link"><a rel="bookmark" href="https://blog.cryptographyengineering.com/2024/04/16/a-quick-post-on-chens-algorithm/"><img width="700" height="430" src="https://blog.cryptographyengineering.com/wp-content/uploads/2024/04/20180405-ibm-q-quantum-computer-02.jpg?w=700&amp;h=430&amp;crop=1" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="A quick post on Chen&#8217;s&nbsp;algorithm" decoding="async" loading="lazy" srcset="https://blog.cryptographyengineering.com/wp-content/uploads/2024/04/20180405-ibm-q-quantum-computer-02.jpg?w=700&amp;h=430&amp;crop=1 700w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/04/20180405-ibm-q-quantum-computer-02.jpg?w=150&amp;h=92&amp;crop=1 150w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/04/20180405-ibm-q-quantum-computer-02.jpg?w=300&amp;h=184&amp;crop=1 300w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/04/20180405-ibm-q-quantum-computer-02.jpg?w=768&amp;h=472&amp;crop=1 768w, https://blog.cryptographyengineering.com/wp-content/uploads/2024/04/20180405-ibm-q-quantum-computer-02.jpg?w=1024&amp;h=629&amp;crop=1 1024w" sizes="(max-width: 700px) 100vw, 700px" data-attachment-id="7797" data-permalink="https://blog.cryptographyengineering.com/2024/04/16/a-quick-post-on-chens-algorithm/20180405-ibm-q-quantum-computer-02/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/04/20180405-ibm-q-quantum-computer-02.jpg" data-orig-size="1200,675" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="20180405-ibm-q-quantum-computer-02" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/04/20180405-ibm-q-quantum-computer-02.jpg?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2024/04/20180405-ibm-q-quantum-computer-02.jpg?w=700" /></a></div><!-- .post-image-link -->
	<div class="entry-content">
		
<p><strong>Update</strong> <strong>(April 19): </strong><em>Yilei Chen <a href="http://www.chenyilei.net/">announced the discovery of a bug</a> in the algorithm, which he does not know how to fix. This was independently discovered by Hongxun Wu and Thomas Vidick. At present, the paper does not provide a polynomial-time algorithm for solving LWE.</em> </p>



<p>If you&#8217;re a normal person — that is, a person who doesn&#8217;t obsessively follow the latest cryptography news — you probably missed last week&#8217;s cryptography bombshell. That news comes in the form of a new e-print authored by Yilei Chen, &#8220;<a href="https://eprint.iacr.org/2024/555">Quantum Algorithms for Lattice Problems</a>&#8220;, which has roiled the cryptography research community. The result is now being evaluated by experts in lattices and quantum algorithm design (<em>and to be clear, I am not one!</em>) but if it holds up, it&#8217;s going to be quite a bad day/week/month/year for the applied cryptography community.</p>



<p>Rather than elaborate at length, here&#8217;s quick set of five bullet-points giving the background.</p>



<p>(1) Cryptographers like to build modern public-key encryption schemes on top of mathematical problems that are believed to be &#8220;hard&#8221;. In practice, we need problems with a specific structure: we can construct <em>efficient</em> solutions for those who hold a secret key, or &#8220;trapdoor&#8221;, and yet also admit <em>no efficient solution</em> for folks who don&#8217;t. While many problems have been considered (and often discarded), most schemes we use today are based on three problems: <a href="https://en.wikipedia.org/wiki/Integer_factorization">factoring</a> (the RSA cryptosystem), <a href="https://en.wikipedia.org/wiki/Discrete_logarithm">discrete logarithm</a> (Diffie-Hellman, DSA) and <a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">elliptic curve discrete logarithm problem</a> (EC-Diffie-Hellman, ECDSA etc.)</p>



<p>(2) While we would like to believe our favorite problems are fundamentally &#8220;hard&#8221;, we know this isn&#8217;t really true. Researchers <a href="https://en.wikipedia.org/wiki/Shor%27s_algorithm">have devised algorithms</a> that solve all of these problems quite efficiently (i.e., in polynomial time) — provided someone figures out how to build a quantum computer powerful enough to run the attack algorithms. <em>Fortunately such a computer has not yet been built!</em></p>



<p>(3) Even though quantum computers are not yet powerful enough to break our public-key crypto, the mere threat of <em>future</em> quantum attacks has inspired industry, government and academia to join forces <a href="https://csrc.nist.gov/projects/post-quantum-cryptography">Fellowship-of-the-Ring-style</a> in order to tackle the problem right now. This isn&#8217;t merely about future-proofing our systems: even if quantum computers take decades to build, future quantum computers could break encrypted messages we send <em>today</em>! </p>



<p>(4) One conspicuous outcome of this fellowship is <a href="https://www.nist.gov/news-events/news/2022/07/nist-announces-first-four-quantum-resistant-cryptographic-algorithms">NIST&#8217;s Post-Quantum Cryptography (PQC) competition</a>: this was an open competition designed to standardize<em> &#8220;post-quantum&#8221; cryptographic schemes</em>. Critically, these schemes must be based on different mathematical problems — most notably, problems that <em>don&#8217;t</em> seem to admit efficient quantum solutions. </p>



<p>(5) Within this new set of schemes, the most popular class of schemes are based on problems related to mathematical objects called <em><a href="https://en.wikipedia.org/wiki/Lattice-based_cryptography">lattices</a></em>. NIST-approved schemes based on lattice problems include <a href="https://en.wikipedia.org/wiki/Kyber">Kyber</a> and <a href="https://pq-crystals.org/dilithium/">Dilithium</a> (which I <a href="https://blog.cryptographyengineering.com/2023/11/30/to-schnorr-and-beyond-part-2/">wrote about recently</a>.) Lattice problems are also the basis of several efficient <a href="https://blog.cryptographyengineering.com/2012/01/02/very-casual-introduction-to-fully/">fully-homomorphic encryption</a> (FHE) schemes.</p>



<p>This background sets up the new result.</p>



<p>Chen&#8217;s (not yet peer-reviewed) <a href="https://eprint.iacr.org/2024/555">preprint</a> claims a<em> </em>new quantum algorithm that efficiently solves the &#8220;shortest independent vector problem&#8221; (SIVP, as well as GapSVP) in lattices with specific parameters. If it holds up, the result could (with numerous important caveats) allow future quantum computers to break schemes that depend on the hardness of specific instances of these problems. The good news here is that even if the result is correct, the vulnerable parameters are very specific: Chen&#8217;s algorithm does not <em>immediately</em> apply to the <a href="https://www.nist.gov/news-events/news/2022/07/nist-announces-first-four-quantum-resistant-cryptographic-algorithms">recently-standardized NIST algorithms</a> such as Kyber or Dilithium. Moreover, the exact concrete complexity of the algorithm is not instantly clear: it may turn out to be impractical to run, even if quantum computers become available.</p>



<p>But there is a saying in our field that <em>attacks only get better. </em>If Chen&#8217;s result can be improved upon, then quantum algorithms could render obsolete an entire generation of &#8220;post-quantum&#8221; lattice-based schemes, forcing cryptographers <a href="https://security.apple.com/blog/imessage-pq3/">and</a> <a href="https://signal.org/blog/pqxdh/">industry</a> <a href="https://bughunters.google.com/blog/5108747984306176/google-s-threat-model-for-post-quantum-cryptography">back</a> to the drawing board.</p>



<p>In other words, both a great technical result — and possibly a mild disaster.</p>



<p>As previously mentioned: I am neither an expert in lattice-based cryptography nor quantum computing. The folks who <em>are</em> those things are very busy trying to validate the writeup<em>:</em> and more than a few big results have fallen apart upon detailed inspection.<em> </em>For those searching for the latest developments, here&#8217;s a <a href="https://nigelsmart.github.io/LWE.html">nice writeup by Nigel Smart</a> that doesn&#8217;t tackle the correctness of the quantum algorithm (see updates at the bottom), but does talk about the possible implications for FHE and PQC schemes (TL;DR: bad for some FHE schemes, but really depends on the concrete details of the algorithm&#8217;s running time.) And here&#8217;s another <a href="https://eprint.iacr.org/2024/583.pdf">brief note on a &#8220;bug&#8221; that was found in the paper</a>, that seems to have been quickly <a href="http://www.chenyilei.net/">addressed by the author.</a></p>



<p>Up until this week I had intended to write another long wonky post about complexity theory, lattices, and what it all meant for applied cryptography. But now I hope you&#8217;ll forgive me if I hold onto that one, for just a little bit longer.</p>
	</div><!-- .entry-content -->

	<footer class="entry-footer">
		
		<div class="post-details">
			By <span class="author vcard"><a class="url fn n" href="https://blog.cryptographyengineering.com/author/matthewdgreen/">Matthew Green</a></span><span class="cat-links">in <a href="https://blog.cryptographyengineering.com/category/academics/" rel="category tag">academics</a>, <a href="https://blog.cryptographyengineering.com/category/attacks/" rel="category tag">attacks</a>, <a href="https://blog.cryptographyengineering.com/category/pqc/" rel="category tag">pqc</a>, <a href="https://blog.cryptographyengineering.com/category/quantum/" rel="category tag">quantum</a></span><span class="post-permalink"><a href="https://blog.cryptographyengineering.com/2024/04/16/a-quick-post-on-chens-algorithm/" rel="bookmark"><time class="entry-date published" datetime="2024-04-16T18:28:39+00:00">April 16, 2024</time><time class="updated" datetime="2024-04-19T14:19:18+00:00">April 19, 2024</time></a></span><span class="word-count">807 Words</span>		</div><!-- .post-details -->
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			
			
	<nav class="navigation posts-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Posts navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://blog.cryptographyengineering.com/page/2/" >Older posts</a></div></div>
	</nav>
		
		</main><!-- #main -->
	</div><!-- #primary -->


		</div><!-- #content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
			<div class="site-info">
				<a href="https://wordpress.com/?ref=footer_custom_svg" title="Create a website or blog at WordPress.com" rel="nofollow"><svg style="fill: currentColor; position: relative; top: 1px;" width="14px" height="15px" viewBox="0 0 14 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-labelledby="title" role="img">
				<desc id="title">Create a website or blog at WordPress.com</desc>
				<path d="M12.5225848,4.97949746 C13.0138466,5.87586309 13.2934037,6.90452431 13.2934037,7.99874074 C13.2934037,10.3205803 12.0351007,12.3476807 10.1640538,13.4385638 L12.0862862,7.88081544 C12.4453251,6.98296834 12.5648813,6.26504621 12.5648813,5.62667922 C12.5648813,5.39497674 12.549622,5.17994084 12.5225848,4.97949746 L12.5225848,4.97949746 Z M7.86730089,5.04801561 C8.24619178,5.02808979 8.58760099,4.98823815 8.58760099,4.98823815 C8.9267139,4.94809022 8.88671369,4.44972248 8.54745263,4.46957423 C8.54745263,4.46957423 7.52803983,4.54957381 6.86996227,4.54957381 C6.25158863,4.54957381 5.21247202,4.46957423 5.21247202,4.46957423 C4.87306282,4.44972248 4.83328483,4.96816418 5.17254589,4.98823815 C5.17254589,4.98823815 5.49358462,5.02808979 5.83269753,5.04801561 L6.81314716,7.73459399 L5.43565839,11.8651647 L3.14394256,5.04801561 C3.52312975,5.02808979 3.86416859,4.98823815 3.86416859,4.98823815 C4.20305928,4.94809022 4.16305906,4.44972248 3.82394616,4.46957423 C3.82394616,4.46957423 2.80475558,4.54957381 2.14660395,4.54957381 C2.02852925,4.54957381 1.88934333,4.54668493 1.74156477,4.54194422 C2.86690406,2.83350881 4.80113651,1.70529256 6.99996296,1.70529256 C8.638342,1.70529256 10.1302017,2.33173369 11.2498373,3.35765419 C11.222726,3.35602457 11.1962815,3.35261718 11.1683554,3.35261718 C10.5501299,3.35261718 10.1114609,3.89113285 10.1114609,4.46957423 C10.1114609,4.98823815 10.4107217,5.42705065 10.7296864,5.94564049 C10.969021,6.36482346 11.248578,6.90326506 11.248578,7.68133501 C11.248578,8.21992476 11.0413918,8.84503256 10.7696866,9.71584277 L10.1417574,11.8132391 L7.86730089,5.04801561 Z M6.99996296,14.2927074 C6.38218192,14.2927074 5.78595654,14.2021153 5.22195356,14.0362644 L7.11048207,8.54925635 L9.04486267,13.8491542 C9.05760348,13.8802652 9.07323319,13.9089317 9.08989995,13.9358945 C8.43574834,14.1661896 7.73285573,14.2927074 6.99996296,14.2927074 L6.99996296,14.2927074 Z M0.706448182,7.99874074 C0.706448182,7.08630113 0.902152921,6.22015756 1.25141403,5.43749503 L4.25357806,13.6627848 C2.15393732,12.6427902 0.706448182,10.4898387 0.706448182,7.99874074 L0.706448182,7.99874074 Z M6.99996296,0.999 C3.14016476,0.999 0,4.13905746 0,7.99874074 C0,11.8585722 3.14016476,14.999 6.99996296,14.999 C10.8596871,14.999 14,11.8585722 14,7.99874074 C14,4.13905746 10.8596871,0.999 6.99996296,0.999 L6.99996296,0.999 Z" id="wordpress-logo-simplified-cmyk" stroke="none" fill=“currentColor” fill-rule="evenodd"></path>
			</svg></a>
				
							</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #content-wrapper -->

			<div id="slide-menu" aria-expanded="false">
			<button class="menu-toggle" aria-controls="slide-menu" aria-expanded="false">Menu</button>

			<h2 class="menu-title">Menu</h2>
			<nav id="slide-navigation" class="main-slide-navigation" role="navigation">
				<ul id="menu-about" class="menu"><li id="menu-item-860" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-860"><a href="https://matthewdgreen.wordpress.com">Home</a></li>
<li id="menu-item-871" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-871"><a href="https://blog.cryptographyengineering.com/about-me/">About Me</a></li>
<li id="menu-item-872" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-872"><a href="https://blog.cryptographyengineering.com/bitcoin-tipjar/">Bitcoin Tipjar</a></li>
<li id="menu-item-1249" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1249"><a href="https://blog.cryptographyengineering.com/top-posts/">Top Posts</a></li>
<li id="menu-item-1232" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1232"><a href="https://blog.cryptographyengineering.com/all-posts/">All Posts</a></li>
<li id="menu-item-873" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-873"><a href="https://blog.cryptographyengineering.com/useful-cryptography-resources/">Useful Cryptography Resources</a></li>
</ul>			</nav><!-- #slide-navigation -->

					</div><!-- #slide-menu -->
	</div><!-- #page -->

		<script type="text/javascript">
		var infiniteScroll = {"settings":{"id":"main","ajaxurl":"https:\/\/blog.cryptographyengineering.com\/?infinity=scrolling","type":"scroll","wrapper":true,"wrapper_class":"infinite-wrap","footer":"page","click_handle":"1","text":"Older posts","totop":"Scroll back to top","currentday":"16.04.24","order":"DESC","scripts":[],"styles":[],"google_analytics":false,"offset":1,"history":{"host":"blog.cryptographyengineering.com","path":"\/page\/%d\/","use_trailing_slashes":true,"parameters":""},"query_args":{"error":"","m":"","p":0,"post_parent":"","subpost":"","subpost_id":"","attachment":"","attachment_id":0,"name":"","pagename":"","page_id":0,"second":"","minute":"","hour":"","day":0,"monthnum":0,"year":0,"w":0,"category_name":"","tag":"","cat":"","tag_id":"","author":"","author_name":"","feed":"","tb":"","paged":0,"meta_key":"","meta_value":"","preview":"","s":"","sentence":"","title":"","fields":"all","menu_order":"","embed":"","category__in":[],"category__not_in":[],"category__and":[],"post__in":[],"post__not_in":[],"post_name__in":[],"tag__in":[],"tag__not_in":[],"tag__and":[],"tag_slug__in":[],"tag_slug__and":[],"post_parent__in":[],"post_parent__not_in":[],"author__in":[],"author__not_in":[],"search_columns":[],"lazy_load_term_meta":false,"posts_per_page":10,"ignore_sticky_posts":false,"suppress_filters":false,"cache_results":true,"update_post_term_cache":true,"update_menu_item_cache":false,"update_post_meta_cache":true,"post_type":"","nopaging":false,"comments_per_page":"50","no_found_rows":false,"order":"DESC"},"query_before":"2025-06-22 07:52:42","last_post_date":"2024-04-16 18:28:39","body_class":"infinite-scroll neverending","loading_text":"Loading new page","stats":"blog=9549322&v=wpcom&tz=0&user_id=0&arch_home=1&subd=matthewdgreen&x_pagetype=infinite"}};
		</script>
		<!--  -->
<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/files\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/pub\/independent-publisher\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="importmap" id="wp-importmap">
{"imports":{"@wordpress\/interactivity":"https:\/\/s0.wp.com\/wp-content\/plugins\/gutenberg-core\/v20.6.0\/build-module\/interactivity\/index.min.js?ver=d9948f13df6155717023"}}
</script>
<script type="module" src="https://s2.wp.com/wp-content/mu-plugins/jetpack-plugin/moon/jetpack_vendor/automattic/jetpack-forms/src/contact-form/../../dist/modules/form/view.js?ver=14.8-a.6" id="jp-forms-view-js-module"></script>
<link rel="modulepreload" href="https://s0.wp.com/wp-content/plugins/gutenberg-core/v20.6.0/build-module/interactivity/index.min.js?ver=d9948f13df6155717023" id="@wordpress/interactivity-js-modulepreload"><script type="application/json" id="wp-script-module-data-@wordpress/interactivity">
{"config":{"jetpack/form":{"error_types":{"is_required":"This field is required.","invalid_form_empty":"The form you are trying to submit is empty.","invalid_form":"Please fill out the form correctly."}}}}
</script>
<script type="text/javascript" src="//0.gravatar.com/js/hovercards/hovercards.min.js?ver=20252517d2298fc173af206bd9f65440008ab9e1ee2bd896241083289a9e27bd0efc7c" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240i'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile →': 'Edit your profile →',
							'View profile →': 'View profile →',
							'Contact': 'Contact',
							'Send money': 'Send money',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Gravatar not found.': 'Gravatar not found.',
							'Too Many Requests.': 'Too Many Requests.',
							'Internal Server Error.': 'Internal Server Error.',
							'Is this you?': 'Is this you?',
							'Claim your free profile.': 'Claim your free profile.',
							'Email': 'Email',
							'Home Phone': 'Home Phone',
							'Work Phone': 'Work Phone',
							'Cell Phone': 'Cell Phone',
							'Contact Form': 'Contact Form',
							'Calendar': 'Calendar',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	</div>
		<div id="infinite-footer">
			<div class="container">
				<div class="blog-info">
					<a id="infinity-blog-title" href="https://blog.cryptographyengineering.com/" rel="home">
						A Few Thoughts on Cryptographic Engineering					</a>
				</div>
				<div class="blog-credits">
					<a href="https://wordpress.com/?ref=footer_custom_svg" title="Create a website or blog at WordPress.com" rel="nofollow"><svg style="fill: currentColor; position: relative; top: 1px;" width="14px" height="15px" viewBox="0 0 14 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-labelledby="title" role="img">
				<desc id="title">Create a website or blog at WordPress.com</desc>
				<path d="M12.5225848,4.97949746 C13.0138466,5.87586309 13.2934037,6.90452431 13.2934037,7.99874074 C13.2934037,10.3205803 12.0351007,12.3476807 10.1640538,13.4385638 L12.0862862,7.88081544 C12.4453251,6.98296834 12.5648813,6.26504621 12.5648813,5.62667922 C12.5648813,5.39497674 12.549622,5.17994084 12.5225848,4.97949746 L12.5225848,4.97949746 Z M7.86730089,5.04801561 C8.24619178,5.02808979 8.58760099,4.98823815 8.58760099,4.98823815 C8.9267139,4.94809022 8.88671369,4.44972248 8.54745263,4.46957423 C8.54745263,4.46957423 7.52803983,4.54957381 6.86996227,4.54957381 C6.25158863,4.54957381 5.21247202,4.46957423 5.21247202,4.46957423 C4.87306282,4.44972248 4.83328483,4.96816418 5.17254589,4.98823815 C5.17254589,4.98823815 5.49358462,5.02808979 5.83269753,5.04801561 L6.81314716,7.73459399 L5.43565839,11.8651647 L3.14394256,5.04801561 C3.52312975,5.02808979 3.86416859,4.98823815 3.86416859,4.98823815 C4.20305928,4.94809022 4.16305906,4.44972248 3.82394616,4.46957423 C3.82394616,4.46957423 2.80475558,4.54957381 2.14660395,4.54957381 C2.02852925,4.54957381 1.88934333,4.54668493 1.74156477,4.54194422 C2.86690406,2.83350881 4.80113651,1.70529256 6.99996296,1.70529256 C8.638342,1.70529256 10.1302017,2.33173369 11.2498373,3.35765419 C11.222726,3.35602457 11.1962815,3.35261718 11.1683554,3.35261718 C10.5501299,3.35261718 10.1114609,3.89113285 10.1114609,4.46957423 C10.1114609,4.98823815 10.4107217,5.42705065 10.7296864,5.94564049 C10.969021,6.36482346 11.248578,6.90326506 11.248578,7.68133501 C11.248578,8.21992476 11.0413918,8.84503256 10.7696866,9.71584277 L10.1417574,11.8132391 L7.86730089,5.04801561 Z M6.99996296,14.2927074 C6.38218192,14.2927074 5.78595654,14.2021153 5.22195356,14.0362644 L7.11048207,8.54925635 L9.04486267,13.8491542 C9.05760348,13.8802652 9.07323319,13.9089317 9.08989995,13.9358945 C8.43574834,14.1661896 7.73285573,14.2927074 6.99996296,14.2927074 L6.99996296,14.2927074 Z M0.706448182,7.99874074 C0.706448182,7.08630113 0.902152921,6.22015756 1.25141403,5.43749503 L4.25357806,13.6627848 C2.15393732,12.6427902 0.706448182,10.4898387 0.706448182,7.99874074 L0.706448182,7.99874074 Z M6.99996296,0.999 C3.14016476,0.999 0,4.13905746 0,7.99874074 C0,11.8585722 3.14016476,14.999 6.99996296,14.999 C10.8596871,14.999 14,11.8585722 14,7.99874074 C14,4.13905746 10.8596871,0.999 6.99996296,0.999 L6.99996296,0.999 Z" id="wordpress-logo-simplified-cmyk" stroke="none" fill=“currentColor” fill-rule="evenodd"></path>
			</svg></a> 				</div>
			</div>
		</div><!-- #infinite-footer -->
				<div id="actionbar" dir="ltr" style="display: none;"
			class="actnbr-pub-independent-publisher actnbr-has-follow actnbr-has-actions">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://blog.cryptographyengineering.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				A Few Thoughts on Cryptographic Engineering			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																						<div class="actnbr-follow-count">Join 1,032 other subscribers</div>
																					<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address" />
										</div>
										<input type="hidden" name="action" value="subscribe" />
										<input type="hidden" name="blog_id" value="9549322" />
										<input type="hidden" name="source" value="https://blog.cryptographyengineering.com/" />
										<input type="hidden" name="sub-type" value="actionbar-follow" />
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="15fd5f7741" />										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.cryptographyengineering.com%252F2025%252F06%252F09%252Fa-bit-more-on-twitter-xs-new-encrypted-messaging%252F">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"/></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
								<li class="actnbr-sitename">
			<a href="https://blog.cryptographyengineering.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				A Few Thoughts on Cryptographic Engineering			</a>
		</li>
								<li class="actnbr-folded-follow">
										<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
								</li>
														<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
							<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.cryptographyengineering.com%252F2025%252F06%252F09%252Fa-bit-more-on-twitter-xs-new-encrypted-messaging%252F">Log in</a></li>
															<li class="flb-report">
									<a href="https://wordpress.com/abuse/?report_url=https://blog.cryptographyengineering.com" target="_blank" rel="noopener noreferrer">
										Report this content									</a>
								</li>
															<li class="actnbr-reader">
									<a href="https://wordpress.com/reader/feeds/53033543">
										View site in Reader									</a>
								</li>
															<li class="actnbr-subs">
									<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
								</li>
																<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
														</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20250116";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20250204";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-2' href='https://s1.wp.com/_static/??-eJytjcEKwjAQRH/IuBar4kH8ljRZQuomG7IbQv9eC/YqKF6GmWF4A70Yx1kxK6RmCrUQs8CMWqx7vDMk5lV8IxTo0QdUAeViCsvLiS6Eeyeyg+9xzlZuggTSY8Fqppb9H2jbaCt+BWok9CZYIqzLp7Qe3NNtuIyn63Aej4f5CTCIg9Y=&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" src="https://s1.wp.com/wp-content/js/mobile-useragent-info.js?m=1609849039i&amp;ver=20241018" id="mobile-useragent-info-js" defer="defer" data-wp-strategy="defer"></script>
<script type="text/javascript" id="coblocks-loader-js-extra">
/* <![CDATA[ */
var wpcom_coblocks_js = {"coblocks_masonry_js":"https:\/\/s2.wp.com\/wp-content\/plugins\/coblocks\/2.18.1-simple-rev.4\/dist\/js\/coblocks-masonry.min.js","coblocks_lightbox_js":"https:\/\/s2.wp.com\/wp-content\/plugins\/coblocks\/2.18.1-simple-rev.4\/dist\/js\/coblocks-lightbox.min.js","jquery_core_js":"\/wp-includes\/js\/jquery\/jquery.min.js","jquery_migrate_js":"\/wp-includes\/js\/jquery\/jquery-migrate.min.js","masonry_js":"\/wp-includes\/js\/masonry.min.js","imagesloaded_js":"\/wp-includes\/js\/imagesloaded.min.js"};
var coblocksLigthboxData = {"closeLabel":"Close Gallery","leftLabel":"Previous","rightLabel":"Next"};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/blog.cryptographyengineering.com\/wp-admin\/admin-ajax.php","nonce":"997cc49447","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/matthewdgreen.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fblog.cryptographyengineering.com%2F2025%2F06%2F09%2Fa-bit-more-on-twitter-xs-new-encrypted-messaging%2F","blog_id":"9549322","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=9549322&v=wpcom&tz=0&user_id=0&arch_home=1&subd=matthewdgreen","is_public":"1"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/_static/??-eJyd0dFOwzAMBdAfwrWKug0eEJ+C2tTd3Dp2VCfb+HtaaQWEeIC9RLqRcyJd4yVBMM2kGWOBJOXI6jhSTm2YbhmjmeIba8CusPTIOrByJvAwm8iW36vIWo3+gN/UjQzWiYXJ8bGqn6oanGMSgpnOVYM9e8bxawjE2p7m37x8okiOqXTLtz0lWg7NsGRhP9G8MkPRkNnU73nswj2Btmc+titylzFxAmGdYLBQHAa+/ptZ61765ZThkoLFn8Df1xXa2YqTfM5tF7d+X+NLfWj2u+bwvN+NH30uxsU='></script>
<script type="text/javascript" crossorigin='anonymous' src="https://s0.wp.com/wp-content/mu-plugins/jetpack-plugin/moon/_inc/build/tiled-gallery/tiled-gallery/tiled-gallery.min.js?m=1725888675i&amp;ver=14.8-a.6" id="tiled-gallery-js" defer="defer" data-wp-strategy="defer"></script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s0.wp.com/wp-content/mu-plugins/carousel-wpcom/carousel-wpcom.js?m=1620989527i'></script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
		<script type="text/javascript">
			(function() {
				var extend = function(out) {
					out = out || {};

					for (var i = 1; i < arguments.length; i++) {
						if (!arguments[i])
						continue;

						for (var key in arguments[i]) {
						if (arguments[i].hasOwnProperty(key))
							out[key] = arguments[i][key];
						}
					}

					return out;
				};
				extend( window.infiniteScroll.settings.scripts, ["jetpack-mu-wpcom-settings","rlt-proxy","jquery-core","jquery-migrate","jquery","wpcom-actionbar-placeholder","grofiles-cards","wpgroho","mobile-useragent-info","the-neverending-homepage","coblocks-loader","independent-publisher-script","independent-publisher-navigation","independent-publisher-skip-link-focus-fix","independent-publisher-wpcom-functions","jetpack-carousel","tiled-gallery","carousel-wpcom"] );
				extend( window.infiniteScroll.settings.styles, ["the-neverending-homepage","wp-block-library","jetpack-layout-grid","jetpack-ratings","mediaelement","wp-mediaelement","coblocks-frontend","wpcom-core-compat-playlist-styles","wpcom-text-widget-styles","wpcom-bbpress2-staff-css","genericons","independent-publisher-style","independent-publisher-wpcom-style","reblogging","geo-location-flair","a8c-global-print","h4-global","wp-emoji-styles","classic-theme-styles","videopress-video-style","jetpack-sharing-buttons-style","global-styles","independent-publisher-fonts","jetpack-global-styles-frontend-style","jetpack-top-posts-widget","jetpack-carousel-swiper-css","jetpack-carousel","tiled-gallery","core-block-supports-duotone"] );
			})();
		</script>
				<span id="infinite-aria" aria-live="polite"></span>
		<script src="//stats.wp.com/w.js?68" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'9549322','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'9549322','v':'wpcom','tz':'0','user_id':'0','arch_home':'1','subd':'matthewdgreen'}]);
_stq.push(['extra', {'crypt':'UE5tW3cvZGRTd1VXTHx0Q0pyYT89K3QrZXh+YlZKVEp3X2Z4d2lWfG5QN2wzaCV3czAtUzk5X19SflczRll4NGxhRnwzVl09PU9ObC0wanxVY3p4MEMsb21iemh4NmYxT1NRemppUXNGWmdoRk1LSEdDVjBkdmRMUWgwSjdzdVoyTkRLSk5XPS05a1JkJS5wcD1ISUhzRldPdy4tTFFlLFtdajl+VFNtXV8xMi8/bkIweEVdPXc0ZmRySFBXOXcvaDF1WEgmcUxBdy43Wy1nLVFoM0pELzZKcUNXa0pROVp+aF9qTV0yRDQ='}]);
_stq.push([ 'clickTrackerInit', '9549322', '0' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script defer id="bilmur" data-custom-props="{&quot;enq_jquery&quot;:&quot;1&quot;,&quot;logged_in&quot;:&quot;0&quot;,&quot;wptheme&quot;:&quot;pub\/independent-publisher&quot;,&quot;wptheme_is_block&quot;:&quot;0&quot;}" data-provider="wordpress.com" data-service="simple" data-site-tz="Etc/GMT-0"  src="/wp-content/js/bilmur.min.js?i=15&m=202525"></script><script>
( function() {
	function getMobileUserAgentInfo() {
		if ( typeof wpcom_mobile_user_agent_info === 'object' ) {
			wpcom_mobile_user_agent_info.init();
			var mobileStatsQueryString = '';

			if ( wpcom_mobile_user_agent_info.matchedPlatformName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
			}

			if ( wpcom_mobile_user_agent_info.matchedUserAgentName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
			}

			if ( wpcom_mobile_user_agent_info.isIPad() ) {
				mobileStatsQueryString += '&x_' + 'ipad_views' + '=' + 'views';
			}

			if ( mobileStatsQueryString != '' ) {
				new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
			}
		}
	}

	document.addEventListener( 'DOMContentLoaded', getMobileUserAgentInfo );
} )();
</script>
</body>
</html>
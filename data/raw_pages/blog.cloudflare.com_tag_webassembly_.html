<!DOCTYPE html><html lang="en-us" dir="ltr"> <head><script async src="https://ot.www.cloudflare.com/public/vendor/onetrust/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" data-domain-script="b1e05d49-f072-4bae-9116-bdb78af15448"></script><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="KeThzeyMOr"><meta name="baidu-site-verification" content="code-NIlrS7gNhx"><meta charset="UTF-8"><meta name="description" content="Get the latest news on how products at Cloudflare are built, technologies used, and open positions to join the teams helping to build a better Internet."><title>WebAssembly</title><meta name="title" content="WebAssembly"><meta name="msvalidate.01" content="CF295E1604697F9CAD18B5A232E871F6"><meta class="swiftype" name="language" data-type="string" content="en"><script src="/static/z/i.js" type="text/javascript" referrerpolicy="origin"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-32x32.png"><link rel="mask-icon" href="/images/favicon-32x32.png" color="#f78100"><link rel="stylesheet" href="/themes/ashes.min.css"><link rel="sitemap" href="/sitemap.xml"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link rel="canonical" href="https://blog.cloudflare.com/tag/webassembly/"><link rel="alternate" type="application/rss+xml" title="Cloudflare Webassembly RSS Feed" href="/tag/webassembly/rss"><link rel="alternate" hreflang="en-us" href="https://blog.cloudflare.com/tag/webassembly/"><link rel="alternate" hreflang="de-de" href="https://blog.cloudflare.com/de-de/tag/webassembly/"><link rel="alternate" hreflang="es-es" href="https://blog.cloudflare.com/es-es/tag/webassembly/"><link rel="alternate" hreflang="fr-fr" href="https://blog.cloudflare.com/fr-fr/tag/webassembly/"><link rel="alternate" hreflang="zh-tw" href="https://blog.cloudflare.com/zh-tw/tag/webassembly/"><link rel="alternate" hreflang="zh-cn" href="https://blog.cloudflare.com/zh-cn/tag/webassembly/"><link rel="alternate" hreflang="pt-br" href="https://blog.cloudflare.com/pt-br/tag/webassembly/"><!-- General Meta Tags --><meta property="article:publisher" content="https://www.facebook.com/cloudflare"><!-- Facebook Meta Tags --><meta property="og:site_name" content="The Cloudflare Blog"><meta property="og:type" content="website"><meta property="og:title" content="The Cloudflare Blog: WebAssembly"><meta property="og:description" content="Collection of Cloudflare blog posts tagged 'WebAssembly'"><meta property="og:url" content="https://blog.cloudflare.com/tag/webassembly/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="628"><!-- Twitter/X Meta Tags --><meta name="twitter:title" content="The Cloudflare Blog: WebAssembly"><meta name="twitter:description" content="Collection of Cloudflare blog posts tagged 'WebAssembly'"><meta name="twitter:url" content="https://blog.cloudflare.com/tag/webassembly/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@cloudflare"><meta property="og:image"><meta name="twitter:image"><link rel="stylesheet" href="/_astro/index.DAblDsYO.css"></head><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z2ccO3m" component-url="/_astro/GoogleAnalytics.o7SaAFZX.js" component-export="GoogleAnalytics" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;title&quot;:[0,&quot;WebAssembly&quot;],&quot;canonical&quot;:[0,&quot;https://blog.cloudflare.com/tag/webassembly&quot;],&quot;info&quot;:[0],&quot;tagInfo&quot;:[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/webassembly&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;visibility&quot;:[0,&quot;public&quot;],&quot;feature_image&quot;:[0,&quot;&quot;],&quot;publicly_index&quot;:[0,true]}],&quot;authorInfo&quot;:[0],&quot;translatedPosts&quot;:[1,[]]}" ssr client="only" opts="{&quot;name&quot;:&quot;GoogleAnalytics&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island><script>(()=>{var l=(n,t)=>{let i=async()=>{await(await n())()},e=typeof t.value=="object"?t.value:void 0,s={timeout:e==null?void 0:e.timeout};"requestIdleCallback"in window?window.requestIdleCallback(i,s):setTimeout(i,s.timeout||200)};(self.Astro||(self.Astro={})).idle=l;window.dispatchEvent(new Event("astro:idle"));})();</script><astro-island uid="O7JsU" prefix="r8" component-url="/_astro/Navigation.JWiNRNo9.js" component-export="Navigation" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;logo&quot;:[0,&quot;//images.ctfassets.net/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png&quot;],&quot;pagesStore&quot;:[0,{&quot;page&quot;:[0,&quot;Tag&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;],&quot;translationsAvailable&quot;:[1,[[0,&quot;de-de&quot;],[0,&quot;es-es&quot;],[0,&quot;fr-fr&quot;],[0,&quot;zh-tw&quot;],[0,&quot;zh-cn&quot;],[0,&quot;pt-br&quot;]]],&quot;navData&quot;:[1,[[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T22:44:28.803Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-06-17T05:04:39.288Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,153],&quot;revision&quot;:[0,44],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;AI&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:21.536Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-05-19T05:03:04.375Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,135],&quot;revision&quot;:[0,46],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Developers&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;5kZtWqjqa7aOUoZr8NFGwI&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:26.040Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-30T14:03:57.409Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,142],&quot;revision&quot;:[0,43],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;name&quot;:[0,&quot;Radar&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:20.198Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-09T11:02:56.665Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,68],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Product News&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:42:46.231Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-09T11:02:54.136Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,134],&quot;revision&quot;:[0,41],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Security&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;16yk8DVbNNifxov5cWvAov&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:56:23.848Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:54.104Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,65],&quot;revision&quot;:[0,29],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;name&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;slug&quot;:[0,&quot;policy&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:46.068Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:53.720Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,136],&quot;revision&quot;:[0,44],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Zero Trust&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;48r7QV00gLMWOIcM1CSDRy&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:54:22.790Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:52.422Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,66],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;name&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;slug&quot;:[0,&quot;speed-and-reliability&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4g8tPriKOAUwdUT4jNPebe&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:40.927Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:51.235Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,77],&quot;revision&quot;:[0,29],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;name&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;slug&quot;:[0,&quot;life-at-cloudflare&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;V86khSc459Yi1AhTlvtY7&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:53.657Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-02-04T17:12:59.473Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,57],&quot;revision&quot;:[0,21],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Partners&quot;],&quot;name&quot;:[0,&quot;Partners&quot;],&quot;slug&quot;:[0,&quot;partners&quot;],&quot;featured&quot;:[0,true]}]}]]]}],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="idle" opts="{&quot;name&quot;:&quot;NavigationComponent&quot;,&quot;value&quot;:true}" await-children><header class="flex flex-row flex-wrap justify-between items-flex-end mw8 center mv3 pl3 pr1"><div class="w-100 flex items-flex-end justify-between justify-start-l"><div class="w-100 tr flex justify-end"><div class="flex justify-between items-center"><span class="dn di-l pr1"><a href="https://dash.cloudflare.com/sign-up" class="f1 blue1 dn di-l b no-underline underline-hover" target="_blank" rel="noreferrer">Get Started Free</a></span><span class="f1 gray4 dn di-l pr1">|</span><span class="dn di-l"><a target="_blank" href="https://www.cloudflare.com/plans/enterprise/contact/" class="f1 gray4 no-underline underline-hover pr1" rel="noreferrer">Contact Sales</a></span><span class="f1 gray4 dn di-l pr1">|</span><div class="relative flex cf-dropdown"><div class="flex items-center" dir="ltr"><button type="button" class="f1 gray4 no-underline language-picker js-language-picker" style="background:transparent;border:none;padding:0"><span class="language-picker__globe-icon"></span><span class="language-picker__caret-icon ph1">▼</span></button></div></div></div></div></div><div class="w-100 w-50-l flex items-end nb5 nb1-l"><a href="/" class="header-logo mr4 dn db-l"><img class="header-logo" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png" alt="The Cloudflare Blog" width="170" height="57"/></a><h2 class="mt0 mb1 dn di-l"><a href="/" class="fw5 f5 gray3 no-underline"><span class="dn di-l">The Cloudflare Blog</span></a></h2></div><div class="w-100 w-50-l dn db-l"><div class="w-100 tr mkto-sub-message"><p class="f2">Subscribe to receive notifications of new posts:</p></div><div class="w-100 tr"><div class="marketo-form-container"><form id="mktoForm_1653"><div class="top-subscribe-form-container"><div class="top-subscribe-form-field"><input placeholder="Email Address" class="top-subscribe-form-input" name="email" type="email" title="Must be valid email."/></div><button class="top-subscribe-form-button" type="button">Subscribe</button></div></form></div></div></div></header><nav dir="ltr" class="bb b--black-10 db dn-l w-100 ph3 "><div class=" flex justify-between items-center" style="height:44px"><a href="/search/"><img class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a><button type="button" style="background:transparent;border:none"><img src="/images/hamburger.svg" alt="hamburger menu"/></button></div><div class="js-mobile-nav-container dn"><div class="flex flex-column flex-wrap bg-gray9 o-95 absolute ph3 z-1 left-0 right-0 mx-4"><div class="pv3 ph2 tl"><a href="/tag/ai/" class="no-underline gray1 f4 fw7">AI</a></div><div class="pv3 ph2 tl"><a href="/tag/developers/" class="no-underline gray1 f4 fw7">Developers</a></div><div class="pv3 ph2 tl"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f4 fw7">Radar</a></div><div class="pv3 ph2 tl"><a href="/tag/product-news/" class="no-underline gray1 f4 fw7">Product News</a></div><div class="pv3 ph2 tl"><a href="/tag/security/" class="no-underline gray1 f4 fw7">Security</a></div><div class="pv3 ph2 tl"><a href="/tag/policy/" class="no-underline gray1 f4 fw7">Policy &amp; Legal</a></div><div class="pv3 ph2 tl"><a href="/tag/zero-trust/" class="no-underline gray1 f4 fw7">Zero Trust</a></div><div class="pv3 ph2 tl"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f4 fw7">Speed &amp; Reliability</a></div><div class="pv3 ph2 tl"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f4 fw7">Life at Cloudflare</a></div><div class="pv3 ph2 tl"><a href="/tag/partners/" class="no-underline gray1 f4 fw7">Partners</a></div></div></div></nav><nav id="nav" class="w-100 bb-0 bb-l b--black-10 z-1"><div id="desktop-nav-items-container" class="flex flex-wrap justify-between items-center mw8 center mv3 mv0-l"><div data-tag="ai" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/ai/" class="no-underline gray1 f2 fw5 pv3">AI</a></div><div data-tag="developers" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/developers/" class="no-underline gray1 f2 fw5 pv3">Developers</a></div><div data-tag="cloudflare-radar" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f2 fw5 pv3">Radar</a></div><div data-tag="product-news" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/product-news/" class="no-underline gray1 f2 fw5 pv3">Product News</a></div><div data-tag="security" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/security/" class="no-underline gray1 f2 fw5 pv3">Security</a></div><div data-tag="policy" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/policy/" class="no-underline gray1 f2 fw5 pv3">Policy &amp; Legal</a></div><div data-tag="zero-trust" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/zero-trust/" class="no-underline gray1 f2 fw5 pv3">Zero Trust</a></div><div data-tag="speed-and-reliability" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f2 fw5 pv3">Speed &amp; Reliability</a></div><div data-tag="life-at-cloudflare" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f2 fw5 pv3">Life at Cloudflare</a></div><div data-tag="partners" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/partners/" class="no-underline gray1 f2 fw5 pv3">Partners</a></div><div class="nav-item ml2 mr3 dn db-l pv3" data-tag="search icon"><a href="/search/"><img id="search-icon" class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a></div></div></nav><!--astro:end--></astro-island> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script> <div class="flex flex-row flex-wrap mw8 center bb b--gray8 ph3"> <h1 class="site-title f7 fw4 mt4 mb3 mv4-l">WebAssembly</h1> </div> <main id="site-main" class="flex flex-row flex-wrap mw8 center pt0 pt3-l mt4-l"> <astro-island uid="Z1txy6K" prefix="r0" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,true],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;3cuVG8K7iSqKV8O3fNrAYK&quot;],&quot;title&quot;:[0,&quot;We shipped FinalizationRegistry in Workers: why you should never use it&quot;],&quot;slug&quot;:[0,&quot;we-shipped-finalizationregistry-in-workers-why-you-should-never-use-it&quot;],&quot;excerpt&quot;:[0,&quot;Cloudflare Workers now support FinalizationRegistry, but just because you can use it doesn’t mean you should.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;We’ve recently added support for the &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/FinalizationRegistry\&quot;&gt;&lt;u&gt;FinalizationRegistry API&lt;/u&gt;&lt;/a&gt; in Cloudflare Workers. This API allows developers to request a callback when a JavaScript object is garbage-collected, a feature that can be particularly relevant for managing external resources, such as memory allocated by &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/WebAssembly\&quot;&gt;&lt;u&gt;WebAssembly&lt;/u&gt;&lt;/a&gt; (Wasm). However, despite its availability, our general advice is: &lt;b&gt;avoid using it directly in most scenarios.&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Our decision to add &lt;code&gt;FinalizationRegistry&lt;/code&gt; — while still cautioning against using it — opens up a bigger conversation: how memory management works when JavaScript and WebAssembly share the same runtime. This is becoming more common in high-performance web apps, and getting it wrong can lead to memory leaks, out-of-memory errors, and performance issues, especially in resource-constrained environments like Cloudflare Workers.&lt;/p&gt;&lt;p&gt;In this post, we’ll look at how JavaScript and Wasm handle memory differently, why that difference matters, and what &lt;code&gt;FinalizationRegistry&lt;/code&gt; is actually useful for. We’ll also explain its limitations, particularly around timing and predictability, walk through why we decided to support it, and how we’ve made it safer to use. Finally, we’ll talk about how newer JavaScript language features offer a more reliable and structured approach to solving these problems.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;memory-management-101\&quot;&gt;Memory management 101&lt;/h2&gt;\n            &lt;a href=\&quot;#memory-management-101\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;javascript\&quot;&gt;JavaScript&lt;/h3&gt;\n            &lt;a href=\&quot;#javascript\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;JavaScript relies on automatic memory management through a process called &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Memory_management#garbage_collection\&quot;&gt;&lt;u&gt;garbage collection&lt;/u&gt;&lt;/a&gt;. This means developers do not need to worry about freeing allocated memory, or lifetimes. The garbage collector identifies and reclaims memory occupied by objects that are no longer needed by the program (that is, garbage). This helps prevent memory leaks and simplifies memory management for developers.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;function greet() {\n  let name = &amp;quot;Alice&amp;quot;;         // String is allocated in memory\n  console.log(&amp;quot;Hello, &amp;quot; + name);\n}                             // &amp;#039;name&amp;#039; goes out of scope\n\ngreet();\n// JavaScript automatically frees allocated memory at some point in future&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;webassembly\&quot;&gt;WebAssembly&lt;/h3&gt;\n            &lt;a href=\&quot;#webassembly\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;WebAssembly (Wasm) is an assembly-like instruction format designed to run high-performance applications on the web. While it initially gained prominence in web browsers, Wasm is also highly effective on the server side. At Cloudflare, we leverage Wasm to enable users to run code written in a variety of programming languages, such as &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/rust/\&quot;&gt;&lt;u&gt;Rust&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/\&quot;&gt;&lt;u&gt;Python&lt;/u&gt;&lt;/a&gt;, directly within our &lt;a href=\&quot;https://www.cloudflare.com/learning/serverless/glossary/what-is-chrome-v8/\&quot;&gt;&lt;u&gt;V8 isolates&lt;/u&gt;&lt;/a&gt;, offering both performance and versatility.&lt;/p&gt;&lt;p&gt;Wasm runtimes are designed to be simple stack machines, and lack built-in garbage collectors. This necessitates manual memory management (allocation and deallocation of memory used by Wasm code), making it an ideal compilation target for languages like Rust and C++ that handle their own memory.&lt;/p&gt;&lt;p&gt;Wasm modules operate on &lt;a href=\&quot;https://webassembly.github.io/spec/core/exec/runtime.html#memory-instances\&quot;&gt;&lt;u&gt;linear memory&lt;/u&gt;&lt;/a&gt;: a resizable block of raw bytes, which JavaScript views as an &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/WebAssembly/Reference/JavaScript_interface/Memory\&quot;&gt;&lt;u&gt;ArrayBuffer&lt;/u&gt;&lt;/a&gt;. This memory is organized in 64 KB pages, and its initial size is defined when the module is compiled or loaded. Wasm code interacts with this memory using 32-bit offsets — integer values functioning as direct pointers that specify a byte offset from the start of its linear memory. This direct memory access model is crucial for Wasm&amp;#39;s high performance. The host environment (which in Cloudflare Workers is JavaScript) also shares this ArrayBuffer, reading and writing (often via &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray\&quot;&gt;&lt;u&gt;TypedArrays&lt;/u&gt;&lt;/a&gt;) to enable vital data exchange between Wasm and JavaScript.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3nWyMj5xginVWLxCnPpUdY/f939bb0b4f0007999aff876854645f16/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1494\&quot; height=\&quot;672\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;A core Wasm design is its &lt;a href=\&quot;https://webassembly.org/docs/security/\&quot;&gt;&lt;u&gt;secure sandbox&lt;/u&gt;&lt;/a&gt;. This confines Wasm code strictly to its own linear memory and explicitly declared imports from the host, preventing unauthorized memory access or system calls. Direct interaction with JavaScript objects is blocked; communication occurs through numeric values, function references, or operations on the shared ArrayBuffer. This strong isolation is vital for security, ensuring Wasm modules don&amp;#39;t interfere with the host or other application components, which is especially important in multi-tenant environments like Cloudflare Workers.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3Ck9v7opkB5Mg1agKNnQm7/c328cc0a2d1c3145a527e1267594fe1d/image2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1984\&quot; height=\&quot;844\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Bridging WebAssembly memory with JavaScript often involves writing low-level &amp;quot;glue&amp;quot; code to convert raw byte arrays from Wasm into usable JavaScript types. Doing this manually for every function or data structure is both tedious and error-prone. Fortunately, tools like &lt;a href=\&quot;https://rustwasm.github.io/wasm-bindgen/\&quot;&gt;&lt;u&gt;wasm-bindgen&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://emscripten.org/\&quot;&gt;&lt;u&gt;Emscripten (Embind)&lt;/u&gt;&lt;/a&gt; handle this interop automatically, generating the binding code needed to pass data cleanly between the two environments. We use these same tools under the hood — wasm-bindgen for Rust-based &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;&lt;u&gt;workers-rs&lt;/u&gt;&lt;/a&gt; projects, and Emscripten for &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/how-python-workers-work/\&quot;&gt;&lt;u&gt;Python Workers&lt;/u&gt;&lt;/a&gt; — to simplify integration and let developers focus on application logic rather than memory translation.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;interoperability\&quot;&gt;Interoperability&lt;/h2&gt;\n            &lt;a href=\&quot;#interoperability\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;High-performance web apps often use JavaScript for interactive UIs and data fetching, while WebAssembly handles demanding operations like media processing and complex calculations for significant performance gains, allowing developers to maximize efficiency. Given the difference in memory management models, developers need  to be careful when using WebAssembly memory in JavaScript.&lt;/p&gt;&lt;p&gt;For this example, we&amp;#39;ll use Rust to compile a WebAssembly module manually. Rust is a popular choice for WebAssembly because it offers precise control over memory and easy Wasm compilation using standard toolchains.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;rust\&quot;&gt;Rust&lt;/h3&gt;\n            &lt;a href=\&quot;#rust\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Here we have two simple functions. &lt;code&gt;make_buffer&lt;/code&gt; creates a string and returns a raw pointer back to JavaScript. The function intentionally “forgets” the memory allocated so that it doesn’t get cleaned up after the function returns. &lt;code&gt;free_buffer&lt;/code&gt;, on the other hand, expects the initial string reference handed back and frees the memory.&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;// Allocate a fresh byte buffer and hand the raw pointer + length to JS.\n// *We intentionally “forget” the Vec so Rust will not free it right away;\n//   JS now owns it and must call `free_buffer` later.*\n#[no_mangle]\npub extern &amp;quot;C&amp;quot; fn make_buffer(out_len: *mut usize) -&amp;gt; *mut u8 {\n    let mut data = b&amp;quot;Hello from Rust&amp;quot;.to_vec();\n    let ptr = data.as_mut_ptr();\n    let len  = data.len();\n\n    unsafe { *out_len = len };\n\n    std::mem::forget(data);\n    return ptr;\n}\n\n/// Counterpart that **must** be called by JS to avoid a leak.\n#[no_mangle]\npub unsafe extern &amp;quot;C&amp;quot; fn free_buffer(ptr: *mut u8, len: usize) {\n    let _ = Vec::from_raw_parts(ptr, len, len);\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;javascript\&quot;&gt;JavaScript&lt;/h3&gt;\n            &lt;a href=\&quot;#javascript\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Back in JavaScript land, we’ll call these Wasm functions and output them using console.log. This is a common pattern in Wasm-based applications since WebAssembly doesn’t have direct access to Web APIs, and rely on a JavaScript “glue” to interface with the outer world in order to do anything useful.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const { instance } = await WebAssembly.instantiate(WasmBytes, {});\n\nconst { memory, make_buffer, free_buffer } = instance.exports;\n\n//  Use the Rust functions\nconst lenPtr = 0;                 // scratch word in Wasm memory\nconst ptr = make_buffer(lenPtr);\n\nconst len = new DataView(memory.buffer).getUint32(lenPtr, true);\nconst data = new Uint8Array(memory.buffer, ptr, len);\n\nconsole.log(new TextDecoder().decode(data)); // “Hello from Rust”\n\nfree_buffer(ptr, len); // free_buffer must be called to prevent memory leaks&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You can find all code samples along with setup instructions &lt;a href=\&quot;https://github.com/cloudflare/cloudflare-blog/tree/master/2025-06-finalization-registry\&quot;&gt;&lt;u&gt;here&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;As you can see, working with Wasm memory from JavaScript requires care, as it introduces the risk of memory leaks if allocated memory isn’t properly released. JavaScript developers are often unfamiliar with manual memory management, and it’s easy to forget returning memory to WebAssembly after use. This can become especially tricky when Wasm-allocated data is passed into JavaScript libraries, making ownership and lifetime harder to track.&lt;/p&gt;&lt;p&gt;While occasional leaks may not cause immediate issues, over time they can lead to increased memory usage and degrade performance, particularly in memory-constrained environments like Cloudflare Workers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;finalizationregistry\&quot;&gt;FinalizationRegistry&lt;/h2&gt;\n            &lt;a href=\&quot;#finalizationregistry\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;&lt;code&gt;FinalizationRegistry&lt;/code&gt;, introduced as part of the &lt;a href=\&quot;https://tc39.es/proposal-weakrefs/\&quot;&gt;&lt;u&gt;TC-39 WeakRef proposal&lt;/u&gt;&lt;/a&gt;, is a JavaScript API which lets you run “finalizers” (aka cleanup callbacks) when an object gets garbage-collected. Let’s look at a simple example to demonstrate the API:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const my_registry = new FinalizationRegistry((obj) =&amp;gt; { console.log(&amp;quot;Cleaned up: &amp;quot; + obj); });\n\n{\n  let temporary = { key: &amp;quot;value&amp;quot; };\n  // Register this object in our FinalizationRegistry -- the second argument,\n  // &amp;quot;temporary&amp;quot;, will be passed to our callback as its obj parameter\n  my_registry.register(temporary, &amp;quot;temporary&amp;quot;);\n}\n\n// At some point in the future when temporary object gets garbage collected, we&amp;#039;ll see &amp;quot;Cleaned up: temporary&amp;quot; in our logs.&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Let’s see how we can use this API in our Wasm-based application:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const { instance } = await WebAssembly.instantiate(WasmBytes, {});\n\nconst { memory, make_buffer, free_buffer } = instance.exports;\n\n// FinalizationRegistry would be responsible for returning memory back to Wasm\nconst cleanupFr = new FinalizationRegistry(({ ptr, len }) =&amp;gt; {\n  free_buffer(ptr, len);\n});\n\n//  Use the Rust functions\nconst lenPtr = 0;                 // scratch word in Wasm memory\nconst ptr = make_buffer(lenPtr);\n\nconst len = new DataView(memory.buffer).getUint32(lenPtr, true);\nconst data = new Uint8Array(memory.buffer, ptr, len);\n\n// Register the data buffer in our FinalizationRegistry so that it gets cleaned up automatically\ncleanupFr.register(data, { ptr, len });\n\nconsole.log(new TextDecoder().decode(data));   // → “Hello from Rust”\n\n// No need to manually call free_buffer, FinalizationRegistry will do this for us&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We can use a &lt;code&gt;FinalizationRegistry&lt;/code&gt; to manage any object borrowed from WebAssembly by registering it with a finalizer that calls the appropriate free function. This is the same approach used by &lt;a href=\&quot;https://rustwasm.github.io/docs/wasm-bindgen/reference/weak-references.html\&quot;&gt;&lt;u&gt;wasm-bindgen&lt;/u&gt;&lt;/a&gt;. It shifts the burden of manual cleanup away from the JavaScript developer and delegates it to the JavaScript garbage collector. However, in practice, things aren’t quite that simple.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;inherent-issues-with-finalizationregistry\&quot;&gt;Inherent issues with FinalizationRegistry&lt;/h2&gt;\n            &lt;a href=\&quot;#inherent-issues-with-finalizationregistry\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;There is a fundamental issue with &lt;code&gt;FinalizationRegistry&lt;/code&gt;: garbage collection is non-deterministic, and may clean up your unused memory at some arbitrary point in the future. In some cases, garbage collection might not even run and your “finalizers” will never be triggered.&lt;/p&gt;&lt;p&gt;This is part of its &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/FinalizationRegistry#notes_on_cleanup_callbacks\&quot;&gt;&lt;u&gt;documentation&lt;/u&gt;&lt;/a&gt; as well:&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&lt;i&gt;“A conforming JavaScript implementation, even one that does garbage collection, is not required to call cleanup callbacks. When and whether it does so is entirely down to the implementation of the JavaScript engine. When a registered object is reclaimed, any cleanup callbacks for it may be called then, or some time later, or not at all.”&lt;/i&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Even Emscripten mentions this in their &lt;a href=\&quot;https://emscripten.org/docs/porting/connecting_cpp_and_javascript/embind.html#automatic-memory-management\&quot;&gt;&lt;u&gt;documentation&lt;/u&gt;&lt;/a&gt;: “&lt;i&gt;... finalizers are not guaranteed to be called, and even if they are, there are no guarantees about their timing or order of execution, which makes them unsuitable for general RAII-style resource management.&lt;/i&gt;”&lt;/p&gt;&lt;p&gt;Given their non-deterministic nature, developers seldom use finalizers for any essential program logic. Treat them as a last-ditch safety net, not as a primary cleanup mechanism — explicit, deterministic teardown logic is almost always safer, faster, and easier to reason about.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;enabling-finalizationregistry-in-workers\&quot;&gt;Enabling FinalizationRegistry in Workers&lt;/h2&gt;\n            &lt;a href=\&quot;#enabling-finalizationregistry-in-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Given its non-deterministic nature and limited early adoption, we initially disabled the &lt;code&gt;FinalizationRegistry&lt;/code&gt; API in our runtime. However, as usage of Wasm-based Workers grew — particularly among high-traffic customers — we began to see new demands emerge. One such customer was running an extremely high requests per second (RPS) workload using WebAssembly, and needed tight control over memory to sustain massive traffic spikes without degradation. This highlighted a gap in our memory management capabilities, especially in cases where manual cleanup wasn’t always feasible or reliable. As a result, we re-evaluated our stance and began exploring the challenges and trade-offs of enabling &lt;code&gt;FinalizationRegistry&lt;/code&gt; within the Workers environment, despite its known limitations.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;preventing-footguns-with-safe-defaults\&quot;&gt;Preventing footguns with safe defaults&lt;/h3&gt;\n            &lt;a href=\&quot;#preventing-footguns-with-safe-defaults\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Because this API could be misused and cause unpredictable results for our customers, we’ve added a few safeguards. Most importantly, cleanup callbacks are run without an active async context, which means they cannot perform any I/O. This includes sending events to a tail Worker, logging metrics, or making fetch requests.&lt;/p&gt;&lt;p&gt;While this might sound limiting, it’s very intentional. Finalization callbacks are meant for cleanup — especially for releasing WebAssembly memory — not for triggering side effects. If we allowed I/O here, developers might (accidentally) rely on finalizers to perform critical logic that depends on when garbage collection happens. That timing is non-deterministic and outside your control, which could lead to flaky, hard-to-debug behavior.&lt;/p&gt;&lt;p&gt;We don’t have full control over when V8’s garbage collector performs cleanup, but V8 does let us nudge the timing of finalizer execution. Like Node and Deno, Workers queue &lt;code&gt;FinalizationRegistry&lt;/code&gt; jobs only after the microtask queue has drained, so each cleanup batch slips into the quiet slots between I/O phases of the event loop.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/69QSYwmiAueWyP2KlvBwGi/183345cbb043acbe4d76c0fdb2ebf4dd/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1992\&quot; height=\&quot;344\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;security-concerns\&quot;&gt;Security concerns&lt;/h3&gt;\n            &lt;a href=\&quot;#security-concerns\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The Cloudflare Workers runtime is &lt;a href=\&quot;https://blog.cloudflare.com/mitigating-spectre-and-other-security-threats-the-cloudflare-workers-security-model\&quot;&gt;&lt;u&gt;specifically engineered&lt;/u&gt;&lt;/a&gt; to prevent side-channel attacks in a multi-tenant environment. Prior to enabling the &lt;code&gt;FinalizationRegistry&lt;/code&gt; API, we did a thorough analysis to assess its impact on our security model and determine the necessity of additional safeguards. The non-deterministic nature of &lt;code&gt;FinalizationRegistry&lt;/code&gt; raised concerns about potential information leaks leading to Spectre-like vulnerabilities, particularly regarding the possibility of exploiting the garbage collector (GC) as a confused deputy or using it to create a timer.&lt;/p&gt;&lt;h4&gt;GC as confused deputy&lt;/h4&gt;&lt;p&gt;One concern was whether the garbage collector (GC) could act as a confused deputy — a security antipattern where a privileged component is tricked into misusing its authority on behalf of untrusted code. In theory, a clever attacker could try to exploit the GC&amp;#39;s ability to access internal object lifetimes and memory behavior in order to infer or manipulate sensitive information across isolation boundaries.&lt;/p&gt;&lt;p&gt;However, our analysis indicated that the V8 GC is effectively contained and not exposed to confused deputy risks within the runtime. This is attributed to our existing threat models and security measures, such as the isolation of user code, where the V8 Isolate serves as the primary security boundary. Furthermore, even though FinalizationRegistry involves some internal GC mechanics, the callbacks themselves execute in the same isolate that registered them — never across isolates — ensuring isolation remains intact.&lt;/p&gt;&lt;h4&gt;GC as timer&lt;/h4&gt;&lt;p&gt;We also evaluated the possibility of using FinalizationRegistry as a high-resolution timing mechanism — a common vector in side-channel attacks like Spectre. The concern here is that an attacker could schedule object finalization in a way that indirectly leaks information via the timing of callbacks.&lt;/p&gt;&lt;p&gt;In practice, though, the resolution of such a &amp;quot;GC timer&amp;quot; is low and highly variable, offering poor reliability for side-channel attacks. Additionally, we control when finalizer callbacks are scheduled — delaying them until after the microtask queue has drained — giving us an extra layer of control to limit timing precision and reduce risk.&lt;/p&gt;&lt;p&gt;Following a review with our security research team, we determined that our existing security model is sufficient to support this API.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;predictable-cleanups\&quot;&gt;Predictable cleanups?&lt;/h2&gt;\n            &lt;a href=\&quot;#predictable-cleanups\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;JavaScript&amp;#39;s &lt;a href=\&quot;https://tc39.es/proposal-explicit-resource-management/\&quot;&gt;&lt;u&gt;Explicit Resource Management&lt;/u&gt;&lt;/a&gt; proposal introduces a deterministic approach to handle resources needing manual cleanup, such as file handles, network connections, or database sessions. Drawing inspiration from constructs like C#&amp;#39;s &lt;a href=\&quot;https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/using\&quot;&gt;&lt;u&gt;using&lt;/u&gt;&lt;/a&gt; and Python&amp;#39;s &lt;a href=\&quot;https://docs.python.org/3/reference/compound_stmts.html#with\&quot;&gt;&lt;u&gt;with&lt;/u&gt;&lt;/a&gt;, this proposal introduces the using and &lt;code&gt;await using&lt;/code&gt; syntax. This new syntax guarantees that objects adhering to a specific cleanup protocol are automatically disposed of when they are no longer within their scope.&lt;/p&gt;&lt;p&gt;Let’s look at a simple example to understand it a bit better.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;class MyResource {\n  [Symbol.dispose]() {\n    console.log(&amp;quot;Resource cleaned up!&amp;quot;);\n  }\n\n  use() {\n    console.log(&amp;quot;Using the resource...&amp;quot;);\n  }\n}\n\n{\n  using res = new MyResource();\n  res.use();\n} // When this block ends, Symbol.dispose is called automatically (and deterministically).&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The proposal also includes additional features that offer finer control over when dispose methods are called. But at a high level, it provides a much-needed, deterministic way to manage resource cleanup. Let’s now update our earlier WebAssembly-based example to take advantage of this new mechanism instead of relying on &lt;code&gt;FinalizationRegistry&lt;/code&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const { instance } = await WebAssembly.instantiate(WasmBytes, {});\nconst { memory, make_buffer, free_buffer } = instance.exports;\n\nclass WasmBuffer {\n  constructor(ptr, len) {\n    this.ptr = ptr;\n    this.len = len;\n  }\n\n  [Symbol.dispose]() {\n    free_buffer(this.ptr, this.len);\n  }\n}\n\n{\n  const lenPtr = 0;\n  const ptr = make_buffer(lenPtr);\n  const len = new DataView(memory.buffer).getUint32(lenPtr, true);\n\n  using buf = new WasmBuffer(ptr, len);\n\n  const data = new Uint8Array(memory.buffer, ptr, len);\n  console.log(new TextDecoder().decode(data));  // → “Hello from Rust”\n} // Symbol.dispose or free_buffer gets called deterministically here&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Explicit Resource Management provides a more dependable way to clean up resources than &lt;code&gt;FinalizationRegistry&lt;/code&gt;, as it runs cleanup logic — such as calling &lt;code&gt;free_buffer&lt;/code&gt; in WasmBuffer via &lt;code&gt;[Symbol.dispose]()&lt;/code&gt; and the &lt;code&gt;using&lt;/code&gt; syntax — deterministically, rather than relying on the garbage collector’s unpredictable timing. This makes it a more reliable choice for managing critical resources, especially memory.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;future\&quot;&gt;Future&lt;/h2&gt;\n            &lt;a href=\&quot;#future\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Emscripten &lt;a href=\&quot;https://emscripten.org/docs/porting/connecting_cpp_and_javascript/embind.html#automatic-memory-management\&quot;&gt;&lt;u&gt;already makes use&lt;/u&gt;&lt;/a&gt; of Explicit Resource Management for handling Wasm memory, using &lt;code&gt;FinalizationRegistry&lt;/code&gt; as a last resort, while wasm-bindgen &lt;a href=\&quot;https://github.com/rustwasm/wasm-bindgen/pull/4118\&quot;&gt;&lt;u&gt;supports it in experimental mode&lt;/u&gt;&lt;/a&gt;. The proposal has seen growing adoption across the ecosystem and was recently conditionally advanced to Stage 4 in the TC39 process, meaning it’ll soon officially be part of the JavaScript language standard. This reflects a broader shift toward more predictable and structured memory cleanup in WebAssembly applications.&lt;/p&gt;&lt;p&gt;We &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/changelog/#2025-05-22\&quot;&gt;&lt;u&gt;recently added support&lt;/u&gt;&lt;/a&gt; for this feature in Cloudflare Workers as well, enabling developers to take advantage of deterministic resource cleanup in edge environments. As support for the feature matures, it&amp;#39;s likely to become a standard practice for managing linear memory safely and reliably.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;finalizationregistry-still-not-dead-yet\&quot;&gt;FinalizationRegistry: still not dead yet?&lt;/h3&gt;\n            &lt;a href=\&quot;#finalizationregistry-still-not-dead-yet\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Explicit Resource Management brings much-needed structure and predictability to resource cleanup in WebAssembly and JavaScript interop applications, but it doesn’t make &lt;code&gt;FinalizationRegistry&lt;/code&gt; obsolete. There are still important use cases, particularly when a Wasm-allocated object’s lifecycle is out of your hands or when explicit disposal isn’t practical. In scenarios involving third-party libraries, dynamic lifecycles, or integration layers that don’t follow &lt;code&gt;using&lt;/code&gt; patterns, &lt;code&gt;FinalizationRegistry&lt;/code&gt; remains a valuable fallback to prevent memory leaks.&lt;/p&gt;&lt;p&gt;Looking ahead, a hybrid approach will likely become the standard in Wasm-JavaScript applications. Developers can use ERM for deterministic cleanup of Wasm memory and other resources, while relying on &lt;code&gt;FinalizationRegistry&lt;/code&gt; as a safety net when full control isn’t possible. Together, they offer a more reliable and flexible foundation for managing memory across the JavaScript and WebAssembly boundary.&lt;/p&gt;&lt;p&gt;Ready to try it yourself? Deploy a &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/webassembly/\&quot;&gt;&lt;u&gt;WebAssembly-powered Worker&lt;/u&gt;&lt;/a&gt; and experiment with memory management — start building with &lt;a href=\&quot;https://developers.cloudflare.com/workers/\&quot;&gt;&lt;u&gt;Cloudflare Workers&lt;/u&gt;&lt;/a&gt; today.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-06-11T14:00+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-06-11T13:00:03.311Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7cLMMILFb6WD9qrMUeJoWO/57652dbdb6f77038eedffd08bef442e4/image4.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Ketan Gupta&quot;],&quot;slug&quot;:[0,&quot;ketan-gupta&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4HNGL8tqmoWI8yZJEEynzY/4dc4778dc00d47cc7da853c61c224fd7/Ketan_Gupta.webp&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Harris Hancock&quot;],&quot;slug&quot;:[0,&quot;harris-hancock&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/kl1szOUahVoAesAqM5x8w/18cf3fe1108e24731361523b5c51e45c/Harris_Hancock.webp&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare Workers now support FinalizationRegistry, but just because you can use it doesn’t mean you should. Dive into the tricky world of JavaScript and WebAssembly memory management and see why newer features make life a lot easier.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/we-shipped-finalizationregistry-in-workers-why-you-should-never-use-it&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;We shipped FinalizationRegistry in Workers: why you should never use it&quot;],&quot;description&quot;:[0,&quot;Cloudflare Workers now support FinalizationRegistry, but just because you can use it doesn’t mean you should. Dive into the tricky world of JavaScript and WebAssembly memory management and see why newer features make life a lot easier. &quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3qcV6p7f2TQDnrcte9HS0w/1488188579d497e0756b603e8e41091f/We_shipped_FinalizationRegistry_in_Workers-_why_you_should_never_use_it-OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-100 featured-post  flex flex-row flex-wrap mb4 items-center bb b--gray8 bn-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-50-l"><a href="/we-shipped-finalizationregistry-in-workers-why-you-should-never-use-it/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">We shipped FinalizationRegistry in Workers: why you should never use it</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2025-06-11</p><p class="f4 fw3 lh-copy " data-testid="post-content">Cloudflare Workers now support FinalizationRegistry, but just because you can use it doesn’t mean you should.<!-- -->...</p><a href="/we-shipped-finalizationregistry-in-workers-why-you-should-never-use-it/" class="no-underline gray1 f4 lh-copy fw3 underline-hover" data-testid="post-continue-reading">Continue reading »</a><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/ketan-gupta/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4HNGL8tqmoWI8yZJEEynzY/4dc4778dc00d47cc7da853c61c224fd7/Ketan_Gupta.webp" alt="Ketan Gupta" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/ketan-gupta/" class="fw5 f4 no-underline black">Ketan Gupta</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/harris-hancock/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/kl1szOUahVoAesAqM5x8w/18cf3fe1108e24731361523b5c51e45c/Harris_Hancock.webp" alt="Harris Hancock" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/harris-hancock/" class="fw5 f4 no-underline black">Harris Hancock</a></div></li></ul></div><div class="w-50-l"><img class="dn di-l " src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7cLMMILFb6WD9qrMUeJoWO/57652dbdb6f77038eedffd08bef442e4/image4.png" alt="We shipped FinalizationRegistry in Workers: why you should never use it"/></div></article><!--astro:end--></astro-island><astro-island uid="jwC97" prefix="r1" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,false],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;3Gqu0zcjgdix3M03fXEu8V&quot;],&quot;title&quot;:[0,&quot;Bringing Python to Workers using Pyodide and WebAssembly&quot;],&quot;slug&quot;:[0,&quot;python-workers&quot;],&quot;excerpt&quot;:[0,&quot;Introducing Cloudflare Workers in Python, now in open beta! We&#39;ve revamped our systems to support Python, from the runtime to deployment. Learn about Python Worker&#39;s lifecycle, dynamic linking, and memory snapshots in this post&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4BCvEmK49aK7qLQuTkUsI1/0aecc2333aabe7e94ee99cdf9f830ef6/pythonweba.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;900\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Starting today, in open beta, you can now &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/\&quot;&gt;write Cloudflare Workers in Python&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;This new support for Python is different from how Workers have historically supported languages beyond JavaScript — in this case, we have directly integrated a Python implementation into &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;workerd&lt;/a&gt;, the open-source Workers runtime. All &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/bindings/\&quot;&gt;bindings&lt;/a&gt;, including bindings to &lt;a href=\&quot;https://developers.cloudflare.com/vectorize/\&quot;&gt;Vectorize&lt;/a&gt;, &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/\&quot;&gt;Workers AI&lt;/a&gt;, &lt;a href=\&quot;https://developers.cloudflare.com/r2/\&quot;&gt;R2&lt;/a&gt;, &lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/\&quot;&gt;Durable Objects&lt;/a&gt;, and more are supported on day one. Python Workers can import a subset of popular Python &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/\&quot;&gt;packages&lt;/a&gt; including &lt;a href=\&quot;https://fastapi.tiangolo.com/\&quot;&gt;FastAPI&lt;/a&gt;, &lt;a href=\&quot;https://python.langchain.com/docs/get_started/introduction\&quot;&gt;Langchain&lt;/a&gt;, &lt;a href=\&quot;https://numpy.org/\&quot;&gt;Numpy&lt;/a&gt; and more. There are no extra build steps or external toolchains.&lt;/p&gt;&lt;p&gt;To do this, we’ve had to push the bounds of all of our systems, from the runtime itself, to our deployment system, to the contents of the Worker bundle that is published across our &lt;a href=\&quot;https://www.cloudflare.com/network/\&quot;&gt;network&lt;/a&gt;. You can &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/\&quot;&gt;read the docs&lt;/a&gt;, and start using it today.&lt;/p&gt;&lt;p&gt;We want to use this post to pull back the curtain on the internal lifecycle of a Python Worker, share what we’ve learned in the process, and highlight where we’re going next.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;beyond-just-compile-to-webassembly\&quot;&gt;Beyond “Just compile to WebAssembly”&lt;/h2&gt;\n            &lt;a href=\&quot;#beyond-just-compile-to-webassembly\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Cloudflare Workers have supported WebAssembly &lt;a href=\&quot;/webassembly-on-cloudflare-workers\&quot;&gt;since 2018&lt;/a&gt; — each Worker is a &lt;a href=\&quot;https://developers.cloudflare.com/workers/reference/how-workers-works/\&quot;&gt;V8 isolate&lt;/a&gt;, powered by the same JavaScript engine as the Chrome web browser. In principle, it’s been &lt;a href=\&quot;/webassembly-on-cloudflare-workers\&quot;&gt;possible&lt;/a&gt; for years to write Workers in any language — including Python — so long as it first compiles to WebAssembly or to JavaScript.&lt;/p&gt;&lt;p&gt;In practice, just because something is possible doesn’t mean it’s simple. And just because “hello world” works doesn’t mean you can reliably build an application. Building full applications requires supporting an ecosystem of packages that developers are used to building with. For a platform to truly support a programming language, it’s necessary to go much further than showing how to compile code using external toolchains.&lt;/p&gt;&lt;p&gt;Python Workers are different from what we’ve done in the past. It’s early, and still in beta, but we think it shows what providing first-class support for programming languages beyond JavaScript can look like on Workers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;the-lifecycle-of-a-python-worker\&quot;&gt;The lifecycle of a Python Worker&lt;/h2&gt;\n            &lt;a href=\&quot;#the-lifecycle-of-a-python-worker\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;With Pyodide now &lt;a href=\&quot;https://github.com/cloudflare/workerd/tree/main/src/pyodide\&quot;&gt;built into workerd&lt;/a&gt;, you can write a Worker like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;from js import Response\n\nasync def on_fetch(request, env):\n    return Response.new(&amp;quot;Hello world!&amp;quot;)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;...with a wrangler.toml file that points to a .py file:&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;name = &amp;quot;hello-world-python-worker&amp;quot;\nmain = &amp;quot;src/entry.py&amp;quot;\ncompatibility_date = &amp;quot;2024-03-18&amp;quot;\ncompatibility_flags = [&amp;quot;python_workers&amp;quot;]&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;…and when you run &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/commands/#dev\&quot;&gt;npx wrangler@latest dev&lt;/a&gt;, the Workers runtime will:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Determine which &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/\&quot;&gt;version of Pyodide&lt;/a&gt; is required, based on your &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/compatibility-dates/\&quot;&gt;compatibility date&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Create an isolate for your Worker, and automatically inject Pyodide&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Serve your Python code using Pyodide&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;This all happens under the hood — no extra toolchain or precompilation steps needed. The Python execution environment is provided for you, mirroring how Workers written in JavaScript already work.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;a-python-interpreter-built-into-the-workers-runtime\&quot;&gt;A Python interpreter built into the Workers runtime&lt;/h2&gt;\n            &lt;a href=\&quot;#a-python-interpreter-built-into-the-workers-runtime\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Just as JavaScript has &lt;a href=\&quot;https://en.wikipedia.org/wiki/List_of_ECMAScript_engines\&quot;&gt;many engines&lt;/a&gt;, Python has &lt;a href=\&quot;https://wiki.python.org/moin/PythonImplementations\&quot;&gt;many implementations&lt;/a&gt; that can execute Python code. &lt;a href=\&quot;https://github.com/python/cpython\&quot;&gt;CPython&lt;/a&gt; is the reference implementation of Python. If you’ve used Python before, this is almost certainly what you’ve used, and is commonly referred to as just “Python”.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://pyodide.org/en/stable/\&quot;&gt;Pyodide&lt;/a&gt; is a port of CPython to WebAssembly. It interprets Python code, without any need to precompile the Python code itself to any other format. It runs in a web browser — check out this &lt;a href=\&quot;https://pyodide-console.pages.dev/\&quot;&gt;REPL&lt;/a&gt;. It is true to the CPython that Python developers know and expect, providing &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/stdlib/\&quot;&gt;most of the Python Standard Library&lt;/a&gt;. It provides a foreign function interface (FFI) to JavaScript, allowing you to call JavaScript APIs directly from Python — more on this below. It provides popular open-source &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/\&quot;&gt;packages&lt;/a&gt;, and can import pure Python packages directly from PyPI.&lt;/p&gt;&lt;p&gt;Pyodide struck us as the perfect fit for Workers. It is designed to allow the core interpreter and each native Python module to be built as separate WebAssembly modules, dynamically linked at runtime. This allows the code footprint for these modules to be shared among all Workers running on the same machine, rather than requiring each Worker to bring its own copy. This is essential to making WebAssembly work well in the Workers environment, where we often run &lt;a href=\&quot;https://www.infoq.com/presentations/cloudflare-v8/\&quot;&gt;thousands of Workers per machine&lt;/a&gt; — we need Workers using the same programming language to share their runtime code footprint. Running thousands of Workers on every machine is what makes it possible for us to deploy every application in every location at a &lt;a href=\&quot;/workers-pricing-scale-to-zero\&quot;&gt;reasonable price&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Just like with JavaScript Workers, with Python Workers we provide the runtime for you:&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4eCllqbVYDOzao6swhou7t/c4731707e15b9b37b4198f05a88682ee/VMs--Containers--ans-Isolates-comparison.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;798\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Pyodide is currently the exception — most languages that target WebAssembly do not yet support dynamic linking, so each application ends up bringing its own copy of its language runtime. We hope to see more languages support dynamic linking in the future, so that we can more effectively bring them to Workers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;how-pyodide-works\&quot;&gt;How Pyodide works&lt;/h3&gt;\n            &lt;a href=\&quot;#how-pyodide-works\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Pyodide executes Python code in WebAssembly, which is a sandboxed environment, separated from the host runtime. Unlike running native code, all operations outside of pure computation (such as file reads) must be provided by a runtime environment, then &lt;i&gt;imported&lt;/i&gt; by the WebAssembly module.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://llvm.org/\&quot;&gt;LLVM&lt;/a&gt; provides three target triples for WebAssembly:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;wasm32-unknown-unknown&lt;/b&gt; – this backend provides no C standard library or system call interface; to support this backend, we would need to manually rewrite every system or library call to make use of imports we would define ourselves in the runtime.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;wasm32-wasi&lt;/b&gt; – WASI is a standardized system interface, and defines a standard set of imports that are implemented in WASI runtimes such as &lt;a href=\&quot;https://github.com/bytecodealliance/wasmtime/\&quot;&gt;wasmtime&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;wasm32-unknown-emscripten&lt;/b&gt; – Like WASI, Emscripten defines the imports that a WebAssembly program needs to execute, but also outputs an accompanying JavaScript library that implements these imported functions.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Pyodide uses Emscripten, and provides three things:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;A distribution of the CPython interpreter, compiled using Emscripten&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;A foreign function interface (FFI) between Python and JavaScript&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;A set of third-party Python packages, compiled using Emscripten’s compiler to WebAssembly.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Of these targets, only Emscripten currently supports dynamic linking, which, as we noted above, is essential to providing a shared language runtime for Python that is shared across isolates. Emscripten does this by &lt;a href=\&quot;https://emscripten.org/docs/compiling/Dynamic-Linking.html\&quot;&gt;providing implementations of dlopen and dlsym,&lt;/a&gt; which use the accompanying JavaScript library to modify the WebAssembly program’s table to link additional WebAssembly-compiled modules at runtime. WASI &lt;a href=\&quot;https://github.com/WebAssembly/component-model/blob/main/design/mvp/examples/SharedEverythingDynamicLinking.md#runtime-dynamic-linking\&quot;&gt;does not yet support&lt;/a&gt; the dlopen/dlsym dynamic linking abstractions used by CPython.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;pyodide-and-the-magic-of-foreign-function-interfaces-ffi\&quot;&gt;Pyodide and the magic of foreign function interfaces (FFI)&lt;/h2&gt;\n            &lt;a href=\&quot;#pyodide-and-the-magic-of-foreign-function-interfaces-ffi\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;You might have noticed that in our Hello World Python Worker, we import Response from the js module:&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;from js import Response\n\nasync def on_fetch(request, env):\n    return Response.new(&amp;quot;Hello world!&amp;quot;)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Why is that?&lt;/p&gt;&lt;p&gt;Most Workers are written in JavaScript, and most of our engineering effort on the Workers runtime goes into improving JavaScript Workers. There is a risk in adding a second language that it might never reach feature parity with the first language and always be a second class citizen. Pyodide’s foreign function interface (FFI) is critical to avoiding this by providing access to all JavaScript functionality from Python. This can be used by the Worker author directly, and it is also used to make packages like &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/fastapi/\&quot;&gt;FastAPI&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/langchain/\&quot;&gt;Langchain&lt;/a&gt; work out-of-the-box, as we’ll show later in this post.&lt;/p&gt;&lt;p&gt;An FFI is a system for calling functions in one language that are implemented in another language. In most cases, an FFI is defined by a &amp;quot;higher-level&amp;quot; language in order to call functions implemented in a systems language, often C. Python’s &lt;a href=\&quot;https://docs.python.org/3/library/ctypes.html#module-ctypes\&quot;&gt;ctypes module&lt;/a&gt; is such a system. These sorts of foreign function interfaces are often difficult to use because of the nature of C APIs.&lt;/p&gt;&lt;p&gt;Pyodide’s foreign function interface is an interface between Python and JavaScript, which are two high level object-oriented languages with a lot of design similarities. When passed from one language to another, immutable types such as strings and numbers are transparently translated. All mutable objects are wrapped in an appropriate proxy.&lt;/p&gt;&lt;p&gt;When a JavaScript object is passed into Python, Pyodide determines which JavaScript protocols the object supports and &lt;a href=\&quot;https://github.com/pyodide/pyodide/blob/main/src/core/jsproxy.c#L3781-L3791\&quot;&gt;dynamically constructs&lt;/a&gt; an appropriate Python class that implements the corresponding Python protocols. For example, if the JavaScript object supports the &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols\&quot;&gt;JavaScript iteration protocol&lt;/a&gt; then the proxy will support the &lt;a href=\&quot;https://docs.python.org/3/library/stdtypes.html#iterator-types\&quot;&gt;Python iteration protocol&lt;/a&gt;. If the JavaScript object is a Promise or other &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise#thenables\&quot;&gt;thenable&lt;/a&gt;, the Python object will be an &lt;a href=\&quot;https://docs.python.org/3/reference/datamodel.html#awaitable-objects\&quot;&gt;awaitable&lt;/a&gt;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;from js import JSON\n\njs_array = JSON.parse(&amp;quot;[1,2,3]&amp;quot;)\n\nfor entry in js_array:\n   print(entry)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The lifecycle of a request to a Python Worker makes use of Pyodide’s FFI, wrapping the incoming JavaScript &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/request/\&quot;&gt;Request&lt;/a&gt; object in a &lt;a href=\&quot;https://pyodide.org/en/stable/usage/api/python-api/ffi.html#pyodide.ffi.JsProxy\&quot;&gt;JsProxy&lt;/a&gt; object that is accessible in your Python code. It then converts the value returned by the Python Worker’s &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/handlers/\&quot;&gt;handler&lt;/a&gt; into a JavaScript &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/response/\&quot;&gt;Response&lt;/a&gt; object that can be delivered back to the client:&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card kg-width-wide\&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/736nXjbNS1gxb4dm8xaptB/9f4dd0232d22e7d7070b1f716813a7e6/Python-Worker-Request-Lifecycle.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;978\&quot; height=\&quot;400\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;why-dynamic-linking-is-essential-and-static-linking-isnt-enough\&quot;&gt;Why dynamic linking is essential, and static linking isn’t enough&lt;/h2&gt;\n            &lt;a href=\&quot;#why-dynamic-linking-is-essential-and-static-linking-isnt-enough\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Python comes with &lt;a href=\&quot;https://cffi.readthedocs.io/en/stable/\&quot;&gt;a C FFI&lt;/a&gt;, and many Python packages use this FFI to import native libraries. These libraries are typically written in C, so they must first be compiled down to WebAssembly in order to work on the Workers runtime. As we noted above, Pyodide is built with Emscripten, which overrides Python’s C FFI — any time a package tries to load a native library, it is instead loaded from a WebAssembly module that is provided by the Workers runtime. Dynamic linking is what makes this possible — it is what lets us override Python’s C FFI, allowing Pyodide to support many &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/\&quot;&gt;Python packages&lt;/a&gt; that have native library dependencies.&lt;/p&gt;&lt;p&gt;Dynamic linking is “pay as you go”, while static linking is “pay upfront” — if code is statically linked into your binary, it must be loaded upfront in order for the binary to run, even if this code is never used.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card kg-width-wide\&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1JiF8v11hINyO6CpNnuP6a/52fad68dedc7a4d1c6beba46eb13f964/Python-Workers---Runtime.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;772\&quot; height=\&quot;400\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Dynamic linking enables the Workers runtime to share the underlying WebAssembly modules of packages across different Workers that are running on the same machine.&lt;/p&gt;&lt;p&gt;We won’t go too much into detail on &lt;a href=\&quot;https://emscripten.org/docs/compiling/Dynamic-Linking.html#runtime-dynamic-linking-with-dlopen\&quot;&gt;how dynamic linking works in Emscripten&lt;/a&gt;, but the main takeaway is that the Emscripten runtime fetches WebAssembly modules from a filesystem abstraction provided in JavaScript. For each Worker, we generate a filesystem at runtime, whose structure mimics a Python distribution that has the Worker’s dependencies installed, but whose underlying files are shared between Workers. This makes it possible to share Python and WebAssembly files between multiple Workers that import the same dependency. Today, we’re able to share these files across Workers, but copy them into each new isolate. We think we can go even further, by employing &lt;a href=\&quot;https://en.wikipedia.org/wiki/Copy-on-write\&quot;&gt;copy-on-write&lt;/a&gt; techniques to share the underlying resource across many Workers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;supporting-server-and-client-libraries\&quot;&gt;Supporting Server and Client libraries&lt;/h2&gt;\n            &lt;a href=\&quot;#supporting-server-and-client-libraries\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Python has a wide variety of popular HTTP client libraries, including &lt;a href=\&quot;https://www.python-httpx.org/\&quot;&gt;httpx&lt;/a&gt;, &lt;a href=\&quot;https://pypi.org/project/urllib3/\&quot;&gt;urllib3&lt;/a&gt;, &lt;a href=\&quot;https://pypi.org/project/requests/\&quot;&gt;requests&lt;/a&gt; and more. Unfortunately, none of them work out of the box in Pyodide. Adding support for these has been one of the longest running user requests for the Pyodide project. The Python HTTP client libraries all work with raw sockets, and the browser security model and CORS do not allow this, so we needed another way to make them work in the Workers runtime.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;async-client-libraries\&quot;&gt;Async Client libraries&lt;/h3&gt;\n            &lt;a href=\&quot;#async-client-libraries\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;For libraries that can make requests asynchronously, including &lt;a href=\&quot;https://docs.aiohttp.org/en/stable/index.html\&quot;&gt;aiohttp&lt;/a&gt; and &lt;a href=\&quot;https://www.python-httpx.org/\&quot;&gt;httpx&lt;/a&gt;, we can use the &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/fetch/\&quot;&gt;Fetch API&lt;/a&gt; to make requests. We do this by patching the library, instructing it to use the Fetch API from JavaScript — taking advantage of Pyodide’s FFI. &lt;a href=\&quot;https://github.com/cloudflare/pyodide/blob/main/packages/httpx/httpx_patch.py\&quot;&gt;The httpx patch&lt;/a&gt; ends up quite simple —fewer than 100 lines of code. Simplified even further, it looks like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;from js import Headers, Request, fetch\n\ndef py_request_to_js_request(py_request):\n    js_headers = Headers.new(py_request.headers)\n    return Request.new(py_request.url, method=py_request.method, headers=js_headers)\n\ndef js_response_to_py_response(js_response):\n  ... # omitted\n\nasync def do_request(py_request):\n  js_request = py_request_to_js_request(py_request)\n    js_response = await fetch(js_request)\n    py_response = js_response_to_py_response(js_response)\n    return py_response&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;synchronous-client-libraries\&quot;&gt;Synchronous Client libraries&lt;/h3&gt;\n            &lt;a href=\&quot;#synchronous-client-libraries\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Another challenge in supporting Python HTTP client libraries is that many Python APIs are synchronous. For these libraries, we cannot use the &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/fetch/\&quot;&gt;fetch API&lt;/a&gt; directly because it is asynchronous.&lt;/p&gt;&lt;p&gt;Thankfully, Joe Marshall recently landed &lt;a href=\&quot;https://urllib3.readthedocs.io/en/stable/reference/contrib/emscripten.html\&quot;&gt;a contribution to urllib3&lt;/a&gt; that adds Pyodide support in web browsers by:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Checking if blocking with &lt;code&gt;Atomics.wait()&lt;/code&gt; is possible&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;If so, start a fetch worker thread&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Delegate the fetch operation to the worker thread and serialize the response into a SharedArrayBuffer&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;In the Python thread, use Atomics.wait to block for the response in the SharedArrayBuffer&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;If &lt;code&gt;Atomics.wait()&lt;/code&gt; doesn’t work, fall back to a synchronous XMLHttpRequest&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Despite this, today Cloudflare Workers do not support &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers\&quot;&gt;worker threads&lt;/a&gt; or synchronous &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\&quot;&gt;XMLHttpRequest&lt;/a&gt;, so neither of these two approaches will work in Python Workers. We do not support synchronous requests today, but there is a way forward…&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;webassembly-stack-switching\&quot;&gt;WebAssembly Stack Switching&lt;/h3&gt;\n            &lt;a href=\&quot;#webassembly-stack-switching\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;There is an approach which will allow us to support synchronous requests. WebAssembly has &lt;a href=\&quot;https://github.com/WebAssembly/js-promise-integration\&quot;&gt;a stage 3 proposal adding support for stack switching&lt;/a&gt;, which &lt;a href=\&quot;https://v8.dev/blog/jspi\&quot;&gt;v8 has an implementation of&lt;/a&gt;. Pyodide contributors have been working on adding support for stack switching to Pyodide since September 2022, and it is almost ready.&lt;/p&gt;&lt;p&gt;With this support, Pyodide exposes a function called &lt;code&gt;run_sync&lt;/code&gt; which can block for completion of an awaitable:&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;from pyodide.ffi import run_sync\n\ndef sync_fetch(py_request):\n   js_request = py_request_to_js_request(py_request)\n   js_response  = run_sync(fetch(js_request))\n   return js_response_to_py_response(js_response)&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;fastapi-and-pythons-asynchronous-server-gateway-interface\&quot;&gt;FastAPI and Python’s Asynchronous Server Gateway Interface&lt;/h3&gt;\n            &lt;a href=\&quot;#fastapi-and-pythons-asynchronous-server-gateway-interface\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;&lt;a href=\&quot;https://fastapi.tiangolo.com/\&quot;&gt;FastAPI&lt;/a&gt; is one of the most popular libraries for defining Python servers. FastAPI applications use a protocol called the &lt;a href=\&quot;https://asgi.readthedocs.io/en/latest/\&quot;&gt;Asynchronous Server Gateway Interface&lt;/a&gt; (ASGI). This means that FastAPI never reads from or writes to a socket itself. An ASGI application expects to be hooked up to an ASGI server, typically &lt;a href=\&quot;https://www.uvicorn.org/\&quot;&gt;uvicorn&lt;/a&gt;. The ASGI server handles all of the raw sockets on the application’s behalf.&lt;/p&gt;&lt;p&gt;Conveniently for us, this means that FastAPI works in Cloudflare Workers without any patches or changes to FastAPI itself. We simply need to replace &lt;a href=\&quot;https://www.uvicorn.org/\&quot;&gt;uvicorn&lt;/a&gt; with an appropriate ASGI server that can run within a Worker. Our initial implementation lives &lt;a href=\&quot;https://github.com/cloudflare/workerd/blob/main/src/pyodide/internal/asgi.py\&quot;&gt;here&lt;/a&gt;, in &lt;a href=\&quot;https://github.com/cloudflare/pyodide\&quot;&gt;the fork of Pyodide&lt;/a&gt; that we maintain. We hope to add a more comprehensive feature set, add test coverage, and then upstream this implementation into Pyodide.&lt;/p&gt;&lt;p&gt;You can try this yourself by cloning &lt;a href=\&quot;https://github.com/cloudflare/python-workers-examples\&quot;&gt;cloudflare/python-workers-examples&lt;/a&gt;, and running &lt;code&gt;npx wrangler@latest dev&lt;/code&gt; in the directory of the FastAPI example.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;importing-python-packages\&quot;&gt;Importing Python Packages&lt;/h2&gt;\n            &lt;a href=\&quot;#importing-python-packages\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Python Workers support &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/\&quot;&gt;a subset of Python packages&lt;/a&gt;, which are &lt;a href=\&quot;https://github.com/cloudflare/pyodide/tree/main/packages\&quot;&gt;provided directly by Pyodide&lt;/a&gt;, including &lt;a href=\&quot;https://numpy.org/\&quot;&gt;numpy&lt;/a&gt;, &lt;a href=\&quot;https://www.python-httpx.org/\&quot;&gt;httpx&lt;/a&gt;, &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/fastapi/\&quot;&gt;FastAPI&lt;/a&gt;, &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/langchain/\&quot;&gt;Langchain&lt;/a&gt;, and more. This ensures compatibility with the Pyodide runtime by pinning package versions to Pyodide versions, and allows Pyodide to patch internal implementations, as we showed above in the case of httpx.&lt;/p&gt;&lt;p&gt;To import a package, simply add it to your &lt;code&gt;requirements.txt&lt;/code&gt; file, without adding a version number. A specific version of the package is provided directly by Pyodide. Today, you can use packages in local development, and in the coming weeks, you will be able to deploy Workers that define dependencies in a &lt;code&gt;requirements.txt&lt;/code&gt; file. Later in this post, we’ll show how we’re thinking about managing new versions of Pyodide and packages.&lt;/p&gt;&lt;p&gt;We maintain our own fork of Pyodide, which allows us to provide patches specific to the Workers runtime, and to quickly expand our support for packages in Python Workers, while also committing to upstreaming our changes back to Pyodide, so that the whole ecosystem of developers can benefit.&lt;/p&gt;&lt;p&gt;Python packages are often big and memory hungry though, and they can do a lot of work at import time. How can we ensure that you can bring in the packages you need, while mitigating long cold start times?&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;making-cold-starts-faster-with-memory-snapshots\&quot;&gt;Making cold starts faster with memory snapshots&lt;/h2&gt;\n            &lt;a href=\&quot;#making-cold-starts-faster-with-memory-snapshots\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;In the example at the start of this post, in local development, we mentioned injecting Pyodide into your Worker. Pyodide itself is 6.4 MB — and Python packages can also be quite large.&lt;/p&gt;&lt;p&gt;If we simply shoved Pyodide into your Worker and uploaded it to Cloudflare, that’d be quite a large Worker to load into a new isolate — cold starts would be slow. On a fast computer with a good network connection, Pyodide takes about two seconds to initialize in a web browser, one second of network time and one second of cpu time. It wouldn’t be acceptable to initialize it every time you update your code for every isolate your Worker runs in across &lt;a href=\&quot;https://www.cloudflare.com/network/\&quot;&gt;Cloudflare’s network&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Instead, when you run &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/commands/#deploy\&quot;&gt;npx wrangler@latest deploy&lt;/a&gt;, the following happens:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Wrangler uploads your Python code and your &lt;code&gt;requirements.txt&lt;/code&gt; file to the Workers API&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;We send your Python code, and your &lt;code&gt;requirements.txt&lt;/code&gt; file to the Workers runtime to be validated&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;We create a new isolate for your Worker, and automatically inject Pyodide plus any &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/\&quot;&gt;packages&lt;/a&gt; you’ve specified in your &lt;code&gt;requirements.txt&lt;/code&gt; file.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;We scan the Worker’s code for import statements, execute them, and then take a snapshot of the Worker’s WebAssembly linear memory. Effectively, we perform the expensive work of importing packages at deploy time, rather than at runtime.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;We deploy this snapshot alongside your Worker’s Python code to Cloudflare’s network.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Just like a JavaScript Worker, we execute the Worker’s &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/limits/#worker-startup-time\&quot;&gt;top-level scope&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;When a request comes in to your Worker, we load this snapshot and use it to bootstrap your Worker in an isolate, avoiding expensive initialization time:&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card kg-width-wide\&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2q0ztvdb60NUqlAsOWWFX4/203e421e31e25c5794f5fada1ad94c40/apipyth.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;475\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;This takes cold starts for a basic Python Worker down to below 1 second. We’re not yet satisfied with this though. We’re confident that we can drive this down much, much further. How? By reusing memory snapshots.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;reusing-memory-snapshots\&quot;&gt;Reusing Memory Snapshots&lt;/h3&gt;\n            &lt;a href=\&quot;#reusing-memory-snapshots\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;When you upload a Python Worker, we generate a single memory snapshot of the Worker’s top-level imports, including both Pyodide and any dependencies. This snapshot is specific to your Worker. It can’t be shared, even though most of its contents are the same as other Python Workers.&lt;/p&gt;&lt;p&gt;Instead, we can create a single, shared snapshot ahead of time, and preload it into a pool of “pre-warmed” isolates. These isolates would already have the Pyodide runtime loaded and ready — making a Python Worker work just like a JavaScript Worker. In both cases, the underlying interpreter and execution environment is provided by the Workers runtime, and available on-demand without delay. The only difference is that with Python, the interpreter runs in WebAssembly, within the Worker.&lt;/p&gt;&lt;p&gt;Snapshots are a common pattern across runtimes and execution environments. Node.js &lt;a href=\&quot;https://docs.google.com/document/d/1YEIBdH7ocJfm6PWISKw03szNAgnstA2B3e8PZr_-Gp4/edit#heading=h.1v0pvnoifuah\&quot;&gt;uses V8 snapshots to speed up startup time&lt;/a&gt;. You can take &lt;a href=\&quot;https://github.com/firecracker-microvm/firecracker/blob/main/docs/snapshotting/snapshot-support.md\&quot;&gt;snapshots of Firecracker microVMs&lt;/a&gt; and resume execution in a different process. There’s lots more we can do here — not just for Python Workers, but for Workers written in JavaScript as well, caching snapshots of compiled code from top-level scope and the state of the isolate itself. Workers are so fast and efficient that to-date we haven’t had to take snapshots in this way, but we think there are still big performance gains to be had.&lt;/p&gt;&lt;p&gt;This is our biggest lever towards driving cold start times down over the rest of 2024.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;future-proofing-compatibility-with-pyodide-versions-and-compatibility-dates\&quot;&gt;Future proofing compatibility with Pyodide versions and Compatibility Dates&lt;/h2&gt;\n            &lt;a href=\&quot;#future-proofing-compatibility-with-pyodide-versions-and-compatibility-dates\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;When you deploy a Worker to Cloudflare, you expect it to keep running indefinitely, even if you never update it again. There are Workers deployed in 2018 that are still running just fine in production.&lt;/p&gt;&lt;p&gt;We achieve this using &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/compatibility-dates/\&quot;&gt;Compatibility Dates&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/compatibility-dates/#compatibility-flags\&quot;&gt;Compatibility Flags&lt;/a&gt;, which provide explicit opt-in mechanisms for new behavior and potentially backwards-incompatible changes, without impacting existing Workers.&lt;/p&gt;&lt;p&gt;This works in part because it mirrors how the Internet and web browsers work. You publish a web page with some JavaScript, and rightly expect it to work forever. Web browsers and Cloudflare Workers have the same type of commitment of stability to developers.&lt;/p&gt;&lt;p&gt;There is a challenge with Python though — both Pyodide and CPython are &lt;a href=\&quot;https://devguide.python.org/versions/\&quot;&gt;versioned&lt;/a&gt;. Updated versions are published regularly and can contain breaking changes. And Pyodide provides a set of &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/\&quot;&gt;built-in packages&lt;/a&gt;, each with a pinned version number. This presents a question — how should we allow you to update your Worker to a newer version of Pyodide?&lt;/p&gt;&lt;p&gt;The answer is &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/compatibility-dates/\&quot;&gt;Compatibility Dates&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/compatibility-dates/#compatibility-flags\&quot;&gt;Compatibility Flags&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;A new version of Python is released every year in August, and a new version of Pyodide is released six (6) months later. When this new version of Pyodide is published, we will add it to Workers by gating it behind a Compatibility Flag, which is only enabled after a specified Compatibility Date. This lets us continually provide updates, without risk of breaking changes, extending the commitment we’ve made for JavaScript to Python.&lt;/p&gt;&lt;p&gt;Each Python release has a &lt;a href=\&quot;https://devguide.python.org/versions/\&quot;&gt;five (5) year support window&lt;/a&gt;. Once this support window has passed for a given version of Python, security patches are no longer applied, making this version unsafe to rely on. To mitigate this risk, while still trying to hold as true as possible to our commitment of stability and long-term support, after five years any Python Worker still on a Python release that is outside of the support window will be automatically moved forward to the next oldest Python release. Python is a mature and stable language, so we expect that in most cases, your Python Worker will continue running without issue. But we recommend updating the compatibility date of your Worker regularly, to stay within the support window.&lt;/p&gt;&lt;p&gt;In between Python releases, we also expect to update and add additional &lt;a href=\&quot;https://developers.cloudflare.com/workers/languages/python/packages/%5C\&quot;&gt;Python packages&lt;/a&gt;, using the same opt-in mechanism. A Compatibility Flag will be a combination of the Python version and the release date of a set of packages. For example, &lt;b&gt;python_3.17_packages_2025_03_01&lt;/b&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;how-bindings-work-in-python-workers\&quot;&gt;How bindings work in Python Workers&lt;/h2&gt;\n            &lt;a href=\&quot;#how-bindings-work-in-python-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;We mentioned earlier that Pyodide provides a foreign function interface (FFI) to JavaScript — meaning that you can directly use JavaScript objects, methods, functions and more, directly from Python.&lt;/p&gt;&lt;p&gt;This means that from day one, all &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/bindings/\&quot;&gt;binding&lt;/a&gt; APIs to other Cloudflare resources are supported in Cloudflare Workers. The env object that is provided by handlers in Python Workers is a JavaScript object that Pyodide provides a proxy API to, handling &lt;a href=\&quot;https://pyodide.org/en/stable/usage/type-conversions.html\&quot;&gt;type translations&lt;/a&gt; across languages automatically.&lt;/p&gt;&lt;p&gt;For example, to write to and read from a &lt;a href=\&quot;https://developers.cloudflare.com/kv/\&quot;&gt;KV&lt;/a&gt; namespace from a Python Worker, you would write:&lt;/p&gt;\n            &lt;pre class=\&quot;language-js\&quot;&gt;&lt;code class=\&quot;language-js\&quot;&gt;from js import Response\n\nasync def on_fetch(request, env):\n    await env.FOO.put(&amp;quot;bar&amp;quot;, &amp;quot;baz&amp;quot;)\n    bar = await env.FOO.get(&amp;quot;bar&amp;quot;)\n    return Response.new(bar) # returns &amp;quot;baz&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This works for Web APIs too — see how Response is imported from the js module? You can import any global from JavaScript this way.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;get-this-javascript-out-of-my-python\&quot;&gt;Get this JavaScript out of my Python!&lt;/h2&gt;\n            &lt;a href=\&quot;#get-this-javascript-out-of-my-python\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;You’re probably reading this post because you want to write Python &lt;i&gt;instead&lt;/i&gt; of JavaScript. &lt;code&gt;from js import Response&lt;/code&gt; just isn’t Pythonic. We know — and we have actually tackled this challenge before for another language (&lt;a href=\&quot;/workers-rust-sdk\&quot;&gt;Rust&lt;/a&gt;). And we think we can do this even better for Python.&lt;/p&gt;&lt;p&gt;We launched &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;workers-rs&lt;/a&gt; in 2021 to make it possible to write Workers in &lt;a href=\&quot;https://www.rust-lang.org/\&quot;&gt;Rust&lt;/a&gt;. For each JavaScript API in Workers, we, alongside open-source contributors, have written bindings that expose a more idiomatic Rust API.&lt;/p&gt;&lt;p&gt;We plan to do the same for Python Workers — starting with the bindings to &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/\&quot;&gt;Workers AI&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/vectorize/\&quot;&gt;Vectorize&lt;/a&gt;. But while workers-rs requires that you use and update an external dependency, the APIs we provide with Python Workers will be built into the Workers runtime directly. Just update your compatibility date, and get the latest, most Pythonic APIs.&lt;/p&gt;&lt;p&gt;This is about more than just making bindings to resources on Cloudflare more Pythonic though — it’s about compatibility with the ecosystem.&lt;/p&gt;&lt;p&gt;Similar to how we &lt;a href=\&quot;https://github.com/cloudflare/workers-rs/pull/477\&quot;&gt;recently converted&lt;/a&gt; workers-rs to use types from the &lt;a href=\&quot;https://crates.io/crates/http\&quot;&gt;http&lt;/a&gt; crate, which makes it easy to use the &lt;a href=\&quot;https://docs.rs/axum/latest/axum/\&quot;&gt;axum&lt;/a&gt; crate for routing, we aim to do the same for Python Workers. For example, the Python standard library provides a &lt;a href=\&quot;https://docs.python.org/3/library/socket.html\&quot;&gt;raw socket API&lt;/a&gt;, which many Python packages depend on. Workers already provides &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/tcp-sockets/\&quot;&gt;connect()&lt;/a&gt;, a JavaScript API for working with raw sockets. We see ways to provide at least a subset of the Python standard library’s socket API in Workers, enabling a broader set of Python packages to work on Workers, with less of a need for patches.&lt;/p&gt;&lt;p&gt;But ultimately, we hope to kick start an effort to create a standardized serverless API for Python. One that is easy to use for any Python developer and offers the same capabilities as JavaScript.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;were-just-getting-started-with-python-workers\&quot;&gt;We’re just getting started with Python Workers&lt;/h2&gt;\n            &lt;a href=\&quot;#were-just-getting-started-with-python-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Providing true support for a new programming language is a big investment that goes far beyond making “hello world” work. We chose Python very intentionally — it’s the &lt;a href=\&quot;https://survey.stackoverflow.co/2023/#technology-most-popular-technologies\&quot;&gt;second most popular programming language after JavaScript&lt;/a&gt; — and we are committed to continuing to improve performance and widen our support for Python packages.&lt;/p&gt;&lt;p&gt;We’re grateful to the Pyodide maintainers and the broader Python community — and we’d love to hear from you. Drop into the Python Workers channel in the &lt;a href=\&quot;https://discord.cloudflare.com/\&quot;&gt;Cloudflare Developers Discord&lt;/a&gt;, or &lt;a href=\&quot;https://github.com/cloudflare/workerd/discussions/categories/python-packages\&quot;&gt;start a discussion on Github&lt;/a&gt; about what you’d like to see next and which Python packages you’d like us to support.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1nmt4B6AYocqmJCw21v5pL/112dcd395906643cbf8a67de22470e13/Workers-and-Python.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;421\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-04-02T14:00:45.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-11-18T16:13:44.463Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/63CDrfoebRdeBzURcaBzQS/3a4ca7a6bb8dff8c209aecdb7e7544a2/python-workers.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;bEVrfgaUfNXu577TT9qb8&quot;],&quot;name&quot;:[0,&quot;Python&quot;],&quot;slug&quot;:[0,&quot;python&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;4hhzQ9V5KQE5wXF4VtEcoG&quot;],&quot;name&quot;:[0,&quot;WASM&quot;],&quot;slug&quot;:[0,&quot;wasm&quot;]}],[0,{&quot;id&quot;:[0,&quot;2xCnBweKwOI3VXdYsGVbMe&quot;],&quot;name&quot;:[0,&quot;Developer Week&quot;],&quot;slug&quot;:[0,&quot;developer-week&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Hood Chatham&quot;],&quot;slug&quot;:[0,&quot;hood&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5NdWrndYBFiQedDDrsFkey/1d7b25517af6f36b842ee4a94a2d4d84/hood.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Garrett Gu&quot;],&quot;slug&quot;:[0,&quot;garrett-gu&quot;],&quot;bio&quot;:[0,&quot;Passionate about compilers, security, web, and audio.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/73rzJLaDaPLOFGzOEVYmsX/d0d6b2e6f8d19e70bc3d35fb52ed682a/garrett-gu.jpg&quot;],&quot;location&quot;:[0,&quot;Austin, TX&quot;],&quot;website&quot;:[0,&quot;garrettgu.com&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Dominik Picheta&quot;],&quot;slug&quot;:[0,&quot;dominik&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4NQ8NXOh8kIeqTdhVt29Y0/f10eccb58f426dd53a2623dd2d290bff/dominik.jpg&quot;],&quot;location&quot;:[0,&quot;London, England&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@d0m96&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Introducing Cloudflare Workers in Python, now in open beta! We&#39;ve revamped our systems to support Python, from the runtime to deployment. Learn about Python Worker&#39;s lifecycle, dynamic linking, and memory snapshots in this post&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Bringing Python to Workers using Pyodide and WebAssembly Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;Translated for Locale&quot;],&quot;deDE&quot;:[0,&quot;Translated for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;Translated for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;Translated for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/python-workers&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Bringing Python to Workers using Pyodide and WebAssembly&quot;],&quot;description&quot;:[0,&quot;Introducing Cloudflare Workers in Python, now in open beta! We&#39;ve revamped our systems to support Python, from the runtime to deployment. Learn about Python Worker&#39;s lifecycle, dynamic linking, and memory snapshots in this post&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5kSAg5ulwidDto5frTBQnz/4a2f978b132f94b3f5e1f797a5b22bf1/python-workers-LODbFp.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-50-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-100"><a href="/python-workers/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">Bringing Python to Workers using Pyodide and WebAssembly</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2024-04-02</p><div class=""><a href="/tag/developers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developers</a><a href="/tag/workers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Cloudflare Workers</a><a href="/tag/webassembly/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">WebAssembly</a><a href="/tag/python/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Python</a><a href="/tag/developer-platform/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developer Platform</a><a href="/tag/wasm/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">WASM</a><a href="/tag/developer-week/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developer Week</a></div><p class="f3 fw4 gray1 lh-copy " data-testid="post-content">Introducing Cloudflare Workers in Python, now in open beta! We&#x27;ve revamped our systems to support Python, from the runtime to deployment. Learn about Python Worker&#x27;s lifecycle, dynamic linking, and memory snapshots in this post<!-- -->...</p><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/hood/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5NdWrndYBFiQedDDrsFkey/1d7b25517af6f36b842ee4a94a2d4d84/hood.png" alt="Hood Chatham" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/hood/" class="fw4 f3 no-underline black">Hood Chatham</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/garrett-gu/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/73rzJLaDaPLOFGzOEVYmsX/d0d6b2e6f8d19e70bc3d35fb52ed682a/garrett-gu.jpg" alt="Garrett Gu" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/garrett-gu/" class="fw4 f3 no-underline black">Garrett Gu</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/dominik/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4NQ8NXOh8kIeqTdhVt29Y0/f10eccb58f426dd53a2623dd2d290bff/dominik.jpg" alt="Dominik Picheta" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/dominik/" class="fw4 f3 no-underline black">Dominik Picheta</a></div></li></ul></div></article><!--astro:end--></astro-island><astro-island uid="Z9OCCt" prefix="r2" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,false],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;7xtevgzV4ycZa3fIFTQOP5&quot;],&quot;title&quot;:[0,&quot;Wasm core dumps and debugging Rust in Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;wasm-coredumps&quot;],&quot;excerpt&quot;:[0,&quot;Debugging Rust and Wasm with Cloudflare Workers involves a lot of the good old time-consuming and nerve-wracking printf&#39;ing strategy. What if there’s a better way? This blog is about enabling and using Wasm core dumps and how you can easily debug Rust in Cloudflare Workers&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5mXdKDMicecNL6Iy017EXq/9b5a272fb48c3bf892c228984aee6ddd/image4-5.png\&quot; alt=\&quot;Wasm core dumps and debugging Rust in Workers\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1125\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;A clear sign of maturing for any new programming language or environment is how easy and efficient debugging them is. Programming, like any other complex task, involves various challenges and potential pitfalls. Logic errors, off-by-ones, null pointer dereferences, and memory leaks are some examples of things that can make software developers desperate if they can&amp;#39;t pinpoint and fix these issues quickly as part of their workflows and tools.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://webassembly.org/\&quot;&gt;WebAssembly&lt;/a&gt; (Wasm) is a binary instruction format designed to be a portable and efficient target for the compilation of high-level languages like &lt;a href=\&quot;https://www.rust-lang.org/\&quot;&gt;Rust&lt;/a&gt;, C, C++, and others. In recent years, it has gained significant traction for building high-performance applications in web and serverless environments.&lt;/p&gt;&lt;p&gt;Cloudflare Workers has had &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;first-party support for Rust and Wasm&lt;/a&gt; for quite some time. We&amp;#39;ve been using this powerful combination to bootstrap and build some of our most recent services, like &lt;a href=\&quot;/introducing-d1/\&quot;&gt;D1&lt;/a&gt;, &lt;a href=\&quot;/introducing-constellation/\&quot;&gt;Constellation&lt;/a&gt;, and &lt;a href=\&quot;/automatic-signed-exchanges/\&quot;&gt;Signed Exchanges&lt;/a&gt;, to name a few.&lt;/p&gt;&lt;p&gt;Using tools like &lt;a href=\&quot;https://github.com/cloudflare/workers-sdk\&quot;&gt;Wrangler&lt;/a&gt;, our command-line tool for building with Cloudflare developer products, makes streaming real-time logs from our applications running remotely easy. Still, to be honest, debugging Rust and Wasm with Cloudflare Workers involves a lot of the good old time-consuming and nerve-wracking &lt;a href=\&quot;https://news.ycombinator.com/item?id=26925570\&quot;&gt;printf&amp;#39;ing&lt;/a&gt; strategy.&lt;/p&gt;&lt;p&gt;What if there’s a better way? This blog is about enabling and using Wasm core dumps and how you can easily debug Rust in Cloudflare Workers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;what-are-core-dumps\&quot;&gt;What are core dumps?&lt;/h3&gt;\n            &lt;a href=\&quot;#what-are-core-dumps\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In computing, a &lt;a href=\&quot;https://en.wikipedia.org/wiki/Core_dump\&quot;&gt;core dump&lt;/a&gt; consists of the recorded state of the working memory of a computer program at a specific time, generally when the program has crashed or otherwise terminated abnormally. They also add things like the processor registers, stack pointer, program counter, and other information that may be relevant to fully understanding why the program crashed.&lt;/p&gt;&lt;p&gt;In most cases, depending on the system’s configuration, core dumps are usually initiated by the operating system in response to a program crash. You can then use a debugger like &lt;a href=\&quot;https://linux.die.net/man/1/gdb\&quot;&gt;gdb&lt;/a&gt; to examine what happened and hopefully determine the cause of a crash. &lt;a href=\&quot;https://linux.die.net/man/1/gdb\&quot;&gt;gdb&lt;/a&gt; allows you to run the executable to try to replicate the crash in a more controlled environment, inspecting the variables, and much more. The Windows&amp;#39; equivalent of a core dump is a &lt;a href=\&quot;https://learn.microsoft.com/en-us/troubleshoot/windows-client/performance/read-small-memory-dump-file\&quot;&gt;minidump&lt;/a&gt;. Other mature languages that are interpreted, like Python, or languages that run inside a virtual machine, like &lt;a href=\&quot;https://docs.oracle.com/javase/8/docs/technotes/guides/visualvm/coredumps.html\&quot;&gt;Java&lt;/a&gt;, also have their ways of generating core dumps for post-mortem analysis.&lt;/p&gt;&lt;p&gt;Core dumps are particularly useful for post-mortem debugging, determining the conditions that lead to a failure after it has occurred.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;webassembly-core-dumps\&quot;&gt;WebAssembly core dumps&lt;/h3&gt;\n            &lt;a href=\&quot;#webassembly-core-dumps\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;WebAssembly has had a &lt;a href=\&quot;https://github.com/WebAssembly/tool-conventions/blob/main/Coredump.md\&quot;&gt;proposal for implementing core dumps&lt;/a&gt; in discussion for a while. It&amp;#39;s a work-in-progress experimental specification, but it provides basic support for the main ideas of post-mortem debugging, including using the &lt;a href=\&quot;https://yurydelendik.github.io/webassembly-dwarf/\&quot;&gt;DWARF&lt;/a&gt; (debugging with attributed record formats) debug format, the same that Linux and gdb use. Some of the most popular Wasm runtimes, like &lt;a href=\&quot;https://github.com/bytecodealliance/wasmtime/pull/5868\&quot;&gt;Wasmtime&lt;/a&gt; and &lt;a href=\&quot;https://github.com/wasmerio/wasmer/pull/3626\&quot;&gt;Wasmer&lt;/a&gt;, have experimental flags that you can enable and start playing with Wasm core dumps today.&lt;/p&gt;&lt;p&gt;If you run Wasmtime or Wasmer with the flag:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;--coredump-on-trap=/path/to/coredump/file&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The core dump file will be emitted at that location path if a crash happens. You can then use tools like &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/tree/main/bin/wasmgdb\&quot;&gt;wasmgdb&lt;/a&gt; to inspect the file and debug the crash.&lt;/p&gt;&lt;p&gt;But let&amp;#39;s dig into how the core dumps are generated in WebAssembly, and what’s inside them.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;how-are-wasm-core-dumps-generated\&quot;&gt;How are Wasm core dumps generated&lt;/h3&gt;\n            &lt;a href=\&quot;#how-are-wasm-core-dumps-generated\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;(and what’s inside them)&lt;/p&gt;&lt;p&gt;When WebAssembly terminates execution due to abnormal behavior, we say that it entered a trap. With Rust, examples of operations that can trap are accessing out-of-bounds addresses or a division by zero arithmetic call. You can read about the &lt;a href=\&quot;https://webassembly.org/docs/security/\&quot;&gt;security model of WebAssembly&lt;/a&gt; to learn more about traps.&lt;/p&gt;&lt;p&gt;The core dump specification plugs into the trap workflow. When WebAssembly crashes and enters a trap, core dumping support kicks in and starts unwinding the call &lt;a href=\&quot;https://webassembly.github.io/spec/core/exec/runtime.html#stack\&quot;&gt;stack&lt;/a&gt; gathering debugging information. For each frame in the stack, it collects the &lt;a href=\&quot;https://webassembly.github.io/spec/core/syntax/modules.html#syntax-func\&quot;&gt;function&lt;/a&gt; parameters and the values stored in locals and in the stack, along with binary offsets that help us map to exact locations in the source code. Finally, it snapshots the &lt;a href=\&quot;https://webassembly.github.io/spec/core/syntax/modules.html#syntax-mem\&quot;&gt;memory&lt;/a&gt; and captures information like the &lt;a href=\&quot;https://webassembly.github.io/spec/core/syntax/modules.html#syntax-table\&quot;&gt;tables&lt;/a&gt; and the &lt;a href=\&quot;https://webassembly.github.io/spec/core/syntax/modules.html#syntax-global\&quot;&gt;global variables&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://dwarfstd.org/\&quot;&gt;DWARF&lt;/a&gt; is used by many mature languages like C, C++, Rust, Java, or Go. By emitting DWARF information into the binary at compile time a debugger can provide information such as the source name and the line number where the exception occurred, function and argument names, and more. Without DWARF, the core dumps would be just pure assembly code without any contextual information or metadata related to the source code that generated it before compilation, and they would be much harder to debug.&lt;/p&gt;&lt;p&gt;WebAssembly &lt;a href=\&quot;https://webassembly.github.io/spec/core/appendix/custom.html#name-section\&quot;&gt;uses a (lighter) version of DWARF&lt;/a&gt; that maps functions, or a module and local variables, to their names in the source code (you can read about the &lt;a href=\&quot;https://webassembly.github.io/spec/core/appendix/custom.html#name-section\&quot;&gt;WebAssembly name section&lt;/a&gt; for more information), and naturally core dumps use this information.&lt;/p&gt;&lt;p&gt;All this information for debugging is then bundled together and saved to the file, the core dump file.&lt;/p&gt;&lt;p&gt;The &lt;a href=\&quot;https://github.com/WebAssembly/tool-conventions/blob/main/Coredump.md#coredump-file-format\&quot;&gt;core dump structure&lt;/a&gt; has multiple sections, but the most important are:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;General information about the process;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The &lt;a href=\&quot;https://webassembly.github.io/threads/core/\&quot;&gt;threads&lt;/a&gt; and their stack frames (note that WebAssembly is &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/webassembly/#threading\&quot;&gt;single threaded&lt;/a&gt; in Cloudflare Workers);&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;A snapshot of the WebAssembly linear memory or only the relevant regions;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Optionally, other sections like globals, data, or table.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Here’s the thread definition from the core dump specification:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;corestack   ::= customsec(thread-info vec(frame))\nthread-info ::= 0x0 thread-name:name ...\nframe       ::= 0x0 ... funcidx:u32 codeoffset:u32 locals:vec(value)\n                stack:vec(value)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;A thread is a custom section called &lt;code&gt;corestack&lt;/code&gt;. A corestack section contains the thread name and a vector (or array) of frames. Each frame contains the function index in the WebAssembly module (&lt;code&gt;funcidx&lt;/code&gt;), the code offset relative to the function&amp;#39;s start (&lt;code&gt;codeoffset&lt;/code&gt;), the list of locals, and the list of values in the stack.&lt;/p&gt;&lt;p&gt;Values are defined as follows:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;value ::= 0x01       =&amp;gt; ∅\n        | 0x7F n:i32 =&amp;gt; n\n        | 0x7E n:i64 =&amp;gt; n\n        | 0x7D n:f32 =&amp;gt; n\n        | 0x7C n:f64 =&amp;gt; n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;At the time of this writing these are the possible &lt;a href=\&quot;https://webassembly.github.io/spec/core/binary/types.html#binary-numtype\&quot;&gt;numbers types&lt;/a&gt; in a value. Again, we wanted to describe the basics; you should track the full &lt;a href=\&quot;https://github.com/WebAssembly/tool-conventions/blob/main/Coredump.md#coredump-file-format\&quot;&gt;specification&lt;/a&gt; to get more detail or find information about future changes. WebAssembly core dump support is in its early stages of specification and implementation, things will get better, things might change.&lt;/p&gt;&lt;p&gt;This is all great news. Unfortunately, however, the Cloudflare Workers &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;runtime&lt;/a&gt; doesn’t support WebAssembly core dumps yet. There is no technical impediment to adding this feature to &lt;a href=\&quot;https://github.com/cloudflare/workerd\&quot;&gt;workerd&lt;/a&gt;; after all, it&amp;#39;s &lt;a href=\&quot;https://developers.cloudflare.com/workers/learning/how-workers-works/\&quot;&gt;based on V8&lt;/a&gt;, but since it powers a critical part of our production infrastructure and products, we tend to be conservative when it comes to adding specifications or standards that are still considered experimental and still going through the definitions phase.&lt;/p&gt;&lt;p&gt;So, how do we get core Wasm dumps in Cloudflare Workers today?&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;polyfilling\&quot;&gt;Polyfilling&lt;/h3&gt;\n            &lt;a href=\&quot;#polyfilling\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Polyfilling means using userland code to provide modern functionality in older environments that do not natively support it. &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Glossary/Polyfill\&quot;&gt;Polyfills&lt;/a&gt; are widely popular in the JavaScript community and the browser environment; they&amp;#39;ve been used extensively to address issues where browser vendors still didn&amp;#39;t catch up with the latest standards, or when they implement the same features in different ways, or address cases where old browsers can never support a new standard.&lt;/p&gt;&lt;p&gt;Meet &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/tree/main/bin/rewriter\&quot;&gt;wasm-coredump-rewriter&lt;/a&gt;, a tool that you can use to rewrite a Wasm module and inject the core dump runtime functionality in the binary. This runtime code will catch most traps (exceptions in host functions are not yet catched and memory violation not by default) and generate a standard core dump file. To some degree, this is similar to how Binaryen&amp;#39;s &lt;a href=\&quot;https://github.com/WebAssembly/binaryen/blob/main/src/passes/Asyncify.cpp\&quot;&gt;Asyncify&lt;/a&gt; &lt;a href=\&quot;https://kripken.github.io/blog/wasm/2019/07/16/asyncify.html\&quot;&gt;works&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Let’s look at code and see how this works. He’s some simple pseudo code:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;export function entry(v1, v2) {\n    return addTwo(v1, v2)\n}\n\nfunction addTwo(v1, v2) {\n  res = v1 + v2;\n  throw &amp;quot;something went wrong&amp;quot;;\n\n  return res\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;An imaginary compiler could take that source and generate the following Wasm binary code:&lt;/p&gt;\n            &lt;pre class=\&quot;language-webassembly\&quot;&gt;&lt;code class=\&quot;language-webassembly\&quot;&gt;  (func $entry (param i32 i32) (result i32)\n    (local.get 0)\n    (local.get 1)\n    (call $addTwo)\n  )\n\n  (func $addTwo (param i32 i32) (result i32)\n    (local.get 0)\n    (local.get 1)\n    (i32.add)\n    (unreachable) ;; something went wrong\n  )\n\n  (export &amp;quot;entry&amp;quot; (func $entry))&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;&lt;i&gt;“;;” is used to denote a comment.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;entry()&lt;/code&gt; is the Wasm function &lt;a href=\&quot;https://webassembly.github.io/spec/core/exec/runtime.html#syntax-hostfunc\&quot;&gt;exported to the host&lt;/a&gt;. In an environment like the browser, JavaScript (being the host) can call entry().&lt;/p&gt;&lt;p&gt;Irrelevant parts of the code have been snipped for brevity, but this is what the Wasm code will look like after &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/tree/main/bin/rewriter\&quot;&gt;wasm-coredump-rewriter&lt;/a&gt; rewrites it:&lt;/p&gt;\n            &lt;pre class=\&quot;language-webassembly\&quot;&gt;&lt;code class=\&quot;language-webassembly\&quot;&gt;  (func $entry (type 0) (param i32 i32) (result i32)\n    ...\n    local.get 0\n    local.get 1\n    call $addTwo ;; see the addTwo function bellow\n    global.get 2 ;; is unwinding?\n    if  ;; label = @1\n      i32.const x ;; code offset\n      i32.const 0 ;; function index\n      i32.const 2 ;; local_count\n      call $coredump/start_frame\n      local.get 0\n      call $coredump/add_i32_local\n      local.get 1\n      call $coredump/add_i32_local\n      ...\n      call $coredump/write_coredump\n      unreachable\n    end)\n\n  (func $addTwo (type 0) (param i32 i32) (result i32)\n    local.get 0\n    local.get 1\n    i32.add\n    ;; the unreachable instruction was here before\n    call $coredump/unreachable_shim\n    i32.const 1 ;; funcidx\n    i32.const 2 ;; local_count\n    call $coredump/start_frame\n    local.get 0\n    call $coredump/add_i32_local\n    local.get 1\n    call $coredump/add_i32_local\n    ...\n    return)\n\n  (export &amp;quot;entry&amp;quot; (func $entry))&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;As you can see, a few things changed:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;The (unreachable) instruction in &lt;code&gt;addTwo()&lt;/code&gt; was replaced by a call to &lt;code&gt;$coredump/unreachable_shim&lt;/code&gt; which starts the unwinding process. Then, the location and debugging data is captured, and the function returns normally to the &lt;code&gt;entry()&lt;/code&gt; caller.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Code has been added after the &lt;code&gt;addTwo()&lt;/code&gt; call instruction in &lt;code&gt;entry()&lt;/code&gt; that detects if we have an unwinding process in progress or not. If we do, then it also captures the local debugging data, writes the core dump file and then, finally, moves to the unconditional trap unreachable.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;In short, we unwind until the host function &lt;code&gt;entry()&lt;/code&gt; gets destroyed by calling unreachable.&lt;/p&gt;&lt;p&gt;Let’s go over the runtime functions that we inject for more clarity, stay with us:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;$coredump/start_frame(funcidx, local_count)&lt;/code&gt; starts a new frame in the coredump.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;$coredump/add_*_local(value)&lt;/code&gt; captures the values of function arguments and in locals (currently capturing values from the stack isn’t implemented.)&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;$coredump/write_coredump&lt;/code&gt; is used at the end and writes the core dump in memory. We take advantage of the first 1 KiB of the Wasm linear memory, which is unused, to store our core dump.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;A diagram is worth a thousand words:&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/27DxZQioAhBsBiltjwIiyL/2dc57b370b6741120a5bb263c2795652/image2-7.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1372\&quot; height=\&quot;986\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Wait, what’s this about the first 1 KiB of the memory being unused, you ask? Well, it turns out that most WebAssembly linters and tools, including &lt;a href=\&quot;https://github.com/emscripten-core/emscripten/issues/5775#issuecomment-344049528\&quot;&gt;Emscripten&lt;/a&gt; and &lt;a href=\&quot;https://github.com/llvm/llvm-project/blob/121e15f96ce401c875e717992a4d054e308ba775/lld/wasm/Writer.cpp#L366\&quot;&gt;WebAssembly’s LLVM&lt;/a&gt; don’t use the first 1 KiB of memory. &lt;a href=\&quot;https://github.com/rust-lang/rust/issues/50543\&quot;&gt;Rust&lt;/a&gt; and &lt;a href=\&quot;https://github.com/ziglang/zig/issues/4496\&quot;&gt;Zig&lt;/a&gt; also use LLVM, but they changed the default. This isn’t pretty, but the hugely popular Asyncify polyfill relies on the same trick, so there’s reasonable support until we find a better way.&lt;/p&gt;&lt;p&gt;But we digress, let’s continue. After the crash, the host, typically JavaScript in the browser, can now catch the exception and extract the core dump from the Wasm instance’s memory:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;try {\n    wasmInstance.exports.someExportedFunction();\n} catch(err) {\n    const image = new Uint8Array(wasmInstance.exports.memory.buffer);\n    writeFile(&amp;quot;coredump.&amp;quot; + Date.now(), image);\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;If you&amp;#39;re curious about the actual details of the core dump implementation, you can find the &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/blob/main/lib/asc-coredump/assembly/coredump.ts\&quot;&gt;source code here&lt;/a&gt;. It was written in &lt;a href=\&quot;https://www.assemblyscript.org/\&quot;&gt;AssemblyScript&lt;/a&gt;, a TypeScript-like language for WebAssembly.&lt;/p&gt;&lt;p&gt;This is how we use the polyfilling technique to implement Wasm core dumps when the runtime doesn’t support them yet. Interestingly, some Wasm runtimes, being optimizing compilers, are likely to make debugging more difficult because function arguments, locals, or functions themselves can be optimized away. Polyfilling or rewriting the binary could actually preserve more source-level information for debugging.&lt;/p&gt;&lt;p&gt;You might be asking what about performance? We did some testing and found that the &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump-bench/blob/main/results.md\&quot;&gt;impact is negligible&lt;/a&gt;; the cost-benefit of being able to debug our crashes is positive. Also, you can easily turn wasm core dumps on or off for specific builds or environments; deciding when you need them is up to you.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;debugging-from-a-core-dump\&quot;&gt;Debugging from a core dump&lt;/h3&gt;\n            &lt;a href=\&quot;#debugging-from-a-core-dump\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;We now know how to generate a core dump, but how do we use it to diagnose and debug a software crash?&lt;/p&gt;&lt;p&gt;Similarly to &lt;a href=\&quot;https://en.wikipedia.org/wiki/GNU_Debugger\&quot;&gt;gdb&lt;/a&gt; (GNU Project Debugger) on Linux, &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/blob/main/bin/wasmgdb/README.md\&quot;&gt;wasmgdb&lt;/a&gt; is the tool you can use to parse and make sense of core dumps in WebAssembly; it understands the file structure, uses DWARF to provide naming and contextual information, and offers interactive commands to navigate the data. To exemplify how it works, &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/blob/main/bin/wasmgdb/demo.md\&quot;&gt;wasmgdb has a demo&lt;/a&gt; of a Rust application that deliberately crashes; we will use it.&lt;/p&gt;&lt;p&gt;Let&amp;#39;s imagine that our Wasm program crashed, wrote a core dump file, and we want to debug it.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ wasmgdb source-program.wasm /path/to/coredump\nwasmgdb&amp;gt;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;When you fire wasmgdb, you enter a &lt;a href=\&quot;https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop\&quot;&gt;REPL (Read-Eval-Print Loop)&lt;/a&gt; interface, and you can start typing commands. The tool tries to mimic the gdb command syntax; you can find the &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/blob/main/bin/wasmgdb/README.md#commands\&quot;&gt;list here&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Let&amp;#39;s examine the backtrace using the bt command:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;wasmgdb&amp;gt; bt\n#18     000137 as __rust_start_panic () at library/panic_abort/src/lib.rs\n#17     000129 as rust_panic () at library/std/src/panicking.rs\n#16     000128 as rust_panic_with_hook () at library/std/src/panicking.rs\n#15     000117 as {closure#0} () at library/std/src/panicking.rs\n#14     000116 as __rust_end_short_backtrace&amp;lt;std::panicking::begin_panic_handler::{closure_env#0}, !&amp;gt; () at library/std/src/sys_common/backtrace.rs\n#13     000123 as begin_panic_handler () at library/std/src/panicking.rs\n#12     000194 as panic_fmt () at library/core/src/panicking.rs\n#11     000198 as panic () at library/core/src/panicking.rs\n#10     000012 as calculate (value=0x03000000) at src/main.rs\n#9      000011 as process_thing (thing=0x2cff0f00) at src/main.rs\n#8      000010 as main () at src/main.rs\n#7      000008 as call_once&amp;lt;fn(), ()&amp;gt; (???=0x01000000, ???=0x00000000) at /rustc/b833ad56f46a0bbe0e8729512812a161e7dae28a/library/core/src/ops/function.rs\n#6      000020 as __rust_begin_short_backtrace&amp;lt;fn(), ()&amp;gt; (f=0x01000000) at /rustc/b833ad56f46a0bbe0e8729512812a161e7dae28a/library/std/src/sys_common/backtrace.rs\n#5      000016 as {closure#0}&amp;lt;()&amp;gt; () at /rustc/b833ad56f46a0bbe0e8729512812a161e7dae28a/library/std/src/rt.rs\n#4      000077 as lang_start_internal () at library/std/src/rt.rs\n#3      000015 as lang_start&amp;lt;()&amp;gt; (main=0x01000000, argc=0x00000000, argv=0x00000000, sigpipe=0x00620000) at /rustc/b833ad56f46a0bbe0e8729512812a161e7dae28a/library/std/src/rt.rs\n#2      000013 as __original_main () at &amp;lt;directory not found&amp;gt;/&amp;lt;file not found&amp;gt;\n#1      000005 as _start () at &amp;lt;directory not found&amp;gt;/&amp;lt;file not found&amp;gt;\n#0      000264 as _start.command_export at &amp;lt;no location&amp;gt;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Each line represents a frame from the program&amp;#39;s call &lt;a href=\&quot;https://webassembly.github.io/spec/core/exec/runtime.html#stack\&quot;&gt;stack&lt;/a&gt;; see frame #3:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;#3      000015 as lang_start&amp;lt;()&amp;gt; (main=0x01000000, argc=0x00000000, argv=0x00000000, sigpipe=0x00620000) at /rustc/b833ad56f46a0bbe0e8729512812a161e7dae28a/library/std/src/rt.rs&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You can read the funcidx, function name, arguments names and values and source location are all present. Let&amp;#39;s select frame #9 now and inspect the locals, which include the function arguments:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;wasmgdb&amp;gt; f 9\n000011 as process_thing (thing=0x2cff0f00) at src/main.rs\nwasmgdb&amp;gt; info locals\nthing: *MyThing = 0xfff1c&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Let’s use the &lt;code&gt;p&lt;/code&gt; command to inspect the content of the thing argument:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;wasmgdb&amp;gt; p (*thing)\nthing (0xfff2c): MyThing = {\n    value (0xfff2c): usize = 0x00000003\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;You can also use the &lt;code&gt;p&lt;/code&gt; command to inspect the value of the variable, which can be useful for nested structures:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;wasmgdb&amp;gt; p (*thing)-&amp;gt;value\nvalue (0xfff2c): usize = 0x00000003&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;And you can use p to inspect memory addresses. Let’s point at &lt;code&gt;0xfff2c&lt;/code&gt;, the start of the &lt;code&gt;MyThing&lt;/code&gt; structure, and inspect:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;wasmgdb&amp;gt; p (MyThing) 0xfff2c\n0xfff2c (0xfff2c): MyThing = {\n    value (0xfff2c): usize = 0x00000003\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;All this information in every step of the stack is very helpful to determine the cause of a crash. In our test case, if you look at frame #10, we triggered an integer overflow. Once you get comfortable walking through wasmgdb and using its commands to inspect the data, debugging core dumps will be another powerful skill under your belt.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;tidying-up-everything-in-cloudflare-workers\&quot;&gt;Tidying up everything in Cloudflare Workers&lt;/h3&gt;\n            &lt;a href=\&quot;#tidying-up-everything-in-cloudflare-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;We learned about core dumps and how they work, and we know how to make Cloudflare Workers generate them using the wasm-coredump-rewriter polyfill, but how does all this work in practice end to end?&lt;/p&gt;&lt;p&gt;We&amp;#39;ve been dogfooding the technique described in this blog at Cloudflare for a while now. Wasm core dumps have been invaluable in helping us debug Rust-based services running on top of Cloudflare Workers like &lt;a href=\&quot;/introducing-d1/\&quot;&gt;D1&lt;/a&gt;, &lt;a href=\&quot;/privacy-edge-making-building-privacy-first-apps-easier/\&quot;&gt;Privacy Edge&lt;/a&gt;, &lt;a href=\&quot;/announcing-amp-real-url/\&quot;&gt;AMP&lt;/a&gt;, or &lt;a href=\&quot;/introducing-constellation/\&quot;&gt;Constellation&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Today we&amp;#39;re open-sourcing the &lt;a href=\&quot;https://github.com/cloudflare/wasm-coredump\&quot;&gt;Wasm Coredump Service&lt;/a&gt; and enabling anyone to deploy it. This service collects the Wasm core dumps originating from your projects and applications when they crash, parses them, prints an exception with the stack information in the logs, and can optionally store the full core dump in a file in an &lt;a href=\&quot;https://developers.cloudflare.com/r2/\&quot;&gt;R2 bucket&lt;/a&gt; (which you can then use with wasmgdb) or send the exception to &lt;a href=\&quot;https://sentry.io/\&quot;&gt;Sentry&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;We use a &lt;a href=\&quot;https://developers.cloudflare.com/workers/configuration/bindings/about-service-bindings/\&quot;&gt;service binding&lt;/a&gt; to facilitate the communication between your application Worker and the Coredump service Worker. A Service binding allows you to send HTTP requests to another Worker without those requests going over the Internet, thus avoiding network latency or having to deal with authentication. Here’s a diagram of how it works:&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/gntGbV7rjDOncMZhFP7x1/3429a64f297c0edbf3327c677d56e0d3/image1-12.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1520\&quot; height=\&quot;1000\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Using it is as simple as npm/yarn installing &lt;code&gt;@cloudflare/wasm-coredump&lt;/code&gt;, configuring a few options, and then adding a few lines of code to your other applications running in Cloudflare Workers, in the exception handling logic:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import shim, { getMemory, wasmModule } from &amp;quot;../build/worker/shim.mjs&amp;quot;\n\nconst timeoutSecs = 20;\n\nasync function fetch(request, env, ctx) {\n    try {\n        // see https://github.com/rustwasm/wasm-bindgen/issues/2724.\n        return await Promise.race([\n            shim.fetch(request, env, ctx),\n            new Promise((r, e) =&amp;gt; setTimeout(() =&amp;gt; e(&amp;quot;timeout&amp;quot;), timeoutSecs * 1000))\n        ]);\n    } catch (err) {\n      const memory = getMemory();\n      const coredumpService = env.COREDUMP_SERVICE;\n      await recordCoredump({ memory, wasmModule, request, coredumpService });\n      throw err;\n    }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The &lt;code&gt;../build/worker/shim.mjs&lt;/code&gt; import comes from the &lt;a href=\&quot;https://github.com/cloudflare/workers-rs/tree/main/worker-build\&quot;&gt;worker-build&lt;/a&gt; tool, from the &lt;a href=\&quot;https://github.com/cloudflare/workers-rs/tree/main\&quot;&gt;workers-rs&lt;/a&gt; packages and is automatically generated when &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/install-and-update/\&quot;&gt;wrangler&lt;/a&gt; builds your Rust-based Cloudflare Workers project. If the Wasm throws an exception, we catch it, extract the core dump from memory, and send it to our Core dump service.&lt;/p&gt;&lt;p&gt;You might have noticed that we race the &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;workers-rs&lt;/a&gt; &lt;code&gt;shim.fetch()&lt;/code&gt; entry point with another Promise to generate a timeout exception if the Rust code doesn&amp;#39;t respond earlier. This is because currently, &lt;a href=\&quot;https://github.com/rustwasm/wasm-bindgen/\&quot;&gt;wasm-bindgen&lt;/a&gt;, which generates the glue between the JavaScript and Rust land, used by workers-rs, has &lt;a href=\&quot;https://github.com/rustwasm/wasm-bindgen/issues/2724\&quot;&gt;an issue&lt;/a&gt; where a Promise might not be rejected if Rust panics asynchronously (leading to the Worker runtime killing the worker with “Error: The script will never generate a response”.). This can block the wasm-coredump code and make the core dump generation flaky.&lt;/p&gt;&lt;p&gt;We are working to improve this, but in the meantime, make sure to adjust &lt;code&gt;timeoutSecs&lt;/code&gt; to something slightly bigger than the typical response time of your application.&lt;/p&gt;&lt;p&gt;Here’s an example of a Wasm core dump exception in Sentry:&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/gqZyPFslc9uqCV7jEgaqW/9425701b4209952518e3aef155d9b572/image3-4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1083\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;You can find a &lt;a href=\&quot;https://github.com/cloudflare/wasm-coredump/tree/main/example\&quot;&gt;working example&lt;/a&gt;, the Sentry and R2 configuration options, and more details in the &lt;a href=\&quot;https://github.com/cloudflare/wasm-coredump\&quot;&gt;@cloudflare/wasm-coredump&lt;/a&gt; GitHub repository.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;too-big-to-fail\&quot;&gt;Too big to fail&lt;/h3&gt;\n            &lt;a href=\&quot;#too-big-to-fail\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;It&amp;#39;s worth mentioning one corner case of this debugging technique and the solution: sometimes your codebase is so big that adding core dump and DWARF debugging information might result in a Wasm binary that is too big to fit in a Cloudflare Worker. Well, worry not; we have a solution for that too.&lt;/p&gt;&lt;p&gt;Fortunately the DWARF for WebAssembly specification also supports &lt;a href=\&quot;https://yurydelendik.github.io/webassembly-dwarf/#external-DWARF\&quot;&gt;external DWARF files&lt;/a&gt;. To make this work, we have a tool called &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/tree/main/bin/debuginfo-split\&quot;&gt;debuginfo-split&lt;/a&gt; that you can add to the build command in the &lt;code&gt;wrangler.toml&lt;/code&gt; configuration:&lt;/p&gt;\n            &lt;pre class=\&quot;language-toml\&quot;&gt;&lt;code class=\&quot;language-toml\&quot;&gt;command = &amp;quot;... &amp;amp;&amp;amp; debuginfo-split ./build/worker/index.wasm&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;What this does is it strips the debugging information from the Wasm binary, and writes it to a new separate file called &lt;code&gt;debug-{UUID}.wasm&lt;/code&gt;. You then need to upload this file to the same R2 bucket used by the Wasm Coredump Service (you can automate this as part of your CI or build scripts). The same UUID is also injected into the main Wasm binary; this allows us to correlate the Wasm binary with its corresponding DWARF debugging information. Problem solved.&lt;/p&gt;&lt;p&gt;Binaries without DWARF information can be significantly smaller. Here’s our example:&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;style type=\&quot;text/css\&quot;&gt;\n.tg  {border-collapse:collapse;border-spacing:0;}\n.tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;\n  overflow:hidden;padding:10px 5px;word-break:normal;}\n.tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;\n  font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}\n.tg .tg-0lax{text-align:left;vertical-align:top}\n&lt;/style&gt;\n&lt;table class=\&quot;tg\&quot; width=\&quot;100%\&quot;&gt;\n&lt;thead&gt;\n  &lt;tr&gt;\n    &lt;th class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;4.5 MiB&lt;/span&gt;&lt;/th&gt;\n    &lt;th class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;debug-63372dbe-41e6-447d-9c2e-e37b98e4c656.wasm&lt;/span&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n  &lt;tr&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;313 KiB&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\&quot;tg-0lax\&quot;&gt;&lt;span style=\&quot;font-weight:400;font-style:normal;text-decoration:none;color:#000;background-color:transparent\&quot;&gt;build/worker/index.wasm&lt;/span&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;&lt;!--kg-card-end: html--&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;final-words\&quot;&gt;Final words&lt;/h3&gt;\n            &lt;a href=\&quot;#final-words\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;We hope you enjoyed reading this blog as much as we did writing it and that it can help you take your Wasm debugging journeys, using Cloudflare Workers or not, to another level.&lt;/p&gt;&lt;p&gt;Note that while the examples used here were around using Rust and WebAssembly because that&amp;#39;s a common pattern, you can use the same techniques if you&amp;#39;re compiling WebAssembly from other languages like C or C++.&lt;/p&gt;&lt;p&gt;Also, note that the WebAssembly core dump standard is a hot topic, and its implementations and adoption are evolving quickly. We will continue improving the &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/tree/main/bin/rewriter\&quot;&gt;wasm-coredump-rewriter&lt;/a&gt;, &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/tree/main/bin/debuginfo-split\&quot;&gt;debuginfo-split&lt;/a&gt;, and &lt;a href=\&quot;https://github.com/xtuc/wasm-coredump/tree/main/bin/wasmgdb\&quot;&gt;wasmgdb&lt;/a&gt; tools and the &lt;a href=\&quot;https://github.com/cloudflare/wasm-coredump\&quot;&gt;wasm-coredump service&lt;/a&gt;. More and more runtimes, including V8, will eventually support core dumps natively, thus eliminating the need to use polyfills, and the tooling, in general, will get better; that&amp;#39;s a certainty. For now, we present you with a solution that works today, and we have strong incentives to keep supporting it.&lt;/p&gt;&lt;p&gt;As usual, you can talk to us on our &lt;a href=\&quot;https://discord.cloudflare.com/\&quot;&gt;Developers Discord&lt;/a&gt; or the &lt;a href=\&quot;https://community.cloudflare.com/c/developers/constellation/97\&quot;&gt;Community forum&lt;/a&gt; or open issues or PRs in our GitHub repositories; the team will be listening.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2023-08-14T14:00:33.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:25:13.577Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5Yyn1buoS0XypIGN6rFH0E/763bee524ecc9557f1e6aafddaaa3893/wasm-coredumps.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;4hhzQ9V5KQE5wXF4VtEcoG&quot;],&quot;name&quot;:[0,&quot;WASM&quot;],&quot;slug&quot;:[0,&quot;wasm&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;w4e8pkoz9c8xNDVhy9eNe&quot;],&quot;name&quot;:[0,&quot;Rust&quot;],&quot;slug&quot;:[0,&quot;rust&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Sven Sauleau&quot;],&quot;slug&quot;:[0,&quot;sven&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4AvybzTkWLlF4cdTgLrE3q/0d45d87578c7668f3d62e49095bb4409/sven.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@svensauleau&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Celso Martinho&quot;],&quot;slug&quot;:[0,&quot;celso&quot;],&quot;bio&quot;:[0,&quot;From when Mosaic took over Gopher. Engineering Director at Cloudflare.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2pzgat1zmt1oF1byi7hskH/7b25e8e00117ee44afe36ad27d7d8032/celso.png&quot;],&quot;location&quot;:[0,&quot;Portugal, Lisbon&quot;],&quot;website&quot;:[0,&quot;https://celso.io/&quot;],&quot;twitter&quot;:[0,&quot;@celso&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Debugging Rust and Wasm with Cloudflare Workers involves a lot of the good old time-consuming and nerve-wracking printf&#39;ing strategy. What if there’s a better way? This blog is about enabling and using Wasm core dumps and how you can easily debug Rust in Cloudflare Workers.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Wasm core dumps and debugging Rust in Cloudflare Workers Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/wasm-coredumps&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Wasm core dumps and debugging Rust in Cloudflare Workers&quot;],&quot;description&quot;:[0,&quot;Debugging Rust and Wasm with Cloudflare Workers involves a lot of the good old time-consuming and nerve-wracking printf&#39;ing strategy. What if there’s a better way? This blog is about enabling and using Wasm core dumps and how you can easily debug Rust in Cloudflare Workers.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1KjAQe3DsacU4jhgZLy48w/49f493203c1a6475ba3ae414d159c8e8/wasm-coredumps-GlVUff.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-50-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-100"><a href="/wasm-coredumps/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">Wasm core dumps and debugging Rust in Cloudflare Workers</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2023-08-14</p><div class=""><a href="/tag/workers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Cloudflare Workers</a><a href="/tag/wasm/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">WASM</a><a href="/tag/webassembly/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">WebAssembly</a><a href="/tag/rust/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Rust</a><a href="/tag/developers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developers</a><a href="/tag/developer-platform/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developer Platform</a></div><p class="f3 fw4 gray1 lh-copy " data-testid="post-content">Debugging Rust and Wasm with Cloudflare Workers involves a lot of the good old time-consuming and nerve-wracking printf&#x27;ing strategy. What if there’s a better way? This blog is about enabling and using Wasm core dumps and how you can easily debug Rust in Cloudflare Workers<!-- -->...</p><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/sven/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4AvybzTkWLlF4cdTgLrE3q/0d45d87578c7668f3d62e49095bb4409/sven.jpg" alt="Sven Sauleau" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/sven/" class="fw4 f3 no-underline black">Sven Sauleau</a></div></li><li class="list flex items-center pr2 mb3"><a href="/author/celso/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2pzgat1zmt1oF1byi7hskH/7b25e8e00117ee44afe36ad27d7d8032/celso.png" alt="Celso Martinho" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/celso/" class="fw4 f3 no-underline black">Celso Martinho</a></div></li></ul></div></article><!--astro:end--></astro-island><astro-island uid="Qer9p" prefix="r3" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,false],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;55qq7fR9xOWSZtN9TZgrik&quot;],&quot;title&quot;:[0,&quot;Use the language of your choice with Pages Functions via WebAssembly&quot;],&quot;slug&quot;:[0,&quot;pages-functions-with-webassembly&quot;],&quot;excerpt&quot;:[0,&quot;Today Pages is excited to offer support for WebAssembly when writing a Pages Function&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4JtGJ8MIiHZVMkCWPqCp3s/94e735629b4710ef2ba8c25a32e1ee6f/image1-48.png\&quot; alt=\&quot;Use the language of your choice with Pages Functions via WebAssembly\&quot; class=\&quot;kg-image\&quot; width=\&quot;1801\&quot; height=\&quot;1013\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;On the Cloudflare Developer Platform, we understand that building any application is a unique experience for every developer. We know that in the developer ecosystem there are a plethora of tools to choose from and as a developer you have preferences and needs. We don’t believe there are “right” or “wrong” tools to use in development and want to ensure a good developer experience no matter your choices. We believe in meeting you where you are.&lt;/p&gt;&lt;p&gt;When Pages Functions moved to &lt;a href=\&quot;/pages-function-goes-ga/\&quot;&gt;Generally Available in November of last year&lt;/a&gt;, we knew it was the key that unlocks a variety of use cases – namely full-stack applications! However, we still felt we could do more to provide the flexibility for you to build what you want and how you want.&lt;/p&gt;&lt;p&gt;That’s why today we’re opening the doors to developers who want to build their server side applications with something other than JavaScript. We’re excited to announce WebAssembly support for Pages Functions projects!&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://webassembly.org/\&quot;&gt;&lt;b&gt;WebAssembly&lt;/b&gt;&lt;/a&gt; &lt;b&gt;(or Wasm)&lt;/b&gt; is a low-level assembly-like language that can run with near-native performance. It provides programming languages such as C/C++, C# or Rust with a compilation target, enabling them to run alongside JavaScript. Primarily designed to run on the &lt;a href=\&quot;https://webassembly.org/docs/web/\&quot;&gt;web&lt;/a&gt; (though &lt;a href=\&quot;https://webassembly.org/docs/non-web/\&quot;&gt;not exclusively&lt;/a&gt;), WebAssembly opens up exciting opportunities for applications to run on the web platform, both on the client and the server, that up until now couldn&amp;#39;t have done so.&lt;/p&gt;&lt;p&gt;With Pages Functions being Workers “under the hood” and Workers having &lt;a href=\&quot;/workers-javascript-modules/\&quot;&gt;Wasm module support&lt;/a&gt; for quite &lt;a href=\&quot;/webassembly-on-cloudflare-workers/\&quot;&gt;some time&lt;/a&gt;, it is only natural that Pages provides a similar experience for our users as well. While not all use cases are a good fit for Wasm, there are &lt;a href=\&quot;https://webassembly.org/docs/use-cases/\&quot;&gt;many&lt;/a&gt; that are. Our goal with adding Wasm support is enabling those use cases and expanding the boundaries of what Functions can build.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;using-webassembly-in-pages-functions\&quot;&gt;Using WebAssembly in Pages Functions&lt;/h3&gt;\n            &lt;a href=\&quot;#using-webassembly-in-pages-functions\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;WebAssembly in Pages Functions works very similar to how it does today in Workers — we read &lt;code&gt;wasm&lt;/code&gt; files as WebAssembly modules, ready for you to import and use directly from within your Functions. In short, like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// functions/api/distance-between.js\n\nimport wasmModule from &amp;quot;../../pkg/distance.wasm&amp;quot;;\n\nexport async function onRequest({ request }) {\n  const moduleInstance = await WebAssembly.instantiate(wasmModule);\n  const distance = await moduleInstance.exports.distance_between();\n\n  return new Response(distance);\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Let’s briefly unpack the code snippet above to highlight some things that are important to understand.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import wasmModule from &amp;quot;../../pkg/distance.wasm&amp;quot;;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Pages makes no assumptions as to how the binary &lt;code&gt;.wasm&lt;/code&gt; files you want to import were compiled. In our example above, &lt;code&gt;distance.wasm&lt;/code&gt; can be a file you compiled yourself out of code you wrote, or equally, a file provided in a third-party library’s distribution. The only thing Pages cares about is that &lt;code&gt;distance.wasm&lt;/code&gt; is a compiled &lt;a href=\&quot;https://webassembly.github.io/spec/core/binary/conventions.html\&quot;&gt;binary&lt;/a&gt; Wasm &lt;a href=\&quot;https://webassembly.github.io/spec/core/binary/modules.html\&quot;&gt;module&lt;/a&gt; file.&lt;/p&gt;&lt;p&gt;The result of that import is a &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/WebAssembly/JavaScript_interface/Module\&quot;&gt;&lt;code&gt;WebAssembly.Module&lt;/code&gt;&lt;/a&gt; object, which you can then &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/WebAssembly/JavaScript_interface/instantiate\&quot;&gt;instantiate&lt;/a&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;const moduleInstance = await WebAssembly.instantiate(wasmModule);&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Once the &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/WebAssembly/JavaScript_interface/Instance\&quot;&gt;&lt;code&gt;WebAssembly.Instance&lt;/code&gt;&lt;/a&gt; object is created, you can start using whatever features your Wasm module &lt;a href=\&quot;https://webassembly.github.io/spec/core/syntax/modules.html#syntax-export\&quot;&gt;&lt;code&gt;exports&lt;/code&gt;&lt;/a&gt;, inside your Functions code:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;const distance = await moduleInstance.exports.distance_between();&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;more-modules-more-fun\&quot;&gt;More modules, more fun!&lt;/h3&gt;\n            &lt;a href=\&quot;#more-modules-more-fun\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Apart from Wasm modules, this work unlocks support for two other module types that you can import within your Functions code: &lt;b&gt;text&lt;/b&gt; and &lt;b&gt;binary&lt;/b&gt;. These are not standardized modules, but can be very handy if you need to import raw text blobs (such as HTML files) as a &lt;code&gt;string&lt;/code&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// functions/my-function.js\nimport html from &amp;quot;404.html&amp;quot;;\n\nexport async function onRequest() {\n  return new Response(html,{\n    headers: { &amp;quot;Content-Type&amp;quot;: &amp;quot;text/html&amp;quot; }\n  });\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;or raw data blobs (such as images) as an &lt;code&gt;ArrayBuffer&lt;/code&gt;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;// functions/my-function.js\nimport image from &amp;quot;../hearts.png.bin&amp;quot;;\n\nexport async function onRequest() {\n  return new Response(image,{\n    headers: { &amp;quot;Content-Type&amp;quot;: &amp;quot;image/png&amp;quot; }\n  });\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-distance-between-us-on-the-surface-of-earth\&quot;&gt;The distance between us on the surface of Earth&lt;/h3&gt;\n            &lt;a href=\&quot;#the-distance-between-us-on-the-surface-of-earth\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Let’s take a look at a live example to see it all in action! We’ve built a small &lt;a href=\&quot;https://pages-with-wasm-demo.pages.dev/\&quot;&gt;demo app&lt;/a&gt; that walks you through an example of Functions with WebAssembly end-to-end. You can check out the code of our demo application available on &lt;a href=\&quot;https://github.com/cloudflare/pages-fns-with-wasm-demo\&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;The application computes the distance in kilometers on the surface of Earth between your current location (based on the geo coordinates of the incoming &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/request/#incomingrequestcfproperties\&quot;&gt;request&lt;/a&gt;) and any other point on the globe, each time you click on the globe&amp;#39;s surface.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4ZkZSyM2pJghHYzcwgfw3T/3c3609ec59bb6589d7a575177cbf602e/image3-31.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1079\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;The code that performs the actual high-performance distance calculation is written in Rust, and is a slight adaptation of the &lt;a href=\&quot;https://rust-lang-nursery.github.io/rust-cookbook/science/mathematics/trigonometry.html#distance-between-two-points-on-the-earth\&quot;&gt;example&lt;/a&gt; provided in the &lt;a href=\&quot;https://rust-lang-nursery.github.io/rust-cookbook/\&quot;&gt;Rust cookbook&lt;/a&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-rust\&quot;&gt;&lt;code class=\&quot;language-rust\&quot;&gt;fn distance_between(from_latitude_degrees: f64, from_longitude_degrees: f64, to_latitude_degrees: f64, to_longitude_degrees: f64) -&amp;gt; f64 {\n    let earth_radius_kilometer = 6371.0_f64;\n\n    let from_latitude = from_latitude_degrees.to_radians();\n    let to_latitude = to_latitude_degrees.to_radians();\n\n    let delta_latitude = (from_latitude_degrees - to_latitude_degrees).to_radians();\n    let delta_longitude = (from_longitude_degrees - to_longitude_degrees).to_radians();\n\n    let central_angle_inner = (delta_latitude / 2.0).sin().powi(2)\n        + from_latitude.cos() * to_latitude.cos() * (delta_longitude / 2.0).sin().powi(2);\n    let central_angle = 2.0 * central_angle_inner.sqrt().asin();\n\n    let distance = earth_radius_kilometer * central_angle;\n    \n    return distance;\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We have a Rust playground experiment available &lt;a href=\&quot;https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=b60cdd8c60bed969c03bf5b87914c196\&quot;&gt;here&lt;/a&gt;, in case you want to play around with this code snippet in particular.&lt;/p&gt;&lt;p&gt;To use the &lt;code&gt;distance_between()&lt;/code&gt; Rust function in Pages Functions, we first compile the code to WebAssembly using &lt;a href=\&quot;https://github.com/rustwasm/wasm-pack\&quot;&gt;&lt;code&gt;wasm-pack&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-rust\&quot;&gt;&lt;code class=\&quot;language-rust\&quot;&gt;##\n# generate the `pkg` folder which will contain the wasm binary\n##\nwasm-pack build&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Then, we import the generated &lt;code&gt;.wasm&lt;/code&gt; artifact from inside our &lt;code&gt;distance-between.js&lt;/code&gt; Pages Function. Now, each time you click on the globe surface, a request to &lt;code&gt;/api/distance-between&lt;/code&gt; is made, which will trigger the &lt;code&gt;distance_between()&lt;/code&gt; function to execute. Once computed, the distance value is returned by our Function, back to the client, which proceeds to display the value to the user.&lt;/p&gt;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1nWcWHd4MNnPVEZQ8A3MwE/868b091b3b4849d2c6d9848a737eb476/image2-23.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1136\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;We want to point out that this application could have been built entirely in JavaScript, however, we equally wanted to show just how simple it is to build it with Rust. The decision to use Rust was motivated by a few factors. First, the tooling ecosystem for building and working with Rust-generated WebAssembly is quite mature, well documented, and easy to get started with. Second, the Rust &lt;a href=\&quot;https://www.rust-lang.org/learn\&quot;&gt;docs&lt;/a&gt; are a fantastic resource if you are new to Rust or to Rust with WebAssembly! If you are looking for a step-by-step tutorial on how to generate and set up a Rust and WebAssembly project, we highly recommend checking out Rust’s official &lt;a href=\&quot;https://rustwasm.github.io/docs/book/introduction.html\&quot;&gt;WebAssembly Book&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;We hope it gives you a solid starting point in exploring what is possible with Wasm on Pages Functions, and inspires you to create some powerful applications of your own. Head over to our &lt;a href=\&quot;https://developers.cloudflare.com/pages/platform/functions/module-support/#module-support\&quot;&gt;docs&lt;/a&gt; to get started today!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2023-03-24T13:00:00.000+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:23:34.210Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7eWiuW2wn8OD7KPDTn0PAA/0451c9180366f0c812f4eadee3171229/pages-functions-with-webassembly.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3kr4meEhp1NrKwm01XXeqk&quot;],&quot;name&quot;:[0,&quot;Cloudflare Pages&quot;],&quot;slug&quot;:[0,&quot;cloudflare-pages&quot;]}],[0,{&quot;id&quot;:[0,&quot;4hhzQ9V5KQE5wXF4VtEcoG&quot;],&quot;name&quot;:[0,&quot;WASM&quot;],&quot;slug&quot;:[0,&quot;wasm&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Carmen Popoviciu&quot;],&quot;slug&quot;:[0,&quot;carmen&quot;],&quot;bio&quot;:[0,&quot;I am a systems engineer on the Pages team. I enjoy building things on the web and being involved in the developer community.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3erUcRopiA9MmArIyQ8eoR/ea6f98d36f567630fc626ff90c2f6e28/carmen.png&quot;],&quot;location&quot;:[0,&quot;Amsterdam, The Netherlands&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@carmenpopoviciu&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Today Pages is excited to offer support for WebAssembly when writing a Pages Function.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Use the language of your choice with Pages Functions via WebAssembly Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/pages-functions-with-webassembly&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Use the language of your choice with Pages Functions via WebAssembly&quot;],&quot;description&quot;:[0,&quot;Today Pages is excited to offer support for WebAssembly when writing a Pages Function.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3ylCsSG9KaBEaEXiG2HLyv/01358f3b02a93e7b9c16a8cc7d11cbff/pages-functions-with-webassembly-3PuBBu.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-50-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-100"><a href="/pages-functions-with-webassembly/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">Use the language of your choice with Pages Functions via WebAssembly</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2023-03-24</p><div class=""><a href="/tag/cloudflare-pages/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Cloudflare Pages</a><a href="/tag/wasm/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">WASM</a><a href="/tag/webassembly/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">WebAssembly</a><a href="/tag/workers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Cloudflare Workers</a><a href="/tag/developers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developers</a><a href="/tag/developer-platform/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developer Platform</a></div><p class="f3 fw4 gray1 lh-copy " data-testid="post-content">Today Pages is excited to offer support for WebAssembly when writing a Pages Function<!-- -->...</p><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/carmen/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3erUcRopiA9MmArIyQ8eoR/ea6f98d36f567630fc626ff90c2f6e28/carmen.png" alt="Carmen Popoviciu" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/carmen/" class="fw4 f3 no-underline black">Carmen Popoviciu</a></div></li></ul></div></article><!--astro:end--></astro-island><astro-island uid="ZmV2ou" prefix="r4" component-url="/_astro/PostCard.DalyEN7z.js" component-export="PostCard" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;currentPage&quot;:[0,1],&quot;isFeaturedImageFirstPost&quot;:[0,false],&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;5Xy5uTuM3ghJ0CV01dfsLi&quot;],&quot;title&quot;:[0,&quot;Running Zig with WASI on Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;running-zig-with-wasi-on-cloudflare-workers&quot;],&quot;excerpt&quot;:[0,&quot;After the recent announcement regarding WASI support in Workers I decided to see what it would take to get code written in Zig to run as a Worker, and it turned out to be pretty trivial. This post documents the process I followed&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6IYT1Gc6y5cogG4X4H9skK/583baf4700006967596b41b2dbff7908/image1-4.png\&quot; alt=\&quot;Running Zig with WASI on Cloudflare Workers\&quot; class=\&quot;kg-image\&quot; width=\&quot;1801\&quot; height=\&quot;1013\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;After the recent announcement regarding &lt;a href=\&quot;/announcing-wasi-on-workers/\&quot;&gt;WASI support in Workers&lt;/a&gt;, I decided to see what it would take to get code written in &lt;a href=\&quot;https://ziglang.org/\&quot;&gt;Zig&lt;/a&gt; to run as a Worker, and it turned out to be trivial. This post documents the process I followed as a new user of Zig. It’s so exciting to see how Cloudflare Workers is a polyglot platform allowing you to write programs in the language you love, or the language you’re learning!&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;hello-world\&quot;&gt;Hello, World!&lt;/h3&gt;\n            &lt;a href=\&quot;#hello-world\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;I’m not a Zig expert by any means, and to keep things entirely honest I’ve only just started looking into the language, but we all have to start somewhere. So, if my Zig code isn’t perfect please bear with me. My goal was to build a real, small program using Zig and deploy it on Cloudflare Workers. And to see how fast I can go from a blank screen to production code.&lt;/p&gt;&lt;p&gt;My goal for this wasn’t ambitious, just read some text from stdin and print it to stdout with line numbers, like running &lt;code&gt;cat -n&lt;/code&gt;. But it does show just how easy the Workers paradigm is. This Zig program works identically on the command-line on my laptop and as an HTTP API deployed on Cloudflare Workers.&lt;/p&gt;&lt;p&gt;Here’s my code. It reads a line from stdin and outputs the same line prefixed with a line number. It terminates when there’s no more input.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;const std = @import(&amp;quot;std&amp;quot;);\n\npub fn main() anyerror!void {\n\t// setup allocator\n\tvar gpa = std.heap.GeneralPurposeAllocator(.{}){};\n\tdefer std.debug.assert(!gpa.deinit());\n\tconst allocator = gpa.allocator();\n\n\t// setup streams\n\tconst stdout = std.io.getStdOut().writer();\n\tconst in = std.io.getStdIn();\n\tvar reader = std.io.bufferedReader(in.reader()).reader();\n\n\tvar counter: u32 = 1;\n\n\t// read input line by line\n\twhile (try reader.readUntilDelimiterOrEofAlloc(allocator, &amp;#039;\\n&amp;#039;, std.math.maxInt(usize))) |line| {\n    \t    defer allocator.free(line);\n    \t    try stdout.print(&amp;quot;{d}\\t{s}\\n&amp;quot;, .{counter, line});\n    \t    counter = counter + 1;\n\t}\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;To build Zig code, you create a &lt;code&gt;build.zig&lt;/code&gt; file that defines how to build your project. For this trivial case I just opted to build an executable from the sources&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;const std = @import(&amp;quot;std&amp;quot;);\n\npub fn build(b: *std.build.Builder) void {\n\tconst target = b.standardTargetOptions(.{});\n\tconst mode = b.standardReleaseOptions();\n\n\tconst exe = b.addExecutable(&amp;quot;print-with-line-numbers&amp;quot;, &amp;quot;src/main.zig&amp;quot;);\n\texe.setTarget(target);\n\texe.setBuildMode(mode);\n\texe.install();\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;By running &lt;code&gt;zig build&lt;/code&gt; the compiler will run and output a binary under &lt;code&gt;zig-out/bin&lt;/code&gt;&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ zig build\n\n$ ls zig-out/bin\nprint-with-line-numbers\n\n$ echo &amp;quot;Hello\\nWorld&amp;quot; | ./zig-out/bin/print-with-line-numbers\n1    Hello\n2    World&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;wasi\&quot;&gt;WASI&lt;/h3&gt;\n            &lt;a href=\&quot;#wasi\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The next step is to get this running on Workers, but first I need to compile it into WASM with WASI support.&lt;/p&gt;&lt;p&gt;Thankfully, this comes out of the box with recent versions of Zig, so you can just tell the compiler to build your executable using the &lt;code&gt;wasm32-wasi&lt;/code&gt; target, which will produce a file that can be run on any WASI-compatible WebAssembly runtime, such as &lt;a href=\&quot;https://wasmtime.dev/\&quot;&gt;wasmtime&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;This same .wasm file can be run in wasmtime and deployed directly to Cloudflare Workers. This makes building, testing and deploying seamless.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ zig build -Dtarget=wasm32-wasi\n\n$ ls zig-out/bin\nprint-with-line-numbers.wasm\n\n$ echo &amp;quot;Hello\\nWorld&amp;quot; | wasmtime ./zig-out/bin/print-with-line-numbers.wasm\n1    Hello\n2    World&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;zig-on-workers\&quot;&gt;Zig on Workers&lt;/h3&gt;\n            &lt;a href=\&quot;#zig-on-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;With our binary ready to go, the last piece is to get it running on Cloudflare Workers using &lt;a href=\&quot;/wrangler-v2-beta/\&quot;&gt;wrangler2&lt;/a&gt;. That is as simple as publishing the .wasm file on workers.dev. If you don’t have a &lt;a href=\&quot;https://workers.dev\&quot;&gt;workers.dev&lt;/a&gt; account, you can follow the tutorial on our &lt;a href=\&quot;https://developers.cloudflare.com/workers/get-started/guide/\&quot;&gt;getting started guide&lt;/a&gt; that will get you from code to deployment within minutes!&lt;/p&gt;&lt;p&gt;In fact, once I signed up for my account, all I needed to do was complete the first two steps, install wrangler and login.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ npx wrangler@wasm login\nAttempting to login via OAuth...\nOpening a link in your default browser: https://dash.cloudflare.com/oauth2/auth\nSuccessfully logged in.&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Then, I ran the following command to publish my worker:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ npx wrangler@wasm publish --name print-with-line-numbers --compatibility-date=2022-07-07 zig-out/bin/print-with-line-numbers.wasm\nUploaded print-with-line-numbers (3.04 sec)\nPublished print-with-line-numbers (6.28 sec)\n  print-with-line-numbers.workers.dev&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;With that step completed, the worker is ready to run and can be invoked by calling the URL printed from the output above.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;echo &amp;quot;Hello\\nWorld&amp;quot; | curl https://print-with-line-numbers.workers.dev -X POST --data-binary @-\n1    Hello\n2    World&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Success!&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;conclusion\&quot;&gt;Conclusion&lt;/h3&gt;\n            &lt;a href=\&quot;#conclusion\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;What impressed me the most here was just how easy this process was.&lt;/p&gt;&lt;p&gt;First, I had a binary compiled for the architecture of my laptop, then I compiled the code into WebAssembly by just passing a flag to the compiler, and finally I had this running on workers &lt;b&gt;without having to change any code.&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Granted, this program was not very complicated and does not do anything other than read from STDIN and write to STDOUT, but it gives me confidence of what is possible, especially as technology like WASI matures.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2022-08-01T15:12:26.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:19:41.828Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1dwbRYEZNLwufUY4kUq6Ok/f4d900fc4b54dbeffd20dac3b7607108/running-zig-with-wasi-on-cloudflare-workers.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;4hhzQ9V5KQE5wXF4VtEcoG&quot;],&quot;name&quot;:[0,&quot;WASM&quot;],&quot;slug&quot;:[0,&quot;wasm&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Daniel Harper&quot;],&quot;slug&quot;:[0,&quot;daniel-harper&quot;],&quot;bio&quot;:[0,&quot;Systems Engineer&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/719D0JWq1bQvAXDtI0Aex9/0ba373c33bf13c4612d6312b7ac6e714/daniel-harper.jpg&quot;],&quot;location&quot;:[0,&quot;United Kingdom&quot;],&quot;website&quot;:[0,&quot;https://djharper.dev&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;After the recent announcement regarding WASI support in Workers I decided to see what it would take to get code written in Zig to run as a Worker, and it turned out to be pretty trivial. This post documents the process I followed&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Running Zig with WASI on Cloudflare Workers Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/running-zig-with-wasi-on-cloudflare-workers&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Running Zig with WASI on Cloudflare Workers&quot;],&quot;description&quot;:[0,&quot;After the recent announcement regarding WASI support in Workers I decided to see what it would take to get code written in Zig to run as a Worker, and it turned out to be pretty trivial. This post documents the process I followed&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2lM9mydTrQbZ2piGtokC1I/2b306b4103386d0ff4aef2da9e2ff1f8/running-zig-with-wasi-on-cloudflare-workers-Tmv5dN.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;PostCard&quot;,&quot;value&quot;:true}" await-children><article class="w-50-l  mt4 mt2-l mb4 ph3 bb b--gray8 bn-l"><div class="w-100"><a href="/running-zig-with-wasi-on-cloudflare-workers/" class="fw5 no-underline gray1" data-testid="post-title"><h2 class="fw5 mt2">Running Zig with WASI on Cloudflare Workers</h2></a><p class="f3 fw5 gray5 my" data-testid="post-date">2022-08-01</p><div class=""><a href="/tag/workers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Cloudflare Workers</a><a href="/tag/webassembly/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">WebAssembly</a><a href="/tag/wasm/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">WASM</a><a href="/tag/developers/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developers</a><a href="/tag/developer-platform/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1" data-testid="post-tag">Developer Platform</a></div><p class="f3 fw4 gray1 lh-copy " data-testid="post-content">After the recent announcement regarding WASI support in Workers I decided to see what it would take to get code written in Zig to run as a Worker, and it turned out to be pretty trivial. This post documents the process I followed<!-- -->...</p><ul class="author-lists flex pl0"><li class="list flex items-center pr2 mb3"><a href="/author/daniel-harper/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/719D0JWq1bQvAXDtI0Aex9/0ba373c33bf13c4612d6312b7ac6e714/daniel-harper.jpg" alt="Daniel Harper" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/daniel-harper/" class="fw4 f3 no-underline black">Daniel Harper</a></div></li></ul></div></article><!--astro:end--></astro-island> <astro-island uid="Z2pvlCW" prefix="r5" component-url="/_astro/MorePosts.DyRVOquy.js" component-export="default" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;posts&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;4zx8IwlpdBe2PLRTAA7xje&quot;],&quot;title&quot;:[0,&quot;Announcing support for WASI on Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;announcing-wasi-on-workers&quot;],&quot;excerpt&quot;:[0,&quot;Today, we are announcing experimental support for WASI (the WebAssembly System Interface) on Cloudflare Workers and support within wrangler2 to make it a joy to work with&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/38dw1f6v1MK3BDS3rYr7mE/c986b7fcb97d2ae3b88688cdce832f36/image1-OG-2.png\&quot; alt=\&quot;Announcing support for WASI on Cloudflare Workers\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;900\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Today, we are announcing experimental support for WASI (the WebAssembly System Interface) on Cloudflare Workers and support within wrangler2 to make it a joy to work with. We continue to be incredibly excited about the entire WebAssembly ecosystem and are eager to adopt the standards as they are developed.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;a-quick-primer-on-webassembly\&quot;&gt;A Quick Primer on WebAssembly&lt;/h3&gt;\n            &lt;a href=\&quot;#a-quick-primer-on-webassembly\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;So what is WASI anyway? To understand WASI, and why we’re excited about it, it’s worth a quick recap of WebAssembly, and the ecosystem around it.&lt;/p&gt;&lt;p&gt;WebAssembly promised us a future in which code written in compiled languages could be compiled to a common binary format and run in a secure sandbox, at near native speeds. While WebAssembly was designed with the browser in mind, the model rapidly extended to server-side platforms such as Cloudflare Workers (which &lt;a href=\&quot;/webassembly-on-cloudflare-workers/\&quot;&gt;has supported WebAssembly&lt;/a&gt; since 2017).&lt;/p&gt;&lt;p&gt;WebAssembly was originally designed to run &lt;i&gt;alongside&lt;/i&gt; Javascript, and requires developers to interface directly with Javascript in order to access the world outside the sandbox. To put it another way, WebAssembly does not provide any standard interface for I/O tasks such as interacting with files, accessing the network, or reading the system clock. This means if you want to respond to an event from the outside world, it&amp;#39;s up to the developer to handle that event in JavaScript, and directly call functions exported from the WebAssembly module. Similarly, if you want to perform I/O from within WebAssembly, you need to implement that logic in Javascript and import it into the WebAssembly module.&lt;/p&gt;&lt;p&gt;Custom toolchains such as Emscripten or libraries such as wasm-bindgen have emerged to make this easier, but they are language specific and add a tremendous amount of complexity and bloat. We&amp;#39;ve even built our own library, workers-rs, using wasm-bindgen that attempts to make writing applications in Rust feel native within a Worker – but this has proven not only difficult to maintain, but requires developers to write code that is Workers specific, and is not portable outside the Workers ecosystem.&lt;/p&gt;&lt;p&gt;We need more.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-webassembly-system-interface-wasi\&quot;&gt;The WebAssembly System Interface (WASI)&lt;/h3&gt;\n            &lt;a href=\&quot;#the-webassembly-system-interface-wasi\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;WASI aims to provide a standard interface that any language compiling to WebAssembly can target. You can read the original post by Lin Clark &lt;a href=\&quot;https://hacks.mozilla.org/2019/03/standardizing-wasi-a-webassembly-system-interface/\&quot;&gt;here&lt;/a&gt;, which gives an excellent introduction – code cartoons and all. In a nutshell, Lin describes WebAssembly as an &lt;i&gt;assembly language&lt;/i&gt; for a &amp;#39;conceptual machine&amp;#39;, whereas WASI is a &lt;i&gt;systems interface&lt;/i&gt; for a ‘conceptual operating system.’&lt;/p&gt;&lt;p&gt;This standardization of the system interface has paved the way for existing toolchains to cross-compile existing codebases to the wasm32-wasi target. A tremendous amount of progress has already been made, specifically within Clang/LLVM via the &lt;a href=\&quot;https://github.com/WebAssembly/wasi-sdk\&quot;&gt;wasi-sdk&lt;/a&gt; and &lt;a href=\&quot;https://doc.rust-lang.org/stable/nightly-rustc/rustc_target/spec/wasm32_wasi/index.html\&quot;&gt;Rust&lt;/a&gt; toolchains. These toolchains leverage a version of &lt;a href=\&quot;https://github.com/WebAssembly/wasi-libc\&quot;&gt;Libc&lt;/a&gt;, which provides POSIX standard API calls, that is built on top of WASI &amp;#39;system calls.&amp;#39; There are even basic implementations in more fringe toolchains such as &lt;a href=\&quot;https://tinygo.org/docs/guides/webassembly/\&quot;&gt;TinyGo&lt;/a&gt; and &lt;a href=\&quot;https://swiftwasm.org/\&quot;&gt;SwiftWasm&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Practically speaking, this means that you can now write applications that not only interoperate with any WebAssembly runtime implementing the standard, but also any POSIX compliant system! This means the exact same &amp;#39;Hello World!&amp;#39; that runs on your local Linux/Mac/Windows WSL machine.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;show-me-the-code\&quot;&gt;Show me the code&lt;/h3&gt;\n            &lt;a href=\&quot;#show-me-the-code\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;WASI sounds great, but does it actually make my life easier? You tell us. Let’s run through an example of how this would work in practice.&lt;/p&gt;&lt;p&gt;First, let’s generate a basic Rust “Hello, world!” application, compile, and run it.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ cargo new hello_world\n$ cd ./hello_world\n$ cargo build --release\n   Compiling hello_world v0.1.0 (/Users/benyule/hello_world)\n    Finished release [optimized] target(s) in 0.28s\n$ ./target/release/hello_world\nHello, world!&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;It doesn’t get much simpler than this. You’ll notice we only define a main() function followed by a println to stdout.&lt;/p&gt;\n            &lt;pre class=\&quot;language-rust\&quot;&gt;&lt;code class=\&quot;language-rust\&quot;&gt;fn main() {\n    println!(&amp;quot;Hello, world!&amp;quot;);\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Now, let’s take the exact same program and compile against the wasm32-wasi target, and run it in an ‘off the shelf’ wasm runtime such as &lt;a href=\&quot;https://wasmtime.dev/\&quot;&gt;Wasmtime&lt;/a&gt;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ cargo build --target wasm32-wasi --release\n$ wasmtime target/wasm32-wasi/release/hello_world.wasm\n\nHello, world!&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Neat! The same code compiles and runs in multiple POSIX environments.&lt;/p&gt;&lt;p&gt;Finally, let’s take the binary we just generated for Wasmtime, but instead publish it to Workers using Wrangler2.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ npx wrangler@wasm dev target/wasm32-wasi/release/hello_world.wasm\n$ curl http://localhost:8787/\n\nHello, world!&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Unsurprisingly, it works! The same code is compatible in multiple POSIX environments and the same binary is compatible across multiple WASM runtimes.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;running-your-cli-apps-in-the-cloud\&quot;&gt;Running your CLI apps in the cloud&lt;/h3&gt;\n            &lt;a href=\&quot;#running-your-cli-apps-in-the-cloud\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The attentive reader may notice that we played a small trick with the HTTP request made via cURL. In this example, we actually stream stdin and stdout to/from the Worker using the HTTP request and response body respectively. This pattern enables some really interesting use cases, specifically, programs designed to run on the command line can be deployed as &amp;#39;services&amp;#39; to the cloud.&lt;/p&gt;&lt;p&gt;‘Hexyl’ is an example that works completely out of the box. Here, we ‘cat’ a binary file on our local machine and ‘pipe’ the output to curl, which will then POST that output to our service and stream the result back. Following the steps we used to compile our &amp;#39;Hello World!&amp;#39;, we can compile hexyl.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ git clone git@github.com:sharkdp/hexyl.git\n$ cd ./hexyl\n$ cargo build --target wasm32-wasi --release&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;And without further modification we were able to take a real-world program and create something we can now run or deploy. Again, let&amp;#39;s tell wrangler2 to preview hexyl, but this time give it some input.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ npx wrangler@wasm dev target/wasm32-wasi/release/hexyl.wasm\n$ echo &amp;quot;Hello, world\\!&amp;quot; | curl -X POST --data-binary @- http://localhost:8787\n\n┌────────┬─────────────────────────┬─────────────────────────┬────────┬────────┐\n│00000000│ 48 65 6c 6c 6f 20 77 6f ┊ 72 6c 64 21 0a          │Hello wo┊rld!_   │\n└────────┴─────────────────────────┴─────────────────────────┴────────┴────────┘\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Give it a try yourself by hitting &lt;a href=\&quot;https://hexly.examples.workers.dev\&quot;&gt;https://hexyl.examples.workers.dev&lt;/a&gt;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;echo &amp;quot;Hello world\\!&amp;quot; | curl https://hexyl.examples.workers.dev/ -X POST --data-binary @- --output -&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;A more useful example, but requires a bit more work, would be to deploy a utility such as swc (swc.rs), to the cloud and use it as an on demand JavaScript/TypeScript transpilation service. Here, we have a few extra steps to ensure that the compiled output is as small as possible, but it otherwise runs out-of-the-box. Those steps are detailed in &lt;a href=\&quot;https://github.com/zebp/wasi-example-swc\&quot;&gt;https://github.com/zebp/wasi-example-swc&lt;/a&gt;, but for now let’s gloss over that and interact with the hosted example.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ echo &amp;quot;const x = (x, y) =&amp;gt; x * y;&amp;quot; | curl -X POST --data-binary @- https://swc-wasi.examples.workers.dev/ --output -\n\nvar x=function(a,b){return a*b}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Finally, we can also do the same with C/C++, but requires a little more lifting to get our Makefile right. Here we show an example of compiling zstd and uploading it as a streaming compression service.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://github.com/zebp/wasi-example-zstd\&quot;&gt;https://github.com/zebp/wasi-example-zstd&lt;/a&gt;&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ echo &amp;quot;Hello world\\!&amp;quot; | curl https://zstd.examples.workers.dev/ -s -X POST --data-binary @- | file -&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;what-if-i-want-to-use-wasi-from-within-a-javascript-worker\&quot;&gt;What if I want to use WASI from within a JavaScript Worker?&lt;/h3&gt;\n            &lt;a href=\&quot;#what-if-i-want-to-use-wasi-from-within-a-javascript-worker\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Wrangler can make it really easy to deploy code without having to worry about the Workers ecosystem, but in some cases you may actually want to invoke your WASI based WASM module from Javascript. This can be achieved with the following simple boilerplate. An updated README will be kept at &lt;a href=\&quot;https://github.com/cloudflare/workers-wasi\&quot;&gt;https://github.com/cloudflare/workers-wasi&lt;/a&gt;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import { WASI } from &amp;quot;@cloudflare/workers-wasi&amp;quot;;\nimport demoWasm from &amp;quot;./demo.wasm&amp;quot;;\n\nexport default {\n  async fetch(request, _env, ctx) {\n    // Creates a TransformStream we can use to pipe our stdout to our response body.\n    const stdout = new TransformStream();\n    const wasi = new WASI({\n      args: [],\n      stdin: request.body,\n      stdout: stdout.writable,\n    });\n\n    // Instantiate our WASM with our demo module and our configured WASI import.\n    const instance = new WebAssembly.Instance(demoWasm, {\n      wasi_snapshot_preview1: wasi.wasiImport,\n    });\n\n    // Keep our worker alive until the WASM has finished executing.\n    ctx.waitUntil(wasi.start(instance));\n\n    // Finally, let&amp;#039;s reply with the WASM&amp;#039;s output.\n    return new Response(stdout.readable);\n  },\n};&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Now with our JavaScript boilerplate and wasm, we can easily deploy our worker with Wrangler’s WASM feature.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;$ npx wrangler publish\nTotal Upload: 473.89 KiB / gzip: 163.79 KiB\nUploaded wasi-javascript (2.75 sec)\nPublished wasi-javascript (0.30 sec)\n  wasi-javascript.zeb.workers.dev&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;back-to-the-future\&quot;&gt;Back to the future&lt;/h2&gt;\n            &lt;a href=\&quot;#back-to-the-future\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;For those of you who have been around for the better part of the past couple of decades, you may notice this looks very similar to RFC3875, better known as CGI (The Common Gateway Interface). While our example here certainly does not conform to the specification, you can imagine how this can be extended to turn the stdin of a basic &amp;#39;command line&amp;#39; application into a full-blown http handler.&lt;/p&gt;&lt;p&gt;We are thrilled to learn where developers take this from here. Share what you build with us on &lt;a href=\&quot;https://discord.com/invite/cloudflaredev\&quot;&gt;Discord&lt;/a&gt; or &lt;a href=\&quot;https://twitter.com/CloudflareDev\&quot;&gt;Twitter&lt;/a&gt;!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2022-07-07T17:09:43.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:19:33.656Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7LXoae3a8zF55NaMHdhzmM/876202c873efa186ecce6a844f83ed33/announcing-wasi-on-workers.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;4hhzQ9V5KQE5wXF4VtEcoG&quot;],&quot;name&quot;:[0,&quot;WASM&quot;],&quot;slug&quot;:[0,&quot;wasm&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Ben Yule&quot;],&quot;slug&quot;:[0,&quot;ben-yule&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/33lAQaWuKvsf18G01UJpLb/e5947b5d6d37eaa1e3b906fb48901d63/ben-yule.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@bjyule&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Zebulon Piasecki&quot;],&quot;slug&quot;:[0,&quot;zeb&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2V5q3DF6hSjOmMYjMwlOt0/3d4cc53e253419bbb30deb047141fb63/zeb.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@zebassembly&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Today, we are announcing experimental support for WASI (the WebAssembly System Interface) on Cloudflare Workers and support within wrangler2 to make it a joy to work with.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Announcing support for WASI on Cloudflare Workers Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/announcing-wasi-on-workers&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Announcing support for WASI on Cloudflare Workers&quot;],&quot;description&quot;:[0,&quot;Today, we are announcing experimental support for WASI (the WebAssembly System Interface) on Cloudflare Workers and support within wrangler2 to make it a joy to work with.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4T9qA3SHntueYPQS6rldT4/c1caf3952bfa809630dd59b250e31bae/announcing-wasi-on-workers-cugMya.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;6OsZbm2qTDYQut1ezEzb8p&quot;],&quot;title&quot;:[0,&quot;Native Rust support on Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers-rust-sdk&quot;],&quot;excerpt&quot;:[0,&quot;Introducing the Cloudflare Workers Rust SDK: write your entire Worker in Rust, no JavaScript required.\n&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1tGhbR9Dn9B8Z8vqQqZkuw/23f914bdb3e395a9b84d7748f2db309e/image1-2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1280\&quot; height=\&quot;640\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;You can now write Cloudflare Workers in 100% Rust, no JavaScript required. Try it out: &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;https://github.com/cloudflare/workers-rs&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Cloudflare Workers has long supported the building blocks to run many languages using  WebAssembly. However, there has always been a challenging “trampoline” step required to allow languages like Rust to talk to JavaScript APIs such as &lt;code&gt;&lt;i&gt;fetch()&lt;/i&gt;&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;In addition to the sizable amount of boilerplate needed, lots of “off the shelf” bindings between languages don’t include support for Cloudflare APIs such as KV and Durable Objects. What we wanted was a way to write a Worker in idiomatic Rust, quickly, and without needing knowledge of the host JavaScript environment. While we had a nice “starter” template that made it easy enough to pull in some Rust libraries and use them from JavaScript, the barrier was still too high if your goal was to write a full program in Rust and ship it to our edge.&lt;/p&gt;&lt;p&gt;Not anymore!&lt;/p&gt;&lt;p&gt;Introducing the &lt;code&gt;**worker**&lt;/code&gt; crate, available on &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;GitHub&lt;/a&gt; and &lt;a href=\&quot;https://crates.io/crates/worker\&quot;&gt;crates.io&lt;/a&gt;, which makes Rust developers feel right at home on the Workers platform by running code inside the V8 WebAssembly engine. In the snippet below, you can see how the worker crate does all the heavy lifting by providing Rustacean-friendly Workers APIs.&lt;/p&gt;\n            &lt;pre class=\&quot;language-rust\&quot;&gt;&lt;code class=\&quot;language-rust\&quot;&gt;use worker::*;\n\n#[event(fetch)]\npub async fn main(req: Request, env: Env) -&amp;gt; Result&amp;lt;Response&amp;gt; {\n    console_log!(\n        &amp;quot;{} {}, located at: {:?}, within: {}&amp;quot;,\n        req.method().to_string(),\n        req.path(),\n        req.cf().coordinates().unwrap_or_default(),\n        req.cf().region().unwrap_or(&amp;quot;unknown region&amp;quot;.into())\n    );\n\n    if !matches!(req.method(), Method::Post) {\n        return Response::error(&amp;quot;Method Not Allowed&amp;quot;, 405);\n    }\n\n    if let Some(file) = req.form_data().await?.get(&amp;quot;file&amp;quot;) {\n        return match file {\n            FormEntry::File(buf) =&amp;gt; {\n                Response::ok(&amp;amp;format!(&amp;quot;size = {}&amp;quot;, buf.bytes().await?.len()))\n            }\n            _ =&amp;gt; Response::error(&amp;quot;`file` part of POST form must be a file&amp;quot;, 400),\n        };\n    }\n\n    Response::error(&amp;quot;Bad Request&amp;quot;, 400)\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Get your own Worker in Rust started with a single command:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;# see installation instructions for our `wrangler` CLI at https://github.com/cloudflare/wrangler\n# (requires v1.19.2 or higher)\n$ wrangler generate --type=rust my-project&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We’ve  stripped away all the glue code, provided an ergonomic HTTP framework, and baked in what you need to build small scripts or full-fledged Workers apps in Rust. You’ll find &lt;i&gt;fetch&lt;/i&gt;, a router, easy-to-use HTTP functionality, Workers &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/kv\&quot;&gt;KV stores&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/workers/learning/using-durable-objects\&quot;&gt;Durable Objects&lt;/a&gt;, secrets, and environment variables too. It’s all &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;open source&lt;/a&gt;, and we’d love &lt;a href=\&quot;https://github.com/cloudflare/workers-rs/issues\&quot;&gt;your feedback&lt;/a&gt;!&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;why-are-we-doing-this\&quot;&gt;Why are we doing this?&lt;/h3&gt;\n            &lt;a href=\&quot;#why-are-we-doing-this\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Cloudflare Workers is on a mission to simplify the developer experience. When we took a hard look at the previous experience writing non-JavaScript Workers, we knew we could do better. Rust happens to be a great language for us to kick-start our mission: it has first-class support for WebAssembly, and a wonderful, growing ecosystem. Tools like &lt;a href=\&quot;https://github.com/rustwasm/wasm-bindgen\&quot;&gt;&lt;code&gt;&lt;i&gt;wasm-bindgen&lt;/i&gt;&lt;/code&gt;&lt;/a&gt;, libraries like &lt;a href=\&quot;https://crates.io/crates/web-sys\&quot;&gt;&lt;code&gt;&lt;i&gt;web-sys&lt;/i&gt;&lt;/code&gt;&lt;/a&gt;, and Rust’s powerful macro system gave us a significant starting-off point. Plus, Rust’s popularity is growing rapidly, and if our own &lt;a href=\&quot;https://github.com/orgs/cloudflare/repositories?q=&amp;type=source&amp;language=rust&amp;sort=\&quot;&gt;use of Rust at Cloudflare&lt;/a&gt; is any indication, there is no question that Rust is staking its claim as a must-have in the developer toolbox.&lt;/p&gt;&lt;p&gt;So give it a try, leave some feedback, even &lt;a href=\&quot;https://github.com/cloudflare/workers-rs\&quot;&gt;open a PR&lt;/a&gt;! By the way, we’re always on the lookout for great people to join us, and we are hiring for many open roles (including Rust engineers!) — &lt;a href=\&quot;https://www.cloudflare.com/careers/\&quot;&gt;take a look&lt;/a&gt;.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2021-09-09T14:00:02.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:15:06.296Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5WXyCtNhtBmXMwxG9KhCeD/bfc7e6f58516bddf8e6d98eb73e283c9/workers-rust-sdk.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5cye1Bh5KxFh3pKSnX8Dsy&quot;],&quot;name&quot;:[0,&quot;Serverless&quot;],&quot;slug&quot;:[0,&quot;serverless&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;w4e8pkoz9c8xNDVhy9eNe&quot;],&quot;name&quot;:[0,&quot;Rust&quot;],&quot;slug&quot;:[0,&quot;rust&quot;]}],[0,{&quot;id&quot;:[0,&quot;4hhzQ9V5KQE5wXF4VtEcoG&quot;],&quot;name&quot;:[0,&quot;WASM&quot;],&quot;slug&quot;:[0,&quot;wasm&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Steve Manuel&quot;],&quot;slug&quot;:[0,&quot;steve-manuel&quot;],&quot;bio&quot;:[0,&quot;I like making things. Enjoy writing Rust, Go. All empty rectangles are considered equal. &quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3TpOTJnhRpcKvUgh6iA0IE/a23c09d7c3baf81bde00598e0533a04a/steve-manuel.jpeg&quot;],&quot;location&quot;:[0,&quot;Boulder, Colorado&quot;],&quot;website&quot;:[0,&quot;https://nilslice.xyz/&quot;],&quot;twitter&quot;:[0,&quot;@nilslice&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Introducing the Cloudflare Workers Rust SDK: write your entire Worker in Rust, no JavaScript required.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Native Rust support on Cloudflare Workers Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/workers-rust-sdk&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Native Rust support on Cloudflare Workers&quot;],&quot;description&quot;:[0,&quot;Introducing the Cloudflare Workers Rust SDK: write your entire Worker in Rust, no JavaScript required.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1SEZ3iBYBJ5NFRXGPt445d/2bf86873ec53715222b7fe6c7316933e/workers-rust-sdk-iYDSUM.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;5AVLtoBd5aIK5zHzElyM9s&quot;],&quot;title&quot;:[0,&quot;Let&#39;s build a Cloudflare Worker with WebAssembly and Haskell&quot;],&quot;slug&quot;:[0,&quot;cloudflare-worker-with-webassembly-and-haskell&quot;],&quot;excerpt&quot;:[0,&quot;Let&#39;s combine the power of Haskell and WebAssembly in a Cloudflare Worker!&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;i&gt;This is a guest post by Cristhian Motoche of &lt;/i&gt;&lt;a href=\&quot;https://www.stackbuilders.com/\&quot;&gt;&lt;i&gt;Stack Builders&lt;/i&gt;&lt;/a&gt;&lt;i&gt;.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;At &lt;a href=\&quot;https://www.stackbuilders.com/\&quot;&gt;Stack Builders&lt;/a&gt;, we believe that Haskell’s system of expressive static types offers many benefits to the software industry and the world-wide community that depends on our services. In order to fully realize these benefits, it is necessary to have proper training and access to an ecosystem that allows for reliable deployment of services. In exploring the tools that help us run our systems based on Haskell, our developer Cristhian Motoche has created a tutorial that shows how to compile Haskell to WebAssembly using Asterius for deployment on Cloudflare.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;\&quot;&gt;&lt;/h3&gt;\n            &lt;a href=\&quot;#\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;What is a Cloudflare Worker?&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/\&quot;&gt;Cloudflare Workers&lt;/a&gt; is a serverless platform that allows us to run our code on the edge of the Cloudflare infrastructure. It&amp;#39;s built on Google V8, so it’s possible to write functionalities in JavaScript or any other language that targets WebAssembly.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://webassembly.org/\&quot;&gt;WebAssembly&lt;/a&gt; is a portable binary instruction format that can be executed fast in a memory-safe sandboxed environment. For this reason, it’s especially useful for tasks that need to perform resource-demanding and self-contained operations.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;why-use-haskell-to-target-webassembly\&quot;&gt;Why use Haskell to target WebAssembly?&lt;/h3&gt;\n            &lt;a href=\&quot;#why-use-haskell-to-target-webassembly\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Haskell is a pure functional &lt;a href=\&quot;https://github.com/appcypher/awesome-wasm-langs\&quot;&gt;language&lt;/a&gt; that can target WebAssembly. As such, It helps developers break down complex tasks into small functions that can later be composed to do complex tasks. Additionally, it’s statically typed and has type inference, so it will complain if there are type errors at compile time. Because of that and &lt;a href=\&quot;https://wiki.haskell.org/Why_Haskell_matters\&quot;&gt;much more&lt;/a&gt;, Haskell is a good source language for targeting WebAssembly.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;from-haskell-to-webassembly\&quot;&gt;From Haskell to WebAssembly&lt;/h3&gt;\n            &lt;a href=\&quot;#from-haskell-to-webassembly\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;We’ll use &lt;a href=\&quot;https://asterius.netlify.app/\&quot;&gt;Asterius&lt;/a&gt; to target WebAssembly from Haskell. It’s a well documented tool that is updated often and supports a lot of Haskell features.&lt;/p&gt;&lt;p&gt;First, as suggested in the &lt;a href=\&quot;https://asterius.netlify.app/images.html#using-prebuilt-container-images\&quot;&gt;documentation&lt;/a&gt;, we’ll use podman to pull the Asterius prebuilt container from Docker hub. In this tutorial, we will use Asterius version &lt;a href=\&quot;https://hub.docker.com/layers/terrorjack/asterius/200617/images/sha256-8e6009198c3940d1b4938b0ab6c0b119d4fce3d7ac0f6336214e758f66887b80?context=explore\&quot;&gt;200617&lt;/a&gt;, which works with GHC 8.8.&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;podman run -it --rm -v $(pwd):/workspace -w /workspace terrorjack/asterius:200617&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Now we’ll create a Haskell module called &lt;code&gt;fact.hs&lt;/code&gt; file that will export a pure function:&lt;/p&gt;\n            &lt;pre class=\&quot;language-haskell\&quot;&gt;&lt;code class=\&quot;language-haskell\&quot;&gt;module Factorial (fact) where\n\nfact :: Int -&amp;gt; Int\nfact n = go n 1\n  where\n    go 0 acc = acc\n    go n acc = go (n - 1) (n*acc)\n\nforeign export javascript &amp;quot;fact&amp;quot; fact :: Int -&amp;gt; Int&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;In this module, we define a pure function called &lt;code&gt;fact&lt;/code&gt;, optimized with tail recursion and exported using the &lt;a href=\&quot;https://asterius.netlify.app/jsffi.html\&quot;&gt;Asterius JavaScript FFI&lt;/a&gt;, so that it can be called when a WebAssembly module is instantiated in JavaScript.&lt;/p&gt;&lt;p&gt;Next, we’ll create a JavaScript file called &lt;code&gt;fact_node.mjs&lt;/code&gt; that contains the following code:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import * as rts from &amp;quot;./rts.mjs&amp;quot;;\nimport module from &amp;quot;./fact.wasm.mjs&amp;quot;;\nimport req from &amp;quot;./fact.req.mjs&amp;quot;;\n\nasync function handleModule(m) {\n  const i = await rts.newAsteriusInstance(Object.assign(req, {module: m}));\n  const result = await i.exports.fact(5);\n  console.log(result);\n}\n\nmodule.then(handleModule);&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This code imports &lt;code&gt;rts.mjs&lt;/code&gt; (common runtime), WebAssembly loaders, and the required parameters for the Asterius instance. It creates a new Asterius instance, it calls the exported function &lt;code&gt;fact&lt;/code&gt; with the input &lt;code&gt;5&lt;/code&gt;, and prints out the result.&lt;/p&gt;&lt;p&gt;You probably have noted that &lt;code&gt;fact&lt;/code&gt; is done &lt;b&gt;asynchronously&lt;/b&gt;. This happens with any exported function by Asterius, even if it’s a pure function.&lt;/p&gt;&lt;p&gt;Next, we’ll compile this code using the Asterius command line interface (CLI) &lt;code&gt;ahc-link&lt;/code&gt;, and we’ll run the JavaScript code in Node:&lt;/p&gt;\n            &lt;pre class=\&quot;language-sh\&quot;&gt;&lt;code class=\&quot;language-sh\&quot;&gt;ahc-link \\\n  --input-hs fact.hs \\\n  --no-main \\\n  --export-function=fact \\\n  --run \\\n  --input-mjs fact_node.mjs \\\n  --output-dir=node&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This command takes &lt;code&gt;fact.hs&lt;/code&gt; as a Haskell input file, specifies that no &lt;code&gt;main&lt;/code&gt; function is exported, and exports the &lt;code&gt;fact&lt;/code&gt; function. Additionally, it takes &lt;code&gt;fact_node.mjs&lt;/code&gt; as the entry JavaScript file that replaces the generated file by default, and it places the generated code in a directory called &lt;code&gt;node&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Running the &lt;code&gt;ahc-link&lt;/code&gt; command from above will print the following output in the console:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;[INFO] Compiling fact.hs to WebAssembly\n...\n[INFO] Running node/fact.mjs\n120&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;As you can see, the result is executed in &lt;code&gt;node&lt;/code&gt; and it prints out the result of &lt;code&gt;fact&lt;/code&gt; in the console.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;push-your-code-to-cloudflare-workers\&quot;&gt;Push your code to Cloudflare Workers&lt;/h3&gt;\n            &lt;a href=\&quot;#push-your-code-to-cloudflare-workers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Now we’ll set everything up for deploying our code to Cloudflare Workers.&lt;/p&gt;&lt;p&gt;First, let’s add a &lt;code&gt;metadata.json&lt;/code&gt; file with the following content:&lt;/p&gt;\n            &lt;pre class=\&quot;language-json\&quot;&gt;&lt;code class=\&quot;language-json\&quot;&gt;{\n  &amp;quot;body_part&amp;quot;: &amp;quot;script&amp;quot;,\n  &amp;quot;bindings&amp;quot;: [\n    {\n      &amp;quot;type&amp;quot;: &amp;quot;wasm_module&amp;quot;,\n      &amp;quot;name&amp;quot;: &amp;quot;WASM&amp;quot;,\n      &amp;quot;part&amp;quot;: &amp;quot;wasm&amp;quot;\n    }\n  ]\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This file is needed to specify the &lt;code&gt;wasm_module&lt;/code&gt; binding. The &lt;code&gt;name&lt;/code&gt; value corresponds to the global variable to access the WebAssembly module from your Worker code. In our example, it’s going to have the name &lt;code&gt;WASM&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Our next step is to define the main point of the Workers script.&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import * as rts from &amp;quot;./rts.mjs&amp;quot;;\nimport fact from &amp;quot;./fact.req.mjs&amp;quot;;\n\nasync function handleFact(param) {\n  const i = await rts.newAsteriusInstance(Object.assign(fact, { module: WASM }));\n  return await i.exports.fact(param);\n}\n\nasync function handleRequest(req) {\n  if (req.method == &amp;quot;POST&amp;quot;) {\n    const data = await req.formData();\n    const param = parseInt(data.get(&amp;quot;param&amp;quot;));\n    if (param) {\n      const resp = await handleFact(param);\n      return new Response(resp, {status: 200});\n    } else {\n      return new Response(\n        &amp;quot;Expecting &amp;#039;param&amp;#039; in request to be an integer&amp;quot;,\n        {status: 400},\n      );\n    }\n  }\n  return new Response(&amp;quot;Method not allowed&amp;quot;, {status: 405});\n}\n\naddEventListener(&amp;quot;fetch&amp;quot;, event =&amp;gt; {\n  event.respondWith(handleRequest(event.request))\n})&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;There are a few interesting things to point out in this code:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;We import &lt;code&gt;rts.mjs&lt;/code&gt; and &lt;code&gt;fact.req.mjs&lt;/code&gt; to load the exported functions from our WebAssembly module.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;handleFact&lt;/code&gt; is an asynchronous function that creates an instance of Asterius with the global &lt;code&gt;WASM&lt;/code&gt; module, as a Workers global variable, and calls the exported function &lt;code&gt;fact&lt;/code&gt; with some input.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;handleRequest&lt;/code&gt; handles the request of the Worker. It expects a &lt;code&gt;POST&lt;/code&gt; request, with a parameter called &lt;code&gt;param&lt;/code&gt; in the request body. If &lt;code&gt;param&lt;/code&gt; is a number, it calls &lt;code&gt;handleFact&lt;/code&gt; to respond with the result of &lt;code&gt;fact&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Using the Service Workers API, we listen to the &lt;code&gt;fetch&lt;/code&gt; event that will respond with the result of &lt;code&gt;handleRequest&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We need to build and bundle our code in a single JavaScript file, because Workers only accepts one script per worker. Fortunately, Asterius comes with Parcel.js, which will bundle all the necessary code in a single JavaScript file.&lt;/p&gt;\n            &lt;pre class=\&quot;language-sh\&quot;&gt;&lt;code class=\&quot;language-sh\&quot;&gt;ahc-link \\\n  --input-hs fact.hs \\\n  --no-main \\\n  --export-function=fact \\\n  --input-mjs fact_cfw.mjs \\\n  --bundle \\\n  --browser \\\n  --output-dir worker&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;&lt;code&gt;ahc-link&lt;/code&gt; will generate some files inside a directory called &lt;code&gt;worker&lt;/code&gt;. For our Workers, we’re only interested in the JavaScript file (&lt;code&gt;fact.js&lt;/code&gt;) and the WebAssembly module (&lt;code&gt;fact.wasm&lt;/code&gt;). Now, it’s time to submit both of them to Workers. We can do this with the provided REST API.&lt;/p&gt;&lt;p&gt;Make sure you have an account id (&lt;code&gt;$CF_ACCOUNT_ID&lt;/code&gt;), a name for your script (&lt;code&gt;$SCRIPT_NAME&lt;/code&gt;), and an API Token (&lt;code&gt;$CF_API_TOKEN&lt;/code&gt;):&lt;/p&gt;\n            &lt;pre class=\&quot;language-sh\&quot;&gt;&lt;code class=\&quot;language-sh\&quot;&gt;cd worker\ncurl -X PUT &amp;quot;https://api.cloudflare.com/client/v4/accounts/$CF_ACCOUNT_ID/workers/scripts/$SCRIPT_NAME&amp;quot; \\\n     -H  &amp;quot;Authorization: Bearer $CF_API_TOKEN&amp;quot; \\\n     -F &amp;quot;metadata=@metadata.json;type=application/json&amp;quot; \\\n     -F &amp;quot;script=@fact.js;type=application/javascript&amp;quot; \\\n     -F &amp;quot;wasm=@fact.wasm;type=application/wasm&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Now, visit the Workers UI, where you can use the editor to view, edit, and test the script. Also, you can enable it to on a &lt;code&gt;workers.dev&lt;/code&gt; subdomain (&lt;code&gt;$CFW_SUBDOMAIN&lt;/code&gt;); in that case, you could then simply:&lt;/p&gt;\n            &lt;pre class=\&quot;language-sh\&quot;&gt;&lt;code class=\&quot;language-sh\&quot;&gt;curl -X POST $CFW_SUBDOMAIN \\\n       -H &amp;#039;Content-Type: application/x-www-form-urlencoded&amp;#039; \\\n       --data &amp;#039;param=5&amp;#039;&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;beyond-a-simple-haskell-file\&quot;&gt;Beyond a simple Haskell file&lt;/h3&gt;\n            &lt;a href=\&quot;#beyond-a-simple-haskell-file\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;So far, we’ve created a WebAssembly module that exports a pure Haskell function we ran in Workers. However, we can also create and build a Cabal project using Asterius &lt;code&gt;ahc-cabal&lt;/code&gt; CLI, and then use &lt;code&gt;ahc-dist&lt;/code&gt; to compile it to WebAssembly.&lt;/p&gt;&lt;p&gt;First, let’s create the project:&lt;/p&gt;\n            &lt;pre class=\&quot;language-sh\&quot;&gt;&lt;code class=\&quot;language-sh\&quot;&gt;ahc-cabal init -m -p cabal-cfw-example&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Then, let’s add some dependencies to our cabal project. The cabal file will look like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-sh\&quot;&gt;&lt;code class=\&quot;language-sh\&quot;&gt;cabal-version:       2.4\nname:                cabal-cfw-example\nversion:             0.1.0.0\nlicense:             NONE\n\nexecutable cabal-cfw-example\n  ghc-options: -optl--export-function=handleReq\n  main-is:             Main.hs\n  build-depends:\n    base,\n    bytestring,\n    aeson &amp;gt;=1.5 &amp;amp;&amp;amp; &amp;lt; 1.6,\n    text\n  default-language:    Haskell2010&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;It’s a simple cabal file, except for the &lt;code&gt;-optl--export-function=handleReq&lt;/code&gt; ghc flag. This is &lt;a href=\&quot;https://github.com/tweag/asterius/issues/362#issuecomment-561576162\&quot;&gt;necessary&lt;/a&gt; when exporting a function from a cabal project.&lt;/p&gt;&lt;p&gt;In this example, we’ll define a simple &lt;code&gt;User&lt;/code&gt; record, and we’ll define its instance automatically using Template Haskell!&lt;/p&gt;\n            &lt;pre class=\&quot;language-haskell\&quot;&gt;&lt;code class=\&quot;language-haskell\&quot;&gt;{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE TemplateHaskell   #-}\n\nmodule Main where\n\nimport           Asterius.Types\nimport           Control.Monad\nimport           Data.Aeson                 hiding (Object)\nimport qualified Data.Aeson                 as A\nimport           Data.Aeson.TH\nimport qualified Data.ByteString.Lazy.Char8 as B8\nimport           Data.Text\n\n\nmain :: IO ()\nmain = putStrLn &amp;quot;CFW Cabal&amp;quot;\n\ndata User =\n  User\n    { name :: Text\n    , age  :: Int\n    }\n\n$(deriveJSON defaultOptions &amp;#039;User)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;&lt;b&gt;NOTE:&lt;/b&gt; It’s not necessary to create a Cabal project for this example, because the prebuilt container comes with a lot of &lt;a href=\&quot;https://github.com/tweag/asterius/issues/354\&quot;&gt;prebuilt packages&lt;/a&gt; (aesona included). Nevertheless, it will help us show the potential of &lt;code&gt;ahc-cabal&lt;/code&gt; and &lt;code&gt;ahc-dist&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Next, we’ll define &lt;code&gt;handleReq&lt;/code&gt;, which we’ll export using JavaScript FFI just like we did before.&lt;/p&gt;\n            &lt;pre class=\&quot;language-haskell\&quot;&gt;&lt;code class=\&quot;language-haskell\&quot;&gt;handleReq :: JSString -&amp;gt; JSString -&amp;gt; IO JSObject\nhandleReq method rawBody =\n  case fromJSString method of\n    &amp;quot;POST&amp;quot; -&amp;gt;\n      let eitherUser :: Either String User\n          eitherUser = eitherDecode (B8.pack $ fromJSString rawBody)\n       in case eitherUser of\n            Right _  -&amp;gt; js_new_response (toJSString &amp;quot;Success!&amp;quot;) 200\n            Left err -&amp;gt; js_new_response (toJSString err) 400\n    _ -&amp;gt; js_new_response (toJSString &amp;quot;Not a valid method&amp;quot;) 405\n\nforeign export javascript &amp;quot;handleReq&amp;quot; handleReq :: JSString -&amp;gt; JSString -&amp;gt; IO JSObject\n\nforeign import javascript &amp;quot;new Response($1, {\\&amp;quot;status\\&amp;quot;: $2})&amp;quot;\n  js_new_response :: JSString -&amp;gt; Int -&amp;gt; IO JSObject&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This time, we define &lt;code&gt;js_new_response&lt;/code&gt;, a Haskell function that creates a JavaScript object, to create a &lt;code&gt;Response&lt;/code&gt;. &lt;code&gt;handleReq&lt;/code&gt; takes two string parameters from JavaScript and it uses them to prepare a response.&lt;/p&gt;&lt;p&gt;Now let’s build and install the binary in the current directory:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;ahc-cabal new-install --installdir . --overwrite-policy=always&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This will generate a binary for our executable, called &lt;code&gt;cabal-cfw-example&lt;/code&gt;. We’re going to use &lt;code&gt;ahc-dist&lt;/code&gt; to take that binary and target WebAssembly:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;ahc-dist --input-exe cabal-cfw-example --export-function=handleReq --no-main --input-mjs cabal_cfw_example.mjs --bundle --browser&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;&lt;code&gt;cabal_cfw_example.mjs&lt;/code&gt; contains the following code:&lt;/p&gt;\n            &lt;pre class=\&quot;language-javascript\&quot;&gt;&lt;code class=\&quot;language-javascript\&quot;&gt;import * as rts from &amp;quot;./rts.mjs&amp;quot;;\nimport cabal_cfw_example from &amp;quot;./cabal_cfw_example.req.mjs&amp;quot;;\n\nasync function handleRequest(req) {\n  const i = await rts.newAsteriusInstance(Object.assign(cabal_cfw_example, { module: WASM }));\n  const body = await req.text();\n  return await i.exports.handleReq(req.method, body);\n}\n\naddEventListener(&amp;quot;fetch&amp;quot;, event =&amp;gt; {\n  event.respondWith(handleRequest(event.request))\n});&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Finally, we can deploy our code to Workers by defining a &lt;code&gt;metadata.json&lt;/code&gt; file and uploading the script and the WebAssembly module using Workers API as we did before.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;caveats\&quot;&gt;Caveats&lt;/h3&gt;\n            &lt;a href=\&quot;#caveats\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Workers &lt;a href=\&quot;https://developers.cloudflare.com/workers/about/limits/#script-size\&quot;&gt;limits&lt;/a&gt; your JavaScript and WebAssembly in file size. Therefore, you need to be careful with any dependencies you add.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;conclusion\&quot;&gt;Conclusion&lt;/h3&gt;\n            &lt;a href=\&quot;#conclusion\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Stack Builders builds better software for better living through technologies like expressive static types. We used Asterius to compile Haskell to WebAssembly and deployed it to Cloudflare Workers using the Workers API. Asterius supports a lot of Haskell features (e.g. Template Haskell) and it provides an easy-to-use JavaScript FFI to interact with JavaScript. Additionally, it provides prebuilt containers that contain a lot of Haskell packages, so you can start writing a script right away.&lt;/p&gt;&lt;p&gt;Following this approach, we can write functional type-safe code in Haskell, target it to WebAssembly, and publish it to Workers, which runs on the edge of the Cloudflare infrastructure.&lt;/p&gt;&lt;p&gt;For more content check our &lt;a href=\&quot;https://www.stackbuilders.com/news/page/1\&quot;&gt;blogs&lt;/a&gt; and &lt;a href=\&quot;https://www.stackbuilders.com/tutorials/\&quot;&gt;tutorials&lt;/a&gt;!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2020-10-06T12:00:00.000+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-09T23:12:11.790Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1T4sDDntXYb9EWUH82Cx4j/5efeaeedacc972b497c227072f1e0c14/cloudflare-worker-with-webassembly-and-haskell.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;4hhzQ9V5KQE5wXF4VtEcoG&quot;],&quot;name&quot;:[0,&quot;WASM&quot;],&quot;slug&quot;:[0,&quot;wasm&quot;]}],[0,{&quot;id&quot;:[0,&quot;5cye1Bh5KxFh3pKSnX8Dsy&quot;],&quot;name&quot;:[0,&quot;Serverless&quot;],&quot;slug&quot;:[0,&quot;serverless&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Cristhian Motoche&quot;],&quot;slug&quot;:[0,&quot;cristhian-motoche&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/EhfFT0wZdO9KhXd8SdyC3/5e470f052053519167a470bd680aa65e/cristhian-motoche.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,&quot;https://www.linkedin.com/in/cristhian-alberto-motoche-macas-706b86127&quot;],&quot;twitter&quot;:[0,&quot;@Camm_v222&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Let&#39;s combine the power of Haskell and WebAssembly in a Cloudflare Worker!&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;Let&#39;s build a Cloudflare Worker with WebAssembly and Haskell Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/cloudflare-worker-with-webassembly-and-haskell&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0],&quot;description&quot;:[0],&quot;imgPreview&quot;:[0,&quot;&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;36wNfaZBn3VBQ13FPMMsJW&quot;],&quot;title&quot;:[0,&quot;? The Wrangler CLI: Deploying Rust with WASM on Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;introducing-wrangler-cli&quot;],&quot;excerpt&quot;:[0,&quot;Today, we&#39;re open sourcing and announcing wrangler, a CLI tool for building, previewing, and publishing Rust and WebAssembly Cloudflare Workers. If that sounds like some word salad to you, that&#39;s a reasonable reaction.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;\n            &lt;figure class=\&quot;kg-card kg-image-card \&quot;&gt;\n            \n            &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2Iobv63iDeiVbJ4cXs9HZM/a793879dc189dcf7cfd4858a1aa5d128/wrangler_rust_wasm.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;2000\&quot; height=\&quot;367\&quot; loading=\&quot;lazy\&quot;/&gt;\n            \n            &lt;/figure&gt;&lt;p&gt;Wrangler is a CLI tool for building Rust WebAssembly Workers&lt;/p&gt;&lt;p&gt;Today, we&amp;#39;re open sourcing and announcing &lt;code&gt;wrangler&lt;/code&gt;, a CLI tool for building, previewing, and publishing Rust and WebAssembly Cloudflare Workers.&lt;/p&gt;&lt;p&gt;If that sounds like some word salad to you, that&amp;#39;s a reasonable reaction. All three of the technologies involved are relatively new and upcoming: WebAssembly, Rust, and Cloudflare Workers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;why-webassembly\&quot;&gt;Why WebAssembly?&lt;/h3&gt;\n            &lt;a href=\&quot;#why-webassembly\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Cloudflare&amp;#39;s mission is to help build a better Internet. We see Workers as an extension of the already incredibly powerful Web Platform, where JavaScript has allowed users to go from building small bits of interactivity, to building full applications. Node.js first extended this from the client to the server- unifying web application development around a single language – JavaScript. By choosing to use V8 isolates (the technology that powers both Node.js and the most popular browser, Chrome), we sought to make its Workers product a fully compatible, new platform for the Web, eliding the distinction between server and client. By leveraging its large global network of servers, Workers allows users to run code as close as possible to end users, eliminating the latency associated server-side logic or large client-side bundles.&lt;/p&gt;&lt;p&gt;But not everyone wants to write JavaScript, and JavaScript is not well suited to express every application. WebAssembly emerged in 2017 as a way to further extend the Web Platform to applications, such as games and other high resource intensive programs, that were previously excluded by the limitations of JavaScript.&lt;/p&gt;&lt;p&gt;V8 isolates give us both JavaScript and WebAssembly. This means that you can leverage the prototyping power and extensive ecosystem of JavaScript, alongside the power of WebAssembly, which in addition to fast, predictable, performance, also opens up the wealth of libraries written in languages that can target WebAssembly, like C, C++, and Rust.&lt;/p&gt;&lt;p&gt;WebAssembly on Workers eliminates trade-offs that were originally considered irresolvable: low-latency, high-performing, and Web Platform compatible- pick three.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;why-rust\&quot;&gt;Why Rust?&lt;/h3&gt;\n            &lt;a href=\&quot;#why-rust\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Rust is a relatively new programming language with the goal of &amp;quot;empowering everyone to build reliable and efficient software&amp;quot;. It&amp;#39;s a systems level language that offers its users a high amount of control, while still seeking to offer an ergonomic, friendly and modern development experience.&lt;/p&gt;&lt;p&gt;The Rust-WebAssembly Working Group made incredible efforts last year to build out a suite of developer tools for WebAssembly. At Cloudflare, we&amp;#39;re excited to support those efforts with paid developer hours and leverage those efforts to empower our users to start harnessing the power of WebAssembly on Workers now.&lt;/p&gt;&lt;p&gt;There are several other toolchains including Emscripten (C, C++) and AssemblyScript (TypeScript) that we&amp;#39;re eager to support in the future. Rust is just the beginning (but we think it&amp;#39;s a pretty great place to start!).&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;why-now\&quot;&gt;Why now?&lt;/h3&gt;\n            &lt;a href=\&quot;#why-now\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;When developing new, highly technical, products, it&amp;#39;s easy to get caught up in the promise and vision- often to the detriment of getting the technology into the hands of the folks who will be using it every day in the future.&lt;/p&gt;&lt;p&gt;We want to broaden the community that has access at the early stages of this technology- who can bring their valuable perspectives and experience, and help us shape the future of these tools.&lt;/p&gt;&lt;p&gt;The first step to accomplishing that is building the tools that can &lt;i&gt;enable&lt;/i&gt; folks to engage with the new platform. &lt;code&gt;wrangler&lt;/code&gt; is a that enabling tool. It&amp;#39;s just enough to unblock users who were previously unable to interact with the platform because there was no paved path.&lt;/p&gt;&lt;p&gt;We don&amp;#39;t plan to stop here. Folks will rightly note that there are some critical developer workflow steps that are missing from &lt;code&gt;wrangler&lt;/code&gt;: linting, testing, benchmarking, and size profiling are a few that come to mind. We&amp;#39;ve got some big plans and we&amp;#39;re excited to build out more, but we&amp;#39;re eager to release this now to enable &lt;i&gt;more&lt;/i&gt; folks to participate in the process. The best way to know what developers need is to ask and listen- by creating and open sourcing &lt;code&gt;wrangler&lt;/code&gt; in such an early phase we&amp;#39;re hoping to shorten the feedback cycle between product and user- and build the &lt;i&gt;right&lt;/i&gt; thing, &lt;i&gt;faster&lt;/i&gt;.&lt;/p&gt;&lt;p&gt;You can install &lt;code&gt;wrangler&lt;/code&gt; using &lt;code&gt;cargo&lt;/code&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-bash\&quot;&gt;&lt;code class=\&quot;language-bash\&quot;&gt;cargo install wrangler&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;To get started, head on over to the &lt;a href=\&quot;https://developers.cloudflare.com/workers/cli-wrangler\&quot;&gt;Cloudflare docs&lt;/a&gt; and follow the &lt;a href=\&quot;https://developers.cloudflare.com/workers/cli-wrangler/install-update\&quot;&gt;tutorial&lt;/a&gt;. You&amp;#39;ll build and preview a Cloudflare Worker that uses Rust compiled to WebAssembly to parse Markdown.&lt;/p&gt;&lt;p&gt;Don&amp;#39;t stop there though. Please check out &lt;a href=\&quot;https://github.com/cloudflare/wrangler\&quot;&gt;the repo&lt;/a&gt;, &lt;a href=\&quot;https://github.com/cloudflare/wrangler/issues\&quot;&gt;file some issues&lt;/a&gt;, build project templates, and write about your experience- we want to hear from you.&lt;/p&gt;&lt;p&gt;We&amp;#39;re really excited to see what y&amp;#39;all build!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2019-03-28T16:08:45.000+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-10T00:32:13.822Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4bQQJfk6NpFgLejYoC1c7V/b96b2b8adcfc3596a1228580da099dcb/introducing-wrangler-cli.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5cye1Bh5KxFh3pKSnX8Dsy&quot;],&quot;name&quot;:[0,&quot;Serverless&quot;],&quot;slug&quot;:[0,&quot;serverless&quot;]}],[0,{&quot;id&quot;:[0,&quot;78aSAeMjGNmCuetQ7B4OgU&quot;],&quot;name&quot;:[0,&quot;JavaScript&quot;],&quot;slug&quot;:[0,&quot;javascript&quot;]}],[0,{&quot;id&quot;:[0,&quot;5ghWZAL0nNGxrphuhWW6G0&quot;],&quot;name&quot;:[0,&quot;WebAssembly&quot;],&quot;slug&quot;:[0,&quot;webassembly&quot;]}],[0,{&quot;id&quot;:[0,&quot;w4e8pkoz9c8xNDVhy9eNe&quot;],&quot;name&quot;:[0,&quot;Rust&quot;],&quot;slug&quot;:[0,&quot;rust&quot;]}],[0,{&quot;id&quot;:[0,&quot;4YYee7nj2IYM3qb1AjguFP&quot;],&quot;name&quot;:[0,&quot;CLI&quot;],&quot;slug&quot;:[0,&quot;cli&quot;]}],[0,{&quot;id&quot;:[0,&quot;3CHhhmZIu8jnzcZ81VLRUQ&quot;],&quot;name&quot;:[0,&quot;Wrangler&quot;],&quot;slug&quot;:[0,&quot;wrangler&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Ashley Williams&quot;],&quot;slug&quot;:[0,&quot;ashley-williams&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/60XJfmkgUaYRc9qyxvukGS/66f3c788012eb0c3f0f76c1209cd8c3a/ashley-williams.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,null],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;? The Wrangler CLI: Deploying Rust with WASM on Cloudflare Workers Config&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/introducing-wrangler-cli&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0],&quot;description&quot;:[0],&quot;imgPreview&quot;:[0,&quot;&quot;]}],&quot;publicly_index&quot;:[0,true]}]]],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;MorePosts&quot;,&quot;value&quot;:true}" await-children><div class="w-100 bt-l b--gray8"><h3 data-testid="more-posts-title" class="orange fw5 f4 ph3 mt4">MORE POSTS</h3></div><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2022-07-07T17:09:43.000+01:00">July 07, 2022  4:09 PM</p><a href="/announcing-wasi-on-workers/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Announcing support for WASI on Cloudflare Workers</h6></a><p class="gray1 lh-copy">Today, we are announcing experimental support for WASI (the WebAssembly System Interface) on Cloudflare Workers and support within wrangler2 to make it a joy to work with<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/ben-yule/" class="fw5 f2 black no-underline">Ben Yule</a></div></li><li class="list flex items-center"><div class="author-name-tooltip"><span class="fw5 f2 black no-underline">, </span><a href="/author/zeb/" class="fw5 f2 black no-underline">Zebulon Piasecki</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/webassembly/" class="no-underline f1 fw2 blue3 underline-hover">WebAssembly</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/wasm/" class="no-underline f1 fw2 blue3 underline-hover">WASM</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developers/" class="no-underline f1 fw2 blue3 underline-hover">Developers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/developer-platform/" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2021-09-09T14:00:02.000+01:00">September 09, 2021  1:00 PM</p><a href="/workers-rust-sdk/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Native Rust support on Cloudflare Workers</h6></a><p class="gray1 lh-copy">Introducing the Cloudflare Workers Rust SDK: write your entire Worker in Rust, no JavaScript required.
<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/steve-manuel/" class="fw5 f2 black no-underline">Steve Manuel</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/serverless/" class="no-underline f1 fw2 blue3 underline-hover">Serverless</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/webassembly/" class="no-underline f1 fw2 blue3 underline-hover">WebAssembly</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/rust/" class="no-underline f1 fw2 blue3 underline-hover">Rust</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/wasm/" class="no-underline f1 fw2 blue3 underline-hover">WASM</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2020-10-06T12:00:00.000+01:00">October 06, 2020  11:00 AM</p><a href="/cloudflare-worker-with-webassembly-and-haskell/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">Let&#x27;s build a Cloudflare Worker with WebAssembly and Haskell</h6></a><p class="gray1 lh-copy">Let&#x27;s combine the power of Haskell and WebAssembly in a Cloudflare Worker!<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/cristhian-motoche/" class="fw5 f2 black no-underline">Cristhian Motoche</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/webassembly/" class="no-underline f1 fw2 blue3 underline-hover">WebAssembly</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/wasm/" class="no-underline f1 fw2 blue3 underline-hover">WASM</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/serverless/" class="no-underline f1 fw2 blue3 underline-hover">Serverless</a></div></div></article><article data-testid="more-posts-article" class="w-100 w-100-m ph3 mb4"><p class="f3 fw5 gray1" data-iso-date="2019-03-28T16:08:45.000+00:00">March 28, 2019  4:08 PM</p><a href="/introducing-wrangler-cli/" class="no-underline gray1 f4 fw5"><h6 class="gray1 f4 fw5 mt2">? The Wrangler CLI: Deploying Rust with WASM on Cloudflare Workers</h6></a><p class="gray1 lh-copy">Today, we&#x27;re open sourcing and announcing wrangler, a CLI tool for building, previewing, and publishing Rust and WebAssembly Cloudflare Workers. If that sounds like some word salad to you, that&#x27;s a reasonable reaction.<!-- -->...</p><ul class="flex pl0 fw6 f2"><span>By<!-- --> </span><li class="list flex items-center"><div class="author-name-tooltip"><a href="/author/ashley-williams/" class="fw5 f2 black no-underline">Ashley Williams</a></div></li></ul><div class="flex flex-row flex-wrap"><div><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/serverless/" class="no-underline f1 fw2 blue3 underline-hover">Serverless</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/javascript/" class="no-underline f1 fw2 blue3 underline-hover">JavaScript</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/webassembly/" class="no-underline f1 fw2 blue3 underline-hover">WebAssembly</a></div><div><span class="f1 fw2 blue3 no-underline underline-hover">, </span><a href="/tag/rust/" class="no-underline f1 fw2 blue3 underline-hover">Rust</a></div></div></article><!--astro:end--></astro-island> <div class="pagination mw-100 center mv5 ph3 w-100 tc"><div class="center w-50-l w-100"><div class="flex items-center justify-center justify-around-m "><ul class="flex list ml3" style="padding-inline-start:inherit"><li class="gray"><a class="no-underline  underline-hover  dib-m dib-l mr1 gray3 " href="/tag/webassembly/">1</a></li></ul></div></div></div> </main>  <footer class="pt4 pb4 pl1 pr1 main-footer"><div class="mw8 center dn db-l ph3"><div class="flex flex-row justify-between"><div class="main-footer__menu-group"><ul id="getting-started-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="getting-started-menu">Getting Started<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/free/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="free-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Free plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/enterprise/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="enterprise" class="f1 blue3 no-underline underline-hover" rel="noreferrer">For enterprises</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compare-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compare plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-your-website/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="get-a-recommendation" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Get a recommendation</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/demo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="request-a-demo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Request a demo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/contact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="contact-sales" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Contact Sales</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1" data-submenu="company-menu">Resources<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/learning/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="learning-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Learning Center</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/analysts/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="analysts-report" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Analyst reports</a></li><li class="pt1 pb1"><a href="https://radar.cloudflare.com/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Radar</a></li><li class="pt1 pb1"><a href="https://cloudflare.tv/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="tv" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare TV</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/case-studies/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="case-studies" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Case Studies</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Webinar" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="webinars" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Webinars</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Whitepaper" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="white-papers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">White Papers</a></li><li class="pt1 pb1"><a href="https://developers.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-docs" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer docs</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/the-net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="theNet" class="f1 blue3 no-underline underline-hover" rel="noreferrer">theNet</a></li></ul></div><div class="main-footer__menu-group"><ul id="sales-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="sales-menu">Solutions<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connectivity-cloud/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connectivity-cloud" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connectivity cloud</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/zero-trust/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="zero-trust" class="f1 blue3 no-underline underline-hover" rel="noreferrer">SSE and SASE services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/application-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="application-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Application services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/developer-platform/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer services</a></li></ul></div><div class="main-footer__menu-group"><ul id="community-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="community-menu">Community<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://community.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="community_hub" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Community Hub</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/galileo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="galileo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Project Galileo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/athenian/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="athenian" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Athenian Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/campaigns/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="cloudflare-for-campaigns" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare for Campaigns</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/technology-partners/cidp/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="critical-infrastructure-defense-project" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Critical Infrastructure Defense Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connect2024/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connect-2024" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connect 2024</a></li></ul></div><div class="main-footer__menu-group"><ul id="support-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="support-menu">Support<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://support.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="help-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Help center</a></li><li class="pt1 pb1"><a href="https://www.cloudflarestatus.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="status" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Status</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/compliance/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compliance" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compliance</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/gdpr/introduction/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="gdpr" class="f1 blue3 no-underline underline-hover" rel="noreferrer">GDPR</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/trust-hub/abuse-approach/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="trust-and-safety" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Trust &amp; Safety</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="company-menu">Company<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-overview/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">About Cloudflare</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/people/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="our_team" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Our team</a></li><li class="pt1 pb1"><a href="https://cloudflare.net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="investor-relations" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Investor relations</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Press</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/careers/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="careers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Careers</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/diversity-equity-and-inclusion/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="diversity-equity-inclusion" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Diversity, equity &amp; inclusion</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/impact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="impact-ESG" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Impact/ESG</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network_map" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network Map</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press-kit/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press-kit" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Logos &amp; press kit</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="partners" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Become a partner</a></li></ul></div></div></div><div class="mw8 center ph3"><div class="flex flex-row flex-wrap justify-center md:justify-between items-center pt4"><div class="flex flex-row space-x-4 items-start w-25-l pb4 pb0-l"><a target="_blank" rel="noreferrer" href="https://www.facebook.com/Cloudflare/" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/facebook.svg" alt="facebook"/></a><a target=" _blank" rel="noreferrer" href="https://x.com/Cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/twitter.svg" alt="X"/></a><a target="_blank" rel="noreferrer" href="https://www.linkedin.com/company/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/linkedin.svg" alt="linkedin"/></a><a target="_blank" rel="noreferrer" href="https://www.youtube.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/youtube.svg" alt="youtube"/></a><a target="_blank" rel="noreferrer" href="https://www.instagram.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/instagram.svg" alt="instagram"/></a></div><div class="w-70-l tr-l tl-ns"><div><span class="main-footer__copyright f1">© <!-- -->2025<!-- --> Cloudflare, Inc.<!-- --> </span><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/privacypolicy/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Privacy Policy<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/website-terms/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Terms of Use<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/disclosure/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Report Security Issues<!-- --> </a><span class="main-footer__copyright f1">|</span><img class="mw2 ph1" src="/images/privacy-options.svg" alt="Privacy Options"/><a href="#cookie-settings" id="ot-sdk-btn" class="ot-sdk-show-settings main-footer__copyright f1 no-underline underline-hover"><span class="brandGray5">Cookie Preferences</span> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/trademark/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Trademark<!-- --> </a></div></div></div></div></footer></html>